name: Build and resolve dependencies

on:
  pull_request:
    paths:
      - datadog_checks_base/datadog_checks/base/data/agent_requirements.in

jobs:
  build-and-resolve-dependencies-linux:
    name: "Build and resolve dependencies for Linux platforms"
    strategy:
      matrix:
        os: ["deb_x64", "rpm_x64"]
    runs-on: "ubuntu-22.04"
    steps:
      - uses: actions/checkout@v4
      - run: "bash .deps-builder/build-dependencies.sh"
        env:
          TARGET_PLATFORM: ${{ matrix.os }}
          AGENT_BUILD_IMAGE_VERSION: "v20878799-a2f77ae"
          INTEGRATIONS_CORE_PATH: ${{ github.workspace }}
          DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
          DOCKER_ACCESS_TOKEN: ${{ secrets.DOCKER_ACCESS_TOKEN }}
