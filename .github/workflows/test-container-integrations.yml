name: Test container integrations

on:
  workflow_call:
    inputs:
      repo:
        required: true
        type: string

      python-version:
        required: false
        default: ""
        type: string
      standard:
        required: false
        default: false
        type: boolean
      latest:
        required: false
        default: false
        type: boolean
      minimum-base-package:
        required: false
        default: false
        type: boolean
      test-py2:
        required: false
        default: false
        type: boolean
      test-py3:
        required: false
        default: true
        type: boolean
      agent-image:
        required: false
        default: ""
        type: string
      agent-image-py2:
        required: false
        default: ""
        type: string
      agent-image-windows:
        required: false
        default: ""
        type: string
      agent-image-windows-py2:
        required: false
        default: ""
        type: string

jobs:
  je6bb20d:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: cert-manager
      target: cert_manager
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  ja3692a6:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: CRI-O
      target: crio
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j2d21154:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Datadog Cluster Agent
      target: datadog_cluster_agent
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j562bfe5:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Amazon ECS Fargate
      target: ecs_fargate
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j72f26c1:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: EKS Fargate
      target: eks_fargate
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j92491f1:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubernetes API server metrics
      target: kube_apiserver_metrics
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j1ce0516:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubernetes Controller Manager
      target: kube_controller_manager
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j19a1b27:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kube DNS
      target: kube_dns
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  jd1817b8:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kube metrics server
      target: kube_metrics_server
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j5a98c4e:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kube Proxy
      target: kube_proxy
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  jeebd4ae:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubernetes Scheduler
      target: kube_scheduler
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j24a5cff:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubelet
      target: kubelet
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  j045310a:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubernetes Cluster Autoscaler
      target: kubernetes_cluster_autoscaler
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  jba841f0:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: Kubernetes State
      target: kubernetes_state
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  ja114815:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: NGINX Ingress Controller
      target: nginx_ingress_controller
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  jaaa5727:
    uses: ./.github/workflows/test-target.yml
    with:
      job-name: OpenMetrics
      target: openmetrics
      platform: linux
      runner: '["ubuntu-22.04"]'
      repo: "${{ inputs.repo }}"
      python-version: "${{ inputs.python-version }}"
      standard: ${{ inputs.standard }}
      latest: ${{ inputs.latest }}
      agent-image: "${{ inputs.agent-image }}"
      agent-image-py2: "${{ inputs.agent-image-py2 }}"
      agent-image-windows: "${{ inputs.agent-image-windows }}"
      agent-image-windows-py2: "${{ inputs.agent-image-windows-py2 }}"
      test-py2: ${{ inputs.test-py2 }}
      test-py3: ${{ inputs.test-py3 }}
      minimum-base-package: ${{ inputs.minimum-base-package }}
    secrets: inherit
  