name: Add team labels
on:
  pull_request:
    types:
      - review_requested

jobs:
  add_team_label:
    runs-on: ubuntu-latest
    name: Add team label
    permissions:
      pull-requests: write
    steps:
      - name: Add labels
        run: |
          for team in $(jq -r '.event.pull_request.requested_teams[].name' <<< "$GITHUB_CONTEXT"); do 
            gh pr edit $NUMBER --add-label "team/$team"
          done
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_REPO: ${{ github.repository }}
          NUMBER: ${{ github.event.number }}
