name: Control-M
files:
- name: control_m.yaml
  options:
  - template: init_config
    options:
    - template: init_config/default
    - template: init_config/http
  - template: instances
    options:
    - name: control_m_api_endpoint
      required: true
      description: |
        Control-M Automation API endpoint, including the `/automation-api` path.
      value:
        type: string
        example: https://example.com:8443/automation-api
      display_priority: 2
    - name: control_m_username
      required: false
      description: |
        Control-M username used for session-login authentication.
        Must be set together with `control_m_password`.
      value:
        type: string
        example: workbench
    - name: control_m_password
      required: false
      secret: true
      description: |
        Control-M password used for session-login authentication.
        Must be set together with `control_m_username`.
      value:
        type: string
    - name: token_lifetime_seconds
      required: false
      description: |
        Assumed Control-M session token lifetime in seconds.
      value:
        type: integer
        example: 1800
    - name: token_refresh_buffer_seconds
      required: false
      description: |
        Refresh session token this many seconds before expiration.
      value:
        type: integer
        example: 300
    - name: job_status_limit
      required: false
      description: |
        Limit query parameter sent to `/run/jobs/status`.
      value:
        type: integer
        example: 200
    - name: job_name_filter
      required: false
      description: |
        Job name filter sent to `/run/jobs/status` as the `jobname` query parameter.
      value:
        type: string
        example: "*"
    - template: instances/http
      overrides:
        headers.display_priority: 1
        headers.enabled: true
        headers.description: |
          Optional HTTP headers to send with every request.
          Use this for static token authentication, for example:
            Authorization: Bearer <your_token>
        headers.value.example:
          Authorization: Bearer <your_token>
        username.hidden: true
        password.hidden: true
    - template: instances/default
