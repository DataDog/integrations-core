* Enable Accounting and Statistics
ALTER QMGR ACCTINT(1) ACCTMQI(ON) ACCTQ(ON)
ALTER QMGR STATINT(1) STATMQI(ON) STATQ(ON) STATCHL(HIGH) STATACLS(MEDIUM)

* Enable Queue Monitoring
ALTER QMGR MONQ(MEDIUM)

* Define the full repository for the cluster
ALTER QMGR REPOS(GCP)

* Define backstop rule for channel auth
SET CHLAUTH('*') TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(NOACCESS) DESCR('Back-stop rule - Blocks everyone') ACTION(REPLACE)

* Clustering channels and listeners
DEFINE LISTENER(A_LS) TRPTYPE(TCP) CONTROL(QMGR)

DEFINE CHANNEL(GCP.A) CHLTYPE(CLUSRCVR) CONNAME('ibm_mq1') CLUSTER(GCP) REPLACE
DEFINE CHANNEL(GCP.B) CHLTYPE(CLUSSDR) CONNAME('ibm_mq2') CLUSTER(GCP) REPLACE

SET CHLAUTH('GCP.A') TYPE (QMGRMAP) QMNAME(B) USERSRC(CHANNEL) ADDRESS('*')


* Application queues
DEFINE QLOCAL('APP.QUEUE.1') DEFBIND(NOTFIXED) CLWLUSEQ(ANY) CLUSTER(GCP) REPLACE

* Application topics
DEFINE TOPIC('APP.BASE.TOPIC') TOPICSTR('app/') REPLACE

* Application connection authentication
** DEFINE AUTHINFO('APP.AUTHINFO') AUTHTYPE(IDPWOS) CHCKCLNT(REQDADM) CHCKLOCL(OPTIONAL) ADOPTCTX(YES) REPLACE
** ALTER QMGR CONNAUTH('APP.AUTHINFO')
** REFRESH SECURITY(*) TYPE(CONNAUTH)

* Application channels
** DEFINE CHANNEL('APP.SVRCONN') CHLTYPE(SVRCONN) MCAUSER('app') REPLACE
** SET CHLAUTH('APP.SVRCONN') TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(CHANNEL) CHCKCLNT(REQUIRED) DESCR('Allows connection via APP channel') ACTION(REPLACE)

* Application auth records
** SET AUTHREC GROUP('mqclient') OBJTYPE(QMGR) AUTHADD(CONNECT,INQ)
** SET AUTHREC PROFILE('APP.**') GROUP('mqclient') OBJTYPE(QUEUE) AUTHADD(BROWSE,GET,INQ,PUT)
** SET AUTHREC PROFILE('APP.**') GROUP('mqclient') OBJTYPE(TOPIC) AUTHADD(PUB,SUB)


ALTER QMGR CHLAUTH (DISABLED)
