id: trend-micro-cloud-one
metric_id: trend-micro-cloud-one
backend_only: false
facets:
  - groups:
      - DNS
    name: Question Name
    path: dns.question.name
    source: log
  - groups:
      - Event
    name: Event Name
    path: evt.name
    source: log
  - groups:
      - Web Access
    name: URL Path
    path: http.url
    source: log
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Client Port
    path: network.client.port
    source: log
  - groups:
      - Geoip
    name: Destination City Name
    path: network.destination.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Destination Continent Code
    path: network.destination.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Destination Continent Name
    path: network.destination.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Destination Country ISO Code
    path: network.destination.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Country Name
    path: network.destination.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision ISO Code
    path: network.destination.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision Name
    path: network.destination.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Destination IP
    path: network.destination.ip
    source: log
  - groups:
      - Web Access
    name: Destination Port
    path: network.destination.port
    source: log
  - groups:
      - User
    name: User ID
    path: usr.id
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
pipeline:
  type: pipeline
  name: Trend Micro Cloud One
  enabled: true
  filter:
    query: "source:trend-micro-cloud-one"
  processors:
    - type: grok-parser
      name: For Workload Security
      enabled: true
      source: message
      samples:
        - <134>2025-07-21T10:41:59Z deepsecurity LEEF:2.0|Trend Micro|Deep
          Security Agent|50.0.3930|21|cat=Firewall name=Deny Internal IP Ranges
          desc=Deny Internal IP Ranges sev=5 cn1=67 cn1Label=Host ID
          dvchost=rhel7-50-5-112 TrendMicroDsTenant=279555847073
          TrendMicroDsTenantId=146271 act=Deny dstMAC=FF:FF:FF:FF:FF:FF
          srcMAC=00:50:56:83:90:7B TrendMicroDsFrameType=IP src=10.0.0.0
          dst=10.0.0.1 in=0 proto=UDP srcPort=12276 dstPort=5055 cnt=172
        - <134>2025-07-29T02:37:51Z deepsecurity LEEF:2.0|Trend Micro|Deep
          Security Agent|50.0.3945|6002200|cat=AppControl name=blocked
          desc=blocked sev=6 cn1=102 cn1Label=Host ID dvchost=admin
          TrendMicroDsTenant=279555847073 TrendMicroDsTenantId=146271
          fileHash=93FA129820D7DD585924E7A2A0633CA424D12836547AC8A8BBD461B5915DEB2A
          suser=admin\\test suid=S-1-5-21-2195366824-2826071503-3266291696-1001
          act=blocked filePath=C:\\Program
          Files\\WindowsApps\\Microsoft.WindowsFeedbackHub_1.2506.12104.0_x64__8wekyb3d8bbwe\\\\PilotshubApp.dll
          fsize=36801024 aggregationType=0 repeatCount=1 cs1=notWhitelisted
          cs1Label=actionReason cs2=14B28E4364B27B823ECE3D0ACB3665A020BB7259
          cs2Label=sha1 cs3=68279BF3A9044AC30953EE11180F5BBD cs3Label=md5
      grok:
        supportRules: >-
          extract_data_till_pipe_delimited %{regex("[^|]*")}

          extract_key_value_pair %{data::keyvalue("=", "\\n\\]\\[{}\"\" :;,/!''\\(\\)*~#&$%^?+\\\\")}
        matchRules: trend_micro_cloud_one_rule
          (<%{integer}>)?%{date("yyyy-M-d'T'H:m:sZ"):time} %{notSpace}
          %{extract_data_till_pipe_delimited}\|%{extract_data_till_pipe_delimited:device_vendor}\|%{extract_data_till_pipe_delimited:device_product}\|%{extract_data_till_pipe_delimited:device_version}\|%{extract_data_till_pipe_delimited:signature_id}\|%{extract_key_value_pair}
    - type: grok-parser
      name: For Network Security
      enabled: true
      source: message
      samples:
        - '714 <36>1 2025-08-01T09:14:32.127+00:00 NetworkSecurityPoC
          LOGID_10-IPS_BLOCK-WARNING - - [meta sequenceId="1413"]
          <36>2025-08-01T09:14:32.127+00:00 NetworkSecurityPoC IPS:
          CEF:0|TippingPoint|vTPS Cloud|2024.9.0.13694|560|DNS: Version Request
          (UDP)|2|dvchost=NetworkSecurityPoC dvc=10.0.0.0 cat=IpsBlock
          deviceFacility=IPS act=Block cs2=00000002-0002-0002-0002-000000000560
          cs2Label=Policy UUID cs3=00000001-0001-0001-0001-000000000560
          cs3Label=Signature UUID src=10.0.0.1 spt=49651 dst=10.0.0.2 dpt=53
          start=Aug 01 2025 09:14:32+0000 cnt=1 deviceInboundInterface=1B
          deviceOutboundInterface=1A cs1=cloud formation cs1Label=Virtual
          Segment cn2=0 cn2Label=SSL Flag c6a1=10.0.0.3 c6a1Label=Client IPv4'
        - '776 <37>1 2025-08-01T09:22:55.627+00:00 NetworkSecurityPoC
          LOGID_10-REP_BLOCK-NOTICE - - [meta sequenceId="1418"]
          <37>2025-08-01T09:22:55.627+00:00 NetworkSecurityPoC IPS:
          CEF:0|TippingPoint|vTPS Cloud|2024.9.0.13694|7610|IP
          Reputation|1|dvchost=NetworkSecurityPoC dvc=10.0.0.0
          cat=ReputationBlock deviceFacility=Reputation act=Block
          cs2=e19397df-f749-4cdb-a2fa-6aa71f1326ed cs2Label=Policy UUID
          cs3=00000001-0001-0001-0001-000000007610 cs3Label=Signature UUID
          src=10.0.0.1 spt=80 dst=10.0.0.2 dpt=57064 start=Aug 01 2025
          00:07:26+0000 cnt=1 deviceInboundInterface=1B
          deviceOutboundInterface=1A cs1=cloud formation cs1Label=Virtual
          Segment cn2=0 cn2Label=SSL Flag c6a1=10.0.0.3 c6a1Label=Client IPv4
          cs6=10.0.0.3 Geolocation Filtering cs6Label=Parameters'
      grok:
        supportRules: >-
          extract_data_till_pipe_delimited %{regex("[^|]*")}

          extract_key_value_pair %{data::keyvalue("=", "\\]\\[{}\"\" :;,/!''\\(\\)*~#&$%^?+\\\\")}
        matchRules: "trend_micro_cloud_one_rule1 %{notSpace} %{notSpace} %{notSpace}
          %{notSpace} %{notSpace:sev} %{notSpace} %{notSpace}
          %{regex(\"[^]]*\")}]\\s*%{regex(\"[^>]*\")}>%{date(\"yyyy-M-d'T'H:m:s\
          .SSSZZ\"):time} %{notSpace} %{regex(\"(.*?)(?=:)\")}\\:
          %{extract_data_till_pipe_delimited}\\|%{extract_data_till_pipe_delimi\
          ted}\\|%{extract_data_till_pipe_delimited}\\|%{extract_data_till_pipe\
          _delimited}\\|%{extract_data_till_pipe_delimited}\\|%{extract_data_ti\
          ll_pipe_delimited}\\|%{extract_data_till_pipe_delimited}\\|%{extract_\
          key_value_pair}"
    - type: date-remapper
      name: Define `time` as the official date of the log
      enabled: true
      sources:
        - time
    - type: attribute-remapper
      name: Map `cat` to `category`
      enabled: true
      sources:
        - cat
      sourceType: attribute
      target: category
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `sev` to `severity`
      enabled: true
      sources:
        - sev
      sourceType: attribute
      target: severity
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `act` to `action`
      enabled: true
      sources:
        - act
      sourceType: attribute
      target: action
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `name` to `evt.name`
      enabled: true
      sources:
        - name
      sourceType: attribute
      target: evt.name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dst` to `network.destination.ip`
      enabled: true
      sources:
        - dst
      sourceType: attribute
      target: network.destination.ip
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dstPort` to `network.destination.port`
      enabled: true
      sources:
        - dstPort
      sourceType: attribute
      target: network.destination.port
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `src` to `network.client.ip`
      enabled: true
      sources:
        - src
      sourceType: attribute
      target: network.client.ip
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: category-processor
      name: Category Processor for `status`
      enabled: true
      categories:
        - filter:
            query: "@severity:(LOGID_10-REP_BLOCK-NOTICE OR LOGID_10-IPS_BLOCK-NOTICE)"
          name: notice
        - filter:
            query: "@severity:(LOGID_10-REP_BLOCK-ERROR OR LOGID_10-IPS_BLOCK-ERROR OR [5 TO
              7])"
          name: error
        - filter:
            query: "@severity:(LOGID_10-REP_BLOCK-WARNING OR LOGID_10-IPS_BLOCK-WARNING OR
              [2 TO 4])"
          name: warning
        - filter:
            query: "@severity:(LOGID_10-REP_BLOCK-CRIT OR LOGID_10-IPS_BLOCK-CRIT OR [8 TO
              10])"
          name: critical
        - filter:
            query: "@severity:1"
          name: info
      target: status
    - type: status-remapper
      name: Define `status` as the official status of the log
      enabled: true
      sources:
        - status
    - type: pipeline
      name: Processing of Workload Security System Events
      enabled: true
      filter:
        query: "@category:System"
      processors:
        - type: attribute-remapper
          name: Map `usrName` to `usr.name`
          enabled: true
          sources:
            - usrName
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing of Workload Security Anti-Malware Events
      enabled: true
      filter:
        query: "@category:Anti-Malware"
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `suser` to `usr.name`
          enabled: true
          sources:
            - suser
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cn2` to `quarantine_file_size`
          enabled: true
          sources:
            - cn2
          sourceType: attribute
          target: quarantine_file_size
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs3` to `infected_resource`
          enabled: true
          sources:
            - cs3
          sourceType: attribute
          target: infected_resource
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs4` to `resource_type`
          enabled: true
          sources:
            - cs4
          sourceType: attribute
          target: resource_type
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs5` to `risk_level`
          enabled: true
          sources:
            - cs5
          sourceType: attribute
          target: risk_level
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs6` to `container`
          enabled: true
          sources:
            - cs6
          sourceType: attribute
          target: container
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - name: Lookup on `resource_type` to `resource_type_value`
          enabled: true
          source: resource_type
          target: resource_type_value
          lookupTable: |-
            10,Files and Directories
            11,System Registry
            12,Internet Cookies
            13,Internet URL Shortcut
            14,Programs in Memory
            15,Program Startup Areas
            16,Browser Helper Object
            17,Layered Service Provider
            18,Hosts File
            19,Windows Policy Settings
            20,Browser
            23,Windows Shell Setting
            24,IE Downloaded Program Files
            25,Add/Remove Programs
            26,Services
            other,Other
          type: lookup-processor
        - name: Lookup on `risk_level` to `risk_level_severity`
          enabled: true
          source: risk_level
          target: risk_level_severity
          lookupTable: |-
            0,Very Low
            25,Low
            50,Medium
            75,High
            100,Very High
          type: lookup-processor
    - type: pipeline
      name: Processing of Workload Security Application Control Events
      enabled: true
      filter:
        query: "@category:AppControl"
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs1` to `actionReason`
          enabled: true
          sources:
            - cs1
          sourceType: attribute
          target: actionReason
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs2` to `sha1`
          enabled: true
          sources:
            - cs2
          sourceType: attribute
          target: sha1
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs3` to `md5`
          enabled: true
          sources:
            - cs3
          sourceType: attribute
          target: md5
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `suid` to `usr.id`
          enabled: true
          sources:
            - suid
          sourceType: attribute
          target: usr.id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `suser` to `usr.name`
          enabled: true
          sources:
            - suser
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: category-processor
          name: Category Processor for `aggregationReason`
          enabled: true
          categories:
            - filter:
                query: "@aggregationType:1"
              name: The event is aggregated based on file name, path, and event type.
            - filter:
                query: "@aggregationType:0"
              name: The event is not aggregated.
            - filter:
                query: "@aggregationType:2"
              name: The event is aggregated based on event type.
          target: aggregationReason
    - type: pipeline
      name: Processing of Workload Security Firewall Events
      enabled: true
      filter:
        query: "@category:Firewall"
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs2` to `tcp_flags`
          enabled: true
          sources:
            - cs2
          sourceType: attribute
          target: tcp_flags
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs3` to `fragmentation_bits`
          enabled: true
          sources:
            - cs3
          sourceType: attribute
          target: fragmentation_bits
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs4` to `icmp_type_code`
          enabled: true
          sources:
            - cs4
          sourceType: attribute
          target: icmp_type_code
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `in` to `network.bytes_read`
          enabled: true
          sources:
            - in
          sourceType: attribute
          target: network.bytes_read
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `out` to `network.bytes_written`
          enabled: true
          sources:
            - out
          sourceType: attribute
          target: network.bytes_written
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `srcPort` to `network.client.port`
          enabled: true
          sources:
            - srcPort
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `TrendMicroDsUserName` to `usr.name`
          enabled: true
          sources:
            - TrendMicroDsUserName
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing of Workload Security Intrusion Prevention Events
      enabled: true
      filter:
        query: '@category:"Intrusion Prevention"'
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs2` to `tcp_flags`
          enabled: true
          sources:
            - cs2
          sourceType: attribute
          target: tcp_flags
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs3` to `fragmentation_bits`
          enabled: true
          sources:
            - cs3
          sourceType: attribute
          target: fragmentation_bits
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs4` to `icmp_type_code`
          enabled: true
          sources:
            - cs4
          sourceType: attribute
          target: icmp_type_code
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `in` to `network.bytes_read`
          enabled: true
          sources:
            - in
          sourceType: attribute
          target: network.bytes_read
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `out` to `network.bytes_written`
          enabled: true
          sources:
            - out
          sourceType: attribute
          target: network.bytes_written
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `srcPort` to `network.client.port`
          enabled: true
          sources:
            - srcPort
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cn3` to `packet_position`
          enabled: true
          sources:
            - cn3
          sourceType: attribute
          target: packet_position
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs1` to `note`
          enabled: true
          sources:
            - cs1
          sourceType: attribute
          target: note
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs5` to `stream_position`
          enabled: true
          sources:
            - cs5
          sourceType: attribute
          target: stream_position
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs6` to `flags`
          enabled: true
          sources:
            - cs6
          sourceType: attribute
          target: flags
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs7` to `flow`
          enabled: true
          sources:
            - cs7
          sourceType: attribute
          target: flow
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - name: Lookup on `flags` to `intrusion_prevention_flag`
          enabled: true
          source: flags
          target: intrusion_prevention_flag
          lookupTable: |-
            1,Data truncated - Data could not be logged.
            2,Log Overflow - Log overflowed after this log.
            4,Suppressed - Logs threshold suppressed after this log.
            8,Have Data - Contains packet data.
            16,Reference Data - References previously logged data.
          type: lookup-processor
        - name: Lookup on `flow` to `event_flow`
          enabled: true
          source: flow
          target: event_flow
          lookupTable: |-
            FWD,Connection Flow
            REV,Reverse Flow
          type: lookup-processor
    - type: pipeline
      name: Processing of Workload Security Integrity Monitor Events
      enabled: true
      filter:
        query: '@category:"Integrity Monitor"'
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `suser` to `usr.name`
          enabled: true
          sources:
            - suser
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing of Workload Security Log Inspection Events
      enabled: true
      filter:
        query: '@category:"Log Inspection"'
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs1` to `li_desc`
          enabled: true
          sources:
            - cs1
          sourceType: attribute
          target: li_desc
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `duser` to `usr.name`
          enabled: true
          sources:
            - duser
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing of Workload Security Web Reputation Events
      enabled: true
      filter:
        query: '@category:"Web Reputation"'
      processors:
        - type: attribute-remapper
          name: Map `cn1` to `host_id`
          enabled: true
          sources:
            - cn1
          sourceType: attribute
          target: host_id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `request` to `http.url`
          enabled: true
          sources:
            - request
          sourceType: attribute
          target: http.url
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing of Workload Security Device Control Events
      enabled: true
      filter:
        query: '@category:"Device Control"'
      processors:
        - type: attribute-remapper
          name: Map `domainName` to `dns.question.name`
          enabled: true
          sources:
            - domainName
          sourceType: attribute
          target: dns.question.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - name: Lookup on `deviceType` to `device_type`
          enabled: true
          source: deviceType
          target: device_type
          lookupTable: |-
            1,USB_STORAGE_DEVICE
            2,MOBILE_DEVICE
          type: lookup-processor
        - name: Lookup on `permission` to `device_permission`
          enabled: true
          source: permission
          target: device_permission
          lookupTable: |-
            0,BLOCK
            2,READ_ONLY
          type: lookup-processor
    - type: pipeline
      name: Processing of Network Security Events
      enabled: true
      filter:
        query: "@category:(ReputationBlock OR IpsBlock)"
      processors:
        - type: attribute-remapper
          name: Map `cs2` to `policy_uuid`
          enabled: true
          sources:
            - cs2
          sourceType: attribute
          target: policy_uuid
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs3` to `signature_uuid`
          enabled: true
          sources:
            - cs3
          sourceType: attribute
          target: signature_uuid
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `spt` to `network.client.port`
          enabled: true
          sources:
            - spt
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `dpt` to `network.destination.port`
          enabled: true
          sources:
            - dpt
          sourceType: attribute
          target: network.destination.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cs1` to `virtual_segment`
          enabled: true
          sources:
            - cs1
          sourceType: attribute
          target: virtual_segment
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `cn2` to `ssl_flag`
          enabled: true
          sources:
            - cn2
          sourceType: attribute
          target: ssl_flag
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `c6a1` to `client_ipv4`
          enabled: true
          sources:
            - c6a1
          sourceType: attribute
          target: client_ipv4
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: geo-ip-parser
      name: Extracting Geo Location from Source IP Address
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
      ip_processing_behavior: do-nothing
    - type: geo-ip-parser
      name: Extracting Geo Location from Destination IP Address
      enabled: true
      sources:
        - network.destination.ip
      target: network.destination.geoip
      ip_processing_behavior: do-nothing
