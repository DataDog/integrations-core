{"title":"Trend Micro Cloud One - Integrity Monitoring Events","description":"This dashboard provides a comprehensive summary of Integrity Monitoring Events.","widgets":[{"id":7860122956062256,"definition":{"type":"image","url":"https://www.trendmicro.com/content/dam/trendmicro/global/en/global/logo/trend-micro-logo.png","url_dark_theme":"https://www.trendmicro.com/content/dam/trendmicro/global/en/core/images/logos/tm-logo-red-white-t.svg","sizing":"contain","margin":"md","has_background":true,"has_border":true,"vertical_align":"center","horizontal_align":"center"},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":8473120442482525,"definition":{"type":"note","content":"This dashboard provides a comprehensive summary of Integrity Monitoring Events.\n\nFor more information, see the [Trend Micro Cloud One Documentation](https://docs.datadoghq.com/integrations/trend_micro_cloud_one/).\n\n**Tips**:\n - Use the timeframe selector in the upper-right corner of the dashboard to change the default timeframe.\n - Clone this dashboard to rearrange, modify, and add widgets and visualizations.\n\n","background_color":"blue","font_size":"14","text_align":"left","vertical_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":100911387412346,"definition":{"type":"note","content":"**Note**\n- This dashboard is populated using trend micro cloud one logs forwarded via a [Datadog Agent](https://docs.datadoghq.com/agent).\n- Please follow the **Installation** and **Configuration** steps [here](/integrations/trend-micro-cloud-one) to enable log collection.\n\n","background_color":"gray","font_size":"16","text_align":"left","vertical_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":3,"width":12,"height":2}},{"id":6145050226400110,"definition":{"title":"Total Integrity Monitoring Events","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"black_on_light_yellow"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":5,"width":3,"height":3}},{"id":3705322922255426,"definition":{"title":"Integrity Monitoring Events Over Time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Integrity Monitor Event","formula":"query1"}],"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":5,"width":9,"height":3}},{"id":7045432472814881,"definition":{"title":"Integrity Monitor Events Distribution","title_size":"16","title_align":"left","requests":[{"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" $user_name $action"},"indexes":["*"],"group_by":[{"facet":"@action","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","style":{"palette":"datadog16"},"formulas":[{"formula":"query1"}],"sort":{"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"type":"sunburst","legend":{"type":"table"}},"layout":{"x":0,"y":8,"width":12,"height":4}},{"id":8851122295538807,"definition":{"title":"Total Created Files","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:created $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"custom_bg","custom_bg_color":"#d3e7f3"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":12,"width":3,"height":3}},{"id":3988945491883698,"definition":{"title":"Created Files Over Time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Files","formula":"query1"}],"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:created $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":12,"width":9,"height":3}},{"id":8568657169949225,"definition":{"title":"Total Renamed Files","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:renamed $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"black_on_light_yellow"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":15,"width":3,"height":3}},{"id":3569879011635809,"definition":{"title":"Renamed Files Over Time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"horizontal","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Files","formula":"query1"}],"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:renamed $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":15,"width":9,"height":3}},{"id":6320775321761570,"definition":{"title":"Total Updated Files","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:updated $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"custom_bg","custom_bg_color":"#eedbcd"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":18,"width":3,"height":3}},{"id":580370201106048,"definition":{"title":"Total Updated Files","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"horizontal","type":"timeseries","requests":[{"formulas":[{"alias":"Files","formula":"query1"}],"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:updated $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":18,"width":9,"height":3}},{"id":1929831752463947,"definition":{"title":"Total Deleted Files","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:deleted $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"black_on_light_red"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":21,"width":3,"height":3}},{"id":7001747440392517,"definition":{"title":"Deleted Files Over Time","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Files","formula":"query1"}],"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:deleted $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":3,"y":21,"width":9,"height":3}},{"id":481217550861624,"definition":{"title":"Top Users Triggering File Integrity Changes","title_size":"16","title_align":"left","type":"toplist","requests":[{"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" -@usr.name:N/A $user_name $action"},"indexes":["*"],"group_by":[{"facet":"@usr.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"}}},"layout":{"x":0,"y":24,"width":4,"height":4}},{"id":8625992464600543,"definition":{"title":"Most Frequently Modified Files","title_size":"16","title_align":"left","type":"toplist","requests":[{"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" $user_name $action"},"indexes":["*"],"group_by":[{"facet":"@filePath","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"}}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"}}},"layout":{"x":4,"y":24,"width":4,"height":4}},{"id":3893677642176008,"definition":{"title":"Top Source Processes","title_size":"16","title_align":"left","type":"toplist","requests":[{"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" -@sproc:N/A $user_name $action"},"indexes":["*"],"group_by":[{"facet":"@sproc","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"desc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"}}},"layout":{"x":8,"y":24,"width":4,"height":4}},{"id":2246595357959898,"definition":{"title":"System Modified Files","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @evt.name:*System*file*modified* $user_name $action"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","value":0,"palette":"black_on_light_yellow"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":28,"width":4,"height":4}},{"id":3139867585467049,"definition":{"title":"Renamed File Details","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"logs","search":{"query":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" @action:renamed $user_name $action"},"indexes":["*"],"group_by":[{"facet":"@oldfilePath","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@filePath","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@msg","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","sort":{"count":1000,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"number","alias":"count","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":4,"y":28,"width":8,"height":4}},{"id":7468793934523942,"definition":{"title":"Integrity Monitor Events","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"logs_stream","query_string":"source:trend-micro-cloud-one service:workload-security @category:\"Integrity Monitor\" $user_name $action","indexes":[],"storage":"hot"},"columns":[{"field":"status_line","width":"auto"},{"field":"timestamp","width":"auto"},{"field":"content","width":"auto"}]}],"type":"list_stream"},"layout":{"x":0,"y":32,"width":12,"height":4}}],"template_variables":[{"name":"action","prefix":"@action","available_values":[],"default":"*"},{"name":"user_name","prefix":"@usr.name","available_values":[],"default":"*"}],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed"}