id: palo-alto-panorama
metric_id: palo-alto-panorama
backend_only: false
facets:
  - groups:
      - Web Access
    name: Method
    path: http.method
    source: log
  - groups:
      - Web Access
    name: User-Agent
    path: http.useragent
    source: log
  - groups:
      - Web Access
    name: Browser
    path: http.useragent_details.browser.family
    source: log
  - groups:
      - Web Access
    name: Device
    path: http.useragent_details.device.family
    source: log
  - groups:
      - Web Access
    name: OS
    path: http.useragent_details.os.family
    source: log
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Client Port
    path: network.client.port
    source: log
  - groups:
      - Geoip
    name: Destination City Name
    path: network.destination.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Destination Continent Code
    path: network.destination.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Destination Continent Name
    path: network.destination.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Destination Country ISO Code
    path: network.destination.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Country Name
    path: network.destination.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision ISO Code
    path: network.destination.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision Name
    path: network.destination.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Destination IP
    path: network.destination.ip
    source: log
  - groups:
      - Web Access
    name: Destination Port
    path: network.destination.port
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Action (Panorama)
    path: palo.alto.panorama.action
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Application Characteristic
    path: palo.alto.panorama.appchar
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Application Container
    path: palo.alto.panorama.appcont
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Application Subcategory
    path: palo.alto.panorama.appsubcat
    source: log
    type: string
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: apprisk
    path: palo.alto.panorama.apprisk
    source: log
    type: integer
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Authentication Result
    path: palo.alto.panorama.event
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Device Category
    path: palo.alto.panorama.dcat
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Device Mode
    path: palo.alto.panorama.dmodel
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Device OS Version
    path: palo.alto.panorama.dosver
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Device Profile
    path: palo.alto.panorama.dprofile
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Device Vendor
    path: palo.alto.panorama.dven
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Destination Mac Address
    path: palo.alto.panorama.dmac
    source: log
    type: string
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Maximum Encapsulation
    path: palo.alto.panorama.max_encap
    source: log
    type: double
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Packets
    path: palo.alto.panorama.pkt
    source: log
    type: integer
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Packets Received
    path: palo.alto.panorama.pktrcvd
    source: log
    type: integer
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Packets Sent
    path: palo.alto.panorama.pktsent
    source: log
    type: integer
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Source Device Category
    path: palo.alto.panorama.scat
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Source Device Model
    path: palo.alto.panorama.smodel
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Source Device OS Version
    path: palo.alto.panorama.sosver
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Source Device Profile
    path: palo.alto.panorama.sprofile
    source: log
    type: string
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Source Device Vendor
    path: palo.alto.panorama.sven
    source: log
    type: string
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Strict Checking
    path: palo.alto.panorama.strict_check
    source: log
    type: double
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Tunnel Fragment
    path: palo.alto.panorama.tunnel_fragment
    source: log
    type: integer
  - facetType: range
    groups:
      - Palo Alto Panorama
    name: Unknown Protocol
    path: palo.alto.panorama.unknown_proto
    source: log
    type: integer
  - facetType: list
    groups:
      - Palo Alto Panorama
    name: Virtual System
    path: palo.alto.panorama.vsys
    source: log
    type: string
  - facetType: range
    groups:
      - Web Access
    name: Network Bytes Read
    path: network.bytes_read
    source: log
    type: double
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Web Access
    name: Bytes Written
    path: network.bytes_written
    source: log
    type: double
    unit:
      family: bytes
      name: byte
pipeline:
  type: pipeline
  name: Palo Alto Panorama
  enabled: true
  filter:
    query: "source:palo-alto-panorama"
  processors:
    - type: grok-parser
      name: Parsing Palo Alto Panorama logs
      enabled: true
      source: message
      samples:
        - <190>Jan 18 12:46:54 PA-VM
          serial=42808DUMMY733|type=TRAFFIC|subtype=end|time_generated=Jan 25
          2024 11:02:57
          GMT|src=10.0.0.1|dst=10.0.0.2|natsrc=10.0.0.3|natdst=10.0.0.4|rule=LAN-WAN|suser=|duser=|app=incomplete|vsys=vsys1|from=LAN|to=WAN|inboundif=ethernet1/1|outboundif=ethernet1/2|logset=POC-Dash-DD-204-9099|sessionid=15281|repeatcnt=1|sport=42071|dport=233|natsport=46973|natdport=233|flags=0x40001b|proto=tcp|act=allow|bytes=134|bytes_sent=74|bytes_received=60|pkt=2|start=2024/01/18
          12:46:45|elapsed=0|cat=any|seq=7288183648727243213|actflag=0x0|sloc=10.0.0.0-10.255.255.255|dloc=10.0.0.0-10.255.255.255|pktsent=1|pktrcvd=1|sessionendreason=tcp-rst-from-server|vsysname=|dvc=PA-VM|actsrc=from-policy|suuid=|duuid=|tunnelid=0|monitortag=|parentid=0|parentst=|tunnel=N/A|associd=0|chunk=0|chunksent=0|chunkrcvd=0|ruleuuid=9d526565-xxyy-4e35-9c2e-6f54430132ec|http2conn=0|appflap=0|policyid=|link=|dynusrgrp=|xffip=|scat=|sprofile=|smodel=|sven=|sosfam=|sosver=|shost=|smac=|dcat=|dprofile=|dmodel=|dven=|dosfam=|dosver=|dhost=|dmac=|contid=|podnamespace=|podname=|sedl=|dedl=|hostid=|srnum=|sdag=|ddag=|sessionown=|subcatapp=unknown|appcat=unknown|apptech=unknown|apprisk=1|appchar=|appcont=|tunneledapp=incomplete|appsaas=no|appstate=no|offloaded=0|flowtype=|cluster=
        - <190>Jan 16 14:15:34 PA-VM
          serial=42808DUMMY733|type=THREAT|subtype=url|time_generated=Jan 25
          2024 11:02:57
          GMT|src=10.1.0.1|dst=10.1.0.2|natsrc=10.0.0.3|natdst=10.0.0.4|rule=Block
          URL and
          Apps|suser=|duser=|app=facebook-base|vsys=vsys1|from=LAN|to=WAN|inboundif=ethernet1/2|outboundif=ethernet1/1|logset=New_Log_Profile|sessionid=1553|repeatcnt=1|sport=49896|dport=443|natsport=16742|natdport=443|flags=0x403400|proto=tcp|act=block-url|misc=www.facebook.com/|threatid=9999(9999)|cat=social-networking|severity=informational|dir=client-to-server|seqno=7312400435275366420|actflags=0x0|sloc=10.0.0.0-10.255.255.255|dloc=India|contenttype=|pcapip=0|filedigest=|cloud=|urlidx=0|useragent=|filetype=|xff=|ref=|sender=|sub=|recipient=|reportid=0|vsysname=|dvc=PA-VM|suuid=|duuid=|http_method=|tunnelid=0|monitortag=|tunnel=N/A|thrcategory=N/A|contentver=AppThreat-0-0|ppid=4294967295|httpheaders=|urlcategory=social-networking,low-risk|ruleuuid=b77632fb-xxyy-49f2-b319-e02d91a826fc|http2conn=0|dynusrgrp=|xffip=|scat=|sprofile=|smodel=|sven=|sosfam=|sosver=|shost=|smac=|dcat=|dprofile=|dmodel=|dven=|dosfam=|dosver=|dhost=|dmac=|contid=|podnamespace=|podname=|hostid=|srnum=|reason=|justification=|subcatApp=social-networking|appcat=saas|apptech=browser-based|apprisk=4|appchar=used-by-malware,able-to-transfer-file,has-known-vulnerability,tunnel-other-application,pervasive-use,is-saas,no-certifications|appcont=facebook|tunneledapp=facebook-base|appsaas=yes|appstate=no|cloudreportid=|cluster=|flowtype=
        - >
          <190>Jan 16 14:15:24 PA-VM receive_time=2024/01/16
          11:27:19|serial=7051000206484|type=SYSTEM|subtype=general|time_generated=Jan
          25 2024 11:02:57
          GMT|vsys=|eventid=general|object=|module=general|severity=informational|opaque=User
          admin performed a log export operation for config
          log.|seqno=7288183790458945051|actionflags=0x0|dg_hier_level_1=0|dg_hier_level_2=0|dg_hier_level_3=0|dg_hier_level_4=0|vsys_name=|device_name=PA-VM|high_res_timestamp=2024-01-16T11:27:20.587+05:30
        - <190>Jan 16 14:15:24 PA-VM receive_time=2023/11/24
          15:38:21|serial=42808DUMMY733|type=CONFIG|subtype=1|time_generated=Jan
          25 2024 11:02:57
          GMT|host=8.8.8.8|vsys=test1|cmd=audit-commit|admin=admin|client=Web|result=Succeeded|path=vsys
          vsys1 rulebase nat rules
          LAN-WAN|before-change-detail=d3669n472-xxyy-4d21-bf0f-ed099ecfbaad|after-change-detail=d3669472-xxyy-4d21-bf0f-ed099ecfbaad|seqno=7304913645853474846|actionflags=0x0|dg_hier_level_1=0|dg_hier_level_2=0|dg_hier_level_3=0|dg_hier_level_4=0|vsys_name=|device_name=PA-VM|dg_id=0|comment=LAN-WAN|high_res_timestamp=2024-01-16T14:15:34.518+05:30
        - <190>Jan 16 14:15:24 PA-VM receive_time=2024/01/16
          14:15:34|serial=42808DUMMY733|type=START|subtype=Start|time_generated=Jan
          25 2024 11:02:57
          GMT|src=10.4.0.1|dst=8.8.8.8|natsrc=10.5.0.1|natdst=8.8.8.8|rule=RuleName|srcuser=DASH12|dstuser=SMT25|app=ssl|vsys=vsys2|from=LAN|to=WAN|inbound_if=ethernet1/2|outbound_if=ethernet1/1|logset=POC-Dash-DD-204-9099|sessionid=2298|repeatcnt=1|sport=53342|dport=443|natsport=53397|natdport=443|flags=0x02000000|proto=tcp|act=Allow|severity=informational|seqno=7324580429950879745|actionflags=0x0|srcloc=10.0.0.0-10.255.255.255|dstloc=United
          States|dg_hier_level_1=0|dg_hier_level_2=0|dg_hier_level_3=0|dg_hier_level_4=0|vsys_name=vsys2|device_name=PA-VM|tunnelid=0|monitortag=420420123|parent_session_id=0|parent_start_time=2024/01/01
          12:15:30|tunnel=IPsec|bytes=847|bytes_sent=781|bytes_received=66|pkt=4|pkts_sent=3|pkts_received=1|max_encap=1|unknown_proto=2|strict_check=2|tunnel_fragment=3|sessions_created=2|sessions_closed=3|session_end_reason=threat|action_source=allow|start=2024/01/01
          12:30:15|elapsed=0|tunnel_insp_rule=insepction_rule_1|remote_user_ip=10.1.2.3|remote_user_id=40201234567|rule_uuid=731925f6-8e55-xxyy-b82f-910b26004dfd|pcap_id=1223xa155545|dynusergroup_name=agnet145|src_edl=10.0.1.2|dst_edl=10.0.3.4|high_res_timestamp=2024-01-16T14:15:34.518+05:30|nssai_sd=|nssai_sst=|pdu_session_id=1234758662|subcategory_of_app=encrypted-tunnel|category_of_app=business-systems|technology_of_app=browser-based|risk_of_app=1|characteristic_of_app=used-by-malware,able-to-transfer-file|container_of_app=google|is_saas_of_app=1|sanctioned_state_of_app=0|cluster_name=test-nw-cluster
      grok:
        supportRules: ""
        matchRules: >
          rule_panorama (<%{integer}>)?((%{date("MMM  d HH:mm:ss")}|%{date("MMM
          dd HH:mm:ss")}) (%{notSpace})?) %{data::keyvalue("="," \"/:,(){};+",
          "", "|")}
    - type: grok-parser
      name: Parsing 'time_generated' to 'timestamp' (epoch)
      enabled: true
      source: time_generated
      samples:
        - Jan 24 2024 10:30:11 GMT
      grok:
        supportRules: ""
        matchRules: date_rule %{date("MMM dd yyyy HH:mm:ss z"):timestamp}
    - type: date-remapper
      name: Define `timestamp` as the official date of the log
      enabled: true
      sources:
        - timestamp
    - type: service-remapper
      name: Define `type` as the official service of the log
      enabled: true
      sources:
        - type
    - type: pipeline
      name: Processors for `severity` field
      enabled: true
      filter:
        query: '@type:("THREAT" OR "START" OR "END" OR "SYSTEM" OR "CORRELATION") '
      processors:
        - name: Lookup for `severity` to `status`
          enabled: true
          source: severity
          target: status
          lookupTable: |-
            informational, info
            low, info
            medium, warning
            high, warning
            critical, critical
          type: lookup-processor
        - type: status-remapper
          name: Define `status` as the official status of the log
          enabled: true
          sources:
            - status
    - type: pipeline
      name: Processors for "Decryption" OR "Traffic" OR "Threat" OR "Tunnel
        Inspection" log types
      enabled: true
      filter:
        query: '@type:("DECRYPTION" OR "TRAFFIC" OR "THREAT" OR "START" OR "END") '
      processors:
        - type: attribute-remapper
          name: Map `natsrc` to `network.client.ip`
          enabled: true
          sources:
            - natsrc
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `natdst` to `network.destination.ip`
          enabled: true
          sources:
            - natdst
          sourceType: attribute
          target: network.destination.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `natsport` to `network.client.port`
          enabled: true
          sources:
            - natsport
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `natdport` to `network.destination.port`
          enabled: true
          sources:
            - natdport
          sourceType: attribute
          target: network.destination.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: Map `network.client.ip` to `network.client.geoip`
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
        - type: geo-ip-parser
          name: Map `network.destination.ip` to `network.destination.geoip`
          enabled: true
          sources:
            - network.destination.ip
          target: network.destination.geoip
          ip_processing_behavior: do-nothing
        - type: attribute-remapper
          name: Map `from` to `srczone`
          enabled: true
          sources:
            - from
          sourceType: attribute
          target: srczone
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `to` to `dstzone`
          enabled: true
          sources:
            - to
          sourceType: attribute
          target: dstzone
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - name: Map `flags` with `flag_details`
          enabled: true
          source: flags
          target: flag_details
          lookupTable: >-
            0x80000000,session has a packet capture (PCAP)

            0x40000000,option is enabled to allow a client to use multiple paths to connect to a destination host

            0x20000000,indicates whether a sample has been submitted for analysis using the WildFire public or private cloud channel

            0x10000000,enterprise credential submission by end user detected

            0x08000000,source for the flow is on the allow list and not subject to recon protection

            0x02000000,IPv6 session

            0x01000000,SSL session is decrypted (SSL Proxy)

            0x00800000,session is denied via URL filtering

            0x00400000,session has a NAT translation performed

            0x00200000,user information for the session was captured through Authentication Portal

            0x00100000,application traffic is on a non-standard destination port

            0x00080000,X-Forwarded-For value from a proxy is in the source user field

            0x00040000,log corresponds to a transaction within a http proxy session (Proxy Transaction)

            0x00020000,Client to Server flow is subject to policy based forwarding

            0x00010000,Server to Client flow is subject to policy based forwarding

            0x00008000,session is a container page access (Container Page)

            0x00002000,session has a temporary match on a rule for implicit application dependency handling

            0x00000800,symmetric return is used to forward traffic for this session

            0x00000400,decrypted traffic is being sent out clear text through a mirror port

            0x00000100,payload of the outer tunnel is being inspected
          type: lookup-processor
        - type: attribute-remapper
          name: Map `act` to `palo.alto.panorama.action`
          enabled: true
          sources:
            - act
          sourceType: attribute
          target: palo.alto.panorama.action
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "User ID" log type
      enabled: true
      filter:
        query: '@type:"USERID" '
      processors:
        - type: attribute-remapper
          name: Map `ip` to `network.client.ip`
          enabled: true
          sources:
            - ip
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `beginport` to `network.client.port`
          enabled: true
          sources:
            - beginport
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `endport` to `network.destination.port`
          enabled: true
          sources:
            - endport
          sourceType: attribute
          target: network.destination.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "Global Protect" log type
      enabled: true
      filter:
        query: '@type:"GLOBALPROTECT" '
      processors:
        - type: attribute-remapper
          name: Map `client_os` to `http.useragent_details.os.family`
          enabled: true
          sources:
            - client_os
          sourceType: attribute
          target: http.useragent_details.os.family
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `public_ip` to `network.client.ip`
          enabled: true
          sources:
            - public_ip
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: Map 'network.client.ip' to 'network.client.geoip'
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Processors for "Traffic" AND "Tunnel Inspection"
      enabled: true
      filter:
        query: '@type:("TRAFFIC" OR "START" OR "END") '
      processors:
        - type: attribute-remapper
          name: Map `bytes_sent` to `network.bytes_read`
          enabled: true
          sources:
            - bytes_sent
          sourceType: attribute
          target: network.bytes_read
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `bytes_received` to `network.bytes_written`
          enabled: true
          sources:
            - bytes_received
          sourceType: attribute
          target: network.bytes_written
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "Authentication" log type
      enabled: true
      filter:
        query: '@type:"AUTHENTICATION" '
      processors:
        - type: attribute-remapper
          name: Map `ip` to `network.client.ip`
          enabled: true
          sources:
            - ip
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `user_agent` to `http.useragent`
          enabled: true
          sources:
            - user_agent
          sourceType: attribute
          target: http.useragent
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: user-agent-parser
          name: Parsing User Agent
          enabled: true
          sources:
            - http.useragent
          target: http.useragent_details
          encoded: false
          combineVersionDetails: false
    - type: pipeline
      name: Processors for 'Threat' log type
      enabled: true
      filter:
        query: '@type:"THREAT" '
      processors:
        - type: attribute-remapper
          name: Map `http_method` to `http.method`
          enabled: true
          sources:
            - http_method
          sourceType: attribute
          target: http.method
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "Decryption" AND "Authentication"
      enabled: true
      filter:
        query: '@type:("DECRYPTION" OR "AUTHENTICATION") '
      processors:
        - type: attribute-remapper
          name: Map `src_osfamily` to `http.useragent_details.os.family`
          enabled: true
          sources:
            - src_osfamily
          sourceType: attribute
          target: http.useragent_details.os.family
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "HIP Match" OR "Correlated Events"
      enabled: true
      filter:
        query: '@type:("HIP-MATCH" OR "CORRELATION") '
      processors:
        - type: attribute-remapper
          name: Map `src` to `network.client.ip`
          enabled: true
          sources:
            - src
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: GeoIP Parser for `network.client.ip`
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Processors for "HIP Match" log type
      enabled: true
      filter:
        query: '@type:"HIP-MATCH" '
      processors:
        - type: attribute-remapper
          name: Map `os` to `http.useragent_details.os.family`
          enabled: true
          sources:
            - os
          sourceType: attribute
          target: http.useragent_details.os.family
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: Map 'network.client.ip' to 'network.client.geoip'
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Processors for "Authentication" OR "User ID" log type
      enabled: true
      filter:
        query: '@type:("AUTHENTICATION" OR "USERID") '
      processors:
        - type: attribute-remapper
          name: Map `user` to `usr.name`
          enabled: true
          sources:
            - user
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: Map 'network.client.ip' to 'network.client.geoip'
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Processors for "HIP Match" OR "Correlated Events" OR "Global Protect" log
        types
      enabled: true
      filter:
        query: '@type:("HIP-MATCH" OR "CORRELATION" OR "GLOBALPROTECT") '
      processors:
        - type: attribute-remapper
          name: Map `srcuser` to `usr.name`
          enabled: true
          sources:
            - srcuser
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processors for "Config" log type
      enabled: true
      filter:
        query: '@type:"CONFIG" '
      processors:
        - type: attribute-remapper
          name: Map `admin` to `usr.name`
          enabled: true
          sources:
            - admin
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: attribute-remapper
      name: Map `appchar` to `palo.alto.panorama.appchar`
      enabled: true
      sources:
        - appchar
      sourceType: attribute
      target: palo.alto.panorama.appchar
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `appcont` to `palo.alto.panorama.appcont`
      enabled: true
      sources:
        - appcont
      sourceType: attribute
      target: palo.alto.panorama.appcont
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `appchar` to `palo.alto.panorama.appchar`
      enabled: true
      sources:
        - appchar
      sourceType: attribute
      target: palo.alto.panorama.appchar
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `appcont` to `palo.alto.panorama.appcont`
      enabled: true
      sources:
        - appcont
      sourceType: attribute
      target: palo.alto.panorama.appcont
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `appsubcat` to `palo.alto.panorama.appsubcat`
      enabled: true
      sources:
        - appsubcat
      sourceType: attribute
      target: palo.alto.panorama.appsubcat
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `apprisk` to `palo.alto.panorama.apprisk`
      enabled: true
      sources:
        - apprisk
      sourceType: attribute
      target: palo.alto.panorama.apprisk
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `event` to `palo.alto.panorama.event`
      enabled: true
      sources:
        - event
      sourceType: attribute
      target: palo.alto.panorama.event
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dcat` to `palo.alto.panorama.dcat`
      enabled: true
      sources:
        - dcat
      sourceType: attribute
      target: palo.alto.panorama.dcat
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dmodel` to `palo.alto.panorama.dmodel`
      enabled: true
      sources:
        - dmodel
      sourceType: attribute
      target: palo.alto.panorama.dmodel
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dosver` to `palo.alto.panorama.dosver`
      enabled: true
      sources:
        - dosver
      sourceType: attribute
      target: palo.alto.panorama.dosver
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dprofile` to `palo.alto.panorama.dprofile`
      enabled: true
      sources:
        - dprofile
      sourceType: attribute
      target: palo.alto.panorama.dprofile
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dven` to `palo.alto.panorama.dven`
      enabled: true
      sources:
        - dven
      sourceType: attribute
      target: palo.alto.panorama.dven
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `dmac` to `palo.alto.panorama.dmac`
      enabled: true
      sources:
        - dmac
      sourceType: attribute
      target: palo.alto.panorama.dmac
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `max_encap` to `palo.alto.panorama.max_encap`
      enabled: true
      sources:
        - max_encap
      sourceType: attribute
      target: palo.alto.panorama.max_encap
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `pkt` to `palo.alto.panorama.pkt`
      enabled: true
      sources:
        - pkt
      sourceType: attribute
      target: palo.alto.panorama.pkt
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `pktrcvd` to `palo.alto.panorama.pktrcvd`
      enabled: true
      sources:
        - pktrcvd
      sourceType: attribute
      target: palo.alto.panorama.pktrcvd
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `pktsent` to `palo.alto.panorama.pktsent`
      enabled: true
      sources:
        - pktsent
      sourceType: attribute
      target: palo.alto.panorama.pktsent
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `scat` to `palo.alto.panorama.scat`
      enabled: true
      sources:
        - scat
      sourceType: attribute
      target: palo.alto.panorama.scat
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `smodel` to `palo.alto.panorama.smodel`
      enabled: true
      sources:
        - smodel
      sourceType: attribute
      target: palo.alto.panorama.smodel
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `sosver` to `palo.alto.panorama.sosver`
      enabled: true
      sources:
        - sosver
      sourceType: attribute
      target: palo.alto.panorama.sosver
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `sprofile` to `palo.alto.panorama.sprofile`
      enabled: true
      sources:
        - sprofile
      sourceType: attribute
      target: palo.alto.panorama.sprofile
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `sven` to `palo.alto.panorama.sven`
      enabled: true
      sources:
        - sven
      sourceType: attribute
      target: palo.alto.panorama.sven
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `strict_check` to `palo.alto.panorama.strict_check`
      enabled: true
      sources:
        - strict_check
      sourceType: attribute
      target: palo.alto.panorama.strict_check
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `tunnel_fragment` to `palo.alto.panorama.tunnel_fragment`
      enabled: true
      sources:
        - tunnel_fragment
      sourceType: attribute
      target: palo.alto.panorama.tunnel_fragment
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `unknown_proto` to `palo.alto.panorama.unknown_proto`
      enabled: true
      sources:
        - unknown_proto
      sourceType: attribute
      target: palo.alto.panorama.unknown_proto
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `vsys` to `palo.alto.panorama.vsys`
      enabled: true
      sources:
        - vsys
      sourceType: attribute
      target: palo.alto.panorama.vsys
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false