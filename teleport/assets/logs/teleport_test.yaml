id: teleport
tests:
  - sample: >
      2024-05-28T14:21:41Z WARN [PROXY:1:C] Cache was forced to load session
      web_session/936cdcda1df1a7a97e5ce2239bd39f71d7e7524a29560fdfdbf206e342f8fddc
      from upstream. Frequent occurrence may indicate sync/perf issues.
      cache/cache.go:2494
    result: null
  - sample: >
      2024-05-28T14:21:52Z INFO [AUDIT]     session.start
      addr.local:172.29.245.165:443 addr.remote:90.118.178.162:41482
      cluster_name:teleport-plint code:T2000I ei:0 event:session.start
      initial_command:[] login:ec2-user namespace:default
      private_key_policy:none proto:ssh server_addr:[::]:3022
      server_hostname:ip-172-29-245-165-ec2-internal
      server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node
      sid:3cce2999-5e30-4415-b9b6-a92dadc3725b size:80:25
      time:2024-05-28T14:21:52.888Z uid:84f7fc1b-575a-4357-aedb-932508acbf23
      user:teleport-admin user_kind:1 events/emitter.go:288
    result: null
  - sample: >
      2024-05-28T14:21:56Z INFO [AUDIT]     session.leave
      cluster_name:teleport-plint code:T2003I ei:20 event:session.leave
      login:ec2-user namespace:default private_key_policy:none
      server_addr:[::]:3022 server_hostname:ip-172-29-245-165-ec2-internal
      server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1
      sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:21:56.593Z
      uid:4d0f781f-f99e-4363-a953-231978b03bbd user:teleport-admin user_kind:1
      events/emitter.go:288
    result: null
  - sample: >
      2024-05-28T14:22:01Z INFO [AUDIT]     session.end
      addr.remote:90.118.178.162:41482 cluster_name:teleport-plint code:T2004I
      ei:21 enhanced_recording:false event:session.end interactive:true
      login:ec2-user namespace:default participants:[teleport-admin]
      private_key_policy:none proto:ssh server_addr:[::]:3022
      server_hostname:ip-172-29-245-165-ec2-internal
      server_id:b05b3c10-c35a-4f25-b6c4-3b315a1d4ec1 session_recording:node
      session_start:2024-05-28T14:21:52.874611176Z
      session_stop:2024-05-28T14:22:01.60145508Z
      sid:3cce2999-5e30-4415-b9b6-a92dadc3725b time:2024-05-28T14:22:01.603Z
      uid:6346cbd5-fcf7-4619-90d9-114b392edfb5 user:teleport-admin user_kind:1
      events/emitter.go:288
    result: null
  - sample: >
      2024-05-28T14:37:32Z INFO [AUDIT]     user.login
      addr.remote:90.118.178.162:37044 cluster_name:teleport-plint code:T1000I
      ei:0 event:user.login method:local mfa_device_name:otp-device
      mfa_device_type:TOTP mfa_device_uuid:efda61ff-6fa6-4434-bcec-ca0bafbafa68
      required_private_key_policy:none success:true
      time:2024-05-28T14:37:32.309Z uid:d7fcf864-66cf-4b7d-9c3a-1acd5abc91e7
      user:teleport-admin user_agent:Mozilla/5.0 (Macintosh; Intel Mac OS X
      10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0
      Safari/537.36 events/emitter.go:288
    result: null
# The `result` field should be left blank to start. Once you submit your log asset files with
# your integration pull-request in a Datadog GitHub repository, Datadog's validations will
# run your raw logs against your pipeline and return the result. If the result output in the
# validation is accurate, take the output and add it to the `result` field in your test YAML file.
