# (C) Datadog, Inc. 2025-present
# All rights reserved
# Licensed under a 3-clause BSD style license (see LICENSE)
DEFAULT_MAX_SLOW_ENTRIES = 128
MAX_SLOW_ENTRIES_KEY = "slowlog-max-len"

REPL_KEY = 'master_link_status'
LINK_DOWN_KEY = 'master_link_down_since_seconds'

DEFAULT_CLIENT_NAME = "unknown"

CONFIG_GAUGE_KEYS = {
    'maxclients': 'redis.net.maxclients',
}

GAUGE_KEYS = {
    'io_threads_active': 'redis.server.io_threads_active',
    'active_defrag_running': 'redis.active_defrag.running',
    'active_defrag_hits': 'redis.active_defrag.hits',
    'active_defrag_misses': 'redis.active_defrag.misses',
    'active_defrag_key_hits': 'redis.active_defrag.key_hits',
    'active_defrag_key_misses': 'redis.active_defrag.key_misses',
    'aof_last_rewrite_time_sec': 'redis.aof.last_rewrite_time',
    'aof_rewrite_in_progress': 'redis.aof.rewrite',
    'aof_current_size': 'redis.aof.size',
    'aof_buffer_length': 'redis.aof.buffer_length',
    'loading_total_bytes': 'redis.aof.loading_total_bytes',
    'loading_loaded_bytes': 'redis.aof.loading_loaded_bytes',
    'loading_loaded_perc': 'redis.aof.loading_loaded_perc',
    'loading_eta_seconds': 'redis.aof.loading_eta_seconds',
    'connected_clients': 'redis.net.clients',
    'connected_slaves': 'redis.net.slaves',
    'rejected_connections': 'redis.net.rejected',
    'blocked_clients': 'redis.clients.blocked',
    'client_biggest_input_buf': 'redis.clients.biggest_input_buf',
    'client_longest_output_list': 'redis.clients.longest_output_list',
    'client_recent_max_input_buffer': 'redis.clients.recent_max_input_buffer',
    'client_recent_max_output_buffer': 'redis.clients.recent_max_output_buffer',
    'evicted_keys': 'redis.keys.evicted',
    'expired_keys': 'redis.keys.expired',
    'latest_fork_usec': 'redis.perf.latest_fork_usec',
    'bytes_received_per_sec': 'redis.bytes_received_per_sec',  # Note: are only available on Azure Redis
    'bytes_sent_per_sec': 'redis.bytes_sent_per_sec',  # Note: are only available on Azure Redis
    'total_connections_received': 'redis.net.total_connections_received',
    'pubsub_channels': 'redis.pubsub.channels',
    'pubsub_patterns': 'redis.pubsub.patterns',
    'rdb_bgsave_in_progress': 'redis.rdb.bgsave',
    'rdb_changes_since_last_save': 'redis.rdb.changes_since_last',
    'rdb_last_bgsave_time_sec': 'redis.rdb.last_bgsave_time',
    'mem_fragmentation_bytes': 'redis.mem.fragmentation',
    'mem_fragmentation_ratio': 'redis.mem.fragmentation_ratio',
    'mem_total_replication_buffers': 'redis.mem.total_replication_buffers',
    'mem_clients_slaves': 'redis.mem.clients_slaves',
    'mem_clients_normal': 'redis.mem.clients_normal',
    'used_memory': 'redis.mem.used',
    'used_memory_lua': 'redis.mem.lua',
    'used_memory_peak': 'redis.mem.peak',
    'used_memory_rss': 'redis.mem.rss',
    'used_memory_startup': 'redis.mem.startup',
    'used_memory_overhead': 'redis.mem.overhead',
    'used_memory_dataset': 'redis.mem.dataset',
    'used_memory_vm_eval': 'redis.mem.vm_eval',
    'used_memory_vm_functions': 'redis.mem.vm_functions',
    'used_memory_vm_total': 'redis.mem.vm_total',
    'used_memory_functions': 'redis.mem.functions',
    'used_memory_scripts_eval': 'redis.mem.scripts_eval',
    'used_memory_scripts': 'redis.mem.scripts',
    'maxmemory': 'redis.mem.maxmemory',
    'master_last_io_seconds_ago': 'redis.replication.last_io_seconds_ago',
    'master_sync_in_progress': 'redis.replication.sync',
    'master_sync_left_bytes': 'redis.replication.sync_left_bytes',
    'repl_backlog_histlen': 'redis.replication.backlog_histlen',
    'master_repl_offset': 'redis.replication.master_repl_offset',
    'slave_repl_offset': 'redis.replication.slave_repl_offset',
    'total_net_repl_input_bytes': 'redis.replication.input_total_bytes',
    'total_net_repl_output_bytes': 'redis.replication.output_total_bytes',
    'allocator_active': 'redis.allocator.active',
    'allocator_allocated': 'redis.allocator.allocated',
    'allocator_muzzy': 'redis.allocator.muzzy',
    'allocator_resident': 'redis.allocator.resident',
    'allocator_rss_bytes': 'redis.allocator.rss_bytes',
    'allocator_rss_ratio': 'redis.allocator.rss_ratio',
    'acl_access_denied_auth': 'redis.acl.denied.auth',
    'acl_access_denied_channel': 'redis.acl.denied.channel',
    'acl_access_denied_cmd': 'redis.acl.denied.cmd',
    'acl_access_denied_key': 'redis.acl.denied.key',
    'allocator_active_lua': 'redis.allocator.debug.active_lua',
    'allocator_allocated_lua': 'redis.allocator.debug.allocated_lua',
    'allocator_frag_bytes_lua': 'redis.allocator.debug.frag_bytes_lua',
    'allocator_frag_ratio': 'redis.allocator.frag_ratio',
    'allocator_resident_lua': 'redis.allocator.debug.resident_lua',
    'aof_base_size': 'redis.aof.base_size',
    'aof_current_rewrite_time_sec': 'redis.aof.rewrite.current_time_sec',
    'aof_delayed_fsync': 'redis.aof.delayed_fsync',
    'aof_enabled': 'redis.aof.enabled',
    'aof_last_cow_size': 'redis.aof.last_cow_size',
    'aof_pending_bio_fsync': 'redis.aof.pending_bio_fsync',
    'aof_pending_rewrite': 'redis.aof.pending_rewrite',
    'aof_rewrite_buffer_length': 'redis.aof.rewrite.buffer_length',
    'aof_rewrite_scheduled': 'redis.aof.rewrite.scheduled',
    'aof_rewrites': 'redis.aof.rewrites',
    'client_output_buffer_limit_disconnections': 'redis.clients.output_buffer_limit_disconnections',
    'client_query_buffer_limit_disconnections': 'redis.clients.query_buffer_limit_disconnections',
    'clients_in_timeout_table': 'redis.clients.timeout_table',
    'evicted_clients': 'redis.clients.evicted',
    'watching_clients': 'redis.clients.watching',
    'pubsub_clients': 'redis.pubsub.clients',
    'pubsubshard_channels': 'redis.pubsub.shard_channels',
    'cluster_connections': 'redis.cluster.connections',
    'cluster_enabled': 'redis.cluster.enabled',
    'unexpected_error_replies': 'redis.errors.unexpected_replies',
    'total_error_replies': 'redis.errors.total_replies',
    'current_active_defrag_time': 'redis.defrag.current_active_time',
    'total_active_defrag_time': 'redis.defrag.total_active_time',
    'current_eviction_exceeded_time': 'redis.eviction.current_exceeded_time',
    'total_eviction_exceeded_time': 'redis.eviction.total_exceeded_time',
    'current_cow_peak': 'redis.cow.current_peak',
    'current_cow_size': 'redis.cow.current_size',
    'current_cow_size_age': 'redis.cow.current_size_age',
    'total_forks': 'redis.fork.total',
    'rdb_current_bgsave_time_sec': 'redis.rdb.current_bgsave_time_sec',
    'rdb_last_cow_size': 'redis.rdb.last_cow_size',
    'rdb_last_load_keys_expired': 'redis.rdb.last_load.keys_expired',
    'rdb_last_load_keys_loaded': 'redis.rdb.last_load.keys_loaded',
    'rdb_last_save_time': 'redis.rdb.last_save_time',
    'rdb_saves': 'redis.rdb.saves',
    'master_port': 'redis.replication.master_port',
    'master_sync_last_io_seconds_ago': 'redis.replication.sync.last_io_seconds_ago',
    'master_sync_read_bytes': 'redis.replication.sync.read_bytes',
    'master_sync_total_bytes': 'redis.replication.sync.total_bytes',
    'second_repl_offset': 'redis.replication.second_repl_offset',
    'repl_backlog_active': 'redis.replication.backlog_active',
    'repl_backlog_first_byte_offset': 'redis.replication.backlog_first_byte_offset',
    'repl_backlog_size': 'redis.replication.backlog_size',
    'replica_announced': 'redis.replication.replica_announced',
    'slave_expires_tracked_keys': 'redis.replication.slave.expires_tracked_keys',
    'slave_priority': 'redis.replication.slave.priority',
    'slave_read_only': 'redis.replication.slave.read_only',
    'slave_read_repl_offset': 'redis.replication.slave.read_repl_offset',
    'sync_full': 'redis.replication.sync.full',
    'sync_partial_err': 'redis.replication.sync.partial_err',
    'sync_partial_ok': 'redis.replication.sync.partial_ok',
    'instantaneous_input_repl_kbps': 'redis.replication.instantaneous_input_kbps',
    'instantaneous_output_repl_kbps': 'redis.replication.instantaneous_output_kbps',
    'min_slaves_good_slaves': 'redis.replication.min_slaves_good_slaves',
    'eventloop_cmd_per_cycle_max': 'redis.eventloop.cmd_per_cycle_max',
    'eventloop_cycles': 'redis.eventloop.cycles',
    'eventloop_duration_aof_sum': 'redis.eventloop.duration_aof_sum',
    'eventloop_duration_cmd_sum': 'redis.eventloop.duration_cmd_sum',
    'eventloop_duration_cron_sum': 'redis.eventloop.duration_cron_sum',
    'eventloop_duration_max': 'redis.eventloop.duration_max',
    'eventloop_duration_sum': 'redis.eventloop.duration_sum',
    'instantaneous_eventloop_duration_usec': 'redis.eventloop.instantaneous_duration_usec',
    'instantaneous_eventloop_cycles_per_sec': 'redis.eventloop.instantaneous_cycles_per_sec',
    'instantaneous_input_kbps': 'redis.net.instantaneous_input',
    'instantaneous_output_kbps': 'redis.net.instantaneous_output',
    'instantaneous_ops_per_sec': 'redis.net.instantaneous_ops_per_sec',
    'expire_cycle_cpu_milliseconds': 'redis.expire_cycle.cpu_milliseconds',
    'expired_subkeys': 'redis.expired.subkeys',
    'expired_time_cap_reached_count': 'redis.expired.time_cap_reached_count',
    'total_blocking_keys': 'redis.keys.total_blocking',
    'total_blocking_keys_on_nokey': 'redis.keys.total_blocking_on_nokey',
    'total_watched_keys': 'redis.keys.total_watched',
    'evicted_scripts': 'redis.scripts.evicted',
    'number_of_cached_scripts': 'redis.scripts.cached',
    'number_of_functions': 'redis.functions.count',
    'number_of_libraries': 'redis.libraries.count',
    'loading': 'redis.loading.loading',
    'loading_rdb_used_mem': 'redis.loading.rdb_used_mem',
    'loading_start_time': 'redis.loading.start_time',
    'migrate_cached_sockets': 'redis.net.migrate_cached_sockets',
    'reply_buffer_expands': 'redis.reply_buffer.expands',
    'reply_buffer_shrinks': 'redis.reply_buffer.shrinks',
    'total_net_input_bytes': 'redis.net.total_input_bytes',
    'total_net_output_bytes': 'redis.net.total_output_bytes',
    'rss_overhead_bytes': 'redis.memory.rss_overhead_bytes',
    'rss_overhead_ratio': 'redis.memory.rss_overhead_ratio',
    'mem_aof_buffer': 'redis.memory.aof_buffer',
    'mem_cluster_links': 'redis.memory.cluster_links',
    'mem_not_counted_for_evict': 'redis.memory.not_counted_for_evict',
    'mem_overhead_db_hashtable_rehashing': 'redis.memory.overhead_db_hashtable_rehashing',
    'mem_replication_backlog': 'redis.memory.replication_backlog',
    'used_memory_peak_time': 'redis.memory.peak_time',
    'search_bytes_collected': 'redis.search.bytes_collected',
    'search_cursors_internal_active': 'redis.search.cursors.internal_active',
    'search_cursors_internal_idle': 'redis.search.cursors.internal_idle',
    'search_cursors_user_active': 'redis.search.cursors.user_active',
    'search_cursors_user_idle': 'redis.search.cursors.user_idle',
    'search_errors_for_index_with_max_failures': 'redis.search.errors.max_failures',
    'search_errors_indexing_failures': 'redis.search.errors.indexing_failures',
    'search_gc_bytes_collected': 'redis.search.gc.bytes_collected',
    'search_gc_marked_deleted_vectors': 'redis.search.gc.marked_deleted_vectors',
    'search_gc_total_cycles': 'redis.search.gc.total_cycles',
    'search_gc_total_docs_not_collected_by_gc': 'redis.search.gc.docs_not_collected',
    'search_gc_total_ms_run': 'redis.search.gc.total_ms_run',
    'search_global_idle': 'redis.search.global_idle',
    'search_global_total': 'redis.search.global_total',
    'search_largest_memory_index': 'redis.search.memory.largest_index',
    'search_marked_deleted_vectors': 'redis.search.marked_deleted_vectors',
    'search_number_of_active_indexes': 'redis.search.indexes.active',
    'search_number_of_active_indexes_indexing': 'redis.search.indexes.active_indexing',
    'search_number_of_active_indexes_running_queries': 'redis.search.indexes.running_queries',
    'search_number_of_indexes': 'redis.search.indexes.total',
    'search_smallest_memory_index': 'redis.search.memory.smallest_index',
    'search_total_active_queries': 'redis.search.queries.active',
    'search_total_active_write_threads': 'redis.search.write_threads.active',
    'search_total_cycles': 'redis.search.total_cycles',
    'search_total_docs_not_collected_by_gc': 'redis.search.docs_not_collected',
    'search_total_indexing_time': 'redis.search.indexing.total_time',
    'search_total_ms_run': 'redis.search.total_ms_run',
    'search_total_queries_processed': 'redis.search.queries.processed',
    'search_total_query_commands': 'redis.search.queries.commands',
    'search_total_query_execution_time_ms': 'redis.search.queries.execution_time_ms',
    'search_used_memory_indexes': 'redis.search.memory.used_indexes',
    'search_used_memory_vector_index': 'redis.search.memory.used_vector_index',
    'search_fields_geo_Geo': 'redis.search.fields.geo.geo',
    'search_fields_geo_NoIndex': 'redis.search.fields.geo.noindex',
    'search_fields_geo_Sortable': 'redis.search.fields.geo.sortable',
    'search_fields_geoshape_Geoshape': 'redis.search.fields.geoshape.geoshape',
    'search_fields_geoshape_NoIndex': 'redis.search.fields.geoshape.noindex',
    'search_fields_geoshape_Sortable': 'redis.search.fields.geoshape.sortable',
    'search_fields_numeric_NoIndex': 'redis.search.fields.numeric.noindex',
    'search_fields_numeric_Numeric': 'redis.search.fields.numeric.numeric',
    'search_fields_numeric_Sortable': 'redis.search.fields.numeric.sortable',
    'search_fields_tag_CaseSensitive': 'redis.search.fields.tag.case_sensitive',
    'search_fields_tag_NoIndex': 'redis.search.fields.tag.noindex',
    'search_fields_tag_Sortable': 'redis.search.fields.tag.sortable',
    'search_fields_tag_Tag': 'redis.search.fields.tag.tag',
    'search_fields_text_NoIndex': 'redis.search.fields.text.noindex',
    'search_fields_text_Sortable': 'redis.search.fields.text.sortable',
    'search_fields_text_Text': 'redis.search.fields.text.text',
    'search_fields_vector_Flat': 'redis.search.fields.vector.flat',
    'search_fields_vector_HNSW': 'redis.search.fields.vector.hnsw',
    'search_fields_vector_Vector': 'redis.search.fields.vector.vector',
    'sentinel_masters': 'redis.sentinel.masters',
    'sentinel_running_scripts': 'redis.sentinel.running_scripts',
    'sentinel_scripts_queue_length': 'redis.sentinel.scripts_queue_length',
    'sentinel_simulate_failure_flags': 'redis.sentinel.simulate_failure_flags',
    'sentinel_tilt': 'redis.sentinel.tilt',
    'sentinel_tilt_since_seconds': 'redis.sentinel.tilt_since_seconds',
    'sentinel_total_tilt': 'redis.sentinel.total_tilt',
    'total_reads_processed': 'redis.ops.reads_processed',
    'total_writes_processed': 'redis.ops.writes_processed',
    'tracking_clients': 'redis.tracking.clients',
    'tracking_total_items': 'redis.tracking.total_items',
    'tracking_total_keys': 'redis.tracking.total_keys',
    'tracking_total_prefixes': 'redis.tracking.total_prefixes',
}

RATE_KEYS = {
    # cpu
    'used_cpu_sys': 'redis.cpu.sys',
    'used_cpu_sys_children': 'redis.cpu.sys_children',
    'used_cpu_user': 'redis.cpu.user',
    'used_cpu_user_children': 'redis.cpu.user_children',
    'used_cpu_sys_main_thread': 'redis.cpu.sys_main_thread',
    'used_cpu_user_main_thread': 'redis.cpu.user_main_thread',
    # stats
    'keyspace_hits': 'redis.stats.keyspace_hits',
    'keyspace_misses': 'redis.stats.keyspace_misses',
    'io_threaded_reads_processed': 'redis.stats.io_threaded_reads_processed',
    'io_threaded_writes_processed': 'redis.stats.io_threaded_writes_processed',
    'total_commands_processed': 'redis.net.commands',
}
