{
  "title": "Redis - Overview",
  "author_name": "Datadog",
  "description": "This dashboard provides a high-level overview of key Redis metrics to help you monitor your Redis primary's performance and manage your Redis instance.\n\nFor more information, see:\n\n- Our [official Redis documentation](https://docs.datadoghq.com/integrations/redisdb/)\n\nOr our 3-part series blog post:\n\n- Part 1: [How to monitor Redis performance metrics](https://www.datadoghq.com/blog/how-to-monitor-redis-performance-metrics/) \n- Part 2: [Collecting Redis metrics](https://www.datadoghq.com/blog/how-to-collect-redis-metrics/)\n- Part 3: [Monitoring Redis with Datadog](https://www.datadoghq.com/blog/monitor-redis-using-datadog/)",
  "widgets": [
    {
      "id": 0,
      "definition": {
        "title": "Overview",
        "title_align": "center",
        "type": "group",
        "background_color": "vivid_pink",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5,
            "definition": {
              "type": "note",
              "content": "This dashboard provides a high-level overview of key Redis metrics to help you monitor your Redis primary's performance and manage your Redis instance.\n\nFor more information, see:\n\n- Our [official Redis documentation](https://docs.datadoghq.com/integrations/redisdb/)\n\nOr our 3-part series blog post:\n\n- Part 1: [How to monitor Redis performance metrics](https://www.datadoghq.com/blog/how-to-monitor-redis-performance-metrics/) \n- Part 2: [Collecting Redis metrics](https://www.datadoghq.com/blog/how-to-collect-redis-metrics/)\n- Part 3: [Monitoring Redis with Datadog](https://www.datadoghq.com/blog/monitor-redis-using-datadog/)\n",
              "background_color": "transparent",
              "font_size": "14",
              "text_align": "left",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left"
            },
            "layout": { "x": 0, "y": 0, "width": 6, "height": 3 }
          },
          {
            "id": 30,
            "definition": {
              "title": "Redis Logs",
              "title_size": "16",
              "type": "log_stream",
              "indexes": [],
              "query": "source:redis $scope",
              "sort": { "column": "time", "order": "desc" },
              "columns": [],
              "show_date_column": true,
              "show_message_column": true,
              "message_display": "expanded-md"
            },
            "layout": { "x": 6, "y": 0, "width": 6, "height": 6 }
          },
          {
            "id": 10,
            "definition": {
              "title": "Redis hosts",
              "title_size": "16",
              "title_align": "left",
              "type": "hostmap",
              "requests": { "fill": { "q": "avg:redis.cpu.sys{*} by {host}" } },
              "node_type": "host",
              "no_metric_hosts": false,
              "no_group_hosts": true,
              "style": { "palette": "Viridis", "palette_flip": false }
            },
            "layout": { "x": 0, "y": 3, "width": 6, "height": 3 }
          }
        ]
      }
    },
    {
      "id": 8772081283213092,
      "definition": {
        "title": "Base Activity Metrics",
        "title_align": "left",
        "type": "group",
        "background_color": "vivid_pink",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 6,
            "definition": {
              "title": "Hit rate",
              "type": "query_value",
              "requests": [
                {
                  "q": "(avg:redis.stats.keyspace_hits{$scope}/(avg:redis.stats.keyspace_hits{$scope}+avg:redis.stats.keyspace_misses{$scope}))*100",
                  "aggregator": "avg",
                  "conditional_formats": [
                    {
                      "comparator": "<",
                      "palette": "black_on_light_red",
                      "value": 75
                    },
                    {
                      "comparator": "<=",
                      "palette": "black_on_light_yellow",
                      "value": 89
                    },
                    {
                      "comparator": ">=",
                      "palette": "black_on_light_green",
                      "value": 90
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "text_align": "center",
              "precision": 0
            },
            "layout": { "x": 0, "y": 0, "width": 2, "height": 2 }
          },
          {
            "id": 9,
            "definition": {
              "title": "Unsaved changes",
              "type": "query_value",
              "requests": [
                {
                  "q": "sum:redis.rdb.changes_since_last{$scope}",
                  "aggregator": "avg",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "black_on_light_red",
                      "value": 1073741824
                    },
                    {
                      "comparator": "<",
                      "palette": "black_on_light_green",
                      "value": 1073741824
                    }
                  ]
                }
              ],
              "autoscale": true,
              "text_align": "left",
              "precision": 2
            },
            "layout": { "x": 2, "y": 0, "width": 2, "height": 2 }
          },
          {
            "id": 7,
            "definition": {
              "title": "Primary link down",
              "type": "query_value",
              "requests": [
                {
                  "q": "sum:redis.replication.master_link_down_since_seconds{$scope}",
                  "aggregator": "avg",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "black_on_light_red",
                      "value": 60
                    },
                    {
                      "comparator": "<",
                      "palette": "black_on_light_green",
                      "value": 60
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "secs",
              "text_align": "center",
              "precision": 0
            },
            "layout": { "x": 4, "y": 0, "width": 2, "height": 2 }
          },
          {
            "id": 8,
            "definition": {
              "type": "note",
              "content": "This metric is only available when the connection between the primary and its replica has been lost. Ideally, this value should never exceed zero—the primary and the replica should be in constant communication to ensure the replica is not serving stale data.",
              "background_color": "white",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "top",
              "show_tick": true,
              "tick_pos": "75%",
              "tick_edge": "top",
              "has_padding": true
            },
            "layout": { "x": 0, "y": 2, "width": 6, "height": 2 }
          },
          {
            "id": 15,
            "definition": {
              "title": "Redis keyspace",
              "type": "query_value",
              "requests": [
                {
                  "q": "sum:redis.keys{$scope}",
                  "aggregator": "max",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "black_on_light_green",
                      "value": 0
                    }
                  ]
                }
              ],
              "autoscale": true,
              "text_align": "left",
              "precision": 2
            },
            "layout": { "x": 0, "y": 4, "width": 2, "height": 2 }
          },
          {
            "id": 16,
            "definition": {
              "title": "Keys",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [{ "formula": "query1", "alias": "Total keys" }],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:redis.keys{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": { "palette": "purple" },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 2, "y": 4, "width": 4, "height": 2 }
          }
        ]
      },
      "layout": { "x": 0, "y": 0, "width": 6, "height": 7 }
    },
    {
      "id": 1,
      "definition": {
        "title": "Connections",
        "title_align": "left",
        "type": "group",
        "background_color": "vivid_pink",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 11,
            "definition": {
              "title": "Connected clients",
              "show_legend": true,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["max", "avg", "min"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    { "formula": "query1", "alias": "Connected clients" }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:redis.net.clients{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": { "palette": "cool" },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 0, "y": 0, "width": 4, "height": 2 }
          },
          {
            "id": 12,
            "definition": {
              "type": "note",
              "content": "Redis has 10,000 client connections available by default, but you can adjust the maximum number of connections with the `maxclient` directive in redis.conf. New connection attempts will be refused if your Redis instance is currently at its maximum number of connections.",
              "background_color": "white",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": { "x": 4, "y": 0, "width": 2, "height": 2 }
          },
          {
            "id": 13,
            "definition": {
              "title": "Connected replicas",
              "show_legend": false,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    { "formula": "query1", "alias": "Connected replicas" }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:redis.net.slaves{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 0, "y": 2, "width": 6, "height": 2 }
          },
          {
            "id": 14,
            "definition": {
              "title": "Rejected connections",
              "show_legend": false,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "diff(query1)",
                      "alias": "Rejected connections"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:redis.net.rejected{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": { "palette": "warm" },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 0, "y": 4, "width": 6, "height": 2 }
          }
        ]
      },
      "layout": { "x": 6, "y": 0, "width": 6, "height": 7 }
    },
    {
      "id": 3,
      "definition": {
        "title": "Memory Metrics",
        "title_align": "left",
        "type": "group",
        "background_color": "vivid_pink",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 23,
            "definition": {
              "title": "Percent Used Memory by Host",
              "show_legend": true,
              "legend_layout": "vertical",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "(query1 / query2) * 100",
                      "alias": "% memory used"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:redis.mem.used{$scope} by {host}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "max:redis.mem.maxmemory{$scope} by {host}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " Max memory reached ",
                  "value": "y = 100",
                  "display_type": "error dashed"
                },
                {
                  "label": " 80% memory usage ",
                  "value": "y = 80",
                  "display_type": "warning dashed"
                }
              ]
            },
            "layout": { "x": 0, "y": 0, "width": 6, "height": 4 }
          },
          {
            "id": 25,
            "definition": {
              "title": "Evictions",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "per_minute(query2)",
                      "alias": "Keys evicted due to the maxmemory limit"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:redis.keys.evicted{$scope} by {host}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": { "palette": "warm" },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 6, "y": 0, "width": 6, "height": 2 }
          },
          {
            "id": 29,
            "definition": {
              "title": "Blocked clients",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query2",
                      "alias": "Connections waiting on a blocking call"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:redis.clients.blocked{$scope}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 6, "y": 2, "width": 6, "height": 2 }
          },
          {
            "id": 24,
            "definition": {
              "type": "note",
              "content": "Memory usage is a crucial performance factor. If `used_memory > total available system memory`, the OS will begin swapping old/unused sections of memory and writing them to disk. Writing or reading from disk is up to 100,000 times slower than writing or reading from memory (0.1 µs for memory vs. 10 ms for disk).",
              "background_color": "white",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "top",
              "has_padding": true
            },
            "layout": { "x": 0, "y": 4, "width": 6, "height": 2 }
          },
          {
            "id": 26,
            "definition": {
              "title": "Fragmentation ratio",
              "type": "query_value",
              "requests": [
                {
                  "q": "avg:redis.mem.fragmentation_ratio{$scope}",
                  "aggregator": "avg",
                  "conditional_formats": [
                    {
                      "comparator": "<",
                      "palette": "black_on_light_red",
                      "value": 1.5
                    },
                    {
                      "comparator": ">=",
                      "palette": "black_on_light_green",
                      "value": 1.5
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2
            },
            "layout": { "x": 6, "y": 4, "width": 2, "height": 2 }
          },
          {
            "id": 27,
            "definition": {
              "title": "Fragmentation ratio",
              "show_legend": false,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "alias": "used_memory_rss / used_memory"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "avg:redis.mem.fragmentation_ratio{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": "Restart Redis",
                  "value": "y = 1.5",
                  "display_type": "error dashed"
                }
              ]
            },
            "layout": { "x": 8, "y": 4, "width": 4, "height": 2 }
          }
        ]
      },
      "layout": { "is_column_break": true }
    },
    {
      "id": 2,
      "definition": {
        "title": "Performance Metrics",
        "title_align": "left",
        "type": "group",
        "background_color": "vivid_pink",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 17,
            "definition": {
              "title": "Latency by Host",
              "show_legend": true,
              "legend_layout": "vertical",
              "legend_columns": ["avg", "max", "value"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query2",
                      "alias": "Latency of the redis INFO command"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:redis.info.latency_ms{$scope} by {host}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": { "palette": "warm" },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 0, "y": 0, "width": 6, "height": 4 }
          },
          {
            "id": 19,
            "definition": {
              "title": "Slowlog",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": ["avg", "min", "max", "value"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    { "formula": "top(query1 / 1000, 10, \"mean\", \"desc\")" }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:redis.slowlog.micros.95percentile{$scope} by {name,command}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 6, "y": 0, "width": 6, "height": 2 }
          },
          {
            "id": 22,
            "definition": {
              "title": "Commands per second",
              "show_legend": false,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    { "formula": "query1", "alias": "Processed commands" }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:redis.net.commands{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": { "palette": "grey" },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": { "x": 6, "y": 2, "width": 6, "height": 2 }
          },
          {
            "id": 18,
            "definition": {
              "type": "note",
              "content": "Latency measures the **time between a client request and the server response**, and monitoring it enables you to detect changes in Redis performance. The single-threaded nature of Redis means that a long response time for one request increases the latency for all subsequent requests, leading to serious bottlenecks.",
              "background_color": "white",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "top",
              "has_padding": true
            },
            "layout": { "x": 0, "y": 4, "width": 6, "height": 2 }
          },
          {
            "id": 20,
            "definition": {
              "title": "Cache hit rate",
              "type": "query_value",
              "requests": [
                {
                  "q": "(avg:redis.stats.keyspace_hits{$scope}/(avg:redis.stats.keyspace_hits{$scope}+avg:redis.stats.keyspace_misses{$scope}))*100",
                  "aggregator": "avg",
                  "conditional_formats": [
                    {
                      "comparator": "<",
                      "palette": "black_on_light_yellow",
                      "value": 75
                    },
                    {
                      "comparator": ">=",
                      "palette": "black_on_light_green",
                      "value": 75
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2
            },
            "layout": { "x": 6, "y": 4, "width": 2, "height": 2 }
          },
          {
            "id": 21,
            "definition": {
              "title": "Cache hit rate",
              "show_legend": false,
              "legend_size": "0",
              "legend_layout": "auto",
              "legend_columns": ["avg", "min", "max", "value", "sum"],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "(query1 / (query1 + query2)) * 100",
                      "alias": "hit %"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:redis.stats.keyspace_hits{$scope}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "avg:redis.stats.keyspace_misses{$scope}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "scale": "linear",
                "label": "",
                "include_zero": true,
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": "Ideal hit rate",
                  "value": "y = 100",
                  "display_type": "ok dashed"
                },
                {
                  "label": "Investigate",
                  "value": "y = 75",
                  "display_type": "warning dashed"
                }
              ]
            },
            "layout": { "x": 8, "y": 4, "width": 4, "height": 2 }
          }
        ]
      }
    }
  ],
  "template_variables": [
    { "name": "scope", "default": "*" },
    { "name": "host", "default": "*", "prefix": "host" }
  ],
  "layout_type": "ordered",
  "is_read_only": true,
  "notify_list": [],
  "reflow_type": "fixed",
  "id": "p87-73m-862"
}
