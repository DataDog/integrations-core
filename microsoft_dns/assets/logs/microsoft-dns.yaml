id: microsoft-dns
metric_id: microsoft-dns
backend_only: false
facets:
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
pipeline:
  type: pipeline
  name: Microsoft DNS
  enabled: true
  filter:
    query: source:microsoft-dns
  processors:
    - type: date-remapper
      name: Define `Event.System.TimeCreated.SystemTime` as the official date of the
        log
      enabled: true
      sources:
        - Event.System.TimeCreated.SystemTime
    - type: service-remapper
      name: Define `service` as the official service of the log
      enabled: true
      sources:
        - service
    - name: Lookup for `Event.System.EventID` to `title`
      enabled: true
      source: Event.System.EventID
      target: title
      lookupTable: |-
        512,Zone create
        513,Zone delete
        514,Zone updated
        515,Record create
        516,Record delete
        517,RRSET delete
        518,Node delete
        519,Record create - dynamic update
        520,Record delete - dynamic update
        521,Record scavenge
        522,Zone scope create
        523,Zone scope delete
        525,Zone sign
        526,Zone unsign
        527,Zone re-sign
        528,Key rollover start
        529,Key rollover end
        530,Key retire
        531,Key rollover triggered
        533,Key poke rollover
        534,Export DNSSEC
        535,Import DNSSEC
        536,Cache purge
        537,Forwarder reset
        540,Root hints
        541,Server setting
        542,Server scope create
        543,Server scope delete
        544,Add trust point DNSKEY
        545,Add trust point DS
        546,Remove trust point
        547,Add trust point root
        548,Restart server
        549,Clear debug logs
        550,Write dirty zones
        551,Clear statistics
        552,Start scavenging
        553,Enlist directory partition
        554,Abort scavenging
        555,Prepare for demotion
        556,Write root hints
        557,Listen address
        558,Active refresh trust points
        559,Pause zone
        560,Resume zone
        561,Reload zone
        562,Refresh zone
        563,Expire zone
        564,Update from DS
        565,Write and notify
        566,Force aging
        567,Scavenge servers
        568,Transfer key master
        569,Add SKD
        570,Modify SKD
        571,Delete SKD
        572,Modify SKD state
        573,Add delegation
        574,Create client subnet record
        575,Delete client subnet record
        576,Update client subnet record
        577,Create server level policy
        578,Create zone level policy
        579,Create forwarding policy
        580,Delete server level policy
        581,Delete zone level policy
        582,Delete forwarding policy
      type: lookup-processor
    - type: attribute-remapper
      name: Map `Event.System.EventID` to `evt.id`
      enabled: true
      sources:
        - Event.System.EventID
      sourceType: attribute
      target: evt.id
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: status-remapper
      name: Define `level` as the official status of the log
      enabled: true
      sources:
        - level
    - type: pipeline
      name: Process Dynamic Update Events
      enabled: true
      filter:
        query: "@evt.id:(519 OR 520)"
      processors:
        - type: attribute-remapper
          name: Map `Event.EventData.Data.Source` to `network.client.ip`
          enabled: true
          sources:
            - Event.EventData.Data.Source
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - name: Lookup for `Event.EventData.Data.Type` to `Event.EventData.Data.TypeName`
          enabled: true
          source: Event.EventData.Data.Type
          target: Event.EventData.Data.TypeName
          lookupTable: |-
            1,Address record
            28,IPv6 address record
            18,AFS database record
            42,Address Prefix List
            257,Certification Authority Authorization
            60,Child copy of DNSKEY record
            59,Child DS
            37,Certificate record
            5,Canonical name record
            62,Child-to-Parent Synchronization
            49,DHCP identifier
            32769,DNSSEC Lookaside Validation record
            39,Delegation name record
            48,DNS Key record
            43,Delegation signer
            108,MAC address (EUI-48)
            109,MAC address (EUI-64)
            13,Host Information
            55,Host Identity Protocol
            65,HTTPS Binding
            45,IPsec Key
            25,Key record
            36,Key Exchanger record
            29,Location record
            15,Mail exchange record
            35,Naming Authority Pointer
            2,Name server record
            47,Next Secure record
            50,Next Secure record version 3
            51,NSEC3 parameters
            61,OpenPGP public key record
            12,PTR Resource Record
            17,Responsible Person
            46,DNSSEC signature
            24,Signature
            53,S/MIME cert association
            6,Start of [a zone of] authority record
            33,Service locator
            44,SSH Public Key Fingerprint
            64,Service Binding
            32768,DNSSEC Trust Authorities
            249,Transaction Key record
            52,TLSA certificate association
            250,Transaction Signature
            16,Text record
            256,Uniform Resource Identifier
            63,Message Digests for DNS Zones
          defaultLookup: Other
          type: lookup-processor
    - type: pipeline
      name: Lookup for Resource Record Type
      enabled: true
      filter:
        query: "@evt.id:(515 OR 516 OR 517 OR 521)"
      processors:
        - name: Lookup for `Event.EventData.Data.Type` to `Event.EventData.Data.TypeName`
          enabled: true
          source: Event.EventData.Data.Type
          target: Event.EventData.Data.TypeName
          lookupTable: |-
            1,Address record
            28,IPv6 address record
            18,AFS database record
            42,Address Prefix List
            257,Certification Authority Authorization
            60,Child copy of DNSKEY record
            59,Child DS
            37,Certificate record
            5,Canonical name record
            62,Child-to-Parent Synchronization
            49,DHCP identifier
            32769,DNSSEC Lookaside Validation record
            39,Delegation name record
            48,DNS Key record
            43,Delegation signer
            108,MAC address (EUI-48)
            109,MAC address (EUI-64)
            13,Host Information
            55,Host Identity Protocol
            65,HTTPS Binding
            45,IPsec Key
            25,Key record
            36,Key Exchanger record
            29,Location record
            15,Mail exchange record
            35,Naming Authority Pointer
            2,Name server record
            47,Next Secure record
            50,Next Secure record version 3
            51,NSEC3 parameters
            61,OpenPGP public key record
            12,PTR Resource Record
            17,Responsible Person
            46,DNSSEC signature
            24,Signature
            53,S/MIME cert association
            6,Start of [a zone of] authority record
            33,Service locator
            44,SSH Public Key Fingerprint
            64,Service Binding
            32768,DNSSEC Trust Authorities
            249,Transaction Key record
            52,TLSA certificate association
            250,Transaction Signature
            16,Text record
            256,Uniform Resource Identifier
            63,Message Digests for DNS Zones
          defaultLookup: Other
          type: lookup-processor
    - type: attribute-remapper
      name: Map `Event.EventData.Data.IpAddress` to `network.client.ip`
      enabled: true
      sources:
        - Event.EventData.Data.IpAddress
      sourceType: attribute
      target: network.client.ip
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: geo-ip-parser
      name: Parse network.client.ip
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
      ip_processing_behavior: do-nothing
    - type: pipeline
      name: OCSF pre transformations
      enabled: true
      filter:
        query: ""
      processors:
        - type: string-builder-processor
          name: Add product name
          enabled: true
          template: Microsoft DNS
          target: ocsf.metadata.product.name
          replaceMissing: false
        - type: string-builder-processor
          name: Add product vendor
          enabled: true
          template: Microsoft
          target: ocsf.metadata.product.vendor_name
          replaceMissing: false
        - type: grok-parser
          name: Convert timestamp to Epoch
          enabled: true
          source: Event.System.TimeCreated.SystemTime
          samples:
            - 2026-01-02T01:30:00.220Z
          grok:
            supportRules: ""
            matchRules: time %{date("yyyy-MM-dd'T'HH:mm:ss.SSSZ"):ocsf.time}
    - type: pipeline
      name: OCSF sub pipeline for class Base Event [0]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@Event.System.EventID:(549 OR 550 OR 551 OR 552 OR 553 OR 554 OR 555 OR 556 OR 565)"
      processors:
        - type: schema-processor
          name: Apply OCSF schema for 0
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Base Event
            classUid: 0
            extensions: []
            profiles:
              - host
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "*"
                  name: Other
                  id: 99
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values:
                  ocsf.activity_id: "99"
                  ocsf.activity_name: Other
                sources:
                  ocsf.activity_name:
                    - title
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.time` to `ocsf.time`
              sources:
                - ocsf.time
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.TimeCreated.SystemTime` to `ocsf.metadata.original_time`
              sources:
                - Event.System.TimeCreated.SystemTime
              sourceType: attribute
              target: ocsf.metadata.original_time
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Correlation` to `ocsf.metadata.correlation_uid`
              sources:
                - Event.System.Correlation
              sourceType: attribute
              target: ocsf.metadata.correlation_uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventRecordID` to `ocsf.metadata.uid`
              sources:
                - Event.System.EventRecordID
              sourceType: attribute
              target: ocsf.metadata.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventID` to `ocsf.metadata.event_code`
              sources:
                - Event.System.EventID
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.metadata.log_provider`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.metadata.log_provider
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ThreadID` to `ocsf.actor.process.tid`
              sources:
                - Event.System.Execution.ThreadID
              sourceType: attribute
              target: ocsf.actor.process.tid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ProcessID` to `ocsf.actor.process.pid`
              sources:
                - Event.System.Execution.ProcessID
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.actor.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Version` to `ocsf.metadata.log_version`
              sources:
                - Event.System.Version
              sourceType: attribute
              target: ocsf.metadata.log_version
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Channel` to `ocsf.metadata.log_name`
              sources:
                - Event.System.Channel
              sourceType: attribute
              target: ocsf.metadata.log_name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Computer` to `ocsf.device.name`
              sources:
                - Event.System.Computer
              sourceType: attribute
              target: ocsf.device.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: ocsf.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Server
                  id: 1
              targets:
                name: ocsf.device.type
                id: ocsf.device.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
    - type: pipeline
      name: OCSF sub pipeline for class Application Lifecycle [6002]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@Event.System.EventID:548"
      processors:
        - type: schema-processor
          name: Apply OCSF schema for 6002
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Application Lifecycle
            classUid: 6002
            extensions: []
            profiles:
              - host
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "*"
                  name: Restart
                  id: 5
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.time` to `ocsf.time`
              sources:
                - ocsf.time
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventID` to `ocsf.metadata.event_code`
              sources:
                - Event.System.EventID
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.metadata.log_provider`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.metadata.log_provider
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Version` to `ocsf.metadata.log_version`
              sources:
                - Event.System.Version
              sourceType: attribute
              target: ocsf.metadata.log_version
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Channel` to `ocsf.metadata.log_name`
              sources:
                - Event.System.Channel
              sourceType: attribute
              target: ocsf.metadata.log_name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Correlation` to `ocsf.metadata.correlation_uid`
              sources:
                - Event.System.Correlation
              sourceType: attribute
              target: ocsf.metadata.correlation_uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.TimeCreated.SystemTime` to `ocsf.metadata.original_time`
              sources:
                - Event.System.TimeCreated.SystemTime
              sourceType: attribute
              target: ocsf.metadata.original_time
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventRecordID` to `ocsf.metadata.uid`
              sources:
                - Event.System.EventRecordID
              sourceType: attribute
              target: ocsf.metadata.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.actor.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ThreadID` to `ocsf.actor.process.tid`
              sources:
                - Event.System.Execution.ThreadID
              sourceType: attribute
              target: ocsf.actor.process.tid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ProcessID` to `ocsf.actor.process.pid`
              sources:
                - Event.System.Execution.ProcessID
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: ocsf.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Server
                  id: 1
              targets:
                name: ocsf.device.type
                id: ocsf.device.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `Event.System.Computer` to `ocsf.device.name`
              sources:
                - Event.System.Computer
              sourceType: attribute
              target: ocsf.device.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.app.name`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.app.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Guid` to `ocsf.app.uid`
              sources:
                - Event.System.Provider.Guid
              sourceType: attribute
              target: ocsf.app.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class Device Config State Change [5019]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@Event.System.EventID:(525 OR 526 OR 527 OR 528 OR 529 OR 530 OR 531 OR 533 OR 536 OR 537 OR 540 OR 541 OR 544 OR 545 OR 546 OR 547 OR 557 OR 558 OR 568)"
      processors:
        - type: schema-processor
          name: Apply OCSF schema for 5019
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Device Config State Change
            classUid: 5019
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@Event.System.EventID:(525 OR 526 OR 527 OR 528 OR 529 OR 530 OR 531 OR 533 OR 536 OR 537 OR 540 OR 541 OR 544 OR 545 OR 546 OR 547 OR 557 OR 558 OR 568)"
                  name: Log
                  id: 1
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "@Event.System.Level:1"
                  name: Critical
                  id: 5
                - filter:
                    query: "@Event.System.Level:2"
                  name: Fatal
                  id: 6
                - filter:
                    query: "@Event.System.Level:3"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:4"
                  name: Informational
                  id: 1
                - filter:
                    query: "@Event.System.Level:5"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:0"
                  name: Unknown
                  id: 0
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values:
                  ocsf.severity: Other
                  ocsf.severity_id: "99"
                sources:
                  ocsf.severity:
                    - Warning
                    - Verbose
              type: schema-category-mapper
            - name: Map `ocsf.time` to `ocsf.time`
              sources:
                - ocsf.time
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.TimeCreated.SystemTime` to `ocsf.metadata.original_time`
              sources:
                - Event.System.TimeCreated.SystemTime
              sourceType: attribute
              target: ocsf.metadata.original_time
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Correlation` to `ocsf.metadata.correlation_uid`
              sources:
                - Event.System.Correlation
              sourceType: attribute
              target: ocsf.metadata.correlation_uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventRecordID` to `ocsf.metadata.uid`
              sources:
                - Event.System.EventRecordID
              sourceType: attribute
              target: ocsf.metadata.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventID` to `ocsf.metadata.event_code`
              sources:
                - Event.System.EventID
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.metadata.log_provider`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.metadata.log_provider
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ThreadID` to `ocsf.actor.process.tid`
              sources:
                - Event.System.Execution.ThreadID
              sourceType: attribute
              target: ocsf.actor.process.tid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ProcessID` to `ocsf.actor.process.pid`
              sources:
                - Event.System.Execution.ProcessID
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.actor.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Version` to `ocsf.metadata.log_version`
              sources:
                - Event.System.Version
              sourceType: attribute
              target: ocsf.metadata.log_version
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Channel` to `ocsf.metadata.log_name`
              sources:
                - Event.System.Channel
              sourceType: attribute
              target: ocsf.metadata.log_name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: ocsf.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Server
                  id: 1
              targets:
                name: ocsf.device.type
                id: ocsf.device.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `Event.System.Computer` to `ocsf.device.name`
              sources:
                - Event.System.Computer
              sourceType: attribute
              target: ocsf.device.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class Entity Management [3004] associated with Record, Zone Scope, and Server Scope entities
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@Event.System.EventID:(515 OR 516 OR 518 OR 519 OR 520 OR 521 OR 522 OR 523 OR 542 OR 543)"
      processors:
        - type: category-processor
          name: Category processor for creating `activity_id` for 99
          enabled: true
          categories:
            - name: scavenge
              filter:
                query: "@Event.System.EventID:521"
          target: other_entity_activity
        - type: category-processor
          name: Category processor for creating `entity.type` for 99
          enabled: true
          categories:
            - name: Record
              filter:
                query: "@Event.System.EventID:(515 OR 516 OR 518 OR 519 OR 520 OR 521)"
            - name: Zone Scope
              filter:
                query: "@Event.System.EventID:(522 OR 523)"
            - name: Server Scope
              filter:
                query: "@Event.System.EventID:(542 OR 543)"
          target: other_entity_type
        - type: schema-processor
          name: Apply OCSF schema for 3004
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Entity Management
            classUid: 3004
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@Event.System.EventID:(515 OR 519 OR 522 OR 542)"
                  name: Create
                  id: 1
                - filter:
                    query: "@Event.System.EventID:(516 OR 518 OR 520 OR 523 OR 543)"
                  name: Delete
                  id: 4
                - filter:
                    query: "@Event.System.EventID:521"
                  name: Other
                  id: 99
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values:
                  ocsf.activity_id: "99"
                  ocsf.activity_name: Other
                sources:
                  ocsf.activity_name:
                    - other_entity_activity
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "@Event.System.Level:1"
                  name: Critical
                  id: 5
                - filter:
                    query: "@Event.System.Level:2"
                  name: Fatal
                  id: 6
                - filter:
                    query: "@Event.System.Level:3"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:4"
                  name: Informational
                  id: 1
                - filter:
                    query: "@Event.System.Level:5"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:0"
                  name: Unknown
                  id: 0
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values:
                  ocsf.severity: Other
                  ocsf.severity_id: "99"
                sources:
                  ocsf.severity:
                    - Warning
                    - Verbose
              type: schema-category-mapper
            - name: Map `ocsf.time` to `ocsf.time`
              sources:
                - ocsf.time
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.TimeCreated.SystemTime` to `ocsf.metadata.original_time`
              sources:
                - Event.System.TimeCreated.SystemTime
              sourceType: attribute
              target: ocsf.metadata.original_time
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Correlation` to `ocsf.metadata.correlation_uid`
              sources:
                - Event.System.Correlation
              sourceType: attribute
              target: ocsf.metadata.correlation_uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventRecordID` to `ocsf.metadata.uid`
              sources:
                - Event.System.EventRecordID
              sourceType: attribute
              target: ocsf.metadata.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventID` to `ocsf.metadata.event_code`
              sources:
                - Event.System.EventID
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.metadata.log_provider`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.metadata.log_provider
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ThreadID` to `ocsf.actor.process.tid`
              sources:
                - Event.System.Execution.ThreadID
              sourceType: attribute
              target: ocsf.actor.process.tid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ProcessID` to `ocsf.actor.process.pid`
              sources:
                - Event.System.Execution.ProcessID
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.actor.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.entity.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.entity.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Version` to `ocsf.metadata.log_version`
              sources:
                - Event.System.Version
              sourceType: attribute
              target: ocsf.metadata.log_version
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Channel` to `ocsf.metadata.log_name`
              sources:
                - Event.System.Channel
              sourceType: attribute
              target: ocsf.metadata.log_name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.EventData.Data.NAME`, `Event.EventData.Data.ZoneScope`, `Event.EventData.Data.Scope`, `Event.EventData.Data.ServerScope` to `ocsf.entity.name`
              sources:
                - Event.EventData.Data.NAME
                - Event.EventData.Data.ZoneScope
                - Event.EventData.Data.Scope
                - Event.EventData.Data.ServerScope
              sourceType: attribute
              target: ocsf.entity.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Computer` to `ocsf.entity.device.name`
              sources:
                - Event.System.Computer
              sourceType: attribute
              target: ocsf.entity.device.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.EventData.Data` to `ocsf.entity.data`
              sources:
                - Event.EventData.Data
              sourceType: attribute
              target: ocsf.entity.data
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: ocsf.entity.type_id
              categories:
                - filter:
                    query: "*"
                  name: Other
                  id: 99
              targets:
                id: ocsf.entity.type_id
                name: ocsf.entity.type
              fallback:
                values:
                  ocsf.entity.type: Other
                  ocsf.entity.type_id: "99"
                sources:
                  ocsf.entity.type:
                    - other_entity_type
              type: schema-category-mapper
            - name: ocsf.entity.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Server
                  id: 1
              targets:
                id: ocsf.entity.device.type_id
                name: ocsf.entity.device.type
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
    - type: pipeline
      name: OCSF sub pipeline for class Entity Management [3004] associated with remaining entity types
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@Event.System.EventID:(513 OR 514 OR 517 OR 534 OR 535 OR 559 OR 560 OR 561 OR 562 OR 563 OR 564 OR 566 OR 567 OR 569 OR 570 OR 571 OR 572 OR 573 OR 574 OR 575 OR 576 OR 577 OR 578 OR 579 OR 580 OR 581 OR 582)"
      processors:
        - type: category-processor
          name: Category processor for creating `activity_id` for 99
          enabled: true
          categories:
            - filter:
                query: "@Event.System.EventID:534"
              name: Export
            - filter:
                query: "@Event.System.EventID:535"
              name: Import
            - filter:
                query: "@Event.System.EventID:559"
              name: Pause
            - filter:
                query: "@Event.System.EventID:562"
              name: Refresh
            - filter:
                query: "@Event.System.EventID:563"
              name: Expire
            - filter:
                query: "@Event.System.EventID:561"
              name: Reload
          target: other_entity_activity
        - type: category-processor
          name: Category processor for creating `entity.type` for 99
          enabled: true
          categories:
            - name: Zone
              filter:
                query: "@Event.System.EventID:(513 OR 514 OR 517 OR 534 OR 535 OR 559 OR 560 OR 561 OR 562 OR 563 OR 564 OR 567)"
            - name: Node
              filter:
                query: "@Event.System.EventID:566"
            - name: Client Subnet Record
              filter:
                query: "@Event.System.EventID:(574 OR 575 OR 576)"
            - name: Child Zone
              filter:
                query: "@Event.System.EventID:573"
            - name: Policy
              filter:
                query: "@Event.System.EventID:(577 OR 578 OR 579 OR 580 OR 581 OR 582)"
            - name: Singing Key Descriptor
              filter:
                query: "@Event.System.EventID:(570 OR 571 OR 572 OR 569)"
          target: other_entity_type
        - type: schema-processor
          name: Apply OCSF schema for 3004
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Entity Management
            classUid: 3004
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@Event.System.EventID:(569 OR 573 OR 574 OR 577 OR 578 OR 579)"
                  name: Create
                  id: 1
                - filter:
                    query: "@Event.System.EventID:(514 OR 517 OR 564 OR 566 OR 567 OR 570 OR 572 OR 576)"
                  name: Update
                  id: 3
                - filter:
                    query: "@Event.System.EventID:(513 OR 571 OR 575 OR 580 OR 581 OR 582)"
                  name: Delete
                  id: 4
                - filter:
                    query: "@Event.System.EventID:560"
                  name: Resume
                  id: 13
                - filter:
                    query: "@Event.System.EventID:(534 OR 535 OR 559 OR 561 OR 562 OR 563)"
                  name: Other
                  id: 99
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values:
                  ocsf.activity_id: "99"
                  ocsf.activity_name: Other
                sources:
                  ocsf.activity_name:
                    - other_entity_activity
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "@Event.System.Level:1"
                  name: Critical
                  id: 5
                - filter:
                    query: "@Event.System.Level:2"
                  name: Fatal
                  id: 6
                - filter:
                    query: "@Event.System.Level:3"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:4"
                  name: Informational
                  id: 1
                - filter:
                    query: "@Event.System.Level:5"
                  name: Other
                  id: 99
                - filter:
                    query: "@Event.System.Level:0"
                  name: Unknown
                  id: 0
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values:
                  ocsf.severity: Other
                  ocsf.severity_id: "99"
                sources:
                  ocsf.severity:
                    - Warning
                    - Verbose
              type: schema-category-mapper
            - name: Map `ocsf.time` to `ocsf.time`
              sources:
                - ocsf.time
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.TimeCreated.SystemTime` to `ocsf.metadata.original_time`
              sources:
                - Event.System.TimeCreated.SystemTime
              sourceType: attribute
              target: ocsf.metadata.original_time
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Correlation` to `ocsf.metadata.correlation_uid`
              sources:
                - Event.System.Correlation
              sourceType: attribute
              target: ocsf.metadata.correlation_uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventRecordID` to `ocsf.metadata.uid`
              sources:
                - Event.System.EventRecordID
              sourceType: attribute
              target: ocsf.metadata.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.EventID` to `ocsf.metadata.event_code`
              sources:
                - Event.System.EventID
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Provider.Name` to `ocsf.metadata.log_provider`
              sources:
                - Event.System.Provider.Name
              sourceType: attribute
              target: ocsf.metadata.log_provider
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ThreadID` to `ocsf.actor.process.tid`
              sources:
                - Event.System.Execution.ThreadID
              sourceType: attribute
              target: ocsf.actor.process.tid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Execution.ProcessID` to `ocsf.actor.process.pid`
              sources:
                - Event.System.Execution.ProcessID
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.actor.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Security.UserID` to `ocsf.entity.user.uid`
              sources:
                - Event.System.Security.UserID
              sourceType: attribute
              target: ocsf.entity.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Version` to `ocsf.metadata.log_version`
              sources:
                - Event.System.Version
              sourceType: attribute
              target: ocsf.metadata.log_version
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Channel` to `ocsf.metadata.log_name`
              sources:
                - Event.System.Channel
              sourceType: attribute
              target: ocsf.metadata.log_name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.EventData.Data.GUID`, `Event.EventData.Data.KeyId`, `Event.EventData.Data.ClientSubnetRecord`, `Event.EventData.Data.Policy`, `Event.EventData.Data.PolicyName`, `Event.EventData.Data.ChildZone`, `Event.EventData.Data.Zone`, `Event.EventData.Data.ZoneName` to `ocsf.entity.name`
              sources:
                - Event.EventData.Data.GUID
                - Event.EventData.Data.KeyId
                - Event.EventData.Data.ClientSubnetRecord
                - Event.EventData.Data.Policy
                - Event.EventData.Data.PolicyName
                - Event.EventData.Data.ChildZone
                - Event.EventData.Data.Zone
                - Event.EventData.Data.ZoneName
              sourceType: attribute
              target: ocsf.entity.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.System.Computer` to `ocsf.entity.device.name`
              sources:
                - Event.System.Computer
              sourceType: attribute
              target: ocsf.entity.device.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `Event.EventData.Data` to `ocsf.entity.data`
              sources:
                - Event.EventData.Data
              sourceType: attribute
              target: ocsf.entity.data
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: ocsf.entity.type_id
              categories:
                - filter:
                    query: "*"
                  name: Other
                  id: 99
              targets:
                name: ocsf.entity.type
                id: ocsf.entity.type_id
              fallback:
                values:
                  ocsf.entity.type: Other
                  ocsf.entity.type_id: "99"
                sources:
                  ocsf.entity.type:
                    - other_entity_type
              type: schema-category-mapper
            - name: ocsf.entity.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Server
                  id: 1
              targets:
                name: ocsf.entity.device.type
                id: ocsf.entity.device.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
