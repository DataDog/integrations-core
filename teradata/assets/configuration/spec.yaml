name: Teradata
files:
- name: teradata.yaml
  options:
  - template: init_config
    options:
    - template: init_config/default
    - template: init_config/db
  - template: instances
    description: |
      Every instance is scheduled independent of the others.

      Note: All '%' characters must be escaped as '%%'
    options:
    - name: use_odbc
      description: |
        Whether or not to use ODBC method for connecting to the Teradata database. If `true`, ODBC options are required.
        If `false`, the check will use the teradatasql python driver to connect to the Teradata database.
      value:
        type: string
        default: true
    - name: use_jdbc
      description: |
        Whether or not to use JDBC method for connecting to the Teradata database.
      value:
        type: string
        default: false
    - name: dsn
      description: Data Source Name. The name of ODBC Driver for Teradata in the [ODBC Data Sources] section of odbc.ini.
      value:
        type: string
        example: <DSN>
    - name: account
      description: |
        The account string to use when logging into the database.
      value:
        type: string
    - name: host
      required: true
      description: |
        The IP address or FQDN (fully qualified domain name) of the Teradata database server. If `use_odbc` is enabled,
        specify the DBC name.
      value:
        type: string
        example: <IP>
    - name: port
      description: |
        Specifies the Teradata database port number
      value:
        type: string
        default: 1025
    - name: database
      description: |
        The name of the database to access.
      value:
        type: string
        example: system
    - name: odbc_driver_path
      description: |
        The named ODBC Driver or the full path to ODBC Driver for Teradata shared objects
        (e.g. <DRIVER_INSTALL_DIR>/teradata/client/ODBC/lib/tdataodbc_sb64.so).
      value:
        type: string
        example: Teradata Database ODBC Driver 17.10
    - name: jdbc_driver_path
      description: |
        The full path to the Teradata JDBC Driver.
      value:
        type: string
        example: <DRIVER_PATH>.jar
    - name: connection_string
      description: |
        Specify a custom connection string to be used for connecting to the Teradata database.
      value:
        type: string
        example: "<CONNECTION_STRING>"
    - name: username
      required: true
      description: Username for the Datadog-Teradata check user.
      value:
        type: string
    - name: password
      required: true
      description: Password for the Datadog-Teradata check user.
      value:
        type: string
    - name: use_tls
      description: Whether or not to use TLS for making connections to the Teradata database.
      value:
        type: string
        default: false
    - name: https_port
      description: The port number used for making TLS connections to the Teradata database.
      value:
        type: string
        example: <PORT>
        default: 443
    - name: ssl_mode
      description: |
        The SSL mode used for making TLS connections to the Teradata database.
        Valid options are:
        * Allow
        * Disable
        * Prefer
        * Require
        * Verify-CA (Note: Does not perform TLS certificate verification if `use_odbc: false`)
        * Verify-Full (Note: Does not perform TLS certificate verification if `use_odbc: false`)
      value:
        type: string
        default: Prefer
    - name: ssl_protocol
      description: Specifies the TLS protocol for HTTPS/TLS connections. Currently, only TLSv1.2 is supported.
      value:
        type: string
        default: TLSv1.2
    - name: ssl_ca
      description: |
        The full path of the directory containing the root certificates for trusted CAs. If `ssl_mode` is not set to
        `Verify-CA` or `Verify-Full`, `ssl_ca` path or `ssl_ca_path` file name will be ignored.
      value:
        type: string
        example: /path/to/ssl_ca_dir
    - name: ssl_ca_path
      description: |
        The full path and name of a .pem file containing one or more certificates for
        trusted Root and Intermediate CAs. If `ssl_mode` is not set to `Verify-CA` or `Verify-Full`,
        `ssl_ca` path or `ssl_ca_path` file name will be ignored.
      value:
        type: string
        example: /path/to/ssl_ca_file/ca.pem
    - name: mechanism_key
      description: |
        Key parameter to the authenication mechanism.
      value:
        type: string
    - name: mechanism_name
      description: |
        The authentication mechanism for connecting to the Teradata data source. If no value is provided,
        the default is determined by the configuration in the `tdgssconfigure` XML file.
        For more info, see: https://docs.teradata.com/r/ODBC-Driver-for-Teradata-User-Guide/October-2021

        Valid options are:
        * TD2 - Selects Teradata 2 authentication mechanism. Username and password are required.
        * TDNEGO - Selects the Authentication Mechanism automatically based on the policy without user involvement.
        * LDAP - Selects LDAP as the authentication mechanism. The application provides the username and password.
        * KRB5 - Selects Kerberos as the authentication mechanism. The application provides the username and password.
      value:
        type: string
  - template: instances/db
  - template: instances/default