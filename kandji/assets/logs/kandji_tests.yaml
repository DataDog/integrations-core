id: kandji
tests:
  - sample: |-
      {
        "id": "01K5TWX6CQ07HFHKSMYQYRDKAB",
        "action": "update",
        "occurred_at": "2025-09-23T09:01:37.420577Z",
        "actor_id": "aa2ec25a-a125-45b5-9489-b9cd66d2d60f",
        "actor_type": "user",
        "target_id": "4b3b6c16-2728-4037-8d4a-342538cad637",
        "target_type": "admin",
        "target_component": "user",
        "new_state": {
          "role": "admin",
          "email": "john.carter@crestdata.ai",
          "first_name": "John",
          "last_name": "Carter"
        }
      }
    result: null
  - sample: >-
      {
        "id": "01K5TPW1DEFFM2SYK7HYJ5TPAB",
        "action": "detect",
        "occurred_at": "2025-09-23T07:16:07.444310Z",
        "actor_id": "EDR",
        "actor_type": "kandji",
        "target_id": "3a867771-949f-4065-9bc2-e79634af48b9.16777220.558457",
        "target_type": "file_detection",
        "target_component": "file",
        "new_state": {
          "process": {
            "pid": 14047,
            "name": "AppStore"
          },
          "ecs": {
            "version": "8.17"
          },
          "file": {
            "path": "/Users/Shared/AppStore.app/Contents/MacOS/AppStore",
            "inode": "558412",
            "hash": {
              "sha256": "4131d4737fe8dfe66d407bfd0a0df18a4a77b89347471cc012da8efc93c661aB"
            },
            "extension": "",
            "directory": "/Users/Shared/AppStore.app/Contents/MacOS",
            "device": "16777222",
            "name": "AppStore"
          },
          "event": {
            "action": "threat-detected",
            "type": [
              "indicator"
            ],
            "kind": "event",
            "created": "2025-09-23T07:16:07.444310+00:00",
            "outcome": "success",
            "category": [
              "file",
              "threat",
              "malware"
            ]
          },
          "@timestamp": "2025-09-23T07:16:07.444310+00:00",
          "user": {
            "id": "501",
            "name": "it"
          },
          "host": {
            "mac": [
              "38:f9:d3:1c:9c:bb",
              "F0:18:98:B6:75:AE",
              "38:f9:d3:1c:9c:bb"
            ],
            "id": "3a867771-949f-4065-9bc2-e79634af48b9",
            "os": {
              "version": "14.7.6",
              "family": "sonoma",
              "platform": "sonoma",
              "name": "Sonoma"
            },
            "name": "ITs-MacBook-Air-2.local"
          }
        },
        "metadata": {
          "file_status": "Detected",
          "classification_source": "Kandji",
          "threat_family_name": "SpyDok",
          "action_taken": "No Action",
          "threat_status": "Not Quarantined",
          "local_host_name": "ITs-MacBook-Air-2",
          "library_item_id": "d239708c-d890-48de-b5f5-f5b5ecc555ca",
          "classification": "Malware",
          "threat_description": "SpyDok is spyware designed to stealthily collect sensitive information such as login credentials, browsing history, and other personal data. It operates by monitoring user activity, exfiltrating stolen data to remote servers controlled by attackers, and maintaining persistence to evade detection.",
          "initial_detection_date": "2025-09-23T07:16:07.444310+00:00",
          "threat_id": "4131d4737fe8dfe66d407bfd0a0df18a4a77b89347471cc012da8efc93c661aB",
          "device": {
            "model": "MacBook Air",
            "id": "3a867771-949f-4065-9bc2-e79634af48b1",
            "serial_number": "C02XPHAYJK12",
            "name": "IT’s MacBook Air"
          }
        }
      }
    result: null
  - sample: |-
      {
        "id": "01K4SVQ3MR2BSPB21TWNWJAJA2",
        "action": "create",
        "occurred_at": "2025-09-10T13:05:53.181373Z",
        "actor_id": "kandji",
        "actor_type": "kandji",
        "target_id": "3fce591e-393c-49cc-91f2-f3eb608404dp",
        "target_type": "device",
        "target_component": "enrollment",
        "new_state": {
          "blueprint": {
            "id": "9d618261-86dd-4a4f-89bc-147f052878fc",
            "name": "iOS test"
          },
          "enrollment_type": "MDM",
          "device": {
            "id": "3fce591e-393c-49cc-91f2-f3eb608404d7",
            "name": "No name"
          }
        }
      }
    result: null
  - sample: >-
      {
        "id": "01K4PQ40BTQPZVS52FJXD0GFB3",
        "action": "detect",
        "occurred_at": "2025-09-09T07:47:49.172851Z",
        "actor_id": "VULNERABILITY_MANAGEMENT",
        "actor_type": "kandji",
        "target_id": "e7268916397088438050fdd671054aab",
        "target_type": "vulnerability",
        "new_state": {
          "ecs": {
            "version": "1.6.0"
          },
          "file": {
            "path": "/Applications/Safari.app",
            "name": "Safari"
          },
          "event": {
            "action": "vulnerability_detect",
            "type": [
              "info"
            ],
            "kind": "alert",
            "id": "e7268916397088438050fdd671054aab",
            "category": [
              "vulnerability"
            ]
          },
          "@timestamp": "2025-09-09T07:47:48.228189Z",
          "vulnerability": {
            "enumeration": "CVE",
            "description": "A cross-origin issue existed with \"iframe\" elements. This was addressed with improved tracking of security origins. This issue is fixed in Safari 18, visionOS 2, watchOS 11, macOS Sequoia 15, iOS 18 and iPadOS 18, tvOS 18. A malicious website may exfiltrate data cross-origin.",
            "scanner": {
              "vendor": "Kandji"
            },
            "score": {
              "exploitability": 0.00086,
              "base": 6.5
            },
            "id": "CVE-2024-44187",
            "severity": "Medium"
          },
          "host": {
            "mac": [
              "f0:18:98:ad:89:bc",
              "F0:18:98:A5:3C:A7",
              "f0:18:98:ad:89:bc"
            ],
            "id": "1e5e3ea1-20d1-4c2c-8b8d-3411608aebab",
            "os": {
              "version": "Sonoma",
              "platform": "darwin",
              "name": "macOS"
            },
            "name": "IT’s MacBook Air"
          },
          "device": {
            "id": "1e5e3ea1-20d1-4c2c-8b8d-3411608aebab"
          }
        }
      }
    result: null
  - sample: |-
      {
        "id": "01K4PJA0E0EQEC7QRXTH6WAJ12",
        "action": "update",
        "occurred_at": "2025-09-09T06:23:43.383914Z",
        "actor_id": "ffc0f98d-5429-4e7a-8d26-9dd015a974ef",
        "actor_type": "user",
        "target_id": "41b6cc51-7905-436a-9e33-b1468ceeb08a",
        "target_type": "blueprint",
        "target_component": "library_items",
        "new_state": {
          "library_items_added": [
            {
              "id": "00722363-0b8b-4fdb-9806-5cf49dd4c4eb",
              "name": "Bloxone"
            }
          ],
          "library_items_scoped": [
            {
              "id": "e6f2f3bf-56ef-4f2f-9613-fc362f29adab",
              "name": "Liftoff-test"
            }
          ],
          "name": "DDS-Test"
        }
      }
    result: null
  - sample: >-
      {
        "device_id": "1e5e3ea1-20d1-4c2c-8b8d-3411608aebab",
        "device_name": "IT’s MacBook Air",
        "device_serial_number": "C02XMF5VJK7A",
        "device_model": "MacBook Air (Retina, 13-inch, 2018)",
        "device_os_version": "14.7.8",
        "blueprint_id": "41b6cc51-7905-436a-9e33-b1468ceeb08d",
        "blueprint_name": "Blueprint-Test",
        "name": "Google Chrome",
        "version": "140.0.7339.81",
        "path": "/Applications/Google Chrome.app",
        "bundle_id": "com.google.Chrome",
        "cve_id": "CVE-2025-10892",
        "description": "Integer overflow in V8 in Google Chrome prior to 140.0.7339.207 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page. (Chromium security severity: High)",
        "cve_link": "https://nvd.nist.gov/vuln/detail/CVE-2025-10892",
        "cvss_score": 8.8,
        "severity": "High",
        "detection_datetime": "2025-09-24T18:57:34.914031Z",
        "cve_published_at": "2025-09-24T17:15:39.940000",
        "cve_modified_at": "2025-09-25T15:55:41.970000"
      }
    result: null