name: ESXi
files:
- name: esxi.yaml
  options:
  - template: init_config
    options:
    - template: init_config/default
  - template: instances
    options:
        - name: host
          required: true
          display_priority: 1
          description: The host used to resolve the ESXi IP. It is either a FQDN or an IP.
          value:
            type: string
            example: <HOSTNAME>
        - name: username
          required: true
          display_priority: 1
          description: |
            The ESXi host username
          value:
            type: string
            example: <USERNAME>
        - name: password
          required: true
          display_priority: 1
          description: |
            The ESXi host password
          value:
            type: string
            example: <PASSWORD>
        - name: use_guest_hostname
          description: |
            If true, the check will use the guest hostname for VMs instead of the VM name.
            This requires the VM to have VMware tools installed. If the guest hostname is
            not available, it will fallback to the VM name.
            Use this if you install the agent on VMs to avoid duplicate entries for hosts
            in the web application UI.
            Note: If VMs are duplicated in the Infrastructure List, follow these troubleshooting steps
                  https://docs.datadoghq.com/integrations/faq/troubleshooting-duplicated-hosts-with-vsphere/.
          value:
            type: boolean
            example: false
        - name: excluded_host_tags
          description: |
            Use this option to send a subset of host tags as metric tags.
            The ESXi integration collects tags for every ESXi host or VM in your environment.
            Those tags can be `esxi_url`, esxi_type`, `esxi_host`, `esxi_folder`, `esxi_cluster`
            `esxi_compute`, `esxi_datacenter`, `esxi_datastore` and are attached to the ESXi metrics by default.
            By default these tags are submitted as host tags, but you can submit them as metric tags instead by using
            this configuration option, see: https://docs.datadoghq.com/tagging/using_tags/
            You will lose the ability to filter your hosts on the tags you specify but they will appear faster
            and will remove spikes from some `count by {TAG}` queries.
            A good use case is to set this parameter to `[esxi_host]`, indeed with VM migrations this tag is expected to
            change often and it is usually helpful to be informed quickly of this change.
          value:
            type: array
            items:
              type: string
            display_default: []
            example:
              - <HOST_TAG>
        - template: instances/default
