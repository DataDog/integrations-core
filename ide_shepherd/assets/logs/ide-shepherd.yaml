id: ide-shepherd
metric_id: ide-shepherd
backend_only: false
installation_sources:
  - ide-shepherd
facets:
  - groups:
      - IDE-Shepherd
    name: IDE
    path: metadata.environment.ide_flavor
    source: log
  - groups:
      - IDE-Shepherd
    name: Extension Lifecycle
    path: activity_name
    source: log
  - groups:
      - IDE-Shepherd
    name: OCSF Class
    path: class_name
    source: log
  - groups:
      - IDE-Shepherd
    name: Extension
    path: application.name
    source: log
  - groups:
      - IDE-Shepherd
    name: Resources UID
    path: resources.uid
    source: log
  - groups:
      - IDE-Shepherd
    name: Technique
    path: observables.name
    source: log
  - groups:
      - IDE-Shepherd
    name: Is Alert
    path: isAlert
    source: log
pipeline:
  type: pipeline
  name: IDE-Shepherd
  enabled: true
  filter:
    query: source:ide-shepherd
  processors:
    - type: service-remapper
      name: Define `service` as the official service of the log
      enabled: true
      sources:
        - service
    - name: Lookup for `activity_id` to `activity_name`
      enabled: true
      source: activity_id
      target: activity_name
      lookupTable: |-
        1,installed
        2,updated
        3,uninstalled
      type: lookup-processor
    - name: Lookup for `class_uid` to `class_name`
      enabled: true
      source: class_uid
      target: class_name
      lookupTable: |-
        2007,Application Security Posture Finding
        2004,Detection Finding
      type: lookup-processor

