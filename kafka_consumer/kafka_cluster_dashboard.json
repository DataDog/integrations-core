{
  "title": "Kafka Cluster Overview",
  "description": "Comprehensive Kafka cluster monitoring including brokers, topics, partitions, consumer groups, and schema registry",
  "widgets": [
    {
      "id": 0,
      "definition": {
        "type": "note",
        "content": "# Kafka Cluster Overview\n\nThis dashboard provides comprehensive visibility into your Kafka cluster including:\n- Broker health and configuration\n- Topic and partition metrics\n- Consumer group lag and membership\n- Schema registry information",
        "background_color": "blue",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 12,
        "height": 2
      }
    },
    {
      "id": 1,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "avg:kafka.broker.count{$kafka_cluster_id}",
            "aggregator": "last"
          }
        ],
        "title": "Total Brokers",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 0,
        "y": 2,
        "width": 3,
        "height": 2
      }
    },
    {
      "id": 2,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "avg:kafka.topic.count{$kafka_cluster_id}",
            "aggregator": "last"
          }
        ],
        "title": "Total Topics",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 3,
        "y": 2,
        "width": 3,
        "height": 2
      }
    },
    {
      "id": 3,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "avg:kafka.consumer_group.count{$kafka_cluster_id}",
            "aggregator": "last"
          }
        ],
        "title": "Consumer Groups",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 6,
        "y": 2,
        "width": 3,
        "height": 2
      }
    },
    {
      "id": 4,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "sum:kafka.topic.size{$kafka_cluster_id,$topic}",
            "aggregator": "last"
          }
        ],
        "title": "Total Messages",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 9,
        "y": 2,
        "width": 3,
        "height": 2
      }
    },
    {
      "id": 5,
      "definition": {
        "type": "note",
        "content": "## Broker Metrics",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 4,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 6,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.broker.count{$kafka_cluster_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Broker Count Over Time",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false,
        "legend_size": "0"
      },
      "layout": {
        "x": 0,
        "y": 5,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 7,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.broker.config.log_retention_bytes{$kafka_cluster_id} by {broker_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Broker Log Retention (Bytes)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 6,
        "y": 5,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 8,
      "definition": {
        "type": "note",
        "content": "## Topic Metrics",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 8,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 9,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.topic.count{$kafka_cluster_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Total Topics",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 9,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 10,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.topic.partitions{$kafka_cluster_id,$topic} by {topic}",
            "display_type": "bars",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Partitions per Topic",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 4,
        "y": 9,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 11,
      "definition": {
        "type": "toplist",
        "requests": [
          {
            "q": "top(avg:kafka.topic.size{$kafka_cluster_id,$topic} by {topic}, 10, 'mean', 'desc')",
            "style": {
              "palette": "dog_classic"
            }
          }
        ],
        "title": "Top 10 Topics by Size (Messages)",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 8,
        "y": 9,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 12,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "sum:kafka.topic.size{$kafka_cluster_id,$topic} by {topic}",
            "display_type": "area",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Topic Size (Total Messages) Over Time",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 0,
        "y": 12,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 13,
      "definition": {
        "type": "note",
        "content": "## Partition Metrics",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 15,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 14,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.partition.beginning_offset{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "cool",
              "line_type": "solid",
              "line_width": "thin"
            }
          }
        ],
        "title": "Partition Beginning Offsets",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 16,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 15,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.partition.end_offset{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "warm",
              "line_type": "solid",
              "line_width": "thin"
            }
          }
        ],
        "title": "Partition End Offsets",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 6,
        "y": 16,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 16,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.partition.size{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "area",
            "style": {
              "palette": "purple",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Partition Size (Messages)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 19,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 17,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "sum:kafka.partition.under_replicated{$kafka_cluster_id,$topic}",
            "aggregator": "last",
            "conditional_formats": [
              {
                "comparator": ">",
                "value": 0,
                "palette": "white_on_red"
              },
              {
                "comparator": "<=",
                "value": 0,
                "palette": "white_on_green"
              }
            ]
          }
        ],
        "title": "Under-Replicated Partitions",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 6,
        "y": 19,
        "width": 3,
        "height": 3
      }
    },
    {
      "id": 18,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "sum:kafka.partition.offline{$kafka_cluster_id,$topic}",
            "aggregator": "last",
            "conditional_formats": [
              {
                "comparator": ">",
                "value": 0,
                "palette": "white_on_red"
              },
              {
                "comparator": "<=",
                "value": 0,
                "palette": "white_on_green"
              }
            ]
          }
        ],
        "title": "Offline Partitions",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 9,
        "y": 19,
        "width": 3,
        "height": 3
      }
    },
    {
      "id": 19,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.partition.replicas{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Partition Replicas",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 22,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 20,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.partition.isr{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "green",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Partition In-Sync Replicas (ISR)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 6,
        "y": 22,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 21,
      "definition": {
        "type": "note",
        "content": "## Consumer Group Metrics",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 25,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 22,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.consumer_group.count{$kafka_cluster_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Total Consumer Groups",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 26,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 23,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.consumer_group.members{$kafka_cluster_id,$consumer_group} by {consumer_group}",
            "display_type": "bars",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Consumer Group Members",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 4,
        "y": 26,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 24,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.consumer_group.state{$kafka_cluster_id,$consumer_group} by {consumer_group,state}",
            "display_type": "line",
            "style": {
              "palette": "semantic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Consumer Group State by State Tag",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0",
        "yaxis": {
          "min": "0",
          "max": "1"
        }
      },
      "layout": {
        "x": 8,
        "y": 26,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 25,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.consumer_offset{$kafka_cluster_id,$topic,$consumer_group} by {consumer_group,topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "cool",
              "line_type": "solid",
              "line_width": "thin"
            }
          }
        ],
        "title": "Consumer Group Offsets",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 0,
        "y": 29,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 26,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.consumer_lag{$kafka_cluster_id,$topic,$consumer_group} by {consumer_group,topic,partition}",
            "display_type": "area",
            "style": {
              "palette": "warm",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Consumer Group Lag (Messages)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 6,
        "y": 29,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 27,
      "definition": {
        "type": "toplist",
        "requests": [
          {
            "q": "top(avg:kafka.consumer_lag{$kafka_cluster_id,$topic,$consumer_group} by {consumer_group,topic}, 10, 'mean', 'desc')",
            "style": {
              "palette": "warm"
            },
            "conditional_formats": [
              {
                "comparator": ">",
                "value": 1000,
                "palette": "white_on_red"
              },
              {
                "comparator": ">",
                "value": 100,
                "palette": "white_on_yellow"
              },
              {
                "comparator": "<=",
                "value": 100,
                "palette": "white_on_green"
              }
            ]
          }
        ],
        "title": "Top 10 Consumer Groups by Lag",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 0,
        "y": 32,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 28,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.broker_offset{$kafka_cluster_id,$topic} by {topic,partition}",
            "display_type": "line",
            "style": {
              "palette": "purple",
              "line_type": "solid",
              "line_width": "thin"
            }
          }
        ],
        "title": "Broker Offsets (High Watermark)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 6,
        "y": 32,
        "width": 6,
        "height": 3
      }
    },
    {
      "id": 29,
      "definition": {
        "type": "note",
        "content": "## Schema Registry",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 35,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 30,
      "definition": {
        "type": "query_value",
        "requests": [
          {
            "q": "avg:kafka.schema_registry.subjects{$kafka_cluster_id}",
            "aggregator": "last"
          }
        ],
        "title": "Total Schemas",
        "title_size": "16",
        "title_align": "left",
        "precision": 0,
        "autoscale": true
      },
      "layout": {
        "x": 0,
        "y": 36,
        "width": 4,
        "height": 2
      }
    },
    {
      "id": 31,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.schema_registry.subjects{$kafka_cluster_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Schema Registry Subjects Over Time",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false
      },
      "layout": {
        "x": 4,
        "y": 36,
        "width": 4,
        "height": 2
      }
    },
    {
      "id": 32,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.schema_registry.versions{$kafka_cluster_id} by {subject}",
            "display_type": "bars",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Schema Versions by Subject",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 8,
        "y": 36,
        "width": 4,
        "height": 2
      }
    },
    {
      "id": 33,
      "definition": {
        "type": "note",
        "content": "## Advanced Metrics",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 38,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 41,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.topic.message_rate{$kafka_cluster_id,$topic} by {topic}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Message Production Rate (msg/sec)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 0,
        "y": 39,
        "width": 6,
        "height": 2
      }
    },
    {
      "id": 42,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.broker.leader_count{$kafka_cluster_id} by {broker_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Leader Partitions per Broker",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 6,
        "y": 39,
        "width": 6,
        "height": 2
      }
    },
    {
      "id": 43,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.broker.partition_count{$kafka_cluster_id} by {broker_id}",
            "display_type": "line",
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Total Partitions per Broker (including replicas)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0"
      },
      "layout": {
        "x": 0,
        "y": 41,
        "width": 6,
        "height": 2
      }
    },
    {
      "id": 44,
      "definition": {
        "type": "timeseries",
        "requests": [
          {
            "q": "avg:kafka.estimated_consumer_lag_seconds{$kafka_cluster_id,$consumer_group,$topic} by {consumer_group,topic}",
            "display_type": "line",
            "style": {
              "palette": "warm",
              "line_type": "solid",
              "line_width": "normal"
            }
          }
        ],
        "title": "Consumer Lag (seconds)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_size": "0",
        "yaxis": {
          "include_zero": true
        }
      },
      "layout": {
        "x": 6,
        "y": 41,
        "width": 6,
        "height": 2
      }
    },
    {
      "id": 45,
      "definition": {
        "type": "note",
        "content": "## Events & Topology Changes",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 43,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 35,
      "definition": {
        "type": "event_stream",
        "query": "source:kafka event_type:broker_config $kafka_cluster_id",
        "event_size": "s",
        "title": "Broker Configuration",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 0,
        "y": 44,
        "width": 12,
        "height": 4
      }
    },
    {
      "id": 36,
      "definition": {
        "type": "event_stream",
        "query": "source:kafka event_type:topic_config $kafka_cluster_id $topic",
        "event_size": "s",
        "title": "Topic Configuration (custom configs that override broker defaults)",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 0,
        "y": 48,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 38,
      "definition": {
        "type": "event_stream",
        "query": "source:kafka event_type:schema_registry $kafka_cluster_id",
        "event_size": "s",
        "title": "Schema Registry (query by topic:xxx, schema_for:value/key, schema_type:AVRO)",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 0,
        "y": 51,
        "width": 6,
        "height": 4
      }
    },
    {
      "id": 39,
      "definition": {
        "type": "event_timeline",
        "query": "source:kafka $kafka_cluster_id",
        "title": "All Kafka Events Timeline",
        "title_size": "16",
        "title_align": "left"
      },
      "layout": {
        "x": 6,
        "y": 51,
        "width": 6,
        "height": 4
      }
    },
    {
      "id": 40,
      "definition": {
        "type": "note",
        "content": "## Event Types & Querying\n\n**Broker Configuration**: Broker-level defaults (apply to all topics unless overridden)\n\n**Topic Configuration**: Topic-specific overrides (only shows topics with custom configs)\n- Shows retention, compression, cleanup policy, etc.\n- Query by topic: `topic:orders`\n\n**Schema Registry**: Raw schema definitions\n- Query by topic: `topic:orders`\n- Query by key/value: `schema_for:value` or `schema_for:key`\n- Query by type: `schema_type:AVRO`\n- Example: `topic:orders schema_for:value` finds the value schema for orders topic\n\n**Timeline**: All events chronologically for correlation",
        "background_color": "yellow",
        "font_size": "14",
        "text_align": "left",
        "show_tick": true,
        "tick_pos": "50%",
        "tick_edge": "left"
      },
      "layout": {
        "x": 0,
        "y": 55,
        "width": 12,
        "height": 3
      }
    }
  ],
  "template_variables": [
    {
      "name": "kafka_cluster_id",
      "default": "*",
      "prefix": "kafka_cluster_id"
    },
    {
      "name": "topic",
      "default": "*",
      "prefix": "topic"
    },
    {
      "name": "consumer_group",
      "default": "*",
      "prefix": "consumer_group"
    },
    {
      "name": "broker_id",
      "default": "*",
      "prefix": "broker_id"
    }
  ],
  "layout_type": "ordered",
  "is_read_only": false,
  "notify_list": [],
  "reflow_type": "fixed"
}
