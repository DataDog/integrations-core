id: cisco-duo
metric_id: cisco-duo
backend_only: false
facets:
- facetType: list
  groups:
  - Cisco Duo
  name: Auth Device Name
  path: auth_device.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device Browser
  path: access_device.browser
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device Browser Version
  path: access_device.browser_version
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device City
  path: access_device.geoip.city.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device IP
  path: access_device.ip.address
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device OS
  path: access_device.os
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device OS Version
  path: access_device.os_version
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Access Device Subdivision
  path: access_device.geoip.subdivision.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Action
  path: duo_action
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Action Name
  path: duo_action_name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Actor Name
  path: actor.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Auth Device Country
  path: auth_device.geoip.country.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Auth Device IP
  path: auth_device.ip
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Context
  path: context
  source: log
  type: string
- facetType: range
  groups:
  - Cisco Duo
  name: Credits
  path: credits
  source: log
  type: double
- facetType: list
  groups:
  - Cisco Duo
  name: Factor
  path: factor
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Object
  path: object
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Reason
  path: duo_reason
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Target Details
  path: duo_target.details
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Target Name
  path: duo_target.name
  source: log
  type: string
- facetType: list
  groups:
  - Cisco Duo
  name: Target Type
  path: duo_target.type
  source: log
  type: string
- groups:
  - User
  name: User Email
  path: usr.email
  source: log
- groups:
  - User
  name: User Name
  path: usr.name
  source: log
- groups:
  - Event
  name: Event Name
  path: evt.name
  source: log
- groups:
  - Event
  name: Event Outcome
  path: evt.outcome
  source: log
pipeline:
  type: pipeline
  name: Cisco Duo
  enabled: true
  filter:
    query: "source:cisco-duo"
  processors:
    - type: date-remapper
      name: Define `isotimestamp`, `ts` as the official date of the log
      enabled: true
      meta:
        tags: []
      sources:
        - isotimestamp
        - ts
    - type: service-remapper
      name: Define `service` as the official service of the log
      enabled: true
      meta:
        tags: []
      sources:
        - service
    - type: pipeline
      name: Cisco Duo Authentication
      enabled: true
      filter:
        query: "service:authentication"
      processors:
        - type: geo-ip-parser
          name: GeoIP Parser for `access_device.ip`
          enabled: true
          meta:
            tags: []
          sources:
            - access_device.ip
          target: access_device.geoip
          ip_processing_behavior: do-nothing
        - type: geo-ip-parser
          name: GeoIP Parser for `auth_device.ip`
          enabled: true
          meta:
            tags: []
          sources:
            - auth_device.ip
          target: auth_device.geoip
          ip_processing_behavior: do-nothing
        - type: attribute-remapper
          name: Map `result` to `evt.outcome`
          enabled: true
          meta:
            tags: []
          sources:
            - result
          sourceType: attribute
          target: evt.outcome
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `email` to `usr.email`
          enabled: true
          meta:
            tags: []
          sources:
            - email
          sourceType: attribute
          target: usr.email
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `event_type` to `evt.name`
          enabled: true
          meta:
            tags: []
          sources:
            - event_type
          sourceType: attribute
          target: evt.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `user.name` to `usr.name`
          enabled: true
          meta:
            tags: []
          sources:
            - user.name
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Cisco Duo Activity
      enabled: true
      filter:
        query: "service:activity"
      processors:
        - type: geo-ip-parser
          name: GeoIP Parser for `access_device.ip.address`
          enabled: true
          meta:
            tags: []
          sources:
            - access_device.ip.address
          target: access_device.geoip
          ip_processing_behavior: do-nothing
        - type: attribute-remapper
          name: Map `target` to `duo_target`
          enabled: true
          meta:
            tags: []
          sources:
            - target
          sourceType: attribute
          target: duo_target
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Cisco Duo Administrator
      enabled: true
      filter:
        query: "service:administrator"
      processors:
        - type: attribute-remapper
          name: Map `username` to `usr.name`
          enabled: true
          meta:
            tags: []
          sources:
            - username
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Cisco Duo Offline Enrollment
      enabled: true
      filter:
        query: "service:offline_enrollment"
      processors:
        - type: attribute-remapper
          name: Map `username` to `usr.name`
          enabled: true
          meta:
            tags: []
          sources:
            - username
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: attribute-remapper
      name: Map `reason` to `duo_reason`
      enabled: true
      meta:
        tags: []
      sources:
        - reason
      sourceType: attribute
      target: duo_reason
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `action` to `duo_action`
      enabled: true
      meta:
        tags: []
      sources:
        - action
      sourceType: attribute
      target: duo_action
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `duo_action.name` to `duo_action_name`
      enabled: true
      meta:
        tags: []
      sources:
        - duo_action.name
      sourceType: attribute
      target: duo_action_name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
