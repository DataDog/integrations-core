id: cisco-duo
tests:
 -
  service: "authentication"
  sample: |-
    {
      "message" : {
        "reason" : "user_marked_fraud",
        "txid" : "some-txid",
        "isotimestamp" : "2023-11-01T08:42:33.314482+00:00",
        "trusted_endpoint_status" : "not trusted",
        "result" : "fraud",
        "access_device" : {
          "epkey" : "SOMEKEY",
          "ip" : "185.64.148.0",
          "location" : {
            "country" : "-",
            "city" : "-",
            "state" : "-"
          }
        },
        "event_type" : "authentication",
        "application" : {
          "name" : "Google Workspace Login",
          "key" : "SOMEKEY"
        },
        "alias" : "abc@example.com",
        "factor" : "duo_push",
        "auth_device" : {
          "ip" : "185.64.148.0",
          "name" : "+1 123 456 7890",
          "location" : {
            "country" : "-",
            "city" : "-",
            "state" : "-"
          },
          "key" : "SOMEKEY"
        },
        "user" : {
          "name" : "abc",
          "groups" : [ "AllUsers (from AD sync)" ],
          "key" : "SOMEKEY"
        },
        "email" : "abc@example.com",
        "timestamp" : 1698828153
      }
    }
  result:
    null
 -
  service: "activity"
  sample: |-
    {
      "message" : {
        "actor" : {
          "name" : "abc",
          "details" : "{\"created\": null, \"last_login\": \"2023-10-10T08:44:35.000000+00:00\", \"email\": \"abc@example.com\", \"status\": null, \"groups\": null}",
          "type" : "admin",
          "key" : "SOMEKEY"
        },
        "access_device" : {
          "os" : "Windows",
          "browser" : "Chrome",
          "ip" : {
            "address" : "185.64.148.0"
          },
          "os_version" : "10",
          "location" : {
            "country" : "-",
            "city" : "-",
            "state" : "-"
          },
          "browser_version" : "117.0.0.0"
        },
        "akey" : "SOMEKEY",
        "activity_id" : "some-activity-id",
        "action" : {
          "name" : "phone_activation_code_regenerated"
        },
        "target" : {
          "name" : "+1 123 456 7890",
          "details" : "{\"manufacturer\": \"-\", \"number\": \"+11234567890\", \"extension\": \"\", \"os_version\": \"13\", \"biometrics_status\": \"Configured\", \"os\": \"Android\", \"model\": \"-\", \"tampered_status\": \"Not tampered\", \"passcode_status\": \"Locked\", \"country_code\": \"1\"}",
          "type" : "phone",
          "key" : "SOMEKEY"
        },
        "ts" : "2023-10-10T04:45:03.639784+00:00"
        }
    }
  result:
    null
 -
  service: "administrator"
  sample: |-
    {
      "message" : {
        "action" : "ad_sync_by_user_begin",
        "description" : "{\"directory\": \"AD Sync\", \"Sync Ref. Code\": \"somecode\", \"users\": \"xyz\"}",
        "isotimestamp" : "2023-11-27T06:38:49+00:00",
        "object" : "xyz",
        "timestamp" : 1701067129,
        "username" : "abc"
      }
    }
  result:
    null
 -
  service: "telephony"
  sample: |-
    {
      "message" : {
        "telephony_id" : "some-telephony-id",
        "credits" : 6,
        "phone" : "+11234567890",
        "context" : "authentication",
        "txid" : "some-txid",
        "type" : "sms",
        "ts" : "2024-01-09T09:08:15.097338+00:00"
      }
    }
  result:
    null
 -
  service: "offline_enrollment"
  sample: |-
    {
      "message" : {
        "action" : "o2fa_user_provisioned",
        "description" : "{\"user_agent\": \"DuoCredProv/4.2.2.1755 (Windows NT 10.0.1809.17763.4851; x64; Server)\", \"hostname\": \"HOST02\", \"factor\": \"duo_otp\"}",
        "isotimestamp" : "2023-10-16T12:20:19+00:00",
        "object" : "RDP-2 Login",
        "timestamp" : 1697458819,
        "username" : "abc"
      }
    }
  result:
    null