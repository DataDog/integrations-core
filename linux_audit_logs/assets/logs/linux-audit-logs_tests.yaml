id: "linux-audit-logs"
tests:
 -
  sample: "type=USER_MAC_CONFIG_CHANGE msg=audit(1736329118.112:6532): pid=381980 uid=0 auid=0 ses=138 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='resrc=port op=add lport=3307 proto=6 tcontext=system_u:object_r:mysqld_port_t:s0 comm=\"semanage\" exe=\"/usr/libexec/platform-python3.6\" hostname=? addr=? terminal=? res=success'UID=\"root\" AUID=\"root\""
  result:
    custom:
      AUID: "root"
      auid: 0
      event_id: 6532
      msg:
        comm: "semanage"
        exe: "/usr/libexec/platform-python3.6"
        hostname: "?"
        lport: 3307
        op:
         - "add"
        proto: 6
        res: "success"
        resrc: "port"
        tcontext: "system_u:object_r:mysqld_port_t:s0"
        terminal: "?"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "USER_MAC_CONFIG_CHANGE"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        status: "Success"
        status_id: 1
        time: 1736329118112
      pid: 381980
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 138
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      timestamp: 1.736329118112E12
      type: "USER_MAC_CONFIG_CHANGE"
      usr:
        id: 0
        name: "root"
    message: "type=USER_MAC_CONFIG_CHANGE msg=audit(1736329118.112:6532): pid=381980 uid=0 auid=0 ses=138 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='resrc=port op=add lport=3307 proto=6 tcontext=system_u:object_r:mysqld_port_t:s0 comm=\"semanage\" exe=\"/usr/libexec/platform-python3.6\" hostname=? addr=? terminal=? res=success'UID=\"root\" AUID=\"root\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1736329118112
 -
  sample: "type=USER_AUTH msg=audit(1740139921.923:1778): pid=155615 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='op=PAM:authentication grantors=pam_usertype,pam_localuser,pam_unix acct=\"devuser\" exe=\"/usr/sbin/sshd\" hostname=10.10.10.10 addr=10.10.10.10 terminal=ssh res=success'UID=\"root\" AUID=\"unset\""
  result:
    custom:
      AUID: "unset"
      auid: 4294967295
      event_id: 1778
      msg:
        acct: "devuser"
        exe: "/usr/sbin/sshd"
        grantors:
         - "pam_usertype"
         - "pam_localuser"
         - "pam_unix"
        hostname: "10.10.10.10"
        op:
         - "PAM:authentication"
        res: "success"
        terminal: "ssh"
      msg_raw: ""
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      ocsf:
        activity_id: 1
        activity_name: "Logon"
        actor:
          process:
            path: "/usr/sbin/sshd"
            pid: 155615
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "ssh"
            uid: "4294967295"
          user:
            name: "unset"
            uid: "4294967295"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Authentication"
        class_uid: 3002
        dst_endpoint:
          hostname: "10.10.10.10"
          ip: "10.10.10.10"
        metadata:
          event_code: "USER_AUTH"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        status: "Success"
        status_id: 1
        time: 1740139921923
        user:
          name: "devuser"
      pid: 155615
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 4294967295
      status: "ok"
      subj: "system_u:system_r:sshd_t:s0-s0:c0.c1023"
      timestamp: 1.740139921923E12
      type: "USER_AUTH"
      usr:
        id: 0
        name: "root"
    message: "type=USER_AUTH msg=audit(1740139921.923:1778): pid=155615 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='op=PAM:authentication grantors=pam_usertype,pam_localuser,pam_unix acct=\"devuser\" exe=\"/usr/sbin/sshd\" hostname=10.10.10.10 addr=10.10.10.10 terminal=ssh res=success'UID=\"root\" AUID=\"unset\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740139921923
 -
  sample: "type=MAC_STATUS msg=audit(1740386730.535:1674): enforcing=0 old_enforcing=1 auid=1001 ses=36 enabled=1 old-enabled=1 lsm=selinux res=1AUID=\"devuser\""
  result:
    custom:
      enabled: 1
      enforcing: 0
      event_id: 1674
      lsm: "selinux"
      msg:
        res: "success"
      msg_raw: ""
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "MAC_STATUS"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        status: "Success"
        status_id: 1
        time: 1740386730535
      old-enabled: 1
      old_enforcing: 1
      post_msg_kv: ""
      pre_msg_kv: ""
      res: 1
      ses: 36
      status: "ok"
      timestamp: 1.740386730535E12
      type: "MAC_STATUS"
      usr:
        id: 1001
        name: "devuser"
    message: "type=MAC_STATUS msg=audit(1740386730.535:1674): enforcing=0 old_enforcing=1 auid=1001 ses=36 enabled=1 old-enabled=1 lsm=selinux res=1AUID=\"devuser\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740386730535
 -
  sample: "type=AVC msg=audit(1669185724.533:182): avc:  denied  { getattr } for  pid=16660 comm=\"groupadd\" name=\"/\" dev=\"proc\" ino=1 scontext=unconfined_u:unconfined_r:groupadd_t:s0-s0:c0.c1023 tcontext=system_u:object_r:proc_t:s0 tclass=filesystem permissive=0"
  result:
    custom:
      comm: "groupadd"
      dev: "proc"
      event_id: 182
      ino: 1
      msg_raw: ""
      name: "/"
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "AVC"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1669185724533
      operation: "getattr"
      outcome: "DENIED"
      permissive: 0
      pid: 16660
      post_msg_kv: ""
      pre_msg_kv: ""
      scontext: "unconfined_u:unconfined_r:groupadd_t:s0-s0:c0.c1023"
      tclass: "filesystem"
      tcontext: "system_u:object_r:proc_t:s0"
      timestamp: 1.669185724533E12
      type: "AVC"
    message: "type=AVC msg=audit(1669185724.533:182): avc:  denied  { getattr } for  pid=16660 comm=\"groupadd\" name=\"/\" dev=\"proc\" ino=1 scontext=unconfined_u:unconfined_r:groupadd_t:s0-s0:c0.c1023 tcontext=system_u:object_r:proc_t:s0 tclass=filesystem permissive=0"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1669185724533
 -
  sample: "type=USER_SELINUX_ERR msg=audit(1669714331.555:198): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='Regex version mismatch, expected: 10.37 2021-05-26 actual: 10.40 2022-04-14  exe=\"/usr/lib/systemd/systemd\" sauid=0 hostname=? addr=? terminal=?'UID=\"root\" AUID=\"unset\" SAUID=\"root\""
  result:
    custom:
      AUID: "unset"
      SAUID: "root"
      auid: 4294967295
      error: "Regex version mismatch, expected: 10.37 2021-05-26 actual: 10.40 2022-04-14"
      event_id: 198
      exe: "/usr/lib/systemd/systemd"
      msg:
        hostname: "?"
        sauid: 0
        terminal: "?"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "USER_SELINUX_ERR"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1669714331555
      pid: 1
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 4294967295
      subj: "system_u:system_r:init_t:s0"
      timestamp: 1.669714331555E12
      type: "USER_SELINUX_ERR"
      usr:
        id: 0
        name: "root"
    message: "type=USER_SELINUX_ERR msg=audit(1669714331.555:198): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='Regex version mismatch, expected: 10.37 2021-05-26 actual: 10.40 2022-04-14  exe=\"/usr/lib/systemd/systemd\" sauid=0 hostname=? addr=? terminal=?'UID=\"root\" AUID=\"unset\" SAUID=\"root\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1669714331555
 -
  sample: "type=USER_ROLE_CHANGE msg=audit(1741000050.325:2606): pid=60958 uid=0 auid=1001 ses=64 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='pam: default-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 selected-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 exe=\"/usr/sbin/sshd\" hostname=10.10.10.10 addr=10.10.10.10 terminal=ssh res=success'UID=\"root\" AUID=\"devuser\""
  result:
    custom:
      AUID: "devuser"
      auid: 1001
      event_id: 2606
      msg:
        default-context: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
        exe: "/usr/sbin/sshd"
        hostname: "10.10.10.10"
        res: "success"
        selected-context: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
        terminal: "ssh"
      msg_raw: ""
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "USER_ROLE_CHANGE"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        status: "Success"
        status_id: 1
        time: 1741000050325
      pid: 60958
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 64
      status: "ok"
      subj: "system_u:system_r:sshd_t:s0-s0:c0.c1023"
      timestamp: 1.741000050325E12
      type: "USER_ROLE_CHANGE"
      usr:
        id: 0
        name: "root"
    message: "type=USER_ROLE_CHANGE msg=audit(1741000050.325:2606): pid=60958 uid=0 auid=1001 ses=64 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='pam: default-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 selected-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 exe=\"/usr/sbin/sshd\" hostname=10.10.10.10 addr=10.10.10.10 terminal=ssh res=success'UID=\"root\" AUID=\"devuser\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1741000050325
 -
  sample: "type=MAC_CONFIG_CHANGE msg=audit(1678360880.644:121): bool=virt_use_nfs val=1 old_val=0 auid=1000 ses=1\x1dAUID=\"serviceuser\""
  result:
    custom:
      event_id: 121
      linux_audit_logs:
        bool: "virt_use_nfs"
      msg_raw: ""
      ocsf:
        activity_id: 99
        activity_name: "Other"
        category_uid: 0
        class_name: "Base Event"
        class_uid: 0
        metadata:
          event_code: "MAC_CONFIG_CHANGE"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1678360880644
      old_val: 0
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 1
      timestamp: 1.678360880644E12
      type: "MAC_CONFIG_CHANGE"
      usr:
        id: 1000
        name: "serviceuser"
      val: 1
    message: "type=MAC_CONFIG_CHANGE msg=audit(1678360880.644:121): bool=virt_use_nfs val=1 old_val=0 auid=1000 ses=1\x1dAUID=\"serviceuser\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1678360880644
 -
  sample: "type=ADD_GROUP msg=audit(1740980591.704:5766): pid=12258 uid=0 auid=1001 ses=535 subj=unconfined msg='op=adding group to /etc/group id=1004 exe=\"/usr/sbin/groupadd\" hostname=ub10-10-10-10 addr=? terminal=pts/3 res=success'UID=\"root\" AUID=\"serviceuser\" ID=\"demo\""
  result:
    custom:
      AUID: "serviceuser"
      ID: "demo"
      auid: 1001
      event_id: 5766
      msg:
        exe: "/usr/sbin/groupadd"
        hostname: "ub10-10-10-10"
        id: 1004
        op:
         - "adding group to /etc/group"
        res: "success"
        terminal: "pts/3"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 6
        activity_name: "Create"
        actor:
          process:
            path: "/usr/sbin/groupadd"
            pid: 12258
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/3"
            uid: "535"
          user:
            name: "serviceuser"
            uid: "1001"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Group Management"
        class_uid: 3006
        group:
          uid: "1004"
        metadata:
          event_code: "ADD_GROUP"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "ub10-10-10-10"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1.740980591704E12
      pid: 12258
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 535
      status: "ok"
      subj: "unconfined"
      timestamp: 1.740980591704E12
      type: "ADD_GROUP"
      usr:
        id: 0
        name: "root"
    message: "type=ADD_GROUP msg=audit(1740980591.704:5766): pid=12258 uid=0 auid=1001 ses=535 subj=unconfined msg='op=adding group to /etc/group id=1004 exe=\"/usr/sbin/groupadd\" hostname=ub10-10-10-10 addr=? terminal=pts/3 res=success'UID=\"root\" AUID=\"serviceuser\" ID=\"demo\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740980591704
 -
  sample: "type=DEL_GROUP msg=audit(1765794074.279:2333): pid=161731 uid=0 auid=1001 ses=27 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=delete-group grp=\"testuser\" acct=\"testuser\" exe=\"/usr/sbin/userdel\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"serviceuser\""
  result:
    custom:
      AUID: "serviceuser"
      auid: 1001
      event_id: 2333
      msg:
        acct: "testuser"
        exe: "/usr/sbin/userdel"
        grp: "testuser"
        hostname: "localhost"
        op:
         - "delete-group"
        res: "success"
        terminal: "pts/1"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 5
        activity_name: "Delete"
        actor:
          process:
            path: "/usr/sbin/userdel"
            pid: 161731
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/1"
            uid: "27"
          user:
            name: "serviceuser"
            uid: "1001"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Group Management"
        class_uid: 3006
        group:
          name: "testuser"
        metadata:
          event_code: "DEL_GROUP"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1.765794074279E12
      pid: 161731
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 27
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      timestamp: 1.765794074279E12
      type: "DEL_GROUP"
      usr:
        id: 0
        name: "root"
    message: "type=DEL_GROUP msg=audit(1765794074.279:2333): pid=161731 uid=0 auid=1001 ses=27 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=delete-group grp=\"testuser\" acct=\"testuser\" exe=\"/usr/sbin/userdel\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"serviceuser\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1765794074279
 -
  sample: "type=ADD_USER msg=audit(1635509157.089:345): pid=73290 uid=0 auid=0 ses=3 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=add-user acct=\"serviceuser\" exe=\"/usr/sbin/useradd\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"root\""
  result:
    custom:
      AUID: "root"
      auid: 0
      event_id: 345
      msg:
        acct: "serviceuser"
        exe: "/usr/sbin/useradd"
        hostname: "localhost"
        op:
         - "add-user"
        res: "success"
        terminal: "pts/1"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 1
        activity_name: "Create"
        actor:
          process:
            path: "/usr/sbin/useradd"
            pid: 73290
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/1"
            uid: "3"
          user:
            name: "root"
            uid: "0"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Account Change"
        class_uid: 3001
        metadata:
          event_code: "ADD_USER"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1.635509157089E12
        user:
          name: "serviceuser"
      pid: 73290
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 3
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      timestamp: 1.635509157089E12
      type: "ADD_USER"
      usr:
        id: 0
        name: "root"
    message: "type=ADD_USER msg=audit(1635509157.089:345): pid=73290 uid=0 auid=0 ses=3 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=add-user acct=\"serviceuser\" exe=\"/usr/sbin/useradd\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"root\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1635509157089
 -
  sample: "type=DEL_USER msg=audit(1740379094.277:2332): pid=161731 uid=0 auid=1001 ses=27 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=delete-user id=1003 exe=\"/usr/sbin/userdel\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"serviceuser\" ID=\"testuser\""
  result:
    custom:
      AUID: "serviceuser"
      ID: "testuser"
      auid: 1001
      event_id: 2332
      msg:
        exe: "/usr/sbin/userdel"
        hostname: "localhost"
        id: 1003
        op:
         - "delete-user"
        res: "success"
        terminal: "pts/1"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 6
        activity_name: "Delete"
        actor:
          process:
            path: "/usr/sbin/userdel"
            pid: 161731
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/1"
            uid: "27"
          user:
            name: "serviceuser"
            uid: "1001"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Account Change"
        class_uid: 3001
        metadata:
          event_code: "DEL_USER"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1.740379094277E12
        user:
          uid: "1003"
      pid: 161731
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 27
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      timestamp: 1.740379094277E12
      type: "DEL_USER"
      usr:
        id: 0
        name: "root"
    message: "type=DEL_USER msg=audit(1740379094.277:2332): pid=161731 uid=0 auid=1001 ses=27 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=delete-user id=1003 exe=\"/usr/sbin/userdel\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"serviceuser\" ID=\"testuser\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740379094277
 -
  sample: "type=USER_CHAUTHTOK msg=audit(1635509189.860:347): pid=73297 uid=0 auid=0 ses=3 subj=unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 msg='op=PAM:chauthtok grantors=pam_pwquality,pam_unix acct=\"serviceuser\" exe=\"/usr/bin/passwd\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"root\""
  result:
    custom:
      AUID: "root"
      auid: 0
      event_id: 347
      msg:
        acct: "serviceuser"
        exe: "/usr/bin/passwd"
        grantors:
         - "pam_pwquality"
         - "pam_unix"
        hostname: "localhost"
        op:
         - "PAM:chauthtok"
        res: "success"
        terminal: "pts/1"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 3
        activity_name: "Password Change"
        actor:
          process:
            path: "/usr/bin/passwd"
            pid: 73297
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/1"
            uid: "3"
          user:
            name: "root"
            uid: "0"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "Account Change"
        class_uid: 3001
        metadata:
          event_code: "USER_CHAUTHTOK"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1.63550918986E12
        user:
          name: "serviceuser"
      pid: 73297
      post_msg_kv: ""
      pre_msg_kv: ""
      ses: 3
      status: "ok"
      subj: "unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023"
      timestamp: 1.63550918986E12
      type: "USER_CHAUTHTOK"
      usr:
        id: 0
        name: "root"
    message: "type=USER_CHAUTHTOK msg=audit(1635509189.860:347): pid=73297 uid=0 auid=0 ses=3 subj=unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 msg='op=PAM:chauthtok grantors=pam_pwquality,pam_unix acct=\"serviceuser\" exe=\"/usr/bin/passwd\" hostname=localhost addr=? terminal=pts/1 res=success'\x1dUID=\"root\" AUID=\"root\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1635509189860
 -
  sample: "type=ROLE_ASSIGN msg=audit(1740720945.670:879): pid=11107 uid=0 auid=1001 ses=21 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=seuser-role,range id=0 old-seuser=user_u old-role=user_r old-range=s0 new-seuser=user_u new-role=staff_r new-range=? exe=/sbin/semanage hostname=localhost addr=? terminal=pts/0 res=success'\x1dUID=\"root\" AUID=\"serviceuser\" ID=\"root\""
  result:
    custom:
      AUID: "serviceuser"
      ID: "root"
      auid: 1001
      event_id: 879
      msg:
        exe: "/sbin/semanage"
        hostname: "localhost"
        id: 0
        new-range: "?"
        new-role: "staff_r"
        new-seuser: "user_u"
        old-range: "s0"
        old-role: "user_r"
        old-seuser: "user_u"
        op:
         - "seuser-role"
         - "range"
        res: "success"
        terminal: "pts/0"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 1
        activity_name: "Assign Privileges"
        actor:
          process:
            path: "/sbin/semanage"
            pid: 11107
            user:
              name: "root"
              uid: "0"
          session:
            terminal: "pts/0"
            uid: "21"
          user:
            name: "serviceuser"
            uid: "1001"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "User Access Management"
        class_uid: 3005
        metadata:
          event_code: "ROLE_ASSIGN"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        privileges:
          - "staff_r"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1740720945670
        user:
          name: "user_u"
      pid: 11107
      post_msg_kv: ""
      pre_msg_kv: ""
      privileges:
          - "staff_r"
      ses: 21
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      target_user_name: "user_u"
      timestamp: 1.74072094567E12
      type: "ROLE_ASSIGN"
      usr:
        id: 0
        name: "root"
    message: "type=ROLE_ASSIGN msg=audit(1740720945.670:879): pid=11107 uid=0 auid=1001 ses=21 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=seuser-role,range id=0 old-seuser=user_u old-role=user_r old-range=s0 new-seuser=user_u new-role=staff_r new-range=? exe=/sbin/semanage hostname=localhost addr=? terminal=pts/0 res=success'\x1dUID=\"root\" AUID=\"serviceuser\" ID=\"root\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740720945670
 -
  sample: "type=ROLE_REMOVE msg=audit(1740130059.788:1002): pid=49119 uid=0 auid=1001 ses=17 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=seuser id=0 old-seuser=test1 old-role=user_r old-range=s0 new-seuser=? new-role=? new-range=? exe=/sbin/semanage hostname=localhost addr=? terminal=pts/0 res=success'\x1dUID=\"root\" AUID=\"devuser\" ID=\"root\""
  result:
    custom:
      AUID: "devuser"
      ID: "root"
      auid: 1001
      event_id: 1002
      msg:
        exe: "/sbin/semanage"
        hostname: "localhost"
        id: 0
        new-range: "?"
        new-role: "?"
        new-seuser: "?"
        old-range: "s0"
        old-role: "user_r"
        old-seuser: "test1"
        op:
         - "seuser"
        res: "success"
        terminal: "pts/0"
      msg_raw: ""
      network:
        client:
          geoip:
            invalidAddress: "?"
          ip: "?"
      ocsf:
        activity_id: 2
        activity_name: "Revoke Privileges"
        actor:
          process:
            pid: 49119
            user:
              name: "root"
              uid: "0"
          session:
            uid: "17"
          user:
            name: "devuser"
            uid: "1001"
        category_name: "Identity & Access Management"
        category_uid: 3
        class_name: "User Access Management"
        class_uid: 3005
        metadata:
          event_code: "ROLE_REMOVE"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        privileges:
          - "user_r"
        severity: "Informational"
        severity_id: 1
        src_endpoint:
          hostname: "localhost"
          ip: "?"
        status: "Success"
        status_id: 1
        time: 1740130059788
        user:
          name: "test1"
      pid: 49119
      post_msg_kv: ""
      pre_msg_kv: ""
      privileges:
          - "user_r"
      ses: 17
      status: "ok"
      subj: "unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023"
      target_user_name: "test1"
      timestamp: 1.740130059788E12
      type: "ROLE_REMOVE"
      usr:
        id: 0
        name: "root"
    message: "type=ROLE_REMOVE msg=audit(1740130059.788:1002): pid=49119 uid=0 auid=1001 ses=17 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=seuser id=0 old-seuser=test1 old-role=user_r old-range=s0 new-seuser=? new-role=? new-range=? exe=/sbin/semanage hostname=localhost addr=? terminal=pts/0 res=success'\x1dUID=\"root\" AUID=\"devuser\" ID=\"root\""
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740130059788
 -
  sample: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/etc/shadow\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
  result:
    custom:
      OGID: "root"
      cap_fe: 0
      cap_fi: 0
      cap_fp: 0
      cap_frootid: 0
      cap_fver: 0
      dev: "fd:03"
      event_id: 2247
      file_name: "shadow"
      inode: 50314523
      item: 0
      mode: 100000
      msg_raw: ""
      name: "/etc/shadow"
      nametype: "NORMAL"
      obj: "system_u:object_r:shadow_t:s0"
      ocsf:
        activity_id: 2
        activity_name: "Read"
        actor:
          user:
            name: "root"
            uid: "0"
        category_name: "System Activity"
        category_uid: 1
        class_name: "File System Activity"
        class_uid: 1001
        device:
          type: "Unknown"
          type_id: 0
          uid: "fd:03"
        file:
          name: "shadow"
          path: "/etc/shadow"
          type: "Regular File"
          type_id: 1
        metadata:
          event_code: "PATH"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1740378301873
      ogid: 0
      post_msg_kv: ""
      pre_msg_kv: ""
      rdev: "00:00"
      timestamp: 1.740378301873E12
      type: "PATH"
      usr:
        id: 0
        name: "root"
    message: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/etc/shadow\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740378301873
 -
  sample: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/lib/x86_64-linux-gnu/libcrypt.so.1\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=DELETE cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
  result:
    custom:
      OGID: "root"
      cap_fe: 0
      cap_fi: 0
      cap_fp: 0
      cap_frootid: 0
      cap_fver: 0
      dev: "fd:03"
      event_id: 2247
      file_name: "libcrypt.so.1"
      inode: 50314523
      item: 0
      mode: 100000
      msg_raw: ""
      name: "/lib/x86_64-linux-gnu/libcrypt.so.1"
      nametype: "DELETE"
      obj: "system_u:object_r:shadow_t:s0"
      ocsf:
        activity_id: 4
        activity_name: "Delete"
        actor:
          user:
            name: "root"
            uid: "0"
        category_name: "System Activity"
        category_uid: 1
        class_name: "File System Activity"
        class_uid: 1001
        device:
          type: "Unknown"
          type_id: 0
          uid: "fd:03"
        file:
          ext: "so"
          name: "libcrypt.so.1"
          path: "/lib/x86_64-linux-gnu/libcrypt.so.1"
          type: "Regular File"
          type_id: 1
        metadata:
          event_code: "PATH"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1740378301873
      ogid: 0
      post_msg_kv: ""
      pre_msg_kv: ""
      rdev: "00:00"
      timestamp: 1.740378301873E12
      type: "PATH"
      usr:
        id: 0
        name: "root"
    message: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/lib/x86_64-linux-gnu/libcrypt.so.1\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=DELETE cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740378301873
 -
  sample: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/lib/\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=PARENT cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
  result:
    custom:
      OGID: "root"
      cap_fe: 0
      cap_fi: 0
      cap_fp: 0
      cap_frootid: 0
      cap_fver: 0
      dev: "fd:03"
      event_id: 2247
      folder_name: "lib"
      inode: 50314523
      item: 0
      mode: 100000
      msg_raw: ""
      name: "/lib/"
      nametype: "PARENT"
      obj: "system_u:object_r:shadow_t:s0"
      ocsf:
        activity_id: 2
        activity_name: "Read"
        actor:
          user:
            name: "root"
            uid: "0"
        category_name: "System Activity"
        category_uid: 1
        class_name: "File System Activity"
        class_uid: 1001
        device:
          type: "Unknown"
          type_id: 0
          uid: "fd:03"
        file:
          name: "lib"
          path: "/lib/"
          type: "Folder"
          type_id: 2
        metadata:
          event_code: "PATH"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1740378301873
      ogid: 0
      post_msg_kv: ""
      pre_msg_kv: ""
      rdev: "00:00"
      timestamp: 1.740378301873E12
      type: "PATH"
      usr:
        id: 0
        name: "root"
    message: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/lib/\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=PARENT cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740378301873
 -
  sample: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/run/nginx.pid\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=CREATE cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
  result:
    custom:
      OGID: "root"
      cap_fe: 0
      cap_fi: 0
      cap_fp: 0
      cap_frootid: 0
      cap_fver: 0
      dev: "fd:03"
      event_id: 2247
      file_name: "nginx.pid"
      inode: 50314523
      item: 0
      mode: 100000
      msg_raw: ""
      name: "/run/nginx.pid"
      nametype: "CREATE"
      obj: "system_u:object_r:shadow_t:s0"
      ocsf:
        activity_id: 1
        activity_name: "Create"
        actor:
          user:
            name: "root"
            uid: "0"
        category_name: "System Activity"
        category_uid: 1
        class_name: "File System Activity"
        class_uid: 1001
        device:
          type: "Unknown"
          type_id: 0
          uid: "fd:03"
        file:
          ext: "pid"
          name: "nginx.pid"
          path: "/run/nginx.pid"
          type: "Regular File"
          type_id: 1
        metadata:
          event_code: "PATH"
          product:
            name: "Linux Audit"
            vendor_name: "Linux"
          version: "1.5.0"
        severity: "Informational"
        severity_id: 1
        time: 1740378301873
      ogid: 0
      post_msg_kv: ""
      pre_msg_kv: ""
      rdev: "00:00"
      timestamp: 1.740378301873E12
      type: "PATH"
      usr:
        id: 0
        name: "root"
    message: "type=PATH msg=audit(1740378301.873:2247): item=0 name=\"/run/nginx.pid\" inode=50314523 dev=fd:03 mode=0100000 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:shadow_t:s0 nametype=CREATE cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\x1dOUID=\"root\" OGID=\"root\""
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1740378301873