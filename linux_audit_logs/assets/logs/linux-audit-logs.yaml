# bypass-global-grok-parser-count-per-pipeline-checks
id: linux-audit-logs
metric_id: linux-audit-logs
backend_only: false
facets:
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - User
    name: User ID
    path: usr.id
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
  - description: ''
    facetType: list
    groups:
      - Linux Audit Logs
    name: Config
    path: linux_audit_logs.bool
    source: log
    type: string
pipeline:
  type: pipeline
  name: Linux Audit Logs
  enabled: true
  filter:
    query: source:linux-audit-logs
  processors:
    - type: grok-parser
      name: Parsing Linux Audit Logs
      enabled: true
      source: message
      samples:
        - "type=USER_MAC_CONFIG_CHANGE msg=audit(1736329118.112:6532):
          pid=381980 uid=0 auid=0 ses=138
          subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
          msg='resrc=port op=add lport=3307 proto=6
          tcontext=system_u:object_r:mysqld_port_t:s0 comm=\"semanage\"
          exe=\"/usr/libexec/platform-python3.6\" hostname=? addr=? terminal=?
          res=success'UID=\"root\" AUID=\"root\""
        - 'type=USER_MAC_CONFIG_CHANGE msg=audit(1736329118.112:6532):
          bool=virt_use_nfs val=1 old_val=0 auid=1000 res=1AUID="serviceuser"'
        - "type=USER_CHAUTHTOK msg=audit(1740980379.836:5762): pid=12243 uid=0
          auid=1001 ses=535 subj=unconfined msg='op=changing uid id=1005
          exe=\"/usr/sbin/usermod\" hostname=ub24-50-5-60 addr=? terminal=pts/3
          res=success'UID=\"root\" AUID=\"serviceuser\" ID=\"unknown(1005)\""
        - 'type=AVC msg=audit(1740636680.316:24484): apparmor="ALLOWED"
          operation="signal" class="signal" profile="/usr/sbin/nginx" pid=87437
          comm="start-stop-daem" requested_mask="receive" denied_mask="receive"
          signal=exists peer="unconfined"'
        - "type=AVC msg=audit(1740736244.131:855): apparmor=\"DENIED\"
          operation=\"open\" class=\"file\" profile=\"/root/sample2.sh\"
          name=\"/etc/group\" pid=2895 comm=\"ls\" requested_mask=\"r\"
          denied_mask=\"r\" fsuid=0 ouid=0\x1dFSUID=\"a\" OUID=\"root\""
      grok:
        supportRules: >-
          log_prefix
          type=%{notSpace:type}%{_space}msg=audit\(%{number:timestamp}\:%{integer:event_id}\)

          unicode_char %{regex("[\\p{C}]")}

          _space \s*
        matchRules: >-
          rule
          %{log_prefix}%{_space}:%{_space}%{data:pre_msg_kv}%{_space}msg=%{singleQuotedString:msg_raw}(%{unicode_char})?%{data:post_msg_kv}

          rule_without_msg %{log_prefix}%{_space}:%{_space}%{data:pre_msg_kv}%{unicode_char}%{data:post_msg_kv}

          rule_without_msg_and_unicode_char %{log_prefix}%{_space}:%{_space}%{data:post_msg_kv}
    - type: grok-parser
      name: Parsing `pre_msg_kv` attribute
      enabled: true
      source: pre_msg_kv
      samples:
        - pid=381980 uid=0 auid=0 ses=138
          subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
        - pid=12243 uid=0 auid=1001 ses=535 subj=unconfined
        - apparmor="ALLOWED"
      grok:
        supportRules: ""
        matchRules: parse_pre_msg_kv_rule %{data::keyvalue("=",":?/\"|*<>,")}
    - type: grok-parser
      name: Parsing `msg_raw` attribute
      enabled: true
      source: msg_raw
      samples:
        - "'resrc=port op=add lport=3307 proto=6
          tcontext=system_u:object_r:mysqld_port_t:s0 comm=\"semanage\"
          exe=\"/usr/libexec/platform-python3.6\" hostname=? addr=? terminal=?
          res=success'"
        - "'op=adding group acct=\"demo\" exe=\"/usr/sbin/useradd\"
          hostname=ub10-10-10-10 addr=? terminal=pts/3 res=success'"
      grok:
        supportRules: ""
        matchRules: parse_msg_raw_rule '%{data:msg:keyvalue("=",":?/\"|*<>, ")}'
    - type: grok-parser
      name: Parsing `post_msg_kv` attribute
      enabled: true
      source: post_msg_kv
      samples:
        - bool=virt_use_nfs val=1 old_val=0 auid=1000 res=1AUID="serviceuser"
        - AUID="serviceuser"
        - apparmor="DENIED" operation="capable" class="cap" profile="rsyslogd"
          pid=838 comm="rsyslogd" capability=12  capname="net_admin"
      grok:
        supportRules: >-
          extract_kv_pair %{data::keyvalue("=",":?/\"|*<>,")}

          extract_UID_or_OUID_or_FSUID_or_SAUID_SUID (UID="%{regex("[^\"]*"):UID}"|OUID="%{regex("[^\"]*"):OUID}"|FSUID="%{regex("[^\"]*"):FSUID}"|SAUID="%{regex("[^\"]*"):SAUID}"|SUID="%{regex("[^\"]*"):SUID}")

          extract_AUID AUID="%{regex("[^\"]*"):AUID}"

          _space \s*
        matchRules: >-
          parse_post_msg_kv_rule
          %{extract_kv_pair}%{_space}(%{extract_AUID}%{_space}|%{extract_UID_or_OUID_or_FSUID_or_SAUID_SUID
          }%{_space})+

          parse_post_msg_kv_without_id_fields_rule %{extract_kv_pair}
    - type: pipeline
      name: Parsing User Selinux Err logs
      enabled: true
      filter:
        query: "@type:USER_SELINUX_ERR"
      processors:
        - type: grok-parser
          name: Parsing User Selinux Err logs
          enabled: true
          source: msg_raw
          samples:
            - "'Regex version mismatch, expected: 10.37 2021-05-26 actual: 10.40
              2022-04-14  exe=\"/usr/lib/systemd/systemd\" sauid=0 hostname=?
              addr=? terminal=?'\x1d"
          grok:
            supportRules: _space \s*
            matchRules: user_selinux_err_rule
              '%{data:error}%{_space}exe="%{regex("[^\"]+"):exe}"
              %{data:msg:keyvalue("=",":?/\"|*<>,")}'
    - type: pipeline
      name: Parsing User Role Change logs
      enabled: true
      filter:
        query: "@type:USER_ROLE_CHANGE"
      processors:
        - type: grok-parser
          name: Parsing User Role Change logs
          enabled: true
          source: msg_raw
          samples:
            - "'pam:
              default-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c\
              1023
              selected-context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.\
              c1023 exe=\"/usr/sbin/sshd\" hostname=172.20.4.65 addr=172.20.4.65
              terminal=ssh res=success'"
          grok:
            supportRules: _space \s*
            matchRules: user_role_change_rule
              '(%{regex("[^:]*"):})?:%{_space}%{data:msg:keyvalue("=",":?/\"|*<>,")}'
    - type: pipeline
      name: Parsing AVC logs
      enabled: true
      filter:
        query: "@type:AVC"
      processors:
        - type: grok-parser
          name: Parsing AVC logs
          enabled: true
          source: post_msg_kv
          samples:
            - 'avc:  denied  { getattr } for  pid=16660 comm="groupadd" name="/"
              dev="proc" ino=1
              scontext=unconfined_u:unconfined_r:groupadd_t:s0-s0:c0.c1023
              tcontext=system_u:object_r:proc_t:s0 tclass=filesystem
              permissive=0'
            - apparmor="DENIED" operation="capable" class="cap"
              profile="rsyslogd" pid=838 comm="rsyslogd"
              capability=12  capname="net_admin"
          grok:
            supportRules: _space \s*
            matchRules: avc_rule
              (avc:%{_space}%{notSpace:outcome:uppercase}%{_space}\{%{_space}%{notSpace:operation}%{_space}\}
              for )?%{data::keyvalue("=",":?/\"|*<>,")}
        - type: attribute-remapper
          name: Map `apparmor` to `outcome`
          enabled: true
          sources:
            - apparmor
          sourceType: attribute
          target: outcome
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `error` to `linux_audit_logs.error`
          enabled: true
          sources:
            - error
          sourceType: attribute
          target: linux_audit_logs.error
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: grok-parser
      name: Convert `msg.grantors` attribute to array
      enabled: true
      source: msg.grantors
      samples:
        - pam_localuser,pam_unix
      grok:
        supportRules: ""
        matchRules: grantors_rule %{notSpace:msg.grantors:array("",",")}
    - type: grok-parser
      name: Convert `msg.op` attribute to array
      enabled: true
      source: msg.op
      samples:
        - seuser-role,range
      grok:
        supportRules: ""
        matchRules: grantors_rule %{data:msg.op:array("",",")}
    - type: arithmetic-processor
      name: Convert `timestamp` epoch to milliseconds epoch
      enabled: true
      expression: timestamp*1000
      target: timestamp
      replaceMissing: false
    - type: date-remapper
      name: Define `timestamp` as the official date of the log
      enabled: true
      sources:
        - timestamp
    - type: service-remapper
      name: Define `service` as the official service of the log
      enabled: true
      sources:
        - service
    - type: attribute-remapper
      name: Map `msg.addr` to `network.client.ip`
      enabled: true
      sources:
        - msg.addr
      sourceType: attribute
      target: network.client.ip
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: pipeline
      name: Map `AUID` when `UID` is not present
      enabled: true
      filter:
        query: "@AUID:* -@UID:*"
      processors:
        - type: attribute-remapper
          name: Map `AUID` to `usr.name`
          enabled: true
          sources:
            - AUID
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: attribute-remapper
      name: Map `UID`, `OUID` to `usr.name`
      enabled: true
      sources:
        - UID
        - OUID
      sourceType: attribute
      target: usr.name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: pipeline
      name: Map `auid` when `uid` is not present
      enabled: true
      filter:
        query: "@auid:* -@uid:*"
      processors:
        - type: attribute-remapper
          name: Map `auid` to `usr.id`
          enabled: true
          sources:
            - auid
          sourceType: attribute
          target: usr.id
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: attribute-remapper
      name: Map `uid`, `ouid` to `usr.id`
      enabled: true
      sources:
        - uid
        - ouid
      sourceType: attribute
      target: usr.id
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: pipeline
      name: Parsing Mac Config Change Logs
      enabled: true
      filter:
        query: "@type:MAC_CONFIG_CHANGE"
      processors:
        - type: attribute-remapper
          name: Map `bool` to `linux_audit_logs.bool`
          enabled: true
          sources:
            - bool
          sourceType: attribute
          target: linux_audit_logs.bool
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: string-builder-processor
      name: Reset `pre_msg_kv` attribute
      enabled: true
      template: "%{resolve_to_empty_string}"
      target: pre_msg_kv
      replaceMissing: true
    - type: string-builder-processor
      name: Reset `msg_raw` attribute
      enabled: true
      template: "%{resolve_to_empty_string}"
      target: msg_raw
      replaceMissing: true
    - type: string-builder-processor
      name: Reset `post_msg_kv` attribute
      enabled: true
      template: "%{resolve_to_empty_string}"
      target: post_msg_kv
      replaceMissing: true
    - name: Lookup on `res` to `msg.res` Field
      enabled: true
      source: res
      target: msg.res
      lookupTable: |-
        0,failed
        1,success
        failed,failed
        success,success
      type: lookup-processor
    - type: geo-ip-parser
      name: Extract geolocation information
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
      ip_processing_behavior: do-nothing
    - name: Lookup on `msg.res` to `status`
      enabled: true
      source: msg.res
      target: status
      lookupTable: |-
        success,ok
        failed,error
      type: lookup-processor
    - type: status-remapper
      name: Define `status` as the official status of the log
      enabled: true
      sources:
        - status
    - type: pipeline
      name: Parsing User Role Assign logs
      enabled: true
      filter:
        query: "@type:ROLE_ASSIGN"
      processors:
        - type: attribute-remapper
          name: Map `msg.new-seuser` to `target_user_name`
          enabled: true
          sources:
            - msg.new-seuser
          sourceType: attribute
          target: target_user_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Convert `msg.new-role` into an array
          enabled: true
          source: msg.new-role
          samples:
            - staff_r
          grok:
            supportRules: ""
            matchRules: rule_convert_role_into_array %{data:privileges:array}
    - type: pipeline
      name: Parsing User Role Remove logs
      enabled: true
      filter:
        query: "@type:ROLE_REMOVE"
      processors:
        - type: attribute-remapper
          name: Map `msg.old-seuser` to `target_user_name`
          enabled: true
          sources:
            - msg.old-seuser
          sourceType: attribute
          target: target_user_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Convert `msg.old-role` into an array
          enabled: true
          source: msg.old-role
          samples:
            - staff_r
          grok:
            supportRules: ""
            matchRules: rule_convert_role_into_array %{data:privileges:array}
    - type: pipeline
      name: OCSF pre transformations
      enabled: true
      filter:
        query: "@type:(ADD_GROUP OR DEL_GROUP OR ADD_USER OR DEL_USER OR USER_CHAUTHTOK
          OR USER_AUTH OR ROLE_ASSIGN OR ROLE_REMOVE OR PATH OR USER_ROLE_CHANGE
          OR USER_SELINUX_ERR OR DAEMON_CONFIG OR DAEMON_ABORT OR
          USER_MAC_CONFIG_CHANGE OR MAC_CONFIG_CHANGE OR MAC_STATUS OR
          MAC_POLICY_LOAD OR AVC OR CONFIG_CHANGE OR SYSCALL)"
      processors:
        - type: string-builder-processor
          name: Add product name
          enabled: true
          template: Linux Audit
          target: ocsf.metadata.product.name
          replaceMissing: false
        - type: string-builder-processor
          name: Add product vendor
          enabled: true
          template: Linux
          target: ocsf.metadata.product.vendor_name
          replaceMissing: false
    - type: pipeline
      name: OCSF sub pipeline for class Base Event [0]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:(USER_ROLE_CHANGE OR USER_SELINUX_ERR OR DAEMON_CONFIG OR
          DAEMON_ABORT OR USER_MAC_CONFIG_CHANGE OR MAC_CONFIG_CHANGE OR
          MAC_STATUS OR MAC_POLICY_LOAD OR AVC OR CONFIG_CHANGE OR SYSCALL)"
      processors:
        - type: schema-processor
          name: Apply OCSF schema for 0
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Base Event
            classUid: 0
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "*"
                  name: Other
                  id: 99
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `type` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class Authentication [3002]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:USER_AUTH"
      processors:
        - type: string-builder-processor
          name: Set ocsf.actor.session.uid attribute
          enabled: true
          template: "%{ses}"
          target: ocsf.actor.session.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.process.user.uid attribute
          enabled: true
          template: "%{usr.id}"
          target: ocsf.actor.process.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.user.uid attribute
          enabled: true
          template: "%{auid}"
          target: ocsf.actor.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.user.uid attribute
          enabled: true
          template: "%{msg.id}"
          target: ocsf.user.uid
          replaceMissing: false
        - type: schema-processor
          name: Apply OCSF schema for 3002
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Authentication
            classUid: 3002
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@type:USER_AUTH"
                  name: Logon
                  id: 1
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `type` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `pid` to `ocsf.actor.process.pid`
              sources:
                - pid
              sourceType: attribute
              target: ocsf.actor.process.pid
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user.uid` to `ocsf.actor.user.uid`
              sources:
                - ocsf.actor.user.uid
              sourceType: attribute
              target: ocsf.actor.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.session.uid` to `ocsf.actor.session.uid`
              sources:
                - ocsf.actor.session.uid
              sourceType: attribute
              target: ocsf.actor.session.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `AUID` to `ocsf.actor.user.name`
              sources:
                - AUID
              sourceType: attribute
              target: ocsf.actor.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.user` to `ocsf.user`
              sources:
                - ocsf.user
              sourceType: attribute
              target: ocsf.user
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.acct` to `ocsf.user.name`
              sources:
                - msg.acct
              sourceType: attribute
              target: ocsf.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.terminal` to `ocsf.actor.session.terminal`
              sources:
                - msg.terminal
              sourceType: attribute
              target: ocsf.actor.session.terminal
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `network.client.ip` to `ocsf.dst_endpoint.ip`
              sources:
                - network.client.ip
              sourceType: attribute
              target: ocsf.dst_endpoint.ip
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.hostname` to `ocsf.dst_endpoint.hostname`
              sources:
                - msg.hostname
              sourceType: attribute
              target: ocsf.dst_endpoint.hostname
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `usr.name` to `ocsf.actor.process.user.name`
              sources:
                - usr.name
              sourceType: attribute
              target: ocsf.actor.process.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.process.user.uid` to `ocsf.actor.process.user.uid`
              sources:
                - ocsf.actor.process.user.uid
              sourceType: attribute
              target: ocsf.actor.process.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.exe` to `ocsf.actor.process.pat`
              sources:
                - msg.exe
              sourceType: attribute
              target: ocsf.actor.process.path
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.user.uid` to `ocsf.user.uid`
              sources:
                - ocsf.user.uid
              sourceType: attribute
              target: ocsf.user.uid
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class Account Change [3001]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:(ADD_USER OR DEL_USER OR USER_CHAUTHTOK)"
      processors:
        - type: string-builder-processor
          name: Set ocsf.actor.session.uid attribute
          enabled: true
          template: "%{ses}"
          target: ocsf.actor.session.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.process.user.uid attribute
          enabled: true
          template: "%{usr.id}"
          target: ocsf.actor.process.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.user.uid attribute
          enabled: true
          template: "%{auid}"
          target: ocsf.actor.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.user.uid attribute
          enabled: true
          template: "%{msg.id}"
          target: ocsf.user.uid
          replaceMissing: false
        - type: schema-processor
          name: Apply OCSF schema for 3001
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Account Change
            classUid: 3001
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@type:ADD_USER"
                  name: Create
                  id: 1
                - filter:
                    query: "@type:DEL_USER"
                  name: Delete
                  id: 6
                - filter:
                    query: "@type:USER_CHAUTHTOK"
                  name: Password Change
                  id: 3
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.event_code` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `pid` to `ocsf.actor.process.pid`
              sources:
                - pid
              sourceType: attribute
              target: ocsf.actor.process.pid
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.process.user.uid` to `ocsf.actor.process.user.uid`
              sources:
                - ocsf.actor.process.user.uid
              sourceType: attribute
              target: ocsf.actor.process.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user.uid` to `ocsf.actor.user.uid`
              sources:
                - ocsf.actor.user.uid
              sourceType: attribute
              target: ocsf.actor.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.session.uid` to `ocsf.actor.session.uid`
              sources:
                - ocsf.actor.session.uid
              sourceType: attribute
              target: ocsf.actor.session.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `AUID` to `ocsf.actor.user.name`
              sources:
                - AUID
              sourceType: attribute
              target: ocsf.actor.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `usr.name` to `ocsf.actor.process.user.name`
              sources:
                - usr.name
              sourceType: attribute
              target: ocsf.actor.process.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.user` to `ocsf.user`
              sources:
                - ocsf.user
              sourceType: attribute
              target: ocsf.user
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.acct` to `ocsf.user.name`
              sources:
                - msg.acct
              sourceType: attribute
              target: ocsf.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.user.uid` to `ocsf.user.uid`
              sources:
                - ocsf.user.uid
              sourceType: attribute
              target: ocsf.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `network.client.ip` to `ocsf.src_endpoint.ip`
              sources:
                - network.client.ip
              sourceType: attribute
              target: ocsf.src_endpoint.ip
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.hostname` to `ocsf.src_endpoint.hostname`
              sources:
                - msg.hostname
              sourceType: attribute
              target: ocsf.src_endpoint.hostname
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.terminal` to `ocsf.actor.session.terminal`
              sources:
                - msg.terminal
              sourceType: attribute
              target: ocsf.actor.session.terminal
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.exe` to `ocsf.actor.process.path`
              sources:
                - msg.exe
              sourceType: attribute
              target: ocsf.actor.process.path
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class Group Management [3006]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:(ADD_GROUP OR DEL_GROUP)"
      processors:
        - type: string-builder-processor
          name: Set ocsf.actor.session.uid attribute
          enabled: true
          template: "%{ses}"
          target: ocsf.actor.session.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.process.user.uid attribute
          enabled: true
          template: "%{usr.id}"
          target: ocsf.actor.process.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.user.uid attribute
          enabled: true
          template: "%{auid}"
          target: ocsf.actor.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.group.uid attribute
          enabled: true
          template: "%{msg.id}"
          target: ocsf.group.uid
          replaceMissing: false
        - type: schema-processor
          name: Apply OCSF schema for 3006
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: Group Management
            classUid: 3006
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: type:ADD_GROUP
                  name: Create
                  id: 6
                - filter:
                    query: "@type:ADD_GROUP"
                  name: Create
                  id: 6
                - filter:
                    query: "@type:DEL_GROUP"
                  name: Delete
                  id: 5
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.group` to `ocsf.group`
              sources:
                - ocsf.group
              sourceType: attribute
              target: ocsf.group
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `type` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.acct` to `ocsf.group.name`
              sources:
                - msg.acct
              sourceType: attribute
              target: ocsf.group.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `pid` to `ocsf.actor.process.pid`
              sources:
                - pid
              sourceType: attribute
              target: ocsf.actor.process.pid
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.process.user.uid` to `ocsf.actor.process.user.uid`
              sources:
                - ocsf.actor.process.user.uid
              sourceType: attribute
              target: ocsf.actor.process.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user.uid` to `ocsf.actor.user.uid`
              sources:
                - ocsf.actor.user.uid
              sourceType: attribute
              target: ocsf.actor.user.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.session.uid` to `ocsf.actor.session.uid`
              sources:
                - ocsf.actor.session.uid
              sourceType: attribute
              target: ocsf.actor.session.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `AUID` to `ocsf.actor.user.name`
              sources:
                - AUID
              sourceType: attribute
              target: ocsf.actor.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `usr.name` to `ocsf.actor.process.user.name`
              sources:
                - usr.name
              sourceType: attribute
              target: ocsf.actor.process.user.name
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.group.uid` to `ocsf.group.uid`
              sources:
                - ocsf.group.uid
              sourceType: attribute
              target: ocsf.group.uid
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.hostname` to `ocsf.src_endpoint.hostname`
              sources:
                - msg.hostname
              sourceType: attribute
              target: ocsf.src_endpoint.hostname
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `network.client.ip` to `ocsf.src_endpoint.ip`
              sources:
                - network.client.ip
              sourceType: attribute
              target: ocsf.src_endpoint.ip
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.terminal` to `ocsf.actor.session.terminal`
              sources:
                - msg.terminal
              sourceType: attribute
              target: ocsf.actor.session.terminal
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.exe` to `ocsf.actor.process.path`
              sources:
                - msg.exe
              sourceType: attribute
              target: ocsf.actor.process.path
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class User Access Management [3005]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:(ROLE_ASSIGN OR ROLE_REMOVE)"
      processors:
        - type: string-builder-processor
          name: Set ocsf.actor.session.uid attribute
          enabled: true
          template: "%{ses}"
          target: ocsf.actor.session.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.process.user.uid attribute
          enabled: true
          template: "%{usr.id}"
          target: ocsf.actor.process.user.uid
          replaceMissing: false
        - type: string-builder-processor
          name: Set ocsf.actor.user.uid attribute
          enabled: true
          template: "%{auid}"
          target: ocsf.actor.user.uid
          replaceMissing: false
        - type: schema-processor
          name: Apply OCSF schema for 3005
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: User Access Management
            classUid: 3005
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@type:ROLE_REMOVE"
                  name: Revoke Privileges
                  id: 2
                - filter:
                    query: "@type:ROLE_ASSIGN"
                  name: Assign Privileges
                  id: 1
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - privileges
              sourceType: attribute
              target: ocsf.privileges
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.user` to `ocsf.user`
              sources:
                - ocsf.user
              sourceType: attribute
              target: ocsf.user
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `target_user_name` to `ocsf.user.name`
              sources:
                - target_user_name
              sourceType: attribute
              target: ocsf.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `pid` to `ocsf.actor.process.pid`
              sources:
                - pid
              sourceType: attribute
              target: ocsf.actor.process.pid
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `uid` to `ocsf.actor.process.user.uid`
              sources:
                - uid
              sourceType: attribute
              target: ocsf.actor.process.user.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `usr.name` to `ocsf.actor.process.user.name`
              sources:
                - usr.name
              sourceType: attribute
              target: ocsf.actor.process.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user.uid` to `ocsf.actor.user.uid`
              sources:
                - ocsf.actor.user.uid
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `AUID` to `ocsf.actor.user.name`
              sources:
                - AUID
              sourceType: attribute
              target: ocsf.actor.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user` to `ocsf.actor.user`
              sources:
                - ocsf.actor.user
              sourceType: attribute
              target: ocsf.actor.user
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor` to `ocsf.actor`
              sources:
                - ocsf.actor
              sourceType: attribute
              target: ocsf.actor
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `type` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.src_endpoint` to `ocsf.src_endpoint`
              sources:
                - ocsf.src_endpoint
              sourceType: attribute
              target: ocsf.src_endpoint
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.hostname` to `ocsf.src_endpoint.hostname`
              sources:
                - msg.hostname
              sourceType: attribute
              target: ocsf.src_endpoint.hostname
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `network.client.ip` to `ocsf.src_endpoint.ip`
              sources:
                - network.client.ip
              sourceType: attribute
              target: ocsf.src_endpoint.ip
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.exe` to `ocsf.actor.process.path`
              sources:
                - msg.exe
              sourceType: attribute
              target: ocsf.actor.process.path
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `msg.terminal` to `ocsf.actor.session.terminal`
              sources:
                - msg.terminal
              sourceType: attribute
              target: ocsf.actor.session.terminal
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
    - type: pipeline
      name: OCSF sub pipeline for class File System Activity [1001]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:PATH"
      processors:
        - type: grok-parser
          name: Extracting file or folder name
          enabled: true
          source: name
          samples:
            - /etc/shadow
            - /run/
            - /run/nginx.pid
          grok:
            supportRules: file_or_folder_path (/%{regex("[^/]*")})*
            matchRules: >-
              rule_extract_folder_name
              %{file_or_folder_path}/%{regex("[^/]*"):folder_name}/

              rule_extract_file_name %{file_or_folder_path}/%{data:file_name}
        - type: grok-parser
          name: Extracting file extention
          enabled: true
          source: file_name
          samples:
            - nginx.pid
            - libcrypt.so.1
            - ld.so.cache
          grok:
            supportRules: ""
            matchRules: >-
              rule_extract_file_extention_1
              (%{regex("[^.]*")}.)+%{word:ocsf.file.ext}.%{number}

              rule_extract_file_extention_2 (%{regex("[^.]*")}.)+%{word:ocsf.file.ext}
        - type: string-builder-processor
          name: Set ocsf.file.name attribute
          enabled: true
          template: "%{folder_name}%{file_name}"
          target: ocsf.file.name
          replaceMissing: true
        - type: string-builder-processor
          name: Set ocsf.actor.user.uid attribute
          enabled: true
          template: "%{ouid}%{usr.id}"
          target: ocsf.actor.user.uid
          replaceMissing: true
        - type: schema-processor
          name: Apply OCSF schema for 1001
          enabled: true
          schema:
            schemaType: ocsf
            version: 1.5.0
            className: File System Activity
            classUid: 1001
            extensions: []
            profiles: []
          mappers:
            - name: ocsf.activity_id
              categories:
                - filter:
                    query: "@nametype:UNKNOWN"
                  name: Unknown
                  id: 0
                - filter:
                    query: "@nametype:CREATE"
                  name: Create
                  id: 1
                - filter:
                    query: "@nametype:(PARENT OR NORMAL)"
                  name: Read
                  id: 2
                - filter:
                    query: "@nametype:DELETE"
                  name: Delete
                  id: 4
                - filter:
                    query: "-@nametype:(CREATE OR DELETE PARENT OR NORMAL OR UNKNOWN)"
                  name: Other
                  id: 99
              targets:
                name: ocsf.activity_name
                id: ocsf.activity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.file.type_id
              categories:
                - filter:
                    query: "@file_name:*"
                  name: Regular File
                  id: 1
                - filter:
                    query: "@folder_name:*"
                  name: Folder
                  id: 2
              targets:
                name: ocsf.file.type
                id: ocsf.file.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.severity_id
              categories:
                - filter:
                    query: "*"
                  name: Informational
                  id: 1
              targets:
                name: ocsf.severity
                id: ocsf.severity_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.status_id
              categories:
                - filter:
                    query: "@msg.res:success"
                  name: Success
                  id: 1
                - filter:
                    query: "@msg.res:failed"
                  name: Failure
                  id: 2
              targets:
                name: ocsf.status
                id: ocsf.status_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: ocsf.device.type_id
              categories:
                - filter:
                    query: "*"
                  name: Unknown
                  id: 0
              targets:
                name: ocsf.device.type
                id: ocsf.device.type_id
              fallback:
                values: {}
                sources: {}
              type: schema-category-mapper
            - name: Map `ocsf.metadata` to `ocsf.metadata`
              sources:
                - ocsf.metadata
              sourceType: attribute
              target: ocsf.metadata
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product` to `ocsf.metadata.product`
              sources:
                - ocsf.metadata.product
              sourceType: attribute
              target: ocsf.metadata.product
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `timestamp` to `ocsf.time`
              sources:
                - timestamp
              sourceType: attribute
              target: ocsf.time
              targetFormat: integer
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.name` to `ocsf.metadata.product.name`
              sources:
                - ocsf.metadata.product.name
              sourceType: attribute
              target: ocsf.metadata.product.name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.metadata.product.vendor_name` to `ocsf.metadata.product.vendor_name`
              sources:
                - ocsf.metadata.product.vendor_name
              sourceType: attribute
              target: ocsf.metadata.product.vendor_name
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `type` to `ocsf.metadata.event_code`
              sources:
                - type
              sourceType: attribute
              target: ocsf.metadata.event_code
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user.uid` to `ocsf.actor.user.uid`
              sources:
                - ocsf.actor.user.uid
              sourceType: attribute
              target: ocsf.actor.user.uid
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `usr.name` to `ocsf.actor.user.name`
              sources:
                - usr.name
              sourceType: attribute
              target: ocsf.actor.user.name
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor.user` to `ocsf.actor.user`
              sources:
                - ocsf.actor.user
              sourceType: attribute
              target: ocsf.actor.user
              targetFormat: string
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.actor` to `ocsf.actor`
              sources:
                - ocsf.actor
              sourceType: attribute
              target: ocsf.actor
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.file` to `ocsf.file`
              sources:
                - ocsf.file
              sourceType: attribute
              target: ocsf.file
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.file.name` to `ocsf.file.name`
              sources:
                - ocsf.file.name
              sourceType: attribute
              target: ocsf.file.name
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `name` to `ocsf.file.path`
              sources:
                - name
              sourceType: attribute
              target: ocsf.file.path
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.file.ext` to `ocsf.file.ext`
              sources:
                - ocsf.file.ext
              sourceType: attribute
              target: ocsf.file.ext
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `ocsf.device` to `ocsf.device`
              sources:
                - ocsf.device
              sourceType: attribute
              target: ocsf.device
              preserveSource: false
              overrideOnConflict: true
              type: schema-remapper
            - name: Map `dev` to `ocsf.device.uid`
              sources:
                - dev
              sourceType: attribute
              target: ocsf.device.uid
              targetFormat: string
              preserveSource: true
              overrideOnConflict: true
              type: schema-remapper
