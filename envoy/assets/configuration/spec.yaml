name: Envoy
files:
- name: envoy.yaml
  options:
  - template: init_config
    options:
    - template: init_config/http
    - template: init_config/default
  - template: instances
    options:
    - template: instances/openmetrics
      overrides:
        openmetrics_endpoint.value.example: http://localhost:80/stats/prometheus
        openmetrics_endpoint.display_priority: 1
    - name: stats_url
      display_priority: 1
      description: |
        The check will attempt to parse the metrics from the admin /stats/ endpoint.
        It must be accessible:
        https://www.envoyproxy.io/docs/envoy/latest/operations/admin
        Add a `?usedonly` on the end if you wish to ignore
        unused metrics instead of reporting them as `0`.

        Note: see the configuration options specific to this option here,
        https://github.com/DataDog/integrations-core/blob/7.33.x/envoy/datadog_checks/envoy/data/conf.yaml.example
      value:
        example: http://localhost:80/stats
        type: string
  - template: logs
    example:
    - type: file
      path: /var/log/envoy.log
      source: envoy
