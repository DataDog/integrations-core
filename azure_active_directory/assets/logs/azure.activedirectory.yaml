id: azure.activedirectory
metric_id: azure-active-directory
backend_only: false
facets:
  - facetType: range
    groups:
      - Measure
    name: Duration
    path: duration
    source: log
    type: double
    unit:
      family: time
      name: nanosecond
  - groups:
      - Event
    name: Event Name
    path: evt.name
    source: log
  - groups:
      - Event
    name: Event Outcome
    path: evt.outcome
    source: log
  - groups:
      - Web Access
    name: User-Agent
    path: http.useragent
    source: log
  - groups:
      - Web Access
    name: Browser
    path: http.useragent_details.browser.family
    source: log
  - groups:
      - Web Access
    name: Device
    path: http.useragent_details.device.family
    source: log
  - groups:
      - Web Access
    name: OS
    path: http.useragent_details.os.family
    source: log
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - User
    name: User Email
    path: usr.email
    source: log
  - groups:
      - User
    name: User ID
    path: usr.id
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
  - groups:
      - Azure
    name: Resource ID
    path: resourceId
    source: log
    type: string
  - groups:
      - Azure
    name: Resource Name
    path: resource_name
    source: log
    type: string
  - groups:
      - Azure
    name: Client Application
    path: properties.clientAppUsed
    source: log
    type: string
  - groups:
      - Azure
    name: Service Principal
    path: properties.servicePrincipalName
    source: log
    type: string
  - groups:
      - Azure
    name: Application Display Name
    path: properties.appDisplayName
    source: log
    type: string
  - groups:
      - Azure
    name: Application ID
    path: properties.appId
    source: log
    type: string
  - groups:
      - Azure
    name: Resource Group
    path: resource_group
    source: tag
    type: string
  - groups:
      - Event
    name: Event Category
    path: evt.category
    source: log
  - groups:
      - Azure
    name: Subscription ID
    path: subscription_id
    source: tag
    type: string
  - groups:
      - Azure
    name: Tenant
    path: tenant
    source: tag
    type: string
pipeline:
  type: pipeline
  name: Azure Active Directory - OCSF
  enabled: true
  filter:
    query: source:azure.activedirectory
  processors:
    - type: grok-parser
      name: Parsing `resource_name` from `resourceId`
      enabled: true
      source: resourceId
      samples:
        - /SUBSCRIPTIONS/8C56D827-5F07-45CE-8F2B-6C5001DB5C6F/RESOURCEGROUPS/ET-COMPUTE-RG/PROVIDERS/MICROSOFT.STORAGE/STORAGEACCOUNTS/ETFLOWLOGS
      grok:
        supportRules: |
          _non_extracted_resource %{regex("[a-zA-Z0-9-_.]*")}
          _resource_name %{regex("[a-zA-Z0-9-_.]*"):resource_name:lowercase}
          _subscriptions %{regex("(?i)SUBSCRIPTIONS")}
          _resource_groups %{regex("(?i)RESOURCEGROUPS")}
          _providers %{regex("(?i)PROVIDERS")}
        matchRules: |
          extract_resource_name /%{_subscriptions}\/%{_non_extracted_resource}\/%{_resource_groups}\/%{_non_extracted_resource}\/%{_providers}%{_non_extracted_resource}\/%{_non_extracted_resource}\/%{data}\/%{_resource_name}
    - type: date-remapper
      name: Define `properties.createdDateTime`, `properties.activityDateTime`, `properties.timeGenerated`, `time` as the official date of the log
      enabled: true
      sources:
        - properties.createdDateTime
        - properties.activityDateTime
        - properties.timeGenerated
        - time
    - type: status-remapper
      name: Define `level` as the official status of the log
      enabled: true
      sources:
        - level
    - type: attribute-remapper
      name: Map `category` to `evt.category`
      enabled: true
      sources:
        - category
      target: evt.category
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: attribute-remapper
      name: Map `operationName` to `evt.name`
      enabled: true
      sources:
        - operationName
      target: evt.name
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: attribute-remapper
      name: Map `callerIpAddress` to `network.client.ip`
      enabled: true
      sources:
        - callerIpAddress
      target: network.client.ip
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: arithmetic-processor
      name: Compute duration in nanoseconds from durationMs in miliseconds
      enabled: true
      expression: durationMs * 1000000
      target: duration
      replaceMissing: false
    - type: geo-ip-parser
      name: Fetching GeoIp data for client ip
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
    - type: attribute-remapper
      name: Map `properties.initiatedBy.user.userPrincipalName`, `properties.userPrincipalName` to `usr.id`
      enabled: true
      sources:
        - properties.initiatedBy.user.userPrincipalName
        - properties.userPrincipalName
      target: usr.id
      preserveSource: true
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: attribute-remapper
      name: Map `properties.initiatedBy.user.userPrincipalName`, `properties.userDisplayName` to `usr.name`
      enabled: true
      sources:
        - properties.initiatedBy.user.userPrincipalName
        - properties.userDisplayName
      target: usr.name
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: attribute-remapper
      name: Map `properties.userPrincipalName` to `usr.email`
      enabled: true
      sources:
        - properties.userPrincipalName
      target: usr.email
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: attribute-remapper
      name: Map `properties.userAgent` to `http.useragent`
      enabled: true
      sources:
        - properties.userAgent
      target: http.useragent
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: user-agent-parser
      name: ""
      enabled: true
      sources:
        - http.useragent
      target: http.useragent_details
      encoded: false
    - type: message-remapper
      name: Define `resultDescription`, `properties.status.additionalDetails` as the official message of the log
      enabled: true
      sources:
        - resultDescription
        - properties.status.additionalDetails
    - type: category-processor
      name: Categorise sign-in event outcomes
      enabled: true
      categories:
        - filter:
            query: "@evt.category:SignInLogs @properties.status.errorCode:0"
          name: success
        - filter:
            query: "@evt.category:SignInLogs -@properties.status.errorCode:0 @properties.status.errorCode:*"
          name: failure
      target: evt.outcome
    - type: attribute-remapper
      name: Map `properties.result` to `evt.outcome`
      enabled: true
      sources:
        - properties.result
      target: evt.outcome
      targetFormat: string
      preserveSource: false
      overrideOnConflict: false
      sourceType: attribute
      targetType: attribute
    - type: string-builder-processor
      name: title - %{evt.name} resulted in %{evt.outcome} initiated by %{usr.id}
      enabled: true
      target: title
      template: "'%{evt.name}' resulted in %{evt.outcome} initiated by %{usr.id} %{properties.initiatedBy.app.displayName}"
      replaceMissing: true
      #OCSF transformations
    - type: pipeline
      name: OCSF pre transformations
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "*"
      processors:
        - type: string-builder-processor
          name: Add version
          enabled: true
          template: 1.5.0
          target: ocsf.metadata.version
          replaceMissing: false
        - type: string-builder-processor
          name: Add product name
          enabled: true
          template: Azure Active Directory
          target: ocsf.metadata.product.name
          replaceMissing: false
        - type: string-builder-processor
          name: Add product vendor
          enabled: true
          template: Microsoft
          target: ocsf.metadata.product.vendor_name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `evt.category` to `ocsf.metadata.log_name`
          enabled: true
          sources:
            - evt.category
          sourceType: attribute
          target: ocsf.metadata.log_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.createdDateTime` to `ocsf.time`
          enabled: true
          sources:
            - properties.createdDateTime
          sourceType: attribute
          target: ocsf.time
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Parse ocsf.time
          enabled: true
          source: ocsf.time
          samples:
            - "2025-08-06T22:02:39.2294950+00:00"
          grok:
            supportRules: ""
            matchRules: parsing_time %{date("yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'+00:00'"):ocsf.time}
        - type: attribute-remapper
          name: Map `evt.name` to `ocsf.metadata.event_code`
          enabled: true
          sources:
            - evt.name
          sourceType: attribute
          target: ocsf.metadata.event_code
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.Id` to `ocsf.metadata.uid`
          enabled: true
          sources:
            - properties.Id
          sourceType: attribute
          target: ocsf.metadata.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add severity
          enabled: true
          template: Informational
          target: ocsf.severity
          replaceMissing: false
        - type: string-builder-processor
          name: Add severity id
          enabled: true
          template: "1"
          target: ocsf.severity_id
          replaceMissing: false
    - type: pipeline
      name: OCSF sub pipeline for class Account Change [3001]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@evt.category:AuditLogs (@properties.category:(UserManagement OR ApplicationManagement) OR (@properties.category:RoleManagement AND @properties.targetResources.type:(ServicePrincipal OR User)))"
      processors:
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "3"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: Identity & Access Management
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "3001"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: Account Change
          target: ocsf.class_name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `evt.name` to `ocsf.activity_name`
          enabled: true
          sources:
            - evt.name
          sourceType: attribute
          target: ocsf.activity_name
          targetType: attribute
          preserveSource: true
        - type: category-processor
          name: OCSF - activity_id mapping
          enabled: true
          categories:
            - filter:
                query: '@evt.name:("Add User" OR "Add service principal")'
              name: "1"
            - filter:
                query: '@evt.name:"Enable Account"'
              name: "2"
            - filter:
                query: '@evt.name:"Change user password"' #Todo: should this include self-service password resets?
              name: "3"
            - filter:
                query: '@evt.name:"Reset password"'
              name: "4"
            - filter:
                query: '@evt.name:"Disable account"'
              name: "5"
            - filter:
                query: '@evt.name:(*Delete\ user OR "Hard delete service principal" OR "Remove service principal")'
              name: "6"
            - filter:
                query: '@evt.name:Add\ *member\ to\ role*'
              name: "7"
            - filter:
                query: '@evt.name:Remove\ *member\ from\ role'
              name: "8"
            - filter:
                query: "*"
              name: "99"
          target: ocsf.activity_id
        - type: category-processor
          name: OCSF - activity_name mapping
          enabled: true
          categories:
            - filter:
                query: '@evt.name:"Add User"'
              name: "Create"
            - filter:
                query: '@evt.name:"Enable Account"'
              name: "Enable"
            - filter:
                query: '@evt.name:"Change user password"'
              name: "Password Change"
            - filter:
                query: '@evt.name:"Reset password"'
              name: "Password Reset"
            - filter:
                query: '@evt.name:"Disable account"'
              name: "Disable"
            - filter:
                query: '@evt.name:"*Delete user"'
              name: "Delete"
            - filter:
                query: '@evt.name:Add\ *member\ to\ role'
              name: "Attach Policy"
            - filter:
                query: '@evt.name:Remove\ *member\ from\ role'
              name: "Detach Policy"
          target: ocsf.activity_name
        - type: attribute-remapper
          name: Map `usr.name`, `properties.initiatedBy.app.displayName`, `identity` to `ocsf.actor.user.name`
          enabled: true
          sources:
            - usr.name
            - properties.initiatedBy.app.displayName
            - identity
          sourceType: attribute
          target: ocsf.actor.user.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.initiatedBy.user.id`, `properties.initiatedBy.app.servicePrincipalId` to `ocsf.actor.user.uid`
          enabled: true
          sources:
            - properties.initiatedBy.user.id
            - properties.initiatedBy.app.servicePrincipalId
          sourceType: attribute
          target: ocsf.actor.user.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `usr.id` to `ocsf.actor.user.email_addr`
          enabled: true
          sources:
            - usr.id
          sourceType: attribute
          target: ocsf.actor.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.actor.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.initiatedBy.user.id:* OR @usr.name:*"
              name: User
            - filter:
                query: "@properties.initiatedBy.app.servicePrincipalId"
              name: System
          target: ocsf.actor.user.type
        - type: category-processor
          name: OCSF - ocsf.actor.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.initiatedBy.user.id:*"
              name: "1"
            - filter:
                query: "@properties.initiatedBy.app.servicePrincipalId"
              name: "3"
            - filter:
                query: "@evt.category:*"
              name: "99"
          target: ocsf.actor.user.type_id
        - type: attribute-remapper
          name: Map `properties.correlationId` to `ocsf.actor.session.uid`
          enabled: true
          sources:
            - properties.correlationId
          sourceType: attribute
          target: ocsf.actor.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `time` to `ocsf.time`
          enabled: true
          sources:
            - time
          sourceType: attribute
          target: ocsf.time
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Parse ocsf.time
          enabled: true
          source: ocsf.time
          samples:
            - "2025-08-06T22:02:39.2294950Z"
          grok:
            supportRules: ""
            matchRules: parsing_time %{date("yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'Z'"):ocsf.time}
        - type: array-processor
          name: Extract `key` from `additionalDetails` array
          enabled: true
          operation:
            source: properties.additionalDetails
            target: ocsf.http_header.name
            filter: 'key:"User-Agent"'
            valueToExtract: key
            type: select
        - type: array-processor
          name: Extract `value` from `additionalDetails` array
          enabled: true
          operation:
            source: properties.additionalDetails
            target: ocsf.http_header.value
            filter: 'key:"User-Agent"'
            valueToExtract: value
            type: select
        - type: array-processor
          name: Move attributes into http_headers array
          enabled: true
          operation:
            source: ocsf.http_header
            target: ocsf.http_request.http_headers
            preserveSource: false
            type: append
        - type: attribute-remapper
          name: Map `network.client.ip` to `ocsf.src_endpoint.ip`
          enabled: true
          sources:
            - network.client.ip
          sourceType: attribute
          target: ocsf.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.resultReason` to `ocsf.status_code`
          enabled: true
          sources:
            - properties.resultReason
          sourceType: attribute
          target: ocsf.status_code
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.status mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.outcome:success"
              name: "1"
            - filter:
                query: "@evt.outcome:failure"
              name: "2"
          target: ocsf.status
        - type: category-processor
          name: OCSF - ocsf.status mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.outcome:success"
              name: "Success"
            - filter:
                query: "@evt.outcome:failure"
              name: "Failure"
            - filter:
                query: "*"
              name: "99"
          target: ocsf.status
        - type: array-processor
          name: Extract Role ID from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.policy.uid
            filter: "type:Role"
            valueToExtract: id
            type: select
        - type: array-processor
          name: Move attributes into policies array
          enabled: true
          operation:
            source: ocsf.policy
            target: ocsf.policies
            preserveSource: false
            type: append
        - type: array-processor
          name: Extract `userPrincipalName` from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.name
            filter: "type:User"
            valueToExtract: userPrincipalName
            type: select
        - type: attribute-remapper
          name: Map `ocsf.user.name` to `ocsf.user.email_addr`
          enabled: true
          sources:
            - ocsf.user.name
          sourceType: attribute
          target: ocsf.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@ocsf.user.email_addr:*"
              name: User
            - filter:
                query: "*"
              name: System
          target: ocsf.user.type
        - type: category-processor
          name: OCSF - ocsf.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@ocsf.user.email_addr:*"
              name: "1"
            - filter:
                query: "*"
              name: "3"
          target: ocsf.user.type_id
        - type: array-processor
          name: Extract `displayName` from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.name
            filter: "type:ServicePrincipal"
            valueToExtract: displayName
            type: select
        - type: array-processor
          name: Extract User id from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.uid
            filter: "type:User"
            valueToExtract: id
            type: select
    - type: pipeline
      name: OCSF sub pipeline for class Authentication [3002]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: 'source:azure.activedirectory @evt.name:"Sign-in activity"'
      processors:
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "3"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: Identity & Access Management
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "3002"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: Authentication
          target: ocsf.class_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add type name
          enabled: true
          template: "Authentication: Logon"
          target: ocsf.type_name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `usr.name`, `properties.servicePrincipalName` to `ocsf.actor.user.name`
          enabled: true
          sources:
            - usr.name
            - properties.servicePrincipalName
          sourceType: attribute
          target: ocsf.actor.user.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.userId`, `properties.servicePrincipalId` to `ocsf.actor.user.uid`
          enabled: true
          sources:
            - properties.userId
            - properties.servicePrincipalId
          sourceType: attribute
          target: ocsf.actor.user.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `usr.email` to `ocsf.actor.user.email_addr`
          enabled: true
          sources:
            - usr.email
          sourceType: attribute
          target: ocsf.actor.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.actor.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.category:(SignInLogs OR NonInteractiveUserSignInLogs)"
              name: User
            - filter:
                query: "@evt.category:(ManagedIdentitySignInLogs OR ServicePrincipalSignInLogs)"
              name: System
          target: ocsf.actor.user.type
        - type: category-processor
          name: OCSF - ocsf.actor.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.category:(SignInLogs OR NonInteractiveUserSignInLogs)"
              name: "1"
            - filter:
                query: "@evt.category:(ManagedIdentitySignInLogs OR ServicePrincipalSignInLogs)"
              name: "3"
            - filter:
                query: "@evt.category:*"
              name: "99"
          target: ocsf.actor.user.type_id
        - type: attribute-remapper
          name: Map `properties.sessionId` to `ocsf.actor.session.uid`
          enabled: true
          sources:
            - properties.sessionId
          sourceType: attribute
          target: ocsf.actor.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `usr.name`, `properties.servicePrincipalName` to `ocsf.user.name`
          enabled: true
          sources:
            - usr.name
            - properties.servicePrincipalName
          sourceType: attribute
          target: ocsf.user.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.userId`, `properties.servicePrincipalId` to `ocsf.user.uid`
          enabled: true
          sources:
            - properties.userId
            - properties.servicePrincipalId
          sourceType: attribute
          target: ocsf.user.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `usr.email` to `ocsf.user.email_addr`
          enabled: true
          sources:
            - usr.email
          sourceType: attribute
          target: ocsf.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.category:(SignInLogs OR NonInteractiveUserSignInLogs)"
              name: User
            - filter:
                query: "@evt.category:(ManagedIdentitySignInLogs OR ServicePrincipalSignInLogs)"
              name: System
          target: ocsf.user.type
        - type: category-processor
          name: OCSF - ocsf.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.category:(SignInLogs OR NonInteractiveUserSignInLogs)"
              name: "1"
            - filter:
                query: "@evt.category:(ManagedIdentitySignInLogs OR ServicePrincipalSignInLogs)"
              name: "3"
            - filter:
                query: "@evt.category:*"
              name: "99"
          target: ocsf.user.type_id
        - type: attribute-remapper
          name: Map `properties.resourceId` to `ocsf.dst_endpoint.uid`
          enabled: true
          sources:
            - properties.resourceId
          sourceType: attribute
          target: ocsf.dst_endpoint.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.resourceDisplayName` to `ocsf.dst_endpoint.svc_name`
          enabled: true
          sources:
            - properties.resourceDisplayName
          sourceType: attribute
          target: ocsf.dst_endpoint.svc_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.resourceId` to `ocsf.service.uid`
          enabled: true
          sources:
            - properties.resourceId
          sourceType: attribute
          target: ocsf.service.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.resourceDisplayName` to `ocsf.service.name`
          enabled: true
          sources:
            - properties.resourceDisplayName
          sourceType: attribute
          target: ocsf.service.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.ipAddress` to `ocsf.src_endpoint.ip`
          enabled: true
          sources:
            - properties.ipAddress
          sourceType: attribute
          target: ocsf.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.deviceDetail.operatingSystem` to `ocsf.src_endpoint.os.name`
          enabled: true
          sources:
            - properties.deviceDetail.operatingSystem
          sourceType: attribute
          target: ocsf.src_endpoint.os.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.src_endpoint.os.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.deviceDetail.operatingSystem:(*MacOs* OR *OSX*)"
              name: "300"
            - filter:
                query: "@properties.deviceDetail.operatingSystem:(*Windows*)"
              name: "100"
            - filter:
                query: "@properties.deviceDetail.operatingSystem:(*Android*)"
              name: "201"
            - filter:
                query: "@properties.deviceDetail.operatingSystem:(*Ios*)"
              name: "301"
            - filter:
                query: "@properties.deviceDetail.operatingSystem:(*Linux*)"
              name: "200"
          target: ocsf.src_endpoint.os.type_id
        - type: attribute-remapper
          name: Map `ocsf.src_endpoint.os.type_id` to `ocsf.src_endpoint.os.type_id`
          enabled: true
          sources:
            - ocsf.src_endpoint.os.type_id
          sourceType: attribute
          target: ocsf.src_endpoint.os.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false

        - type: attribute-remapper
          name: Map `properties.location.city` to `ocsf.src_endpoint.location.city`
          enabled: true
          sources:
            - properties.location.city
          sourceType: attribute
          target: ocsf.src_endpoint.location.city
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.location.countryOrRegion` to `ocsf.src_endpoint.location.country`
          enabled: true
          sources:
            - properties.location.countryOrRegion
          sourceType: attribute
          target: ocsf.src_endpoint.location.country
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.location.geoCoordinates.longitude` to `ocsf.src_endpoint.location.long`
          enabled: true
          sources:
            - properties.location.geoCoordinates.longitude
          sourceType: attribute
          target: ocsf.src_endpoint.location.lat
          targetType: attribute
          targetFormat: double
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.location.countryOrRegion.latitude` to `ocsf.src_endpoint.location.lat`
          enabled: true
          sources:
            - properties.location.countryOrRegion.latitude
          sourceType: attribute
          target: ocsf.src_endpoint.location.long
          targetType: attribute
          targetFormat: double
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - status_id mapping
          enabled: true
          categories:
            - filter:
                query: "@resultSignature:(SUCCESS)"
              name: "1"
            - filter:
                query: "@resultSignature:(FAILURE)"
              name: "2"
          target: ocsf.status_id
        - type: category-processor
          name: OCSF - status mapping
          enabled: true
          categories:
            - filter:
                query: "@resultSignature:(SUCCESS)"
              name: Success
            - filter:
                query: "@resultSignature:(FAILURE)"
              name: Failure
          target: ocsf.status
        - type: attribute-remapper
          name: Map `resultType` to `ocsf.status_code`
          enabled: true
          sources:
            - resultType
          sourceType: attribute
          target: ocsf.status_code
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.authenticationRequirement` to `ocsf.is_mfa`
          enabled: true
          sources:
            - properties.authenticationRequirement
          sourceType: attribute
          target: ocsf.is_mfa
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.sessionId` to `ocsf.session.uid`
          enabled: true
          sources:
            - properties.sessionId
          sourceType: attribute
          target: ocsf.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false

        - type: category-processor
          name: OCSF - severity mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.riskLevelDuringSignIn:low"
              name: "Low"
            - filter:
                query: "@properties.riskLevelDuringSignIn:medium"
              name: "Medium"
            - filter:
                query: "@properties.riskLevelDuringSignIn:high"
              name: "High"
            - filter:
                query: "@properties.riskLevelDuringSignIn:hidden"
              name: "Unknown"
          target: ocsf.severity
        - type: category-processor
          name: OCSF - severity_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.riskLevelDuringSignIn:low"
              name: "2"
            - filter:
                query: "@properties.riskLevelDuringSignIn:medium"
              name: "3"
            - filter:
                query: "@properties.riskLevelDuringSignIn:high"
              name: "4"
            - filter:
                query: "@properties.riskLevelDuringSignIn:hidden"
              name: "0"
          target: ocsf.severity_id
        - type: grok-parser
          name: Convert `ocsf.is_mfa` to boolean type
          enabled: true
          source: ocsf.is_mfa
          samples:
            - "multiFactorAuthentication"
            - "singleFactorAuthentication"
          grok:
            supportRules: ""
            matchRules: |
              convert_to_boolean %{boolean("multiFactorAuthentication", "singleFactorAuthentication"):ocsf.is_mfa}
        - type: category-processor
          name: OCSF - activity_id mapping
          enabled: true
          categories:
            - filter:
                query: '@evt.name:"Sign-in activity"'
              name: "1"
          target: ocsf.activity_id
        - type: category-processor
          name: OCSF - activity_name mapping
          enabled: true
          categories:
            - filter:
                query: '@ocsf.activity_id:("1")'
              name: Logon
          target: ocsf.activity_name
    - type: pipeline
      name: OCSF sub pipeline for class Group Management [3006]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@evt.category:AuditLogs (@properties.category:GroupManagement OR (@properties.category:RoleManagement AND @properties.targetResources.type:Group))"
      processors:
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "3"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: Identity & Access Management
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "3006"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: Group Management
          target: ocsf.class_name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `evt.name` to `ocsf.activity_name`
          enabled: true
          sources:
            - evt.name
          sourceType: attribute
          target: ocsf.activity_name
          targetType: attribute
          preserveSource: true
        - type: category-processor
          name: OCSF - activity_id mapping
          enabled: true
          categories:
            - filter:
                query: '@evt.name:Add\ *member\ to\ role*'
              name: "1"
            - filter:
                query: '@evt.name:Remove\ *member\ from\ role'
              name: "2"
            - filter:
                query: '@evt.name:"Add member to group"'
              name: "3"
            - filter:
                query: '@evt.name:"Remove member from group"'
              name: "4"
            - filter:
                query: '@evt.name:*Delete\ group'
              name: "5"
            - filter:
                query: '@evt.name:"Add group"'
              name: "6"
            - filter:
                query: "*"
              name: "99"
          target: ocsf.activity_id
        - type: category-processor
          name: OCSF - activity_name mapping
          enabled: true
          categories:
            - filter:
                query: '@evt.name:Add\ *member\ to\ role*'
              name: "Assign Privileges"
            - filter:
                query: '@evt.name:Remove\ *member\ from\ role'
              name: "Revoke Privileges"
            - filter:
                query: '@evt.name:"Add member to group"'
              name: "Add User"
            - filter:
                query: '@evt.name:"Remove member from group"'
              name: "Remove User"
            - filter:
                query: '@evt.name:*Delete\ group'
              name: "Delete"
            - filter:
                query: '@evt.name:"Add group"'
              name: "Create"
          target: ocsf.activity_name
        - type: attribute-remapper
          name: Map `usr.name`, `properties.initiatedBy.app.displayName`, `identity` to `ocsf.actor.user.name`
          enabled: true
          sources:
            - usr.name
            - properties.initiatedBy.app.displayName
            - identity
          sourceType: attribute
          target: ocsf.actor.user.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.initiatedBy.user.id`, `properties.initiatedBy.app.servicePrincipalId` to `ocsf.actor.user.uid`
          enabled: true
          sources:
            - properties.initiatedBy.user.id
            - properties.initiatedBy.app.servicePrincipalId
          sourceType: attribute
          target: ocsf.actor.user.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `usr.id` to `ocsf.actor.user.email_addr`
          enabled: true
          sources:
            - usr.id
          sourceType: attribute
          target: ocsf.actor.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.actor.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.initiatedBy.user.id:* OR @usr.name:*"
              name: User
            - filter:
                query: "@properties.initiatedBy.app.servicePrincipalId"
              name: System
          target: ocsf.actor.user.type
        - type: category-processor
          name: OCSF - ocsf.actor.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.initiatedBy.user.id:*"
              name: "1"
            - filter:
                query: "@properties.initiatedBy.app.servicePrincipalId"
              name: "3"
            - filter:
                query: "@evt.category:*"
              name: "99"
          target: ocsf.actor.user.type_id
        - type: attribute-remapper
          name: Map `properties.correlationId` to `ocsf.actor.session.uid`
          enabled: true
          sources:
            - properties.correlationId
          sourceType: attribute
          target: ocsf.actor.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `time` to `ocsf.time`
          enabled: true
          sources:
            - time
          sourceType: attribute
          target: ocsf.time
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Parse ocsf.time
          enabled: true
          source: ocsf.time
          samples:
            - "2025-08-06T22:02:39.2294950Z"
          grok:
            supportRules: ""
            matchRules: parsing_time %{date("yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'Z'"):ocsf.time}
        - type: array-processor
          name: Extract `key` from `additionalDetails` array
          enabled: true
          operation:
            source: properties.additionalDetails
            target: ocsf.http_header.name
            filter: 'key:"User-Agent"'
            valueToExtract: key
            type: select
        - type: array-processor
          name: Extract `value` from `additionalDetails` array
          enabled: true
          operation:
            source: properties.additionalDetails
            target: ocsf.http_header.value
            filter: 'key:"User-Agent"'
            valueToExtract: value
            type: select
        - type: array-processor
          name: Move attributes into http_headers array
          enabled: true
          operation:
            source: ocsf.http_header
            target: ocsf.http_request.http_headers
            preserveSource: false
            type: append
        - type: attribute-remapper
          name: Map `network.client.ip` to `ocsf.src_endpoint.ip`
          enabled: true
          sources:
            - network.client.ip
          sourceType: attribute
          target: ocsf.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.resultReason` to `ocsf.status_code`
          enabled: true
          sources:
            - properties.resultReason
          sourceType: attribute
          target: ocsf.status_code
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.status mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.outcome:success"
              name: "1"
            - filter:
                query: "@evt.outcome:failure"
              name: "2"
          target: ocsf.status
        - type: category-processor
          name: OCSF - ocsf.status mapping
          enabled: true
          categories:
            - filter:
                query: "@evt.outcome:success"
              name: "Success"
            - filter:
                query: "@evt.outcome:failure"
              name: "Failure"
            - filter:
                query: "*"
              name: "99"
          target: ocsf.status
        - type: array-processor
          name: Extract User/SP Id from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.uid
            filter: "type:(User OR ServicePrincipal)"
            valueToExtract: id
            type: select
        - type: array-processor
          name: Extract `userPrincipalName` from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.name
            filter: "type:User"
            valueToExtract: userPrincipalName
            type: select
        - type: attribute-remapper
          name: Map `ocsf.user.name` to `ocsf.user.email_addr`
          enabled: true
          sources:
            - ocsf.user.name
          sourceType: attribute
          target: ocsf.user.email_addr
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@ocsf.user.email_addr:*"
              name: User
            - filter:
                query: "ocsf.user.name:*"
              name: System
          target: ocsf.user.type
        - type: category-processor
          name: OCSF - ocsf.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@ocsf.user.email_addr:*"
              name: "1"
            - filter:
                query: "ocsf.user.name:*"
              name: "3"
          target: ocsf.user.type_id
        - type: array-processor
          name: Extract `displayName` from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.user.name
            filter: "type:ServicePrincipal"
            valueToExtract: displayName
            type: select
        - type: array-processor
          name: Extract Group Id from `properties.targetResources` array
          enabled: true
          operation:
            source: properties.targetResources
            target: ocsf.group.uid
            filter: "type:Group"
            valueToExtract: id
            type: select
    - type: pipeline
      name: OCSF sub pipeline for class API Activity [6003]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@evt.category:MicrosoftGraphActivityLogs"
      processors:
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "6"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: Application Activity
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "6003"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: API Activity
          target: ocsf.class_name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `properties.requestMethod` to `ocsf.activity_name`
          enabled: true
          sources:
            - properties.requestMethod
          sourceType: attribute
          target: ocsf.activity_name
          targetType: attribute
          preserveSource: true
        - type: category-processor
          name: OCSF - activity_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.requestMethod:POST"
              name: "1"
            - filter:
                query: "@properties.requestMethod:GET"
              name: "2"
            - filter:
                query: "@properties.requestMethod:PATCH"
              name: "3"
            - filter:
                query: "@properties.requestMethod:DELETE"
              name: "4"
            - filter:
                query: "@properties.requestMethod:*"
              name: "99"
          target: ocsf.activity_id
        - type: category-processor
          name: OCSF - activity_name mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.requestMethod:POST"
              name: "Assign Privileges"
            - filter:
                query: "@properties.requestMethod:GET"
              name: "Revoke Privileges"
            - filter:
                query: "@properties.requestMethod:PATCH"
              name: "Add User"
            - filter:
                query: "@properties.requestMethod:DELETE"
              name: "Remove User"
          target: ocsf.activity_name
        - type: attribute-remapper
          name: Map `properties.signInActivityId` to `ocsf.actor.session.uid`
          enabled: true
          sources:
            - properties.signInActivityId
          sourceType: attribute
          target: ocsf.actor.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.UserPrincipalObjectID` to `ocsf.actor.user.uid`
          enabled: true
          sources:
            - properties.UserPrincipalObjectID
          sourceType: attribute
          target: ocsf.actor.user.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - ocsf.actor.user.type mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.servicePrincipalId:*"
              name: System
            - filter:
                query: "@properties.UserPrincipalObjectIDL*"
              name: User
          target: ocsf.actor.user.type
        - type: category-processor
          name: OCSF - ocsf.actor.user.type_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.servicePrincipalId:*"
              name: "3"
            - filter:
                query: "@properties.UserPrincipalObjectID:*"
              name: "1"
          target: ocsf.actor.user.type_id
        - type: attribute-remapper
          name: Map `properties.requestMethod` to `ocsf.api.operation`
          enabled: true
          sources:
            - properties.requestMethod
          sourceType: attribute
          target: ocsf.api.operation
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `operationVersion` to `ocsf.api.version`
          enabled: true
          sources:
            - operationVersion
          sourceType: attribute
          target: ocsf.api.version
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `properties.ipAddress` to `ocsf.src_endpoint.ip`
          enabled: true
          sources:
            - properties.ipAddress
          sourceType: attribute
          target: ocsf.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false

        - type: string-builder-processor
          name: Add dst_endpoint.hostname
          enabled: true
          template: "graph.microsoft.com"
          target: ocsf.dst_endpoint.hostname
          replaceMissing: false
        - type: string-builder-processor
          name: Add dst_endpoint.name
          enabled: true
          template: "Microsoft Graph API"
          target: ocsf.dst_endpoint.name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `time` to `ocsf.time`
          enabled: true
          sources:
            - time
          sourceType: attribute
          target: ocsf.time
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: grok-parser
          name: Parse ocsf.time
          enabled: true
          source: ocsf.time
          samples:
            - "2025-08-06T22:02:39.2294950Z"
          grok:
            supportRules: ""
            matchRules: parsing_time %{date("yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'Z'"):ocsf.time}
        - type: attribute-remapper
          name: Map `properties.durationMs` to `ocsf.duration`
          enabled: true
          sources:
            - properties.durationMs
          sourceType: attribute
          target: ocsf.duration
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `level` to `ocsf.severity`
          enabled: true
          sources:
            - level
          sourceType: attribute
          target: ocsf.severity
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - severity_id mapping
          enabled: true
          categories:
            - filter:
                query: "@level:Informational"
              name: "1"
            - filter:
                query: "@level:Low"
              name: "2"
            - filter:
                query: "@level:Medium"
              name: "3"
            - filter:
                query: "@level:High"
              name: "4"
            - filter:
                query: "@level:*"
              name: "99"
          target: ocsf.severity_id
        - type: attribute-remapper
          name: Map `resultSignature` to `ocsf.status_code`
          enabled: true
          sources:
            - resultSignature
          sourceType: attribute
          target: ocsf.status_code
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `resultSignature` to `ocsf.status`
          enabled: true
          sources:
            - resultSignature
          sourceType: attribute
          target: ocsf.status
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: OCSF - status_id mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.responseStatusCode:[200 TO 299]"
              name: "1"
            - filter:
                query: "@properties.responseStatusCode:[400 TO 599]"
              name: "2"
            - filter:
                query: "@properties.responseStatusCode:*"
              name: "99"
          target: ocsf.status_id
        - type: category-processor
          name: OCSF - status mapping
          enabled: true
          categories:
            - filter:
                query: "@properties.responseStatusCode:[200 TO 299]"
              name: "Success"
            - filter:
                query: "@properties.responseStatusCode:[400 TO 599]"
              name: "Failure"
            - filter:
                query: "@properties.responseStatusCode:*"
              name: "99"
          target: ocsf.status
        - type: string-builder-processor
          name: Add User-Agent header
          enabled: true
          template: "User-Agent"
          target: ocsf.http_header.name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `http.useragent` to `ocsf.http_header.value`
          enabled: true
          sources:
            - http.useragent
          sourceType: attribute
          target: ocsf.http_header.value
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: array-processor
          name: Move attributes into http_headers array
          enabled: true
          operation:
            source: ocsf.http_header
            target: ocsf.http_request.http_headers
            preserveSource: false
            type: append
    - type: pipeline
      name: OCSF post transformations
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "*"
      processors:
        - type: attribute-remapper
          name: Map `ocsf.category_uid` to `ocsf.category_uid`
          enabled: true
          sources:
            - ocsf.category_uid
          sourceType: attribute
          target: ocsf.category_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.class_uid` to `ocsf.class_uid`
          enabled: true
          sources:
            - ocsf.class_uid
          sourceType: attribute
          target: ocsf.class_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.severity_id` to `ocsf.severity_id`
          enabled: true
          sources:
            - ocsf.severity_id
          sourceType: attribute
          target: ocsf.severity_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.activity_id` to `ocsf.activity_id`
          enabled: true
          sources:
            - ocsf.activity_id
          sourceType: attribute
          target: ocsf.activity_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false

        - type: arithmetic-processor
          name: Type ID calculator
          enabled: true
          expression: (ocsf.class_uid * 100) + ocsf.activity_id
          target: ocsf.type_uid_float
          replaceMissing: false
        - type: attribute-remapper
          name: Map `ocsf.type_uid_float` to `ocsf.type_uid`
          enabled: true
          sources:
            - ocsf.type_uid_float
          sourceType: attribute
          target: ocsf.type_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.status_id` to `ocsf.status_id`
          enabled: true
          sources:
            - ocsf.status_id
          sourceType: attribute
          target: ocsf.status_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.actor.user.type_id` to `ocsf.actor.user.type_id`
          enabled: true
          sources:
            - ocsf.actor.user.type_id
          sourceType: attribute
          target: ocsf.actor.user.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.user.type_id` to `ocsf.user.type_id`
          enabled: true
          sources:
            - ocsf.user.type_id
          sourceType: attribute
          target: ocsf.user.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
