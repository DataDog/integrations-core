{
    "author_name": "Datadog",
    "description": "## Vault\n\nThis dashboard provides a high-level overview of your Vault clusters so you can monitor its performance and cluster health.\n\n- [Official Vault integration docs](https://docs.datadoghq.com/integrations/vault/)\n- [Monitoring HashiCorp Vault with Datadog](https://www.datadoghq.com/blog/monitor-hashicorp-vault-with-datadog/)\n\nClone this template dashboard to make changes and add your own graph widgets.",
    "layout_type": "ordered",
    "template_variables": [
        {
            "available_values": [],
            "default": "*",
            "name": "vault_cluster",
            "prefix": "vault_cluster"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "api_url",
            "prefix": "api_url"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.auth.client_token",
            "prefix": "@auth.client_token"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.request.client_token_accessor",
            "prefix": "@request.client_token_accessor"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.request.remote_address",
            "prefix": "@request.remote_address"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.auth.display_name",
            "prefix": "@auth.display_name"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.request.mount_type",
            "prefix": "@request.mount_type"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.request.path",
            "prefix": "@request.path"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "logs.request.operation",
            "prefix": "@request.operation"
        }
    ],
    "title": "Vault - Overview (OpenMetricsV2)",
    "widgets": [
        {
            "definition": {
                "banner_img": "/static/images/integration_dashboard/vault_hero_1.png",
                "layout_type": "ordered",
                "show_title": false,
                "title": "About Vault",
                "title_align": "center",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "transparent",
                            "content": "## Vault\n\nThis dashboard provides a high-level overview of your Vault clusters so you can monitor its performance and cluster health.\n\nAudit devices is a logging mechanism that keeps detailed logs of all requests and responses to Vault. Audit Devices are not enabled by default and should be enabled to be used in the Cloud SIEM.\n\n",
                            "font_size": "16",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 6856665905714958,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "transparent",
                            "content": "## Useful Links\n\n- [Monitoring Vault with Datadog \u2197](https://www.datadoghq.com/blog/vault-monitoring-with-datadog/#collect-and-analyze-all-your-vault-logs)\n- [Hashicorp Vault Auditing Documentation \u2197](https://www.vaultproject.io/docs/audit#enabling-disabling-audit-devices)\n- [Datadog Vault Integration Documentation \u2197](https://docs.datadoghq.com/integrations/vault)\n- [Datadog Vault Monitoring 3 Blog Part Series \u2197](https://www.datadoghq.com/blog/monitor-vault-metrics-and-logs)",
                            "font_size": "16",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "center",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 3660302701095376,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 3,
                            "y": 0
                        }
                    }
                ]
            },
            "id": 0,
            "layout": {
                "height": 7,
                "width": 6,
                "x": 0,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Overview",
                "title_align": "center",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "check": "vault.initialized",
                            "group_by": [],
                            "grouping": "cluster",
                            "tags": [
                                "*",
                                "$vault_cluster",
                                "$api_url"
                            ],
                            "title": "Initialized",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "check_status"
                        },
                        "id": 8654869819698766,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "check": "vault.can_connect",
                            "group_by": [],
                            "grouping": "cluster",
                            "tags": [
                                "*",
                                "$api_url"
                            ],
                            "title": "Can connect",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "check_status"
                        },
                        "id": 3808484313637414,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 2,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "check": "vault.unsealed",
                            "group_by": [],
                            "grouping": "cluster",
                            "tags": [
                                "*",
                                "$vault_cluster",
                                "$api_url"
                            ],
                            "title": "Unsealed",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "check_status"
                        },
                        "id": 4875834698546500,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 4,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "color_preference": "text",
                            "count": 50,
                            "display_format": "countsAndList",
                            "hide_zero_counts": true,
                            "last_triggered_format": "relative",
                            "query": "integration:vault",
                            "show_last_triggered": false,
                            "show_priority": false,
                            "show_status": true,
                            "sort": "status,asc",
                            "start": 0,
                            "summary_type": "monitors",
                            "title": "Vault Monitor Overview",
                            "type": "manage_status"
                        },
                        "id": 4300183138545700,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 2
                        }
                    }
                ]
            },
            "id": 1,
            "layout": {
                "height": 7,
                "width": 6,
                "x": 6,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Performance",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Login request count",
                                            "formula": "query5"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query5",
                                            "query": "sum:vault.vault.core.handle.login_request.count{$vault_cluster,$api_url} by {vault_cluster,api_url}.as_count().rollup(sum)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "blue"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Week Before",
                                            "formula": "2 * week_before(query0)"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query0",
                                            "query": "sum:vault.vault.core.handle.login_request.count{$vault_cluster,$api_url}.as_count().fill(null).rollup(sum)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "dotted",
                                        "line_width": "normal",
                                        "palette": "green"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Login requests",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 1049094212182326,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Core Vault handle requests",
                                            "formula": "query4"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query4",
                                            "query": "sum:vault.vault.core.handle.request.count{$vault_cluster,$api_url} by {vault_cluster,api_url}.as_count().rollup(sum)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "blue"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Week Before",
                                            "formula": "2 * week_before(query0)"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query0",
                                            "query": "sum:vault.vault.core.handle.request.count{$vault_cluster,$api_url}.as_count().fill(null).rollup(sum)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "dotted",
                                        "line_width": "normal",
                                        "palette": "green"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Core handle requests",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 5360312192322620,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Login request latency (ms)",
                                            "formula": "ewma_3(query3 / query7)",
                                            "number_format": {
                                                "unit": {
                                                    "label": "ms/request",
                                                    "type": "custom_unit_label"
                                                }
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "sum:vault.vault.core.handle.login_request.sum{$vault_cluster,$api_url} by {vault_cluster,api_url}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query7",
                                            "query": "sum:vault.vault.core.handle.login_request.count{$vault_cluster,$api_url} by {vault_cluster,api_url}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "cool"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Login request latency",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 7910607609141736,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Request latency",
                                            "formula": "query3 / query7",
                                            "number_format": {
                                                "unit": {
                                                    "label": "ms/request",
                                                    "type": "custom_unit_label"
                                                }
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "sum:vault.vault.core.handle.request.sum{$vault_cluster,$api_url} by {api_url,vault_cluster}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query7",
                                            "query": "sum:vault.vault.core.handle.request.count{$vault_cluster,$api_url} by {api_url,vault_cluster}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_reverse": false,
                                        "palette": "cool"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Request latency",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 8930787296591998,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 6,
                            "y": 3
                        }
                    }
                ]
            },
            "id": 2,
            "layout": {
                "height": 7,
                "width": 12,
                "x": 0,
                "y": 7
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Runtime",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Total garbage collector pause time (ns)",
                                            "formula": "query6"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query6",
                                            "query": "avg:vault.vault.runtime.gc.pause_ns.sum{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Garbage collector pause time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 7616603997410384,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Bytes allocated by Vault process",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "max:vault.vault.runtime.alloc.bytes{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                },
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Bytes allocated to Vault",
                                            "formula": "query2"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "max:vault.vault.runtime.sys.bytes{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "orange"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Memory allocation",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 7705172436099530,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 3
                        }
                    }
                ]
            },
            "id": 6,
            "layout": {
                "height": 7,
                "width": 4,
                "x": 0,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Token",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@auth.display_name",
                                                    "limit": 100,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault @auth.token_ttl:>46080 $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Tokens Greater Than 30 Days",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 5455418732509084,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Vault tokens created",
                                            "formula": "query2"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:vault.vault.token.create.count{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Number of tokens created",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 2734285897055334,
                        "layout": {
                            "height": 3,
                            "width": 5,
                            "x": 3,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@auth.token_type",
                                                    "limit": 10,
                                                    "should_exclude_missing": true,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault @request.operation:create $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {},
                            "title": "Token Types Created",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 5882554771659276,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Token Type",
                                            "formula": "query1"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@auth.token_type",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault @request.operation:create $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Token Types Created",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 8757546369667726,
                        "layout": {
                            "height": 3,
                            "width": 5,
                            "x": 3,
                            "y": 3
                        }
                    }
                ]
            },
            "id": 8,
            "layout": {
                "height": 7,
                "width": 8,
                "x": 4,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "vivid_purple",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Logging Overview",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "cell_display_mode": "bar",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "host",
                                                    "limit": 100,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Log activity by host",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 2134188196810948,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "max",
                                "value"
                            ],
                            "legend_layout": "horizontal",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Vault logs",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "env",
                                                    "limit": 10,
                                                    "should_exclude_missing": true,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query2",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "purple"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Log volume by environment",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 1258160608807844,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "purple",
                            "content": "You can gain an even deeper understanding of Vault\u2019s activity by collecting and analyzing logs from your Vault clusters. Vault produces two types of logs: server logs and audit logs. Server logs record all activities that occur on each server, and they are the first place to look when troubleshooting an error. Log entries include a timestamp, log level, log source (e.g., core, storage), and log message. They are also grouped by pattern for ease of overview.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "bottom",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 5,
                        "layout": {
                            "height": 1,
                            "width": 12,
                            "x": 0,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "matches",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "volume",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "service",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "message",
                                            "width": "auto"
                                        }
                                    ],
                                    "query": {
                                        "data_source": "logs_pattern_stream",
                                        "group_by": [
                                            {
                                                "facet": "service"
                                            }
                                        ],
                                        "indexes": [],
                                        "query_string": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                    },
                                    "response_format": "event_list"
                                }
                            ],
                            "title": "All logs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "list_stream"
                        },
                        "id": 2115911637253564,
                        "layout": {
                            "height": 5,
                            "width": 12,
                            "x": 0,
                            "y": 5
                        }
                    }
                ]
            },
            "id": 3,
            "layout": {
                "height": 11,
                "width": 12,
                "x": 0,
                "y": 21
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Activity",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.remote_address",
                                                    "limit": 25,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 25,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Top Vault Requests by IP",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 4254548397052216,
                        "layout": {
                            "height": 4,
                            "width": 2,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.remote_address",
                                                    "limit": 100,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "asc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Requests by Rare IPs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 1776539419867568,
                        "layout": {
                            "height": 4,
                            "width": 2,
                            "x": 2,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.mount_type",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {},
                            "title": "Requests by mount type",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 3560343377470418,
                        "layout": {
                            "height": 4,
                            "width": 2,
                            "x": 4,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.client_token_accessor",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Top Client Token Accessors",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 4418354492646266,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Vault Log Volume",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 291938895140890,
                        "layout": {
                            "height": 1,
                            "width": 3,
                            "x": 9,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.operation",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Vault Operations",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 567235502020146,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 9,
                            "y": 1
                        }
                    }
                ]
            },
            "id": 4,
            "layout": {
                "height": 5,
                "width": 12,
                "x": 0,
                "y": 32
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Storage Backend",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Consul GET duration",
                                            "formula": "query3"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "avg:vault.vault.consul.get.sum{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "warm"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Consul GET duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 6447626950267332,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Consul list duration (ms)",
                                            "formula": "query3"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "avg:vault.vault.consul.list.sum{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "warm"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Consul LIST duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 8432096213458172,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 3,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Consul PUT duration (ms)",
                                            "formula": "query3"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "avg:vault.vault.consul.put.sum{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "warm"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Consul PUT duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 7525508033147558,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Consul DELETE duration",
                                            "formula": "query3"
                                        }
                                    ],
                                    "on_right_yaxis": false,
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "avg:vault.vault.consul.delete.sum{$vault_cluster,$api_url,$logs.auth.client_token,$logs.request.client_token_accessor,$logs.request.remote_address,$logs.auth.display_name,$logs.request.mount_type,$logs.request.path,$logs.request.operation}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "warm"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Consul DELETE duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 6685472247312078,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 9,
                            "y": 0
                        }
                    }
                ]
            },
            "id": 7,
            "layout": {
                "height": 4,
                "width": 12,
                "x": 0,
                "y": 37
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Client Token Activity",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "blue",
                            "content": "Use this section to quickly investigate a vault token by looking up a Token Accessor. A Token Accessor is created and returned with every token that is created. The token accessor value can be used to look up a token's properties, revoke a token, renew a taken, and look up a token's capabilities on a path.\n\nYou can click on a client token in the Top Client Token Accessors widget and click on `Set $request.client_token_accessor`. This will update the widgets in the Client Token Investigator for all information related to the Client Token Accessor that was set in the template variables. \n\nA Client Token Accessor looks like this: `hmac-sha256:97ea0893c72ddf1b9fe3f2f477526ff06e89cceff7a74ea7016d2e3e9b25a804`",
                            "font_size": "12",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 4622110032256590,
                        "layout": {
                            "height": 2,
                            "width": 9,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.client_token_accessor",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Client token by accessor",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 8258230789541618,
                        "layout": {
                            "height": 5,
                            "width": 3,
                            "x": 9,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.remote_address",
                                                    "limit": 100,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "asc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Client token by IPs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 7321836322263742,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Requests by client token accessor",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.client_token_accessor",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "cool"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Historical activity by accessor",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 5092863776380150,
                        "layout": {
                            "height": 3,
                            "width": 5,
                            "x": 4,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "cell_display_mode": "bar",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.operation",
                                                    "limit": 10,
                                                    "should_exclude_missing": true,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Operations by client token",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 5099313152151602,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 0,
                            "y": 5
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@auth.display_name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Top users by client token accessor ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 1645099613316488,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 3,
                            "y": 5
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "metric": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.mount_type",
                                                    "limit": 50,
                                                    "should_exclude_missing": true,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                },
                                                {
                                                    "facet": "@request.client_token_accessor",
                                                    "limit": 10,
                                                    "should_exclude_missing": true,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "metric": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {},
                            "title": "Mount types by client token",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 4800477545973282,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 6,
                            "y": 5
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@request.path",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Request paths by client token",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 3605930163980802,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 9,
                            "y": 5
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "matches",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "volume",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "service",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "message",
                                            "width": "auto"
                                        }
                                    ],
                                    "query": {
                                        "data_source": "logs_pattern_stream",
                                        "group_by": [
                                            {
                                                "facet": "service"
                                            }
                                        ],
                                        "indexes": [],
                                        "query_string": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster "
                                    },
                                    "response_format": "event_list"
                                }
                            ],
                            "title": "All logs by client token",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "list_stream"
                        },
                        "id": 7109789718928374,
                        "layout": {
                            "height": 5,
                            "width": 12,
                            "x": 0,
                            "y": 9
                        }
                    }
                ]
            },
            "id": 10,
            "layout": {
                "height": 15,
                "width": 12,
                "x": 0,
                "y": 41
            }
        },
        {
            "definition": {
                "background_color": "vivid_purple",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Datadog Security Monitoring",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "gray",
                            "content": "Datadog Security Monitoring analyzes HashiCorp Vault audit logs to detect threats to your environment in real time. If you aren't currently using  [Datadog Security Monitoring](https://app.datadoghq.com/security), please consider signing up. ",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 5944879021383970,
                        "layout": {
                            "height": 1,
                            "width": 12,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=source:vault status:critical"
                                }
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#bc303c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:critical source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "CRITICALs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 6255926866858486,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 0,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=source:vault status:high"
                                }
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#d33043",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:high source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "HIGHs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 2600798289917504,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 2,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=@workflow.rule.name:{{@workflow.rule.name.value}}"
                                }
                            ],
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "palette": "white_on_red",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Security Signals",
                            "type": "toplist"
                        },
                        "id": 721282318874290,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 4,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=@workflow.rule.name:{{@workflow.rule.name.value}}"
                                }
                            ],
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "palette": "white_on_red",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                                {
                                                    "facet": "@evt.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "title": "Security Signals by Events",
                            "type": "toplist"
                        },
                        "id": 7444326215896084,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 8,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?source:vault status:medium"
                                }
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e5a21c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:medium source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "MEDIUMs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 5260559479014138,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=source:vault status:low"
                                }
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#ffb52b",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:vault status:low $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "LOWs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 6029228368019808,
                        "layout": {
                            "height": 1,
                            "width": 2,
                            "x": 2,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                                {
                                    "label": "View related Security Signals",
                                    "link": "/security?query=source:vault status:info"
                                }
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#84c1e0",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:info source:vault $logs.auth.client_token $logs.request.client_token_accessor $logs.request.remote_address $logs.auth.display_name $logs.request.mount_type $logs.request.path $logs.request.operation $api_url $vault_cluster"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "INFOs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 8879352798849398,
                        "layout": {
                            "height": 1,
                            "width": 2,
                            "x": 2,
                            "y": 4
                        }
                    }
                ]
            },
            "id": 9,
            "layout": {
                "height": 6,
                "is_column_break": true,
                "width": 12,
                "x": 0,
                "y": 56
            }
        }
    ]
}