id: "cofense-triage"
tests:
 -
  sample: |-
    {
      "relationships" : {
        "owner" : {
          "links" : {
            "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/owner",
            "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/owner"
          }
        },
        "reports" : {
          "links" : {
            "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/reports",
            "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/reports"
          }
        },
        "comments" : {
          "links" : {
            "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/comments",
            "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/comments"
          }
        }
      },
      "links" : {
        "self" : "https://triage.example.com/api/public/v2/threat_indicators/17"
      },
      "attributes" : {
        "threat_level" : "Malicious",
        "threat_source" : "Triage-UI",
        "updated_at" : "2020-10-30T20:58:55.383Z",
        "threat_value" : "example.com",
        "threat_type" : "Hostname",
        "created_at" : "2020-10-30T20:58:55.377Z"
      },
      "id" : "17",
      "type" : "threat_indicators"
    }
  service: "threat-indicators"
  result:
    custom:
      attributes:
        created_at: "2020-10-30T20:58:55.377Z"
        threat_level: "Malicious"
        threat_source: "Triage-UI"
        threat_type: "Hostname"
        threat_value: "example.com"
        updated_at: "2020-10-30T20:58:55.383Z"
      id: "17"
      links:
        self: "https://triage.example.com/api/public/v2/threat_indicators/17"
      relationships:
        comments:
          links:
            related: "https://triage.example.com/api/public/v2/threat_indicators/17/comments"
            self: "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/comments"
        owner:
          links:
            related: "https://triage.example.com/api/public/v2/threat_indicators/17/owner"
            self: "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/owner"
        reports:
          links:
            related: "https://triage.example.com/api/public/v2/threat_indicators/17/reports"
            self: "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/reports"
      type: "threat_indicators"
    message: |-
      {
        "relationships" : {
          "owner" : {
            "links" : {
              "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/owner",
              "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/owner"
            }
          },
          "reports" : {
            "links" : {
              "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/reports",
              "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/reports"
            }
          },
          "comments" : {
            "links" : {
              "related" : "https://triage.example.com/api/public/v2/threat_indicators/17/comments",
              "self" : "https://triage.example.com/api/public/v2/threat_indicators/17/relationships/comments"
            }
          }
        },
        "links" : {
          "self" : "https://triage.example.com/api/public/v2/threat_indicators/17"
        },
        "attributes" : {
          "threat_level" : "Malicious",
          "threat_source" : "Triage-UI",
          "updated_at" : "2020-10-30T20:58:55.383Z",
          "threat_value" : "example.com",
          "threat_type" : "Hostname",
          "created_at" : "2020-10-30T20:58:55.377Z"
        },
        "id" : "17",
        "type" : "threat_indicators"
      }
    service: "threat-indicators"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1604091535383
 -
  sample: '{"id":"123539","type":"reports","links":{"self":"https://triage.example.com/api/public/v2/reports/123539"},"attributes":{"location":"Inbox","risk_score":85,"from_address":"user@example.com","subject":"Cofense:
      Initial UltiPro account activation email for new
      hires","received_at":"2018-05-07T17:44:33.000Z","reported_at":"2018-08-03T16:29:43.000Z","raw_headers":"raw_headers","text_body":"text_body","html_body":"html_body","md5":"02dc1a3fdb2d090e5cb4101123456789","sha256":"d7374941971c1d282afccddbbc7b1f8577d190ea52f59d17b9a9ca7123456789","match_priority":2,"attachment_details":[{"id":81873,"md5":"c38bfbd7a7eecc1943f0368123456789","sha256":"034fdb050c475dd01cefec6730672f4950433a14c2edfa8a4517ad1123456789","filename":"image001.jpg","parent_id":null,"payload_id":16131,"size_in_bytes":27745},{"id":81874,"md5":"bddc253eb03f31a10e8c70d123456789","sha256":"a8f972d88ea73dee703d0a9c77fa2081150275cf251621a5c8f4b51123456789","filename":"image002.jpg","parent_id":null,"payload_id":16132,"size_in_bytes":30352},{"id":81875,"md5":"faf8647b390ffadc84c548b123456789","sha256":"31a575c971b683cede7c6af9b60df636c8227ab5accac6b20239cd9123456789","filename":"image003.jpg","parent_id":null,"payload_id":16133,"size_in_bytes":125246}],"attachments_count":3,"comments_count":0,"rules_count":1,"urls":[{"id":61425,"raw":"https://gateway.example.com/"},{"id":204330,"raw":"http://portal.cofense.com=20"},{"id":204331,"raw":"http://portal.cofense.com"}],"urls_count":3,"tags":[],"categorization_tags":[],"aisf_rule_score":8.5,"aisf_bayes_score":2,"aisf_score_threshold":5,"aisf_bayes_last_submitted_as":"unsubmitted","aisf_is_spam":"True","aisf_learned_at":null,"aisf_forgot_at":null,"aisf_scored_at":"2025-01-15T12:00:03.013Z","aisf_error":null,"aisf_error_response_message":null,"aisf_errored_at":null,"first_processed_at":null,"processed_at":null,"created_at":"2025-01-11T12:44:14.000Z","updated_at":"2025-01-15T12:00:03.489Z","rule_details":[{"id":2618,"name":"Test","priority":2,"source_rule_type":"local"}]},"relationships":{"assignee":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/assignee","related":"https://triage.example.com/api/public/v2/reports/123539/assignee"},"data":null},"category":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/category","related":"https://triage.example.com/api/public/v2/reports/123539/category"},"data":null},"cluster":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/cluster","related":"https://triage.example.com/api/public/v2/reports/123539/cluster"},"data":{"type":"clusters","id":"15848"}},"processed_by":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/processed_by","related":"https://triage.example.com/api/public/v2/reports/123539/processed_by"},"data":null},"reporter":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/reporter","related":"https://triage.example.com/api/public/v2/reports/123539/reporter"},"data":{"type":"reporters","id":"1215"}},"attachment_payloads":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/attachment_payloads","related":"https://triage.example.com/api/public/v2/reports/123539/attachment_payloads"}},"attachments":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/attachments","related":"https://triage.example.com/api/public/v2/reports/123539/attachments"}},"cofense_intelligence_indicators":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/cofense_intelligence_indicators","related":"https://triage.example.com/api/public/v2/reports/123539/cofense_intelligence_indicators"}},"domains":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/domains","related":"https://triage.example.com/api/public/v2/reports/123539/domains"}},"headers":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/headers","related":"https://triage.example.com/api/public/v2/reports/123539/headers"}},"hostnames":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/hostnames","related":"https://triage.example.com/api/public/v2/reports/123539/hostnames"}},"urls":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/urls","related":"https://triage.example.com/api/public/v2/reports/123539/urls"}},"rules":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/rules","related":"https://triage.example.com/api/public/v2/reports/123539/rules"}},"threat_indicators":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/threat_indicators","related":"https://triage.example.com/api/public/v2/reports/123539/threat_indicators"}},"comments":{"links":{"self":"https://triage.example.com/api/public/v2/reports/123539/relationships/comments","related":"https://triage.example.com/api/public/v2/reports/123539/comments"}}},"meta":{"risk_score_summary":{"integrations":0,"vip":0,"reporter":1,"rules":2}}}'
  result: null