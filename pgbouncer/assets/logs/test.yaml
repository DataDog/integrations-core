id: "pgbouncer"
tests:
 -
  sample: "2019-06-13 11:38:29.250 12 LOG Stats: 0 xacts/s, 0 queries/s, in 0 B/s, out 0 B/s, xact 0 us, query 0 us wait time 52 us"
  result:
    custom:
      date: 1560425909250
      db:
        query:
          rate: 0.0
          us: 0.0
        read:
          rate: 0.0
        wait_time: 52.0
        write:
          rate: 0.0
        xact:
          rate: 0.0
          us: 0.0
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:38:29.250 12 LOG Stats: 0 xacts/s, 0 queries/s, in 0 B/s, out 0 B/s, xact 0 us, query 0 us wait time 52 us"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425909250
 -
  sample: "2019-06-13 11:38:29.250 UTC [12] LOG Stats: 0 xacts/s, 0 queries/s, in 0 B/s, out 0 B/s, xact 0 us, query 0 us wait time 52 us"
  result:
    custom:
      date: 1560425909250
      db:
        query:
          rate: 0.0
          us: 0.0
        read:
          rate: 0.0
        wait_time: 52.0
        write:
          rate: 0.0
        xact:
          rate: 0.0
          us: 0.0
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:38:29.250 UTC [12] LOG Stats: 0 xacts/s, 0 queries/s, in 0 B/s, out 0 B/s, xact 0 us, query 0 us wait time 52 us"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425909250
 -
  sample: "2019-06-13 11:37:31.382 12 LOG C-0xa845e0: datadog_test/postgres@172.25.0.1:34884 login attempt: db=datadog_test user=postgres tls=no"
  result:
    custom:
      date: 1560425851382
      db:
        instance: "datadog_test"
        tls: "no"
        user: "postgres"
      error:
        message: "login attempt"
      level: "INFO"
      logger:
        thread_id: 12
      network:
        destination:
          ip: "172.25.0.1"
          port: 34884
    message: "2019-06-13 11:37:31.382 12 LOG C-0xa845e0: datadog_test/postgres@172.25.0.1:34884 login attempt: db=datadog_test user=postgres tls=no"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425851382
 -
  sample: "2019-06-13 11:37:31.382 UTC [12] LOG C-0xa845e0: datadog_test/postgres@172.25.0.1:34884 login attempt: db=datadog_test user=postgres tls=no"
  result:
    custom:
      date: 1560425851382
      db:
        instance: "datadog_test"
        tls: "no"
        user: "postgres"
      error:
        message: "login attempt"
      level: "INFO"
      logger:
        thread_id: 12
      network:
        destination:
          ip: "172.25.0.1"
          port: 34884
    message: "2019-06-13 11:37:31.382 UTC [12] LOG C-0xa845e0: datadog_test/postgres@172.25.0.1:34884 login attempt: db=datadog_test user=postgres tls=no"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425851382
 -
  sample: "2019-06-13 12:55:18.603 13049 LOG C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42806 login failed: db=postgres user=root"
  result:
    custom:
      date: 1560430518603
      db:
        instance: "postgres"
        user: "root"
      error:
        message: "login failed"
      level: "INFO"
      logger:
        thread_id: 13049
      network:
        destination:
          ip: "127.0.0.1"
          port: 42806
    message: "2019-06-13 12:55:18.603 13049 LOG C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42806 login failed: db=postgres user=root"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560430518603
 -
  sample: "2019-06-13 12:55:18.603 UTC [13049] LOG C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42806 login failed: db=postgres user=root"
  result:
    custom:
      date: 1560430518603
      db:
        instance: "postgres"
        user: "root"
      error:
        message: "login failed"
      level: "INFO"
      logger:
        thread_id: 13049
      network:
        destination:
          ip: "127.0.0.1"
          port: 42806
    message: "2019-06-13 12:55:18.603 UTC [13049] LOG C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42806 login failed: db=postgres user=root"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560430518603
 -
  sample: "2019-06-13 12:54:30.775 13049 WARNING C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42798 Pooler Error: No such database: postgres"
  result:
    custom:
      date: 1560430470775
      db:
        instance: "(nodb)"
        user: "(nouser)"
      description: "Pooler Error: No such database: postgres"
      level: "WARNING"
      logger:
        thread_id: 13049
      network:
        destination:
          ip: "127.0.0.1"
          port: 42798
    message: "2019-06-13 12:54:30.775 13049 WARNING C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42798 Pooler Error: No such database: postgres"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560430470775
 -
  sample: "2019-06-13 12:54:30.775 UTC [13049] WARNING C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42798 Pooler Error: No such database: postgres"
  result:
    custom:
      date: 1560430470775
      db:
        instance: "(nodb)"
        user: "(nouser)"
      description: "Pooler Error: No such database: postgres"
      level: "WARNING"
      logger:
        thread_id: 13049
      network:
        destination:
          ip: "127.0.0.1"
          port: 42798
    message: "2019-06-13 12:54:30.775 UTC [13049] WARNING C-0x5562e9990540: (nodb)/(nouser)@127.0.0.1:42798 Pooler Error: No such database: postgres"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560430470775
 -
  sample: "2019-06-13 13:04:01.893 47 ERROR fill_defaults fail"
  result:
    custom:
      date: 1560431041893
      description: "fill_defaults fail"
      level: "ERROR"
      logger:
        thread_id: 47
    message: "2019-06-13 13:04:01.893 47 ERROR fill_defaults fail"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560431041893
 -
  sample: "2019-06-13 13:04:01.893 UTC [47] ERROR fill_defaults fail"
  result:
    custom:
      date: 1560431041893
      description: "fill_defaults fail"
      level: "ERROR"
      logger:
        thread_id: 47
    message: "2019-06-13 13:04:01.893 UTC [47] ERROR fill_defaults fail"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560431041893
 -
  sample: "2019-06-13 11:37:29.314 12 LOG process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
  result:
    custom:
      date: 1560425849314
      description: "process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:37:29.314 12 LOG process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425849314
 -
  sample: "2019-06-13 11:37:29.314 UTC [12] LOG process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
  result:
    custom:
      date: 1560425849314
      description: "process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:37:29.314 UTC [12] LOG process up: pgbouncer 1.8.1, libevent 2.0.21-stable (epoll), adns: c-ares 1.10.0, tls: OpenSSL 1.0.2g  1 Mar 2016"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425849314
 -
  sample: "2019-06-13 11:37:29.313 12 LOG listening on 0.0.0.0:6432"
  result:
    custom:
      date: 1560425849313
      description: "listening on 0.0.0.0:6432"
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:37:29.313 12 LOG listening on 0.0.0.0:6432"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425849313
 -
  sample: "2019-06-13 11:37:29.313 UTC [12] LOG listening on 0.0.0.0:6432"
  result:
    custom:
      date: 1560425849313
      description: "listening on 0.0.0.0:6432"
      level: "INFO"
      logger:
        thread_id: 12
    message: "2019-06-13 11:37:29.313 UTC [12] LOG listening on 0.0.0.0:6432"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425849313
 -
  sample: "2019-06-13 11:37:31.382 12 LOG C-0xa845e0: (nodb)/(nouser)@172.25.0.1:34884 registered new auto-database: db = datadog_test"
  result:
    custom:
      date: 1560425851382
      db:
        instance: "datadog_test"
        user: "(nouser)"
      error:
        message: "registered new auto-database"
      level: "INFO"
      logger:
        thread_id: 12
      network:
        destination:
          ip: "172.25.0.1"
          port: 34884
    message: "2019-06-13 11:37:31.382 12 LOG C-0xa845e0: (nodb)/(nouser)@172.25.0.1:34884 registered new auto-database: db = datadog_test"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425851382
 -
  sample: "2019-06-13 11:37:31.382 UTC [12] LOG C-0xa845e0: (nodb)/(nouser)@172.25.0.1:34884 registered new auto-database: db = datadog_test"
  result:
    custom:
      date: 1560425851382
      db:
        instance: "datadog_test"
        user: "(nouser)"
      error:
        message: "registered new auto-database"
      level: "INFO"
      logger:
        thread_id: 12
      network:
        destination:
          ip: "172.25.0.1"
          port: 34884
    message: "2019-06-13 11:37:31.382 UTC [12] LOG C-0xa845e0: (nodb)/(nouser)@172.25.0.1:34884 registered new auto-database: db = datadog_test"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1560425851382

