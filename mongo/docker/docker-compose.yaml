version: '3'

services:
  mongo:
    image: mongo:latest
    container_name: mongo_latest
    volumes:
      - ./restaurants.json:/docker-entrypoint-initdb.d/restaurants.json
      - ./employees.json:/docker-entrypoint-initdb.d/employees.json
      - ./provision/import_dummy_data.sh:/docker-entrypoint-initdb.d/10_import_dummy_data.sh
      - ./mongo.conf:/etc/mongo.conf
    command: ["mongod", "--config", "/etc/mongo.conf"]
    networks:
      - mongodb

  agent:
    image: datadog/agent-dev:master
    container_name: agent_mongo
    environment:
      - DD_API_KEY=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
    volumes:
      - ./mongo.yaml:/etc/datadog-agent/conf.d/mongo.d/mongo.yaml
      - ../:/home/mongo
    networks:
      - mongodb

networks:
  mongodb: {}
