id: forescout
tests:
 -
  sample: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Port bite. Source: 10.10.10.10. Destination: 20.20.20.20:139"
  result:
    custom:
      additional_details: "Source: 10.10.10.10. Destination: 20.20.20.20:139"
      appliance: "ddsfs"
      event_type_identifier: "Port bite"
      evt:
        name: "bite-events"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
        destination:
          geoip: {}
          ip: "20.20.20.20"
          port: 139
      service: "threat-protection"
      timestamp: 22851841000
    message: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Port bite. Source: 10.10.10.10. Destination: 20.20.20.20:139"
    service: "threat-protection"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22851841000
 -
  sample: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Scan event. Source: 10.10.10.10."
  result:
    custom:
      additional_details: "Source: 10.10.10.10."
      appliance: "ddsfs"
      event_type_identifier: "Scan event"
      evt:
        name: "scan-events"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "threat-protection"
      timestamp: 22851841000
    message: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Scan event. Source: 10.10.10.10."
    service: "threat-protection"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22851841000
 -
  sample: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Manual event. Source: 10.10.10.10"
  result:
    custom:
      additional_details: "Source: 10.10.10.10"
      appliance: "ddsfs"
      event_type_identifier: "Manual event"
      evt:
        name: "lockdown-events"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "threat-protection"
      timestamp: 22851841000
    message: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Manual event. Source: 10.10.10.10"
    service: "threat-protection"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22851841000
 -
  sample: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Block Event: Host: 10.10.10.10, Target: 20.20.20.20, Time: 1469975529, Service: 23/TCP, Is Virtual Firewall blocking rule: false, Reason: Port block"
  result:
    custom:
      additional_details: "Host: 10.10.10.10, Target: 20.20.20.20, Time: 1469975529, Service: 23/TCP, Is Virtual Firewall blocking rule: false, Reason: Port block"
      appliance: "ddsfs"
      epoch_time: 1.469975529E9
      event_type_identifier: "Block Event"
      evt:
        name: "block-events"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
        destination:
          geoip: {}
          ip: "20.20.20.20"
          port: 23
      protocol: "TCP"
      reason: "Port block"
      service: "threat-protection"
      timestamp: 22851841000
      virtual_firewall_blocking_rule: false
    message: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Block Event: Host: 10.10.10.10, Target: 20.20.20.20, Time: 1469975529, Service: 23/TCP, Is Virtual Firewall blocking rule: false, Reason: Port block"
    service: "threat-protection"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22851841000
 -
  sample: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Mail Infection Attempt. Source: 10.10.10.10. Details: mail_from=sender@from.com,mail_to=recipient@to.com,mail_subject=Check out this report"
  result:
    custom:
      additional_details: "Source: 10.10.10.10. Details: mail_from=sender@from.com,mail_to=recipient@to.com,mail_subject=Check out this report"
      appliance: "ddsfs"
      event_type_identifier: "Mail Infection Attempt"
      evt:
        name: "email-worm-events"
      identifier: "forescout-syslog"
      mail_subject: "Check"
      mail_to: "recipient@to.com"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "threat-protection"
      timestamp: 22851841000
      usr:
        email: "sender@from.com"
    message: "<165>Sep 22 11:44:01 ddsfs forescout-syslog[2895]: Mail Infection Attempt. Source: 10.10.10.10. Details: mail_from=sender@from.com,mail_to=recipient@to.com,mail_subject=Check out this report"
    service: "threat-protection"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22851841000
 -
  sample: "<165>Sep 23 15:51:32 ddsfs forescout-syslog[2992]: Log: License alert. Details: The ForeScout eyeControl license capacity was exceeded.. Severity: 4"
  result:
    custom:
      activity_type: "License alert"
      appliance: "ddsfs"
      details: "The ForeScout eyeControl license capacity was exceeded."
      event_type_identifier: "Log"
      evt:
        name: "system-log-events"
      identifier: "forescout-syslog"
      service: "system-logs"
      severity: 4
      status: "Warning"
      timestamp: 22953092000
    message: "License alert. Details: The ForeScout eyeControl license capacity was exceeded.. Severity: 4"
    service: "system-logs"
    status: "warn"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22953092000
 -
  sample: "<165>Sep 23 17:53:27 ddsfs forescout-syslog[2992]: Log: Login success by admin@10.10.10.10. Details: User admin logged in from 10.10.10.10. Severity: 6"
  result:
    custom:
      activity_type: "Login"
      appliance: "ddsfs"
      details: "User admin logged in from 10.10.10.10"
      event_type_identifier: "Log"
      evt:
        name: "system-log-events"
        outcome: "success"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "system-logs"
      severity: 6
      status: "Informational"
      timestamp: 22960407000
      usr:
        name: "by admin"
    message: "Login success by admin@10.10.10.10. Details: User admin logged in from 10.10.10.10. Severity: 6"
    service: "system-logs"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22960407000
 -
  sample: "<165>Sep 25 14:48:09 ddsfs forescout-syslog[2544404]: Log: Login failed demo user@10.10.10.10. Details: User abhi failed to login from 10.10.10.10. Severity: 4"
  result:
    custom:
      activity_type: "Login"
      appliance: "ddsfs"
      details: "User abhi failed to login from 10.10.10.10"
      event_type_identifier: "Log"
      evt:
        name: "system-log-events"
        outcome: "failed"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "system-logs"
      severity: 4
      status: "Warning"
      timestamp: 23122089000
      usr:
        name: "demo user"
    message: "Login failed demo user@10.10.10.10. Details: User abhi failed to login from 10.10.10.10. Severity: 4"
    service: "system-logs"
    status: "warn"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 23122089000
 -
  sample: "<165>Sep 23 16:41:22 ddsfs forescout-syslog[2992]: Log: Logout by admin@10.10.10.10. Details: User admin@10.10.10.10 logged out. Severity: 6"
  result:
    custom:
      activity_type: "Logout"
      appliance: "ddsfs"
      details: "User admin@10.10.10.10 logged out"
      event_type_identifier: "Log"
      evt:
        name: "system-log-events"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "system-logs"
      severity: 6
      status: "Informational"
      timestamp: 22956082000
      usr:
        name: "admin"
    message: "Logout by admin@10.10.10.10. Details: User admin@10.10.10.10 logged out. Severity: 6"
    service: "system-logs"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22956082000
 -
  sample: "<165>Sep 24 01:07:58 ddsfs forescout-syslog[2992]: System statistics: CPU usage: 17%, Available memory : 12237100 KB, Used memory: 23337288 KB, Available swap: 16777208 KB, Used swap: 11467492 KB"
  result:
    custom:
      appliance: "ddsfs"
      available_memory: 1.22371E7
      available_swap: 1.6777208E7
      cpu_usage: 17.0
      event_type_identifier: "System statistics"
      evt:
        name: "system-status-messages"
      identifier: "forescout-syslog"
      service: "system-logs"
      timestamp: 22986478000
      used_memory: 2.3337288E7
      used_swap: 1.1467492E7
    message: "CPU usage: 17%, Available memory : 12237100 KB, Used memory: 23337288 KB, Available swap: 16777208 KB, Used swap: 11467492 KB"
    service: "system-logs"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22986478000
 -
  sample: "<165>Sep 24 11:28:04 ddsfs forescout-syslog[2992]: Application status: CounterACT Appliance is running;Connected clients: admin@10.10.10.10;EM connection status: N/A (standalone appliance);Assigned hosts: 144;Engine status: Disabled ;Installed Plugins: Wireless, FireEye HX, Web API, Visibility Content Plugin, NBT Scanner, Security Policy Templates, Centralized Network Controller, Advanced Compliance, IOC Scanner, Cloud Uploader, VMware NSX, Technical Support, Switch Content, External Classifier, Data Publisher, Advanced Tools, DNS Enforce, Azure, IoT Posture Assessment Engine, CEF, Device Profile Library, Connect, Device Classification Engine, Data Exchange (DEX), NIC Vendor DB, Admin API, Web Client, Windows Applications, Flow Analyzer, RADIUS, Linux, Switch, pxGrid, Network Controller, Passive Sensor, OS X, Microsoft SCCM/ECM, DPI, Cloud Classification Gateway, Flow Collector, DNS Query Extension, IoT Posture Assessment Library, HPS Inspection Engine, DHCP Classifier, Windows Vulnerability DB, Active Probing Plugin, Rogue Device, Network Controller Content, HPS Agent Manager, VPN, FireEye NX, Dashboards, AWS, Data Receiver, Forescout Infrastructure Update Pack, Reports, Packet Engine, VMware vSphere, Device Data Publisher, Syslog, User Directory, Hardware Inventory, Cloud Data Exchange, DNS Client;;"
  result:
    custom:
      appliance: "ddsfs"
      application_status: "CounterACT Appliance is running"
      assigned_hosts: 144.0
      em_connection_status: "N/A (standalone appliance)"
      engine_status: "Disabled"
      event_type_identifier: "Application status"
      evt:
        name: "packet-engine-status-messages"
      hostname: "10.10.10.10"
      identifier: "forescout-syslog"
      installed_plugins:
       - "Wireless"
       - "FireEye HX"
       - "Web API"
       - "Visibility Content Plugin"
       - "NBT Scanner"
       - "Security Policy Templates"
       - "Centralized Network Controller"
       - "Advanced Compliance"
       - "IOC Scanner"
       - "Cloud Uploader"
       - "VMware NSX"
       - "Technical Support"
       - "Switch Content"
       - "External Classifier"
       - "Data Publisher"
       - "Advanced Tools"
       - "DNS Enforce"
       - "Azure"
       - "IoT Posture Assessment Engine"
       - "CEF"
       - "Device Profile Library"
       - "Connect"
       - "Device Classification Engine"
       - "Data Exchange (DEX)"
       - "NIC Vendor DB"
       - "Admin API"
       - "Web Client"
       - "Windows Applications"
       - "Flow Analyzer"
       - "RADIUS"
       - "Linux"
       - "Switch"
       - "pxGrid"
       - "Network Controller"
       - "Passive Sensor"
       - "OS X"
       - "Microsoft SCCM/ECM"
       - "DPI"
       - "Cloud Classification Gateway"
       - "Flow Collector"
       - "DNS Query Extension"
       - "IoT Posture Assessment Library"
       - "HPS Inspection Engine"
       - "DHCP Classifier"
       - "Windows Vulnerability DB"
       - "Active Probing Plugin"
       - "Rogue Device"
       - "Network Controller Content"
       - "HPS Agent Manager"
       - "VPN"
       - "FireEye NX"
       - "Dashboards"
       - "AWS"
       - "Data Receiver"
       - "Forescout Infrastructure Update Pack"
       - "Reports"
       - "Packet Engine"
       - "VMware vSphere"
       - "Device Data Publisher"
       - "Syslog"
       - "User Directory"
       - "Hardware Inventory"
       - "Cloud Data Exchange"
       - "DNS Client"
      service: "system-logs"
      timestamp: 23023684000
      usr:
        name: "admin"
    message: "CounterACT Appliance is running;Connected clients: admin@10.10.10.10;EM connection status: N/A (standalone appliance);Assigned hosts: 144;Engine status: Disabled ;Installed Plugins: Wireless, FireEye HX, Web API, Visibility Content Plugin, NBT Scanner, Security Policy Templates, Centralized Network Controller, Advanced Compliance, IOC Scanner, Cloud Uploader, VMware NSX, Technical Support, Switch Content, External Classifier, Data Publisher, Advanced Tools, DNS Enforce, Azure, IoT Posture Assessment Engine, CEF, Device Profile Library, Connect, Device Classification Engine, Data Exchange (DEX), NIC Vendor DB, Admin API, Web Client, Windows Applications, Flow Analyzer, RADIUS, Linux, Switch, pxGrid, Network Controller, Passive Sensor, OS X, Microsoft SCCM/ECM, DPI, Cloud Classification Gateway, Flow Collector, DNS Query Extension, IoT Posture Assessment Library, HPS Inspection Engine, DHCP Classifier, Windows Vulnerability DB, Active Probing Plugin, Rogue Device, Network Controller Content, HPS Agent Manager, VPN, FireEye NX, Dashboards, AWS, Data Receiver, Forescout Infrastructure Update Pack, Reports, Packet Engine, VMware vSphere, Device Data Publisher, Syslog, User Directory, Hardware Inventory, Cloud Data Exchange, DNS Client;;"
    service: "system-logs"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 23023684000
 -
  sample: "<165>Sep 19 10:28:46 ddsfs forescout-syslog[2887]: User admin session 4723885926247600395 changed License Management. Details: Failed to update license file on CounterACT Appliance 10.10.10.10. <EOL> Error:<EOL> The file format is invalid. The file is not a valid license file."
  result:
    custom:
      action: "update"
      appliance: "ddsfs"
      entity_name: "CounterACT Appliance"
      error: "The file format is invalid. The file is not a valid license file."
      evt:
        name: "user-operations"
        outcome: "failed"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "user-operations"
      session_id: "4723885926247600395"
      target: "License Management"
      timestamp: 22588126000
      usr:
        name: "admin"
    message: "User admin session 4723885926247600395 changed License Management. Details: Failed to update license file on CounterACT Appliance 10.10.10.10. <EOL> Error:<EOL> The file format is invalid. The file is not a valid license file."
    service: "user-operations"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22588126000
 -
  sample: "<165>Sep 19 10:10:18 ddsfs forescout-syslog[2887]: User admin session 935304488040107520 changed License Management. Details: License file has been activated successfully on CounterACT Appliance 10.10.10.10. <EOL> <EOL> Successful activation details:<EOL> ForeScout forescout-syslog license - Type: NFR, Capacity: 100, Status: Valid. Start date: 10 Sep 2025, Expiration date: 10 Sep 2028"
  result:
    custom:
      action: "activate"
      additional_license_details: " <EOL> <EOL> Successful activation details:<EOL> ForeScout forescout-syslog license - Type: NFR, Capacity: 100, Status: Valid. Start date: 10 Sep 2025, Expiration date: 10 Sep 2028"
      appliance: "ddsfs"
      entity_name: "CounterACT Appliance"
      evt:
        name: "user-operations"
        outcome: "success"
      identifier: "forescout-syslog"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      service: "user-operations"
      session_id: "935304488040107520"
      target: "License Management"
      timestamp: 22587018000
      usr:
        name: "admin"
    message: "User admin session 935304488040107520 changed License Management. Details: License file has been activated successfully on CounterACT Appliance 10.10.10.10. <EOL> <EOL> Successful activation details:<EOL> ForeScout forescout-syslog license - Type: NFR, Capacity: 100, Status: Valid. Start date: 10 Sep 2025, Expiration date: 10 Sep 2028"
    service: "user-operations"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22587018000
 -
  sample: "<165>Sep 18 18:40:13 ddsfs forescout-syslog[232083]: User admin session 7737223649048649975 changed License Management. Details: Failed to remove Connect Module license from CounterACT Appliance 10.50.14.51. <EOL> Error:<EOL> Before you can remove the license, first uninstall the module in Options > Modules."
  result:
    custom:
      action: "remove"
      appliance: "ddsfs"
      entity_name: "CounterACT Appliance"
      error: "Before you can remove the license, first uninstall the module in Options > Modules."
      evt:
        name: "user-operations"
        outcome: "failed"
      identifier: "forescout-syslog"
      module_name: "Connect"
      network:
        client:
          geoip: {}
          ip: "10.50.14.51"
      service: "user-operations"
      session_id: "7737223649048649975"
      target: "License Management"
      timestamp: 22531213000
      usr:
        name: "admin"
    message: "User admin session 7737223649048649975 changed License Management. Details: Failed to remove Connect Module license from CounterACT Appliance 10.50.14.51. <EOL> Error:<EOL> Before you can remove the license, first uninstall the module in Options > Modules."
    service: "user-operations"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22531213000
 -
  sample: "<165>Sep 19 10:27:57 ddsfs forescout-syslog[2887]: User admin session 4723885926247600395 changed License Management. Details: Failed to upload license file on Enterprise Manager : The file format is invalid. The file is not a valid license file."
  result:
    custom:
      action: "upload"
      appliance: "ddsfs"
      entity_name: "Enterprise Manager"
      error: "The file format is invalid. The file is not a valid license file."
      evt:
        name: "user-operations"
        outcome: "failed"
      identifier: "forescout-syslog"
      service: "user-operations"
      session_id: "4723885926247600395"
      target: "License Management"
      timestamp: 22588077000
      usr:
        name: "admin"
    message: "User admin session 4723885926247600395 changed License Management. Details: Failed to upload license file on Enterprise Manager : The file format is invalid. The file is not a valid license file."
    service: "user-operations"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22588077000
 -
  sample: "<165>Sep 19 10:57:01 ddsfs forescout-syslog[2887]: User admin session 0 changed Segment Configuration. Details: Edited the following Segment Datadog-test :<EOL>   <EOL>  Added the following Ranges:<EOL>   172.17.0.0-172.17.1.255"
  result:
    custom:
      appliance: "ddsfs"
      evt:
        name: "user-operations"
      identifier: "forescout-syslog"
      ip_range: "172.17.0.0-172.17.1.255"
      segment_name: "Datadog-test"
      service: "user-operations"
      session_id: "0"
      target: "Segment Configuration"
      timestamp: 22589821000
      usr:
        name: "admin"
    message: "User admin session 0 changed Segment Configuration. Details: Edited the following Segment Datadog-test :<EOL>   <EOL>  Added the following Ranges:<EOL>   172.17.0.0-172.17.1.255"
    service: "user-operations"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 22589821000
