## Overview

[Tanium][1] is an enterprise platform designed for endpoint management. It provides security and IT operations teams with rapid visibility and control to secure and manage all network endpoints.

This integration ingests the following logs:

- **Threat Response Alerts**: This endpoint contains information about the core incident response lifecycle with integrated capabilities for alerting, analysis, containment, and remediation.
- **Threat Response Audit**: This endpoint contains information about the centralized view of audit events generated by the Tanium Threat Response.
- **Platform Audit**: This endpoint contains information about the authentication, API token usage, local settings, persona changes, user settings, and system settings information.

This integration collects logs from the sources listed above and transmits them to Datadog for analysis in [Log Explorer][3] and [Cloud SIEM][4].

## Setup

### Retrieve Datadog CIDR Range

1. Use an API platform such as Postman, or curl to make a GET request to the [Datadog API endpoint][5].
2. Once you receive the response, locate the **webhooks** section in the JSON. It will look something like this:
   ```json
      "webhooks": {
         "prefixes_ipv4": [
            "0.0.0.0/32",
            ...
         ],
         "prefixes_ipv6": []
         }
   ```
3. From the **prefixes_ipv4** list under the Webhooks section, copy each CIDR entry.

### Generate API Credentials in Tanium

1. Sign in to Tanium Console as a user who has the following permissions:
   - `Special`: Token Use
   - `Execute`: Threat Response API
   - `Read`: Audit, Threat Response Alerts, and Threat Response Audit
2. From the main menu, navigate to **Administration** > **Permissions** > **API Tokens**.
3. Click **New API Token** and configure the token settings:
   - **Expiration**: Enter the expiration interval as `365` days. Ensure you rotate the token before it expires. Refer to the "Rotate API Token in Tanium" section for instructions.
   - **Trusted IP addresses**: Enter each CIDR entry retrieved in the "Retrieve Datadog CIDR Range" section, separated by commas or new lines.
4. Click on **Create**.
5. Click on **Yes** and copy the **token** for later use.
6. This integration supports both **cloud-based** and **self-hosted** Tanium instances:
   - **Cloud-based**: The Host format is **\<customer\>.cloud.tanium.com**. Replace **\<customer\>** with your organization's specific subdomain.
   - **Self-hosted**: The Host is domain of your self-hosted tanium instance. The instance must be publicly accessible through HTTPS. Example: `tk-example.titankube.com`, `123.123.123.123:8443`.

### Rotate API Token in Tanium

1. Sign in to Tanium Console as a user who has the following permission:
   - `Special`: Token Rotate
2. From the main menu, navigate to **Administration** > **Permissions** > **API Tokens**.
3. Select the token and click **Rotate Token**.
4. Enter the old **Token** value and click **Rotate**.
5. Click on **Yes** and copy the new **token** for later use.

### Connect your Tanium Account to Datadog

1. Add your Host and API Token.
   | Parameters | Description |
   | ------------------- |------------------------------------------------------------- |
   | Host | The Host of your Tanium platform. |
   | API Token | The API Token of your Tanium platform. |

2. Click the Save button to save your settings.

## Data Collected

### Logs

The Tanium integration collects and forwards threat-response alerts, threat-response audit logs, and platform audit logs to Datadog.

### Metrics

The Tanium integration does not include any metrics.

### Events

The Tanium integration does not include any events.

## Support

For any further assistance, contact [Datadog support][2].

[1]: https://www.tanium.com/
[2]: https://docs.datadoghq.com/help/
[3]: https://docs.datadoghq.com/logs/explorer/
[4]: https://www.datadoghq.com/product/cloud-siem/
[5]: https://docs.datadoghq.com/api/latest/ip-ranges/
