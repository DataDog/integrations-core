id: juniper-srx-firewall
tests:
  - sample: '{"tunnel-inspection":"Off","user-type":"N/A","reason":"idle
      Timeout","packet-incoming-interface":"ge-0/0/1.0","bytes-from-client":"650","source-tenant":"N/A","peer-destination-port":"0","nat-connection-tag":"0","src-vrf-grp":"N/A","connection-tag":"0","service-name":"junos-https","hostname":"NA
      NA","session-flag":"0","policy-name":"default-permit","destination-address":"10.10.20.20","packets-from-server":"8","nat-destination-port":"443","src-nat-rule-name":"snat_pat","nat-source-address":"20.20.20.20","destination-service":"N/A","peer-source-port":"0","source-zone-name":"trust","secure-web-proxy-session-type":"NA","bytes-from-server":"6268","tunnel-inspection-policy-set":"root","application-characteristics":"N/A","peer-source-address":"0.0.0.0","session-id":"105822","source-port":"50267","roles":"N/A","dst-nat-rule-type":"N/A","nested-application":"UNKNOWN","syslog":{"severity":6,"hostname":"dds-srx","appname":"RT_FLOW","msgid":"RT_FLOW_SESSION_CLOSE","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"},"source-address":"10.10.10.10","destination-zone-name":"untrust","application-category":"N/A","application-sub-category":"N/A","src-nat-rule-type":"source
      rule","elapsed-time":"1803","nat-source-port":"10019","nat-destination-address":"30.30.30.30","application-risk":"-1","packets-from-client":"6","peer-session-id":"0","dst-nat-rule-name":"N/A","application":"UNKNOWN","encrypted":"UNKNOWN","peer-destination-address":"0.0.0.0","destination-port":"443","protocol-id":"6","username":"user1","dst-vrf-grp":"N/A"}'
    result: null
  - sample: '{"reason":"timeout","source-address":"10.10.10.10","source-port":"12345","destination-address":"10.10.20.20","destination-port":"80","service-name":"HTTP","application":"Web","nested-application":"NestedApp","nat-source-address":"10.10.10.10","nat-source-port":"54321","nat-destination-address":"10.10.20.20","nat-destination-port":"8080","src-nat-rule-name":"src-rule-1","dst-nat-rule-name":"dst-rule-1","protocol-id":"6","policy-name":"policy-1","source-zone-name":"internal","destination-zone-name":"external","session-id":"sess-001","packets-from-client":100,"bytes-from-client":2048,"packets-from-server":150,"bytes-from-server":4096,"elapsed-time":300,"username":"user1","roles":["admin"],"encrypted":false,"profile-name":"profile-1","rule-name":"rule-1","routing-instance":"instance-1","destination-interface-name":"eth0","uplink-incoming-interface-name":"uplink-eth0","uplink-tx-bytes":1024,"uplink-rx-bytes":2048,"category":"network","sub-category":"security","apbr-policy-name":"apbr-1","multipath-rule-name":"multipath-1","src-vrf-grp":"vrf-1","dst-vrf-grp":"vrf-2","dscp-value":10,"apbr-rule-type":"type-1","syslog":{"severity":5,"hostname":"dds-srx","msgid":"APPTRACK_SESSION_CLOSE","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"message":"Packet dropped 10.10.10.10/1234->10.10.10.20/80 6 ge-0/0/0
      trust","source-address":"10.10.10.10","source-port":"1234","destination-address":"10.10.10.20","destination-port":"80","protocol-id":"6","interface-name":"ge-0/0/0","source-zone-name":"trust","syslog":{"severity":5,"hostname":"dds-srx","msgid":"FLOW_LOG_PKT_DROP","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"username":"dummyuser10","realm-name":"dummyrealm10","src-ip-str":"10.10.10.10","user-application":"dummyapp10","hostname":"dummyhost10","device-id-str":"dummydevice10","device-os":"Windows
      10","win-domain":"dummydomain10","win-grp":"dummygroup10","syslog":{"severity":5,"hostname":"dds-srx","msgid":"REMOTE_ACCESS_VPN_AUTH_OK","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"username":"dummyuser1","realm-name":"dummyrealm1","src-ip-str":"192.10.10.10","user-application":"dummyapp1","hostname":"dummyhost1","device-id-str":"dummydevice1","device-os":"Windows
      10","win-domain":"dummydomain1","win-grp":"dummygroup1","error-message":"Invalid
      password","syslog":{"severity":4,"hostname":"dds-srx","msgid":"REMOTE_ACCESS_VPN_AUTH_FAIL","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"username":"dummyuser10","group-name":"dummygroup1","client-address":"10.10.10.10","syslog":{"severity":4,"hostname":"dds-srx","msgid":"FWAUTH_WEBAUTH_SUCCESS","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"tenant-id":"tenant-003","source-address":"10.10.10.10","hostname":"host-3","status":"infected","policy-name":"policy-3","threat-score":75,"verdict-number":2,"state":"cleaning","reason":"spyware
      detected","message":"Host infected due to spyware
      download","username":"user3","syslog":{"severity":3,"hostname":"dds-srx","msgid":"AAMW_HOST_INFECTED_EVENT_LOG","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:17:19.289Z"}}'
    result: null
  - sample: '{"epoch-time":"1672531200","message-type":"Attack
      log","source-address":"10.10.10.10","source-port":"12346","destination-address":"10.10.20.20","destination-port":"443","protocol-name":"TCP","service-name":"HTTPS","application-name":"Secure
      Web","rule-name":"rule-2","rulebase-name":"rulebase-2","policy-name":"policy-2","export-id":"exp-002","repeat-count":"2","action":"block","threat-severity":"medium","attack-name":"Cross-Site
      Scripting","nat-source-address":"10.10.10.10","nat-source-port":"54322","nat-destination-address":"10.10.20.20","nat-destination-port":"8443","elapsed-time":"150","inbound-bytes":"2048","outbound-bytes":"4096","inbound-packets":"15","outbound-packets":"30","source-zone-name":"internal","source-interface-name":"eth1","destination-zone-name":"external","destination-interface-name":"eth2","packet-log-id":"pkt-002","alert":"false","username":"user2","roles":["user"],"xff-header":"10.0.0.3","cve-id":"CVE-2021-12346","session-id":"sess-002","message":"Attack
      blocked","syslog":{"severity":4,"hostname":"dds-srx","msgid":"IDP_ATTACK_LOG_EVENT","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:15:19.289Z"}}'
    result: null
  - sample: '{"source-zone":"internal","destination-zone":"external","source-address":"10.10.10.10","source-port":"50001","destination-address":"10.10.20.20","destination-port":"443","session-id":"sess-002","application":"Secure
      Web","nested-application":"HTTPS","category":"Malicious","reason":"Malware","profile":"web-protection-2","url":"https://example.com","username":"user2","roles":["user"],"application-sub-category":"High
      Risk","urlcategory-risk":"5","syslog":{"severity":4,"hostname":"dds-srx","msgid":"WEBFILTER_URL_BLOCKED","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:16:19.289Z"}}'
    result: null
  - sample: '{"attack-name":"ICMP
      Echo","source-address":"10.10.10.10","destination-address":"10.10.20.20","source-zone-name":"untrust","interface-name":"ge-0/0/1","action":"alert","syslog":{"severity":4,"hostname":"dds-srx","appname":"RT_SCREEN","msgid":"RT_SCREEN_ICMP","prival":14,"facility":1,"version":1,"timestamp":"2025-02-19T20:16:19.289Z"}}'
    result: null