id: "bluecat-edge"
tests:
 -
  sample: |-
    {
      "site_details" : {
        "name" : "Site Testing",
        "id" : "a56e996d-cd54-45c5-8bed-5de015612e0b"
      },
      "vendor" : {
        "endpoint" : "dns-query-logs"
      },
      "query_log" : {
        "queryClassId" : 1,
        "query" : "10.13.40.10.in-addr.arpa.",
        "latency" : 12,
        "source" : "10.41.13.131",
        "queryType" : "PTR",
        "queryId" : 1,
        "queryProtocol" : "UDP",
        "queriedNamespaces" : [ {
          "latency" : 11,
          "name" : "Default",
          "rCode" : "NXDOMAIN",
          "responseData" : {
            "questions" : [ {
              "classId" : 1,
              "recordType" : "PTR",
              "domainName" : "10.13.40.10.in-addr.arpa."
            } ],
            "header" : {
              "rCode" : "NXDOMAIN",
              "id" : 1
            },
            "time" : 1768561943109
          },
          "id" : "97e3ecb9-f066-11f0-96fb-06915da638a8",
          "cycle" : 0
        } ],
        "actionTaken" : "query-response",
        "response" : "NXDOMAIN",
        "identity" : {
          "identityId" : "identity_id_example",
          "userId" : "example@test.bluecat.com"
        },
        "drsId" : "87a16e58-11d3-4d45-a574-af92520d3b90",
        "siteId" : "955ff30b-93a9-4f13-9de1-aeaa25190f49",
        "time" : 1770033982000,
        "id" : "17685619430971F61B04D4186D474A54EBAF987E153D9"
      }
    }
  service: "bluecatedge"
  result:
    custom:
      dns:
        flags:
          rcode: "NXDOMAIN"
        id: 1
        question:
          name: "10.13.40.10.in-addr.arpa."
          type: "PTR"
      network:
        client:
          geoip: {}
          ip: "10.41.13.131"
      query_log:
        actionTaken: "query-response"
        drsId: "87a16e58-11d3-4d45-a574-af92520d3b90"
        id: "17685619430971F61B04D4186D474A54EBAF987E153D9"
        identity:
          identityId: "identity_id_example"
        latency : 12
        queriedNamespaces:
         -
          latency: 11
          name: "Default"
          rCode: "NXDOMAIN"
          responseData:
            questions:
             -
              classId: 1
              recordType: "PTR"
              domainName: "10.13.40.10.in-addr.arpa."
            header:
              rCode: "NXDOMAIN"
              id: 1
            time: 1768561943109
          id: "97e3ecb9-f066-11f0-96fb-06915da638a8"
          cycle: 0
        queryClassId: 1
        queryProtocol: "UDP"
        siteId: "955ff30b-93a9-4f13-9de1-aeaa25190f49"
        time: 1770033982000
      site_details:
        id: "a56e996d-cd54-45c5-8bed-5de015612e0b"
        name: "Site Testing"
      usr:
        id: "example@test.bluecat.com"
      vendor:
        endpoint: "dns-query-logs"
    message: |-
      {
        "site_details" : {
          "name" : "Site Testing",
          "id" : "a56e996d-cd54-45c5-8bed-5de015612e0b"
        },
        "vendor" : {
          "endpoint" : "dns-query-logs"
        },
        "query_log" : {
          "queryClassId" : 1,
          "query" : "10.13.40.10.in-addr.arpa.",
          "latency" : 12,
          "source" : "10.41.13.131",
          "queryType" : "PTR",
          "queryId" : 1,
          "queryProtocol" : "UDP",
          "queriedNamespaces" : [ {
            "latency" : 11,
            "name" : "Default",
            "rCode" : "NXDOMAIN",
            "responseData" : {
              "questions" : [ {
                "classId" : 1,
                "recordType" : "PTR",
                "domainName" : "10.13.40.10.in-addr.arpa."
              } ],
              "header" : {
                "rCode" : "NXDOMAIN",
                "id" : 1
              },
              "time" : 1768561943109
            },
            "id" : "97e3ecb9-f066-11f0-96fb-06915da638a8",
            "cycle" : 0
          } ],
          "actionTaken" : "query-response",
          "response" : "NXDOMAIN",
          "identity" : {
            "identityId" : "identity_id_example",
            "userId" : "example@test.bluecat.com"
          },
          "drsId" : "87a16e58-11d3-4d45-a574-af92520d3b90",
          "siteId" : "955ff30b-93a9-4f13-9de1-aeaa25190f49",
          "time" : 1770033982000,
          "id" : "17685619430971F61B04D4186D474A54EBAF987E153D9"
        }
      }
    service: "bluecatedge"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1770033982000