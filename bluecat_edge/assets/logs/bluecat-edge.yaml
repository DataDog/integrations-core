id: bluecat-edge
metric_id: bluecat-edge
backend_only: false
facets:
  - groups:
      - DNS
    name: Response Code
    path: dns.flags.rcode
    source: log
  - groups:
      - DNS
    name: DNS ID
    path: dns.id
    source: log
  - groups:
      - DNS
    name: Question Name
    path: dns.question.name
    source: log
  - groups:
      - DNS
    name: Question Type
    path: dns.question.type
    source: log
  - facetType: range
    groups:
      - Measure
    name: Duration
    path: duration
    source: log
    type: double
    unit:
      family: time
      name: nanosecond
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - User
    name: User ID
    path: usr.id
    source: log
pipeline:
  type: pipeline
  name: Bluecat Edge
  enabled: true
  filter:
    query: source:bluecat-edge
  processors:
    - type: date-remapper
      name: Define `query_log.time` as the official date of the log
      enabled: true
      sources:
        - query_log.time
    - type: attribute-remapper
      name: Map `query_log.source` to `network.client.ip`
      enabled: true
      sources:
        - query_log.source
      sourceType: attribute
      target: network.client.ip
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.query` to `dns.question.name`
      enabled: true
      sources:
        - query_log.query
      sourceType: attribute
      target: dns.question.name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.queryType` to `dns.question.type`
      enabled: true
      sources:
        - query_log.queryType
      sourceType: attribute
      target: dns.question.type
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.response` to `dns.flags.rcode`
      enabled: true
      sources:
        - query_log.response
      sourceType: attribute
      target: dns.flags.rcode
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.latency` to `duration`
      enabled: true
      sources:
        - query_log.latency
      sourceType: attribute
      target: duration
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.queryId` to `dns.id`
      enabled: true
      sources:
        - query_log.queryId
      sourceType: attribute
      target: dns.id
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `query_log.identity.userId` to `usr.id`
      enabled: true
      sources:
        - query_log.identity.userId
      sourceType: attribute
      target: usr.id
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: geo-ip-parser
      name: Extract Geolocation information from Client IP
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
      ip_processing_behavior: do-nothing
