{
    "title": "BlueCat Edge DNS Query Insights",
    "description": "This dashboard provides visibility into DNS query logs, enabling analysis of query patterns, response behavior, and potential security or performance issues.\n",
    "widgets": [
        {
            "id": 8266097185570179,
            "definition": {
                "type": "image",
                "url": "https://bluecatnetworks.com/wp-content/uploads/2024/02/bluecat-logo.svg",
                "url_dark_theme": "https://bluecatnetworks.com/wp-content/uploads/2024/02/bluecat-logo.svg",
                "sizing": "contain",
                "has_background": false,
                "has_border": false,
                "vertical_align": "center",
                "horizontal_align": "center"
            },
            "layout": {
                "x": 0,
                "y": 0,
                "width": 3,
                "height": 3
            }
        },
        {
            "id": 7742355813107440,
            "definition": {
                "type": "note",
                "content": "[BlueCat Edge](https://bluecatnetworks.com/products/edge/) is an intelligent DNS resolver and caching layer that leverages existing DNS infrastructure to provide unprecedented visibility and control over DNS traffic.\n\nThis dashboard provides visibility into DNS query logs, enabling analysis of query patterns, response behavior, and potential security or performance issues.\n\nFor more information, see the [BlueCat Edge Integration Documentation](https://docs.datadoghq.com/integrations/bluecat_edge/).\n\n**Tips**\n- Use the timeframe selector in the upper-right corner of the dashboard to change the default timeframe.\n- Clone this dashboard to rearrange, modify, and add widgets and visualizations.",
                "background_color": "blue",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "center",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
            },
            "layout": {
                "x": 3,
                "y": 0,
                "width": 9,
                "height": 3
            }
        },
        {
            "id": 7182509353613846,
            "definition": {
                "title": "Overview",
                "background_color": "vivid_blue",
                "show_title": true,
                "type": "group",
                "layout_type": "ordered",
                "widgets": [
                    {
                        "id": 7617383393443244,
                        "definition": {
                            "type": "note",
                            "content": "This group gives a quick overview of BlueCat Edge DNS query logs. It shows queries, threats, and allowed, blocked, redirected, or monitored traffic, along with detailed logs for easy tracking and analysis.",
                            "background_color": "blue",
                            "font_size": "14",
                            "text_align": "center",
                            "vertical_align": "top",
                            "show_tick": false,
                            "tick_pos": "50%",
                            "tick_edge": "left",
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 12,
                            "height": 1
                        }
                    },
                    {
                        "id": 2472286608559669,
                        "definition": {
                            "title": "DNS query logs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "custom_bg",
                                            "custom_bg_color": "#96beeb"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "type": "bars",
                                "yaxis": {}
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 1,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 4295917980664189,
                        "definition": {
                            "title": "DNS query details",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "response_format": "event_list",
                                    "query": {
                                        "data_source": "logs_stream",
                                        "query_string": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type",
                                        "indexes": [],
                                        "storage": "hot"
                                    },
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "timestamp",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "content",
                                            "width": "auto"
                                        }
                                    ]
                                }
                            ],
                            "type": "list_stream"
                        },
                        "layout": {
                            "x": 3,
                            "y": 1,
                            "width": 9,
                            "height": 3
                        }
                    },
                    {
                        "id": 4486977271645685,
                        "definition": {
                            "title": "Allowed DNS queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.actionTaken:query-response $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "black_on_light_green"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 4480739060295532,
                        "definition": {
                            "title": "Blocked DNS queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.actionTaken:block $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "black_on_light_yellow"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 3,
                            "y": 4,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 5357831697998246,
                        "definition": {
                            "title": "Redirect DNS queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.actionTaken:redirect $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "custom_bg",
                                            "custom_bg_color": "#fdecd3"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 3634147621039574,
                        "definition": {
                            "title": "Monitored DNS queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.actionTaken:monitor $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "custom_bg",
                                            "custom_bg_color": "#d3f1f3"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 9,
                            "y": 4,
                            "width": 3,
                            "height": 3
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 3,
                "width": 12,
                "height": 8
            }
        },
        {
            "id": 2585768574854758,
            "definition": {
                "title": "Traffic Insights",
                "background_color": "vivid_blue",
                "show_title": true,
                "type": "group",
                "layout_type": "ordered",
                "widgets": [
                    {
                        "id": 5588295403195470,
                        "definition": {
                            "type": "note",
                            "content": "This group provides a complete view of BlueCat Edge DNS traffic and performance. Track query trends, top users and domains, response types, GSLB rules, redirected traffic, and detailed logs at a glance.",
                            "background_color": "blue",
                            "font_size": "14",
                            "text_align": "center",
                            "vertical_align": "top",
                            "show_tick": false,
                            "tick_pos": "50%",
                            "tick_edge": "left",
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 12,
                            "height": 1
                        }
                    },
                    {
                        "id": 5273683559392443,
                        "definition": {
                            "title": "DNS queries over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": false,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Queries",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 0,
                            "y": 1,
                            "width": 12,
                            "height": 3
                        }
                    },
                    {
                        "id": 2538978080876910,
                        "definition": {
                            "title": "Query distribution by actions",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.actionTaken"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 1276139755100136,
                        "definition": {
                            "title": "Query distribution by type",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@dns.question.type"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 4119406512994446,
                        "definition": {
                            "title": "Average latency over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": false,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Queries",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "avg",
                                                "metric": "@duration"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 12,
                            "height": 3
                        }
                    },
                    {
                        "id": 8757088607950575,
                        "definition": {
                            "title": "Queried domains",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_table",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@dns.question.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    },
                                    "formulas": [
                                        {
                                            "cell_display_mode": "number",
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "has_search_bar": "auto"
                        },
                        "layout": {
                            "x": 0,
                            "y": 11,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 3417100932808771,
                        "definition": {
                            "title": "DNS response distribution",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@dns.flags.rcode"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 11,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 656280263103845,
                        "definition": {
                            "title": "Top sites",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@site_details.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                },
                                "palette": "datadog16"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 15,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 7203001180189054,
                        "definition": {
                            "title": "Query per second by sites",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_table",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@site_details.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    },
                                    "formulas": [
                                        {
                                            "cell_display_mode": "number",
                                            "alias": "THROUGHPUT",
                                            "formula": "throughput(query1)"
                                        }
                                    ]
                                }
                            ],
                            "has_search_bar": "auto"
                        },
                        "layout": {
                            "x": 6,
                            "y": 15,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 5165792815395118,
                        "definition": {
                            "title": "DNS protocol distribution",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.queryProtocol"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 19,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 3040876384001668,
                        "definition": {
                            "title": "Top users",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@usr.id"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                }
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 19,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 266450349666847,
                        "definition": {
                            "title": "Top source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@network.client.ip"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                }
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 23,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 7220177244125470,
                        "definition": {
                            "title": "Unique IPs over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": false,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Unique IPs",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "cardinality",
                                                "metric": "@network.client.ip"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 6,
                            "y": 23,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 4027543350734461,
                        "definition": {
                            "title": "Geolocation distribution of source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "geomap",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.geoip.country.iso_code",
                                                    "limit": 250,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "palette": "hostmap_blues",
                                "palette_flip": false
                            },
                            "view": {
                                "focus": "WORLD"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 27,
                            "width": 12,
                            "height": 4
                        }
                    },
                    {
                        "id": 2567684634711551,
                        "definition": {
                            "title": "Top namespaces",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.queriedNamespaces.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                }
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 31,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 5964158305709618,
                        "definition": {
                            "title": "Redirected domains",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_table",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.redirectDomain"
                                                ],
                                                "limit": 1000,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 1000,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    },
                                    "formulas": [
                                        {
                                            "cell_display_mode": "number",
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "has_search_bar": "auto"
                        },
                        "layout": {
                            "x": 6,
                            "y": 31,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 4675550091402547,
                        "definition": {
                            "title": "Authority domains",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_table",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.authority.domainName"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    },
                                    "formulas": [
                                        {
                                            "cell_display_mode": "number",
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "has_search_bar": "auto"
                        },
                        "layout": {
                            "x": 0,
                            "y": 35,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 465817888103062,
                        "definition": {
                            "title": "Top GSLB rules",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.gslbRule.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                }
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 35,
                            "width": 6,
                            "height": 4
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 11,
                "width": 12,
                "height": 40
            }
        },
        {
            "id": 5412195412723052,
            "definition": {
                "title": "Threat Insights",
                "background_color": "vivid_blue",
                "show_title": true,
                "type": "group",
                "layout_type": "ordered",
                "widgets": [
                    {
                        "id": 1400965187298698,
                        "definition": {
                            "type": "note",
                            "content": "This group provides visibility into DNS queries associated with threats. Track threat types, indicators, top sources and domains, response patterns, and detailed threat logs.",
                            "background_color": "blue",
                            "font_size": "14",
                            "text_align": "center",
                            "vertical_align": "top",
                            "show_tick": false,
                            "tick_pos": "50%",
                            "tick_edge": "left",
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 12,
                            "height": 1
                        }
                    },
                    {
                        "id": 4216141487897898,
                        "definition": {
                            "title": "Queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "black_on_light_red"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 1,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 3655591609779925,
                        "definition": {
                            "title": "Queries over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": true,
                            "legend_layout": "horizontal",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Threat Type",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.threats.type"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 3,
                            "y": 1,
                            "width": 9,
                            "height": 3
                        }
                    },
                    {
                        "id": 8726426484348872,
                        "definition": {
                            "title": "Distribution by threat type",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "bar_chart",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.threats.type"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                },
                                "palette": "datadog16"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 4,
                            "height": 4
                        }
                    },
                    {
                        "id": 7996849100386637,
                        "definition": {
                            "title": "Threat indicators distribution",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $action_taken $client_ip $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.threats.indicators"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 8,
                            "height": 4
                        }
                    },
                    {
                        "id": 5778826200229529,
                        "definition": {
                            "title": "Threat indicators over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": true,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.threats.indicators"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 12,
                            "height": 3
                        }
                    },
                    {
                        "id": 8046754851126157,
                        "definition": {
                            "title": "Top domains with threat",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_table",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@dns.question.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    },
                                    "formulas": [
                                        {
                                            "cell_display_mode": "number",
                                            "alias": "COUNT",
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "has_search_bar": "auto"
                        },
                        "layout": {
                            "x": 0,
                            "y": 11,
                            "width": 12,
                            "height": 4
                        }
                    },
                    {
                        "id": 7306900764524359,
                        "definition": {
                            "title": "Top source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@network.client.ip"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                },
                                "palette": "datadog16"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 15,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 582380017840500,
                        "definition": {
                            "title": "Threats distribution by response",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@dns.flags.rcode"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                },
                                                "should_exclude_missing": true
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 15,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 8121776641000888,
                        "definition": {
                            "title": "Geolocation distribution of source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "geomap",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.geoip.country.iso_code",
                                                    "limit": 250,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 500,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "palette": "hostmap_blues",
                                "palette_flip": false
                            },
                            "view": {
                                "focus": "WORLD"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 19,
                            "width": 12,
                            "height": 4
                        }
                    },
                    {
                        "id": 8481613709367945,
                        "definition": {
                            "title": "Log details",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "response_format": "event_list",
                                    "query": {
                                        "data_source": "logs_stream",
                                        "query_string": "source:bluecat-edge @query_log.threats.type:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type",
                                        "indexes": [],
                                        "storage": "hot"
                                    },
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "timestamp",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@network.client.ip",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@dns.question.name",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@query_log.threats",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "content",
                                            "width": "auto"
                                        }
                                    ]
                                }
                            ],
                            "type": "list_stream"
                        },
                        "layout": {
                            "x": 0,
                            "y": 23,
                            "width": 12,
                            "height": 3
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 51,
                "width": 12,
                "height": 27,
                "is_column_break": true
            }
        },
        {
            "id": 5488288491526257,
            "definition": {
                "title": "Policy Insights",
                "background_color": "vivid_blue",
                "show_title": true,
                "type": "group",
                "layout_type": "ordered",
                "widgets": [
                    {
                        "id": 273678832353518,
                        "definition": {
                            "type": "note",
                            "content": "This group gives an overview of BlueCat Edge policy enforcement. Monitor total and over-time policied queries, top policies, event types, source IPs, geolocation, and detailed logs.",
                            "background_color": "blue",
                            "font_size": "14",
                            "text_align": "center",
                            "vertical_align": "top",
                            "show_tick": false,
                            "tick_pos": "50%",
                            "tick_edge": "left",
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 12,
                            "height": 1
                        }
                    },
                    {
                        "id": 8709067669009221,
                        "definition": {
                            "title": "Policied queries",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "black_on_light_yellow"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "yaxis": {},
                                "type": "bars"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 1,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 7122824368002132,
                        "definition": {
                            "title": "Policied queries over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": false,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 3,
                            "y": 1,
                            "width": 9,
                            "height": 3
                        }
                    },
                    {
                        "id": 7909022069959718,
                        "definition": {
                            "title": "Policied query rate",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "number_format": {
                                                "unit": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "percent"
                                                }
                                            },
                                            "formula": "default_zero(query1 / query2 * 100)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        },
                                        {
                                            "name": "query2",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "value": 0,
                                            "palette": "black_on_light_yellow"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2,
                            "timeseries_background": {
                                "type": "bars",
                                "yaxis": {}
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 3,
                            "height": 3
                        }
                    },
                    {
                        "id": 2139146125166566,
                        "definition": {
                            "title": "Policied query rate over time",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": false,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "number_format": {
                                                "unit": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "percent"
                                                }
                                            },
                                            "alias": "Policied query rate",
                                            "formula": "query1 / query2 * 100"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        },
                                        {
                                            "name": "query2",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "order_by": "values",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "line"
                                }
                            ]
                        },
                        "layout": {
                            "x": 3,
                            "y": 4,
                            "width": 9,
                            "height": 3
                        }
                    },
                    {
                        "id": 8438457881889916,
                        "definition": {
                            "title": "Top policies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.matchedPolicies.name"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                },
                                "palette": "dog_classic"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 7,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 1826960888316506,
                        "definition": {
                            "title": "Distribution by event type",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@query_log.matchedPolicies.eventType"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "datadog16"
                                    },
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "type": "sunburst",
                            "legend": {
                                "type": "table"
                            }
                        },
                        "layout": {
                            "x": 6,
                            "y": 7,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 1794929694120050,
                        "definition": {
                            "title": "Top source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": {
                                                "fields": [
                                                    "@network.client.ip"
                                                ],
                                                "limit": 10,
                                                "sort": {
                                                    "aggregation": "count",
                                                    "metric": "count",
                                                    "order": "desc"
                                                }
                                            },
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                },
                                "palette": "dog_classic"
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 11,
                            "width": 4,
                            "height": 4
                        }
                    },
                    {
                        "id": 6613888589856052,
                        "definition": {
                            "title": "Geolocation distribution of source IPs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "geomap",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "name": "query1",
                                            "data_source": "logs",
                                            "search": {
                                                "query": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type"
                                            },
                                            "indexes": [
                                                "*"
                                            ],
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.geoip.country.iso_code",
                                                    "limit": 250,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "palette": "hostmap_blues",
                                "palette_flip": false
                            },
                            "view": {
                                "focus": "WORLD"
                            }
                        },
                        "layout": {
                            "x": 4,
                            "y": 11,
                            "width": 8,
                            "height": 4
                        }
                    },
                    {
                        "id": 7211745523029244,
                        "definition": {
                            "title": "Log details",
                            "title_size": "16",
                            "title_align": "left",
                            "requests": [
                                {
                                    "response_format": "event_list",
                                    "query": {
                                        "data_source": "logs_stream",
                                        "query_string": "source:bluecat-edge @query_log.matchedPolicies.name:* $client_ip $action_taken $response $user_id $protocol $site_name $query_type",
                                        "indexes": [],
                                        "storage": "hot"
                                    },
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "timestamp",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@network.client.ip",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@dns.question.name",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "content",
                                            "width": "auto"
                                        }
                                    ]
                                }
                            ],
                            "type": "list_stream"
                        },
                        "layout": {
                            "x": 0,
                            "y": 15,
                            "width": 12,
                            "height": 3
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 78,
                "width": 12,
                "height": 19
            }
        },
        {
            "id": 4511506877003760,
            "definition": {
                "title": "Datadog Cloud SIEM",
                "title_align": "center",
                "background_color": "vivid_blue",
                "show_title": true,
                "type": "group",
                "layout_type": "ordered",
                "widgets": [
                    {
                        "id": 3421906514135689,
                        "definition": {
                            "type": "note",
                            "content": "\nDatadog Cloud SIEM analyzes and correlates **BlueCat Edge** DNS query logs to detect threats to your environment in real time. If you don't see signals please make sure you've enabled [Datadog Cloud SIEM](/security/overview).",
                            "background_color": "vivid_blue",
                            "font_size": "14",
                            "text_align": "center",
                            "vertical_align": "center",
                            "show_tick": false,
                            "tick_pos": "50%",
                            "tick_edge": "left",
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 12,
                            "height": 1
                        }
                    },
                    {
                        "id": 1986218800116155,
                        "definition": {
                            "title": "CRITICALs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#bc303c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [],
                                            "search": {
                                                "query": "source:bluecat-edge status:critical"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "autoscale": true,
                            "custom_links": [],
                            "precision": 2
                        },
                        "layout": {
                            "x": 0,
                            "y": 1,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3548438047623814,
                        "definition": {
                            "title": "HIGHs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#d33043",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [],
                                            "search": {
                                                "query": "source:bluecat-edge status:high"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "autoscale": true,
                            "custom_links": [],
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 1,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 6398959628976550,
                        "definition": {
                            "title": "Critical Security Signals",
                            "type": "toplist",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#bc303c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "search": {
                                                "query": "source:bluecat-edge status:critical"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "custom_links": [],
                            "style": {}
                        },
                        "layout": {
                            "x": 4,
                            "y": 1,
                            "width": 8,
                            "height": 4
                        }
                    },
                    {
                        "id": 7328477465329482,
                        "definition": {
                            "title": "MEDIUMs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e5a21c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [],
                                            "search": {
                                                "query": "source:bluecat-edge status:medium"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "autoscale": true,
                            "custom_links": [],
                            "precision": 2
                        },
                        "layout": {
                            "x": 0,
                            "y": 3,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 5639117398920092,
                        "definition": {
                            "title": "LOWs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#ffb52b",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [],
                                            "search": {
                                                "query": "source:bluecat-edge status:low"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "autoscale": true,
                            "custom_links": [],
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 3,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 7854080996189968,
                        "definition": {
                            "title": "High Security Signals",
                            "type": "toplist",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#d33043",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "search": {
                                                "query": "source:bluecat-edge status:high"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "custom_links": [],
                            "style": {}
                        },
                        "layout": {
                            "x": 0,
                            "y": 5,
                            "width": 6,
                            "height": 4
                        }
                    },
                    {
                        "id": 7828044569765466,
                        "definition": {
                            "title": "Medium Security Signals",
                            "type": "toplist",
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e5a21c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "security_signals",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "search": {
                                                "query": "source:bluecat-edge status:medium"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "type": "formula",
                                                "index": 0,
                                                "order": "desc"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "custom_links": [],
                            "style": {}
                        },
                        "layout": {
                            "x": 6,
                            "y": 5,
                            "width": 6,
                            "height": 4
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 97,
                "width": 12,
                "height": 1
            }
        }
    ],
    "template_variables": [
        {
            "name": "client_ip",
            "prefix": "@network.client.ip",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "action_taken",
            "prefix": "@query_log.actionTaken",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "response",
            "prefix": "@dns.flags.rcode",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "user_id",
            "prefix": "@usr.id",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "protocol",
            "prefix": "@query_log.queryProtocol",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "site_name",
            "prefix": "@site_details.name",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "query_type",
            "prefix": "@dns.question.type",
            "available_values": [],
            "default": "*"
        }
    ],
    "layout_type": "ordered",
    "notify_list": [],
    "reflow_type": "fixed"
}