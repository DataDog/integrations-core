id: proofpoint-on-demand
tests:
  - sample: |-
      {
        "msgParts": [],
        "guid": "AAaaA1a30A6A5AA6aaacAAa11a1aAAAA",
        "filter": {
          "suborgs": {
            "rcpts": [
              "0"
            ],
            "sender": "0"
          },
          "routeDirection": "outbound",
          "actions": [
            {
              "module": "access",
              "action": "accept",
              "isFinal": "True",
              "rule": "system"
            }
          ],
          "delivered": {
            "rcpts": [
              "james@abc.com"
            ]
          },
          "durationSecs": 0.049325,
          "disposition": "accept",
          "routes": [
            "allow_relay",
            "firewallsafe"
          ],
          "verified": {
            "rcpts": [
              "james@abc.com"
            ]
          },
          "msgSizeBytes": 1777,
          "qid": "11AAa1AA1111111"
        },
        "ts": "2025-05-11T07:05:02.318134-0700",
        "metadata": {
          "origin": {
            "data": {
              "version": "8.22.0.1767",
              "theater": "us",
              "agent": "a0072552.ppops.net",
              "cid": "pod_hosted"
            }
          }
        },
        "envelope": {
          "from": "netflip@abc.com",
          "rcpts": [
            "james@abc.com"
          ]
        },
        "connection": {
          "sid": "11a3aa1aaa",
          "host": "localhost",
          "ip": "100.0.0.0",
          "protocol": "smtp:smtp",
          "country": "**",
          "tls": {
            "inbound": {
              "version": "TLSv1.3",
              "cipher": "TLS_AES_256_GCM_SHA384",
              "cipherBits": 256
            }
          },
          "helo": "local@abc.com",
          "resolveStatus": "ok"
        },
        "msg": {
          "header": {
            "to": [
              "james@abc.com"
            ],
            "message-id": [
              "111111111111.11AA111A110111@a0011111.abc.net"
            ],
            "from": [
              "netflip@abc.com"
            ],
            "subject": [
              "Entertainment"
            ]
          },
          "lang": "",
          "sizeBytes": 1777,
          "parsedAddresses": {},
          "normalizedHeader": {
            "to": [
              "james@abc.com"
            ],
            "message-id": [
              "111111111111.11AA111A110111@a0011111.abc.net"
            ],
            "from": [
              "netflip@abc.com"
            ],
            "subject": [
              "About Entertainment"
            ]
          }
        }
      }
    result: null
