id: delinea-secret-server
tests:
  - sample: "2025-02-26T06:47:27.458Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10005|SECRET - EDIT|2|msg=[[SecretServer]] Event:
      [Secret] Action: [Edit] By User: admin Item name: Win-DDS-DNA (Item Id: 3)
      Container name: Windows (Container Id: 4) Details:  Settings: (Inherit
      Secret Policy) Account Name: administrator  Account Domain:
      dds-dns.local  suid=2 suser=admin cs4=admin cs4Label=suser Display Name
      src=171.22.240.116 rt=Feb 26 2025 06:47:18 fname=Win-DDS-DNA
      fileType=Secret fileId=3 cs3Label=Folder cs3=Windows"
    result:
      custom:
        account_domain: "dds-dns.local"
        account_name: "administrator"
        action: "edit"
        action_id: "10005"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs3Label: "Folder"
          cs4Label: "suser Display Name"
        details: "Settings: (Inherit Secret Policy)"
        event: "SECRET - EDIT"
        event_type: "secret"
        folder_id: 4
        folder_name: "Windows"
        item_id: 3
        item_name: "Win-DDS-DNA"
        item_type: "Secret"
        network:
          client:
            geoip: {}
            ip: "171.22.240.116"
        rt: 1740552438000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Secret] Action: [Edit] By User: admin Item name: Win-DDS-DNA (Item Id: 3) Container name: Windows (Container Id: 4) Details:  Settings: (Inherit Secret Policy) Account Name: administrator  Account Domain: dds-dns.local"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740552438000  
  - sample: "2025-02-25T06:22:22.992Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10006|SECRET - LAUNCH|2|msg=[[SecretServer]] Event:
      [Secret] Action: [Launch] By User: admin Item name: Win-DDS-DNA (Item Id:
      3) Container name: Windows (Container Id: 4) Details:  Remote Desktop -
      198.20.21.10 Host: [10.20.10.20] Username: [administrator] Account Name:
      administrator  Account Domain: dds-dns.local  suid=2 suser=admin cs4=admin
      cs4Label=suser Display Name src=174.20.20.220 rt=Feb 25 2025 06:22:20
      fname=Win-DDS-DNA fileType=Secret fileId=3 cs3Label=Folder cs3=Windows"
    result:
      custom:
        account_domain: "dds-dns.local"
        account_name: "administrator"
        action: "launch"
        action_id: "10006"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs3Label: "Folder"
          cs4Label: "suser Display Name"
        details: "Remote Desktop - 198.20.21.10 Host: [10.20.10.20] Username: [administrator]"
        event: "SECRET - LAUNCH"
        event_type: "secret"
        folder_id: 4
        folder_name: "Windows"
        item_id: 3
        item_name: "Win-DDS-DNA"
        item_type: "Secret"
        network:
          client:
            geoip: {}
            ip: "174.20.20.220"
        rt: 1740464540000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Secret] Action: [Launch] By User: admin Item name: Win-DDS-DNA (Item Id: 3) Container name: Windows (Container Id: 4) Details:  Remote Desktop - 198.20.21.10 Host: [10.20.10.20] Username: [administrator] Account Name: administrator  Account Domain: dds-dns.local"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740464540000
  - sample: "2025-02-25T07:19:03.058Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10140|GROUP - CREATE|2|msg=[[SecretServer]] Event:
      [Group] Action: [Create] By User: admin Item name: Dev-Team (Item Id:
      5)  suid=2 suser=admin cs4=admin cs4Label=suser Display Name
      src=198.20.21.10 rt=Feb 25 2025 07:19:01"
    result:
      custom:
        action: "create"
        action_id: "10140"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "GROUP - CREATE"
        event_type: "group"
        item_id: 5
        item_name: "Dev-Team"
        network:
          client:
            geoip: {}
            ip: "198.20.21.10"
        rt: 1740467941000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Group] Action: [Create] By User: admin Item name: Dev-Team (Item Id: 5)"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740467941000
  - sample: "2025-03-06T10:33:17.456Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|7|FOLDER - CREATE|2|msg=[[SecretServer]] Event:
      [Folder] Action: [Create] By User: admin Item name: Test sub folder (Item
      Id: 11) Container name: Test Logs (Container Id: 10)  suid=2 suser=admin
      cs4=admin cs4Label=suser Display Name src=171.20.12.170 rt=Mar 06 2025
      10:33:13 fname=Test sub folder fileType=Folder fileId=11"
    result:
      custom:
        action: "create"
        action_id: "7"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "FOLDER - CREATE"
        event_type: "folder"
        folder_id: 10
        folder_name: "Test Logs"
        item_id: 11
        item_name: "Test sub folder"
        item_type: "Folder"
        network:
          client:
            geoip: {}
            ip: "171.20.12.170"
        rt: 1741257193000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Folder] Action: [Create] By User: admin Item name: Test sub folder (Item Id: 11) Container name: Test Logs (Container Id: 10)"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1741257193000
  - sample: "2025-02-25T06:31:43.116Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10|ROLE - ASSIGNUSERORGROUP|2|msg=[[SecretServer]]
      Event: [Role] Action: [Assign user or group] By User: admin Item name:
      User (Item Id: 3) Container name: john (Container Id: 3)  suid=2
      suser=admin cs4=admin cs4Label=suser Display Name fname=User fileType=Role
      fileId=3 cs2Label=Group or User cs2=john src=172.22.1.221 rt=Feb 25
      2025 06:31:41"
    result:
      custom:
        action: "assignuserorgroup"
        action_id: "10"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs2Label: "Group or User"
          cs4Label: "suser Display Name"
        event: "ROLE - ASSIGNUSERORGROUP"
        event_type: "role"
        group_or_user: "john"
        item_id: 3
        item_name: "User"
        item_type: "Role"
        network:
          client:
            geoip: {}
            ip: "172.22.1.221"
        rt: 1740465101000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Role] Action: [Assign user or group] By User: admin Item name: User (Item Id: 3) Container name: john (Container Id: 3)"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740465101000
  - sample: "2025-02-25T07:00:33.005Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|15|CONFIGURATION - EDIT|2|msg=[[SecretServer]] Event:
      [Configuration] Action: [Edit] By User: admin
      Details:  AuthenticateAgainstActiveDirectory: false to true;
      EnableActiveDirectoryIntegration: false to true;
      AllowActiveDirectorySynchronization: false to true;
      EnableAutomaticADUserDisabling: false to true;
      AutomaticADUserDisablingIntervalMonths: blank to 3; suid=2 suser=admin
      cs4=admin cs4Label=suser Display Name src=172.22.1.223 rt=Feb 25 2025
      07:00:26"
    result: 
      custom:
        action: "edit"
        action_id: "15"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "CONFIGURATION - EDIT"
        event_type: "configuration"
        network:
          client:
            geoip: {}
            ip: "172.22.1.223"
        rt: 1740466826000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Configuration] Action: [Edit] By User: admin Details:  AuthenticateAgainstActiveDirectory: false to true; EnableActiveDirectoryIntegration: false to true; AllowActiveDirectorySynchronization: false to true; EnableAutomaticADUserDisabling: false to true; AutomaticADUserDisablingIntervalMonths: blank to 3;"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740466826000
  - sample: "2025-02-26T06:36:17.395Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10145|DOMAIN - SYNCHRONIZE|2|msg=[[SecretServer]]
      Event: [Domain] Action: [Synchronize] By User: ThycoticSystem
      Details:  Active Directory sync initiated suid=1 suser=ThycoticSystem
      cs4=ThycoticSystem cs4Label=suser Display Name rt=Feb 26 2025 06:36:16"
    result:
      custom:
        action: "synchronize"
        action_id: "10145"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "DOMAIN - SYNCHRONIZE"
        event_type: "domain"
        rt: 1740551776000
        severity: "info"
        suser_display_name: "ThycoticSystem"
        syslog:
          severity: 2
        usr:
          id: 1
          name: "ThycoticSystem"
      message: "[[SecretServer]] Event: [Domain] Action: [Synchronize] By User: ThycoticSystem Details:  Active Directory sync initiated"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740551776000
  - sample: "2025-02-25T08:57:23.004Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10090|SITECONNECTOR -
      CREDENTIALVIEW|2|msg=[[SecretServer]] Event: [Site connector] Action:
      [Credential view] By User: admin Item name: Default MemoryMq Service (Item
      Id: 1)  suid=2 suser=admin cs4=admin cs4Label=suser Display Name
      src=171.22.1.229 rt=Feb 25 2025 08:57:14"
    result:
      custom:
        action: "credentialview"
        action_id: "10090"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "SITECONNECTOR - CREDENTIALVIEW"
        event_type: "siteconnector"
        item_id: 1
        item_name: "Default MemoryMq Service"
        network:
          client:
            geoip: {}
            ip: "171.22.1.229"
        rt: 1740473834000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Site connector] Action: [Credential view] By User: admin Item name: Default MemoryMq Service (Item Id: 1)"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740473834000
  - sample: '2025-02-27T12:27:17.553Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10051|SECRETPOLICY - CREATE|2|msg=[[SecretServer]]
      Event: [Secret policy] Action: [Create] By User: admin Item name: Test
      (Item Id: 1) Details:  admin created secret policy "Test". suid=2
      suser=admin cs4=admin cs4Label=suser Display Name src=10.20.10.20
      rt=Feb 27 2025 12:27:13'
    result:
      custom:
        action: "create"
        action_id: "10051"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        details: "admin created secret policy \"Test\"."
        event: "SECRETPOLICY - CREATE"
        event_type: "secretpolicy"
        item_id: 1
        item_name: "Test"
        network:
          client:
            geoip: {}
            ip: "10.20.10.20"
        rt: 1740659233000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Secret policy] Action: [Create] By User: admin Item name: Test (Item Id: 1) Details:  admin created secret policy \"Test\"."
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740659233000
  - sample: "2025-03-06T09:09:57.532Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10021|SECRETTEMPLATE - CREATE|2|msg=[[SecretServer]]
      Event: [Secret template] Action: [Create] By User: admin Item name: Test
      for log creation (Item Id: 6054)  suid=2 suser=admin cs4=admin
      cs4Label=suser Display Name src=170.29.1.179 rt=Mar 06 2025 09:09:52"
    result:
      custom:
        action: "create"
        action_id: "10021"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        event: "SECRETTEMPLATE - CREATE"
        event_type: "secrettemplate"
        item_id: 6054
        item_name: "Test for log creation"
        network:
          client:
            geoip: {}
            ip: "170.29.1.179"
        rt: 1741252192000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Secret template] Action: [Create] By User: admin Item name: Test for log creation (Item Id: 6054)"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1741252192000
  - sample: "2025-03-06T11:09:47.383Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10111|IPADDRESSRANGE - DELETE|2|msg=[[SecretServer]]
      Event: [IP address range] Action: [Delete] By User: admin Details:  Test
      Log suid=2 suser=admin cs4=admin cs4Label=suser Display Name
      src=171.21.1.178 rt=Mar 06 2025 11:09:41"
    result:
      custom:
        action: "delete"
        action_id: "10111"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        details: "Test Log"
        event: "IPADDRESSRANGE - DELETE"
        event_type: "ipaddressrange"
        network:
          client:
            geoip: {}
            ip: "171.21.1.178"
        rt: 1741259381000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [IP address range] Action: [Delete] By User: admin Details:  Test Log"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1741259381000
  - sample: "2025-02-26T05:37:07.847Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|500|System Log|7|msg=Archive/Delete Permission check
      returned error message: Folder Path does not exist. rt=Feb 26 2025
      05:37:07"
    result:
      custom:
        action_id: "500"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        event: "System Log"
        event_type: "system log"
        rt: 1740548227000
        severity: "warning"
        syslog:
          severity: 7
      message: "Archive/Delete Permission check returned error message: Folder Path does not exist."
      status: "warn"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1740548227000
  - sample: "2025-03-06T13:13:07.456Z DSS-01 CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10074|SITE - EDIT|2|msg=[[SecretServer]] Event: [Site]
      Action: [Edit] By User: admin Details:  InitializationVector: blank to
      [156, 20, 239, 201, 144, 126, 197, 35, 17, 69, 223, 83, 217, 214, 208,
      251]; suid=2 suser=admin cs4=admin cs4Label=suser Display Name
      src=198.20.21.113 rt=Mar 06 2025 13:12:58"
    result:
      custom:
        action: "edit"
        action_id: "10074"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        details: "InitializationVector: blank to [156, 20, 239, 201, 144, 126, 197, 35, 17, 69, 223, 83, 217, 214, 208, 251];"
        event: "SITE - EDIT"
        event_type: "site"
        network:
          client:
            geoip: {}
            ip: "198.20.21.113"
        rt: 1741266778000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Site] Action: [Edit] By User: admin Details:  InitializationVector: blank to [156, 20, 239, 201, 144, 126, 197, 35, 17, 69, 223, 83, 217, 214, 208, 251];"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1741266778000
  - sample: "2025-03-12T16:25:27.393Z de CEF:0|Thycotic Software|Secret
      Server|11.7.000061|10083|ENGINE - ENGINEACTIVATE|2|msg=[[SecretServer]]
      Event: [Engine] Action: [Engine activated] By User: admin Details:  Engine
      [de.dds-dns.local] has been activated suid=2 suser=admin cs4=admin
      cs4Label=suser Display Name src=10.10.128.10 rt=Mar 12 2025 16:25:18"
    result:
      custom:
        action: "engineactivate"
        action_id: "10083"
        application_name: "Secret Server"
        application_version: "11.7.000061"
        attributeLabels:
          cs4Label: "suser Display Name"
        details: "Engine [de.dds-dns.local] has been activated"
        event: "ENGINE - ENGINEACTIVATE"
        event_type: "engine"
        network:
          client:
            geoip: {}
            ip: "10.10.128.10"
        rt: 1741796718000
        severity: "info"
        suser_display_name: "admin"
        syslog:
          severity: 2
        usr:
          id: 2
          name: "admin"
      message: "[[SecretServer]] Event: [Engine] Action: [Engine activated] By User: admin Details:  Engine [de.dds-dns.local] has been activated"
      status: "info"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1741796718000