id: trend-micro-email-security
tests:
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|400101|TRACKING|4|rt=2024-01-01T11:11:11.111Z suser=user1@example1.com duser=user2@example2.com msg=Test src=1.1.1.1 cs1Label=mailUuid cs1=7ea8f636-c26e-4b78-a341-9b5becb83db7 cs2Label=direction cs2=incoming cs3Label=messageId cs3=<201802061558581772031@example.com> cn1Label=messageSize cn1=110786 act=Quarantined cs4Label=attachments cs4=[{\"fileName\":\"IMG_6838.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6840.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6839.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}] cs5Label=tlsInfo cs5=upstreamTLS: TLS 1.3"
  result:
    custom:
      action: "Quarantined"
      attachments:
       - "{\"fileName\":\"IMG_6838.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
       - "{\"fileName\":\"IMG_6840.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
       - "{\"fileName\":\"IMG_6839.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
      attributeLabels:
        cn1Label: "messageSize"
        cs1Label: "mailUuid"
        cs2Label: "direction"
        cs3Label: "messageId"
        cs4Label: "attachments"
        cs5Label: "tlsInfo"
      direction: "incoming"
      eventid: 400101.0
      genTime: 1704107471111
      mailID: "7ea8f636-c26e-4b78-a341-9b5becb83db7"
      messageID: "201802061558581772031@example.com"
      network:
        client:
          geoip: {}
          ip: "1.1.1.1"
      recipient: "user2@example2.com"
      rt: "2024-01-01T11:11:11.111Z"
      sender: "user1@example1.com"
      service: "tracking"
      status: "info"
      subject: "Test"
      syslog:
        severity: 4
      tlsInfo: "upstreamTLS: TLS 1.3"
      trend_micro_email_security:
        messageSize: 110786
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|400101|TRACKING|4|rt=2024-01-01T11:11:11.111Z suser=user1@example1.com duser=user2@example2.com msg=Test src=1.1.1.1 cs1Label=mailUuid cs1=7ea8f636-c26e-4b78-a341-9b5becb83db7 cs2Label=direction cs2=incoming cs3Label=messageId cs3=<201802061558581772031@example.com> cn1Label=messageSize cn1=110786 act=Quarantined cs4Label=attachments cs4=[{\"fileName\":\"IMG_6838.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6840.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6839.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}] cs5Label=tlsInfo cs5=upstreamTLS: TLS 1.3"
    service: "tracking"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471111
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|400101|TRACKING|4|rt=2024-01-01T11:11:11.111Z duser=user2@example2.com suser=user+1=2@example1.com msg=Test src=1.1.1.1 cs1Label=mailUuid cs1=7ea8f636-c26e-4b78-a341-9b5becb83db7 cs2Label=direction cs2=incoming cs3Label=messageId cs3=<201802061558581772031@example.com> cn1Label=messageSize cn1=110786 act=Quarantined cs4Label=attachments cs4=[{\"fileName\":\"IMG_6838.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6840.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6839.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}] cs5Label=tlsInfo cs5=upstreamTLS: TLS 1.3"
  result:
    custom:
      action: "Quarantined"
      attachments:
       - "{\"fileName\":\"IMG_6838.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
       - "{\"fileName\":\"IMG_6840.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
       - "{\"fileName\":\"IMG_6839.JPG\""
       - "\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}"
      attributeLabels:
        cn1Label: "messageSize"
        cs1Label: "mailUuid"
        cs2Label: "direction"
        cs3Label: "messageId"
        cs4Label: "attachments"
        cs5Label: "tlsInfo"
      direction: "incoming"
      eventid: 400101.0
      genTime: 1704107471111
      mailID: "7ea8f636-c26e-4b78-a341-9b5becb83db7"
      messageID: "201802061558581772031@example.com"
      network:
        client:
          geoip: {}
          ip: "1.1.1.1"
      recipient: "user2@example2.com"
      rt: "2024-01-01T11:11:11.111Z"
      sender: "user+1=2@example1.com"
      service: "tracking"
      status: "info"
      subject: "Test"
      syslog:
        severity: 4
      tlsInfo: "upstreamTLS: TLS 1.3"
      trend_micro_email_security:
        messageSize: 110786
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|400101|TRACKING|4|rt=2024-01-01T11:11:11.111Z duser=user2@example2.com suser=user+1=2@example1.com msg=Test src=1.1.1.1 cs1Label=mailUuid cs1=7ea8f636-c26e-4b78-a341-9b5becb83db7 cs2Label=direction cs2=incoming cs3Label=messageId cs3=<201802061558581772031@example.com> cn1Label=messageSize cn1=110786 act=Quarantined cs4Label=attachments cs4=[{\"fileName\":\"IMG_6838.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6840.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"},{\"fileName\":\"IMG_6839.JPG\",\"sha256\":\"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e\"}] cs5Label=tlsInfo cs5=upstreamTLS: TLS 1.3"
    service: "tracking"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471111
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|100101|DETECTION|6|rt=2024-01-01T11:11:11.111Z cs1Label=eventType cs1=phishing cs2Label=domainName cs2=example1.com suser=user1@example1.com duser=user2@example2.com cs3Label=direction cs3=incoming cs4Label=messageId cs4=<201802061558581772031@example.com> msg=Verify your recent Paypal Login. cn1Label=messageSize cn1=8108 cs5Label=policyName cs5=Organization: Spam or Phish act=Quarantine cs6Label=details cs6={\"spamReport\":{\"enginePatternVersion\":\"9.1.0.1023;28430006\",\"spamResultHeader\":\"12-61.305000-7.000000\",\"spamRidHeader\":\"9K6OzQCiKE7zM6ecwoboGZLfX5Gnp7prgmDrf1zpvMS6foOGZryRylfQKjekZ+rhAGQJ4gQhehoED9lHmqenw2oTqU8IxUnLma5Qz6w5yRdvSvtg+ZtwNv57bd7fnmWyZdPNNq+hOYDcdNV++dLhRFrnBGaGznk0MtqLW6iaAWojX0IkaZrKuuM8Gx7eB++8azLNsoH1anyrVsmhQqjIEpg2bPTK51SPue+MXDyHOKViRkRaCb8R6rwptKEZVSFON0k3BPiMJd82vloDwxXReSJZM9bpdaLOTZW1d55txTpPY31/tBnhHVlUrfbEO4XLoxoOGgfqmoWFFO2MNm6/rYNo8aigfXl27l2rdWvCNNLYEsc0rY6uIzmoNwIfiIkBOteHVGUMZ+CCAE1EKFooi9sZEa6FhDr/hwoXg5tKrXI8Kl/p2lkA3yOBUNfl7yjX6knnvwW4IBrlDUPFhvg8bdrm58Qo63ifbZV1yGYsALXcUM8eHgEsoSNtLITDj2qg75rS2rwbHajJtoyGVE0N8B2OWvOeeOFgERHJp/LC8yhIZJVWgmZoiUXAu2AdPCjay3lb5BXIUBraHGpNWFFrlFwHkvsOWIElewkA5d2ECrJP9lenBzC0IPCaoDKYGUf1Mh64lt1LdnMg9aSS/j3h2mptfQT7Y5fSnzX0voMPHKbtpuulZPDu4La+oPjYPJTs61QLTB7pBzZRyflMZlN/KZufzCD644GrmbRj7PVyNI1rAlSpuYY8HaryV/2jRq/XCL2cB40CER6dxbKU9TgFq2zD8QwRdriSNoIyp7OOjhuZ82QLu17vbST5U3lJ4T8K5qcUWsc4XNOJkcezle6Wsxme9l60CJ/XiYND5QoK3VoiVDZDa7ea/VhU9WiBKMRl\",\"snapHeader\":\"Not\",\"spamXGenCloudHeader\":\"71c5bfd7-0ace-4177-ad9e-f96523a93294-0-0-200-0\"}}"
  result:
    custom:
      action: "Quarantine"
      attributeLabels:
        cn1Label: "messageSize"
        cs1Label: "eventType"
        cs2Label: "domainName"
        cs3Label: "direction"
        cs4Label: "messageId"
        cs5Label: "policyName"
        cs6Label: "details"
      cs1: "phishing"
      details: "\"spamReport\":{\"enginePatternVersion\":\"9.1.0.1023;28430006\",\"spamResultHeader\":\"12-61.305000-7.000000\",\"spamRidHeader\":\"9K6OzQCiKE7zM6ecwoboGZLfX5Gnp7prgmDrf1zpvMS6foOGZryRylfQKjekZ+rhAGQJ4gQhehoED9lHmqenw2oTqU8IxUnLma5Qz6w5yRdvSvtg+ZtwNv57bd7fnmWyZdPNNq+hOYDcdNV++dLhRFrnBGaGznk0MtqLW6iaAWojX0IkaZrKuuM8Gx7eB++8azLNsoH1anyrVsmhQqjIEpg2bPTK51SPue+MXDyHOKViRkRaCb8R6rwptKEZVSFON0k3BPiMJd82vloDwxXReSJZM9bpdaLOTZW1d55txTpPY31/tBnhHVlUrfbEO4XLoxoOGgfqmoWFFO2MNm6/rYNo8aigfXl27l2rdWvCNNLYEsc0rY6uIzmoNwIfiIkBOteHVGUMZ+CCAE1EKFooi9sZEa6FhDr/hwoXg5tKrXI8Kl/p2lkA3yOBUNfl7yjX6knnvwW4IBrlDUPFhvg8bdrm58Qo63ifbZV1yGYsALXcUM8eHgEsoSNtLITDj2qg75rS2rwbHajJtoyGVE0N8B2OWvOeeOFgERHJp/LC8yhIZJVWgmZoiUXAu2AdPCjay3lb5BXIUBraHGpNWFFrlFwHkvsOWIElewkA5d2ECrJP9lenBzC0IPCaoDKYGUf1Mh64lt1LdnMg9aSS/j3h2mptfQT7Y5fSnzX0voMPHKbtpuulZPDu4La+oPjYPJTs61QLTB7pBzZRyflMZlN/KZufzCD644GrmbRj7PVyNI1rAlSpuYY8HaryV/2jRq/XCL2cB40CER6dxbKU9TgFq2zD8QwRdriSNoIyp7OOjhuZ82QLu17vbST5U3lJ4T8K5qcUWsc4XNOJkcezle6Wsxme9l60CJ/XiYND5QoK3VoiVDZDa7ea/VhU9WiBKMRl\",\"snapHeader\":\"Not\",\"spamXGenCloudHeader\":\"71c5bfd7-0ace-4177-ad9e-f96523a93294-0-0-200-0\"}"
      direction: "incoming"
      domainName: "example1.com"
      eventType: "Phishing"
      eventid: 100101.0
      genTime: 1704107471111
      messageID: "201802061558581772031@example.com"
      policyName: "Organization: Spam or Phish"
      recipients:
       - "user2@example2.com"
      rt: "2024-01-01T11:11:11.111Z"
      sender: "user1@example1.com"
      service: "detection"
      status: "critical"
      subject: "Verify your recent Paypal Login."
      syslog:
        severity: 6
      trend_micro_email_security:
        messageSize: 8108
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|100101|DETECTION|6|rt=2024-01-01T11:11:11.111Z cs1Label=eventType cs1=phishing cs2Label=domainName cs2=example1.com suser=user1@example1.com duser=user2@example2.com cs3Label=direction cs3=incoming cs4Label=messageId cs4=<201802061558581772031@example.com> msg=Verify your recent Paypal Login. cn1Label=messageSize cn1=8108 cs5Label=policyName cs5=Organization: Spam or Phish act=Quarantine cs6Label=details cs6={\"spamReport\":{\"enginePatternVersion\":\"9.1.0.1023;28430006\",\"spamResultHeader\":\"12-61.305000-7.000000\",\"spamRidHeader\":\"9K6OzQCiKE7zM6ecwoboGZLfX5Gnp7prgmDrf1zpvMS6foOGZryRylfQKjekZ+rhAGQJ4gQhehoED9lHmqenw2oTqU8IxUnLma5Qz6w5yRdvSvtg+ZtwNv57bd7fnmWyZdPNNq+hOYDcdNV++dLhRFrnBGaGznk0MtqLW6iaAWojX0IkaZrKuuM8Gx7eB++8azLNsoH1anyrVsmhQqjIEpg2bPTK51SPue+MXDyHOKViRkRaCb8R6rwptKEZVSFON0k3BPiMJd82vloDwxXReSJZM9bpdaLOTZW1d55txTpPY31/tBnhHVlUrfbEO4XLoxoOGgfqmoWFFO2MNm6/rYNo8aigfXl27l2rdWvCNNLYEsc0rY6uIzmoNwIfiIkBOteHVGUMZ+CCAE1EKFooi9sZEa6FhDr/hwoXg5tKrXI8Kl/p2lkA3yOBUNfl7yjX6knnvwW4IBrlDUPFhvg8bdrm58Qo63ifbZV1yGYsALXcUM8eHgEsoSNtLITDj2qg75rS2rwbHajJtoyGVE0N8B2OWvOeeOFgERHJp/LC8yhIZJVWgmZoiUXAu2AdPCjay3lb5BXIUBraHGpNWFFrlFwHkvsOWIElewkA5d2ECrJP9lenBzC0IPCaoDKYGUf1Mh64lt1LdnMg9aSS/j3h2mptfQT7Y5fSnzX0voMPHKbtpuulZPDu4La+oPjYPJTs61QLTB7pBzZRyflMZlN/KZufzCD644GrmbRj7PVyNI1rAlSpuYY8HaryV/2jRq/XCL2cB40CER6dxbKU9TgFq2zD8QwRdriSNoIyp7OOjhuZ82QLu17vbST5U3lJ4T8K5qcUWsc4XNOJkcezle6Wsxme9l60CJ/XiYND5QoK3VoiVDZDa7ea/VhU9WiBKMRl\",\"snapHeader\":\"Not\",\"spamXGenCloudHeader\":\"71c5bfd7-0ace-4177-ad9e-f96523a93294-0-0-200-0\"}}"
    service: "detection"
    status: "critical"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471111
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|100101|DETECTION|6|rt=2024-01-01T11:11:11.111Z cs1Label=eventType cs1=virus cs2Label=domainName cs2=example1.com suser=user1@example1.com duser=user2@example2.com cs3Label=direction cs3=outgoing cs4Label=messageId cs4=<201802061558581772031@example.com> msg=eicar.org cn1Label=messageSize cn1=2926 cs5Label=policyName cs5=Organization: Global Outbound Policy (Virus) act=Quarantine cs6Label=details cs6={\"threatNames\":\"Eicar_test_file\",\"fileInfo\":[{\"fileName\":\"noname\",\"threatName\":\"Eicar_test_file\"}]}"
  result:
    custom:
      action: "Quarantine"
      attributeLabels:
        cn1Label: "messageSize"
        cs1Label: "eventType"
        cs2Label: "domainName"
        cs3Label: "direction"
        cs4Label: "messageId"
        cs5Label: "policyName"
        cs6Label: "details"
      cs1: "virus"
      details: "\"threatNames\":\"Eicar_test_file\",\"fileInfo\":[{\"fileName\":\"noname\",\"threatName\":\"Eicar_test_file\"}]"
      direction: "outgoing"
      domainName: "example1.com"
      eventType: "Malware"
      eventid: 100101.0
      genTime: 1704107471111
      messageID: "201802061558581772031@example.com"
      policyName: "Organization: Global Outbound Policy (Virus)"
      recipients:
       - "user2@example2.com"
      rt: "2024-01-01T11:11:11.111Z"
      sender: "user1@example1.com"
      service: "detection"
      status: "critical"
      subject: "eicar.org"
      syslog:
        severity: 6
      trend_micro_email_security:
        messageSize: 2926
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|100101|DETECTION|6|rt=2024-01-01T11:11:11.111Z cs1Label=eventType cs1=virus cs2Label=domainName cs2=example1.com suser=user1@example1.com duser=user2@example2.com cs3Label=direction cs3=outgoing cs4Label=messageId cs4=<201802061558581772031@example.com> msg=eicar.org cn1Label=messageSize cn1=2926 cs5Label=policyName cs5=Organization: Global Outbound Policy (Virus) act=Quarantine cs6Label=details cs6={\"threatNames\":\"Eicar_test_file\",\"fileInfo\":[{\"fileName\":\"noname\",\"threatName\":\"Eicar_test_file\"}]}"
    service: "detection"
    status: "critical"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471111
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|500101|CTP_DETECTION|2|rt=2024-01-01 11:11:11 cs2Label=timeOfClick cs2=2024-01-01 11:11:11 request=http://example4.com act=warned but accessed msg=hello cs1Label=messageId cs1=<202102181642138223747@trend.com> suser=user1@example1.com duser=user2@example2.com"
  result:
    custom:
      action: "warned but accessed"
      attributeLabels:
        cs1Label: "messageId"
        cs2Label: "timeOfClick"
      email_severity: "Safe"
      eventid: 500101.0
      genTime: 1704107471000
      messageId: "202102181642138223747@trend.com"
      recipient: "user2@example2.com"
      rt: "2024-01-01 11:11:11"
      sender: "user1@example1.com"
      service: "ctp_detection"
      status: "ok"
      subject: "hello"
      syslog:
        severity: 2
      timeOfClick: "2024-01-01 11:11:11"
      trend_micro_email_security:
        url: "http://example4.com"
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|500101|CTP_DETECTION|2|rt=2024-01-01 11:11:11 cs2Label=timeOfClick cs2=2024-01-01 11:11:11 request=http://example4.com act=warned but accessed msg=hello cs1Label=messageId cs1=<202102181642138223747@trend.com> suser=user1@example1.com duser=user2@example2.com"
    service: "ctp_detection"
    status: "ok"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471000
 -
  sample: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|300101|AUDIT|4|rt=2024-01-01T11:11:11Z cs1Label=accountType cs1=admin suser=user1@example1.com cs2Label=eventType cs2=Administration act=Edit Syslog Setting (Audit Logs) cs3Label=affectedDomains cs3=example1.com"
  result:
    custom:
      accountType: "admin"
      action: "Edit Syslog Setting (Audit Logs)"
      affectedDomains: "example1.com"
      attributeLabels:
        cs1Label: "accountType"
        cs2Label: "eventType"
        cs3Label: "affectedDomains"
      eventType: "Administration"
      eventid: 300101.0
      genTime: 1704107471000
      rt: "2024-01-01T11:11:11Z"
      service: "audit"
      status: "info"
      syslog:
        severity: 4
      usr:
        name: "user1@example1.com"
    message: "<14> 2024-01-01T11:11:11Z forwarder.tmes.trendmicro.com tmes[1]: CEF:0|Trend Micro|TMES|1.0.0.0|300101|AUDIT|4|rt=2024-01-01T11:11:11Z cs1Label=accountType cs1=admin suser=user1@example1.com cs2Label=eventType cs2=Administration act=Edit Syslog Setting (Audit Logs) cs3Label=affectedDomains cs3=example1.com"
    service: "audit"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1704107471000