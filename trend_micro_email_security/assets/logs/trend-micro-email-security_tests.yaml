id: trend-micro-email-security
tests:
  - sample:
      '{"genTime":"2024-01-01T01:01:01Z","timestamp":"2024-01-01T01:01:02Z","deliveryTime":"2024-01-01T01:01:05Z","sender":"sender@example.com","direction":"in","messageID":"<7bebfeb6-f035-451f-8c4f-3377ab457b07@atl1s07mta2135.xt.local>","subject":"response
      sample","size":66390,"mailID":"73173f80-2e0e-46df-b2dc-a62e80167067","recipient":"rcpt@example.com","action":"Delivered","tlsInfo":"upstreamTLS:
      TLS 1.2; downstreamTLS: TLS
      1.2","headerFrom":"header_sender@example.com","headerTo":["header_rcpt1@example.com","header_rcpt2@example.com","header_rcpt3@example.com"],"senderIP":"1.1.1.1","deliveredTo":"2.2.2.2","attachments":[{"fileName":"test1.zip","sha256":"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e"},{"fileName":"test2.zip","sha256":"329436266f3927e89ea961e26855c8bd1f51401d92babd6627e493295376daf5"}],"embeddedUrls":["http://example1.com","http://example2.com"],"details":"250
      2.0.0 Ok: queued as 3CBEFC0811","type":"accepted_traffic"}'
    service: tracking
    result: null
  - sample:
      '{"genTime":"2024-01-01T01:01:01Z","timestamp":"2024-01-01T01:01:02Z","deliveryTime":"2024-01-01T01:01:05Z","sender":"sender@example.com","direction":"out","messageID":"<7bebfeb6-f035-451f-8c4f-3377ab457b07@atl1s07mta2135.xt.local>","subject":"response
      sample","size":66390,"mailID":"73173f80-2e0e-46df-b2dc-a62e80167067","recipient":"rcpt@example.com","action":"Delivered","tlsInfo":"upstreamTLS:
      TLS 1.2; downstreamTLS: TLS
      1.2","headerFrom":"header_sender@example.com","headerTo":["header_rcpt1@example.com","header_rcpt2@example.com","header_rcpt3@example.com"],"senderIP":"1.1.1.1","deliveredTo":"example.com[2.2.2.2]:25","attachments":[{"fileName":"test1.zip","sha256":"f78960148721b59dcb563b9964a4d47e2a834a4259f46cd12db7c1cfe82ff32e"},{"fileName":"test2.zip","sha256":"329436266f3927e89ea961e26855c8bd1f51401d92babd6627e493295376daf5"}],"embeddedUrls":["http://example1.com","http://example2.com"],"details":"250
      2.0.0 Ok: queued as 3CBEFC0811","type":"accepted_traffic"}'
    service: tracking
    result: null
  - sample:
      '{"timestamp":"2024-01-01T01:01:02.002Z","genTime":"2024-01-01T01:01:01.001Z","eventType":"Suspicious
      Objects","eventSubtype":"Suspicious
      URLs","domainName":"example.com","sender":"sender@example.com","headerFrom":"header_sender@example.com","recipients":["rcpt1@example.com","rcpt2@example.com"],"headerTo":["header_rcpt1@example.com","header_rcpt2@example.com"],"direction":"in","messageID":"<20200725033505.DC75B100860D8@example.com>","subject":"response
      sample","size":6564,"policyName":"test_policy: example.com:
      Virus","policyAction":"Bypass","details":"{\"urlInfo\":[{\"url\":\"https://mcusercontent.com/87564ad664ceeac44909ec631/images/a8730208-6096-404c-9dd6-1c61c47a2861.png);background-repeat:\",\"extractType\":\"body\"}]}"}'
    service: detection
    result: null
