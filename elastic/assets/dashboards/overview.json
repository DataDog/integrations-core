{
    "title": "Elasticsearch - Overview",
    "description": "This dashboard provides a high-level overview of your Elasticsearch clusters, so you can track health status, search and indexing performance, and resource utilization metrics from all your nodes and be better prepared to address potential issues. Further reading on Elasticsearch monitoring:\n\n- [Datadog's guide to key Elasticsearch metrics](https://www.datadoghq.com/blog/monitor-elasticsearch-performance-metrics/)\n\n- [How to collect Elasticsearch metrics with native and open source tools](https://www.datadoghq.com/blog/collect-elasticsearch-metrics/)\n\n- [How to monitor Elasticsearch with Datadog](https://www.datadoghq.com/blog/monitor-elasticsearch-datadog/)\n\n- [How to solve 5 Elasticsearch performance and scaling problems](https://www.datadoghq.com/blog/elasticsearch-performance-scaling-problems/)\n\n- [How to resolve unassigned shards in Elasticsearch](https://www.datadoghq.com/blog/elasticsearch-unassigned-shards/)\n\n- [Datadog's Elasticsearch integration docs](https://docs.datadoghq.com/integrations/elastic/)\n\nClone this template dashboard to make changes and add your own graph widgets. (cloned) (cloned)",
    "author_name": "Datadog",
    "widgets": [
      {
        "id": 0,
        "definition": {
          "type": "note",
          "content": "This dashboard provides a **high-level** overview of your Elasticsearch clusters, so you can track health status, search and indexing performance, and resource utilization metrics from all your nodes and be better prepared to address potential issues.\nFurther reading on Elasticsearch monitoring:\n\n- [Datadog's guide to key Elasticsearch metrics](https://www.datadoghq.com/blog/monitor-elasticsearch-performance-metrics/)\n\n- [How to collect Elasticsearch metrics with native and open source tools](https://www.datadoghq.com/blog/collect-elasticsearch-metrics/)\n\n- [How to monitor Elasticsearch with Datadog](https://www.datadoghq.com/blog/monitor-elasticsearch-datadog/)\n\n- [How to solve 5 Elasticsearch performance and scaling problems](https://www.datadoghq.com/blog/elasticsearch-performance-scaling-problems/)\n\n- [How to resolve unassigned shards in Elasticsearch](https://www.datadoghq.com/blog/elasticsearch-unassigned-shards/)\n\n- [Datadog's Elasticsearch integration docs](https://docs.datadoghq.com/integrations/elastic/)",
          "background_color": "white",
          "font_size": "16",
          "text_align": "left",
          "vertical_align": "top",
          "show_tick": false,
          "tick_pos": "50%",
          "tick_edge": "left",
          "has_padding": true
        },
        "layout": { "x": 0, "y": 0, "width": 4, "height": 5 }
      },
      {
        "id": 1,
        "definition": {
          "title": "Overview",
          "reflow_type": "fixed",
          "type": "group",
          "layout_type": "ordered",
          "widgets": [
            {
              "id": 6,
              "definition": {
                "title": "Total store size",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "sum:elasticsearch.store.size{$cluster_name}",
                    "aggregator": "last"
                  }
                ],
                "autoscale": true,
                "precision": 0
              },
              "layout": { "x": 0, "y": 0, "width": 2, "height": 2 }
            },
            {
              "id": 7,
              "definition": {
                "title": "Disk space used",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "(1-(sum:elasticsearch.fs.total.available_in_bytes{$cluster_name} by {host}/sum:elasticsearch.fs.total.total_in_bytes{$cluster_name} by {host}))*100",
                    "aggregator": "avg",
                    "conditional_formats": [
                      {
                        "comparator": "<",
                        "palette": "black_on_light_green",
                        "value": 80
                      },
                      {
                        "comparator": ">",
                        "palette": "black_on_light_yellow",
                        "value": 80
                      },
                      {
                        "comparator": ">",
                        "palette": "black_on_light_red",
                        "value": 90
                      }
                    ]
                  }
                ],
                "custom_unit": "%",
                "precision": 1
              },
              "layout": { "x": 2, "y": 0, "width": 2, "height": 2 }
            },
            {
              "id": 8,
              "definition": {
                "title": "Average of file descriptors",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "avg:elasticsearch.process.open_fd{$cluster_name,$node_name}",
                    "aggregator": "avg"
                  }
                ],
                "autoscale": true,
                "precision": 2
              },
              "layout": { "x": 4, "y": 0, "width": 4, "height": 2 }
            },
            {
              "id": 9,
              "definition": {
                "title": "Available nodes",
                "title_size": "13",
                "title_align": "center",
                "type": "check_status",
                "check": "elasticsearch.can_connect",
                "grouping": "cluster",
                "group_by": [],
                "tags": []
              },
              "layout": { "x": 0, "y": 2, "width": 3, "height": 2 }
            },
            {
              "id": 10,
              "definition": {
                "title": "Nodes by cluster status",
                "title_size": "13",
                "title_align": "center",
                "type": "check_status",
                "check": "elasticsearch.cluster_health",
                "grouping": "cluster",
                "group_by": [],
                "tags": []
              },
              "layout": { "x": 3, "y": 2, "width": 3, "height": 2 }
            },
            {
              "id": 11,
              "definition": {
                "type": "note",
                "content": "If the cluster status is `yellow`, at least one replica shard is **unallocated or missing**. Search results will still be complete, but if more shards disappear, you may **lose** data.\n\nA `red` cluster status indicates that at least one `primary` shard is missing, and you are **missing** data, which means that searches will return partial results. You will also be blocked from indexing into that shard. Consider setting up an **alert** to trigger if status has been yellow for more than 5 min or if the status has been red for the past minute.",
                "background_color": "white",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
              },
              "layout": { "x": 6, "y": 2, "width": 2, "height": 2 }
            }
          ]
        },
        "layout": { "x": 4, "y": 0, "width": 8, "height": 5 }
      },
      {
        "id": 2,
        "definition": {
          "title": "Cluster Performance",
          "reflow_type": "fixed",
          "type": "group",
          "layout_type": "ordered",
          "widgets": [
            {
              "id": 12,
              "definition": {
                "title": "Avg query and fetch latency over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "(sum:elasticsearch.search.query.time{$cluster_name}/sum:elasticsearch.search.query.total{$cluster_name})",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  },
                  {
                    "q": "(sum:elasticsearch.search.fetch.time{$cluster_name}/sum:elasticsearch.search.fetch.total{$cluster_name})",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 0, "y": 0, "width": 8, "height": 3 }
            },
            {
              "id": 13,
              "definition": {
                "type": "note",
                "content": "Set an **alert** if the query latency exceeds a threshold, and if it fires, look for potential resource bottlenecks, or investigate whether you need to optimize your queries.\n\nThe `fetch latency` should typically be much less than the `query latency`. If you notice this metric consistently increasing, this could indicate a problem with **slow disks**, enriching of documents (highlighting relevant text in search results, etc.), or requesting too many results.\n",
                "background_color": "white",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
              },
              "layout": { "x": 8, "y": 0, "width": 4, "height": 3 }
            },
            {
              "id": 14,
              "definition": {
                "title": "Number of documents in $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "sum:elasticsearch.docs.count{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "dog_classic",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 0, "y": 3, "width": 6, "height": 2 }
            },
            {
              "id": 15,
              "definition": {
                "title": "Avg indexing latency over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "avg:elasticsearch.indexing.index.time{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "dog_classic",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 6, "y": 3, "width": 6, "height": 2 }
            },
            {
              "id": 16,
              "definition": {
                "title": "Indexing ops per node",
                "title_size": "16",
                "title_align": "left",
                "time": {},
                "type": "toplist",
                "requests": [
                  {
                    "q": "top(diff(avg:elasticsearch.indexing.index.total{$cluster_name} by {host}), 10, 'sum', 'desc')"
                  }
                ]
              },
              "layout": { "x": 0, "y": 5, "width": 3, "height": 2 }
            },
            {
              "id": 17,
              "definition": {
                "title": "Queries per node",
                "title_size": "16",
                "title_align": "left",
                "time": {},
                "type": "toplist",
                "requests": [
                  {
                    "q": "top(diff(avg:elasticsearch.search.query.total{$cluster_name} by {host}), 10, 'sum', 'desc')"
                  }
                ]
              },
              "layout": { "x": 3, "y": 5, "width": 3, "height": 2 }
            },
            {
              "id": 18,
              "definition": {
                "title": "Total number of pending task in $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "sum:elasticsearch.pending_tasks_total{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "dog_classic",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 6, "y": 5, "width": 6, "height": 2 }
            }
          ]
        }
      },
      {
        "id": 3,
        "definition": {
          "title": "Shards",
          "reflow_type": "fixed",
          "type": "group",
          "layout_type": "ordered",
          "widgets": [
            {
              "id": 19,
              "definition": {
                "title": "Active shards over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "max:elasticsearch.active_shards{$cluster_name}",
                    "aggregator": "max"
                  }
                ],
                "autoscale": true,
                "precision": 0
              },
              "layout": { "x": 0, "y": 0, "width": 4, "height": 2 }
            },
            {
              "id": 20,
              "definition": {
                "title": "Initializing shards",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "max:elasticsearch.initializing_shards{$cluster_name}",
                    "aggregator": "max",
                    "conditional_formats": [
                      {
                        "comparator": ">",
                        "palette": "black_on_light_red",
                        "value": 0
                      },
                      {
                        "comparator": ">=",
                        "palette": "black_on_light_green",
                        "value": 0
                      }
                    ]
                  }
                ],
                "autoscale": false,
                "custom_unit": "",
                "precision": 0
              },
              "layout": { "x": 4, "y": 0, "width": 4, "height": 2 }
            },
            {
              "id": 21,
              "definition": {
                "title": "Relocating shards",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "max:elasticsearch.relocating_shards{$cluster_name}",
                    "aggregator": "max",
                    "conditional_formats": [
                      {
                        "comparator": ">",
                        "palette": "black_on_light_red",
                        "value": 0
                      },
                      {
                        "comparator": "<=",
                        "palette": "black_on_light_green",
                        "value": 0
                      }
                    ]
                  }
                ],
                "autoscale": true,
                "precision": 0
              },
              "layout": { "x": 8, "y": 0, "width": 4, "height": 2 }
            },
            {
              "id": 22,
              "definition": {
                "title": "Unassigned shards",
                "title_size": "16",
                "title_align": "left",
                "type": "query_value",
                "requests": [
                  {
                    "q": "max:elasticsearch.unassigned_shards{$cluster_name}",
                    "aggregator": "max",
                    "conditional_formats": [
                      {
                        "comparator": ">",
                        "palette": "black_on_light_red",
                        "value": 0
                      },
                      {
                        "comparator": ">=",
                        "palette": "black_on_light_green",
                        "value": 0
                      }
                    ]
                  }
                ],
                "autoscale": true,
                "precision": 0
              },
              "layout": { "x": 0, "y": 2, "width": 4, "height": 2 }
            },
            {
              "id": 23,
              "definition": {
                "type": "note",
                "content": "If the number of unassigned shard > `0`, it often means that an action should be taken. Among the possible source of error, the two main ones are the following:\n\n- It is possible that the shard allocation is purposefully delayed, in that case a logs with the message `delaying allocation for [54] unassigned shards, next check in [1m]` should appear too.\n\n- Other possibility is that there are **too many shards** for not enough **nodes**. In that case, make sure that every index in your cluster is initialised with **fewer** replicas per primary shard than the number of nodes in your cluster.\n",
                "background_color": "transparent",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": false,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": false
              },
              "layout": { "x": 4, "y": 2, "width": 8, "height": 2 }
            },
            {
              "id": 24,
              "definition": {
                "title": "Active shards (total and primary) over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "max:elasticsearch.active_shards{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  },
                  {
                    "q": "max:elasticsearch.active_primary_shards{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 0, "y": 4, "width": 6, "height": 3 }
            },
            {
              "id": 25,
              "definition": {
                "title": "Shards initializing, relocating, unassigned over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": true,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "max:elasticsearch.initializing_shards{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  },
                  {
                    "q": "max:elasticsearch.unassigned_shards{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  },
                  {
                    "q": "max:elasticsearch.relocating_shards{$cluster_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "cool",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "line"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 6, "y": 4, "width": 6, "height": 3 }
            }
          ]
        }
      },
      {
        "id": 4,
        "definition": {
          "title": "Network Summary",
          "reflow_type": "fixed",
          "type": "group",
          "layout_type": "ordered",
          "widgets": [
            {
              "id": 26,
              "definition": {
                "title": "Bytes received over $cluster_name,$node_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "per_second(avg:elasticsearch.transport.rx_count{$cluster_name,$node_name} by {host})",
                    "style": {
                      "palette": "green",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                }
              },
              "layout": { "x": 0, "y": 0, "width": 7, "height": 2 }
            },
            {
              "id": 27,
              "definition": {
                "type": "note",
                "content": "A `GET` request is more straightforward than a normal search request—it retrieves a document based on its ID.\n\nAn unsuccessful get-by-ID request means that the document ID was **not found**.\n\nYou shouldn’t usually have a problem with this type of request, but it may be a good idea to keep an eye out for unsuccessful `GET` requests when they happen.\n",
                "background_color": "white",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
              },
              "layout": { "x": 7, "y": 0, "width": 5, "height": 2 }
            },
            {
              "id": 28,
              "definition": {
                "title": "Rate of opened HTTP connections over $cluster_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "per_second(sum:elasticsearch.http.total_opened{$cluster_name})",
                    "style": {
                      "palette": "dog_classic",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                }
              },
              "layout": { "x": 0, "y": 2, "width": 7, "height": 2 }
            },
            {
              "id": 29,
              "definition": {
                "type": "note",
                "content": "Requests sent in any language but `Java` will communicate with Elasticsearch using RESTful API over HTTP.\n\nIf the total number of opened HTTP connections is constantly `increasing`, it could indicate that your HTTP clients are not properly establishing **persistent** connections.\n",
                "background_color": "white",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
              },
              "layout": { "x": 7, "y": 2, "width": 5, "height": 2 }
            },
            {
              "id": 30,
              "definition": {
                "title": "Total number of unsuccessful GETs over $cluster_name,$node_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "sum:elasticsearch.get.missing.total{$cluster_name,$node_name}",
                    "on_right_yaxis": false,
                    "style": {
                      "palette": "dog_classic",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                },
                "markers": []
              },
              "layout": { "x": 0, "y": 4, "width": 7, "height": 2 }
            },
            {
              "id": 31,
              "definition": {
                "type": "note",
                "content": "Communication between nodes is a **key** component of a balanced cluster.\n\nYou’ll want to monitor the network to make sure it’s healthy and that it keeps up with the demands on your cluster *(e.g. as shards are replicated or rebalanced across nodes)*. \n\n`Elasticsearch` provides transport metrics about cluster communication, but you can also look at the `rate` of bytes sent and received to see how much **traffic** your network is receiving.\n",
                "background_color": "transparent",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": true,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
              },
              "layout": { "x": 7, "y": 4, "width": 5, "height": 4 }
            },
            {
              "id": 32,
              "definition": {
                "title": "Bytes sent over $cluster_name,$node_name",
                "title_size": "16",
                "title_align": "left",
                "show_legend": false,
                "legend_size": "0",
                "type": "timeseries",
                "requests": [
                  {
                    "q": "per_second(avg:elasticsearch.transport.tx_count{$cluster_name,$node_name} by {host})",
                    "style": {
                      "palette": "purple",
                      "line_type": "solid",
                      "line_width": "normal"
                    },
                    "display_type": "area"
                  }
                ],
                "yaxis": {
                  "scale": "linear",
                  "label": "",
                  "include_zero": true,
                  "min": "auto",
                  "max": "auto"
                }
              },
              "layout": { "x": 0, "y": 6, "width": 7, "height": 2 }
            }
          ]
        }
      },
      {
        "id": 5,
        "definition": {
          "title": "Logs",
          "reflow_type": "fixed",
          "type": "group",
          "layout_type": "ordered",
          "widgets": [
            {
              "id": 33,
              "definition": {
                "title": "",
                "type": "log_stream",
                "indexes": [],
                "query": "source:elasticsearch $cluster_name",
                "sort": { "column": "time", "order": "desc" },
                "columns": ["core_host", "core_service"],
                "show_date_column": true,
                "show_message_column": true,
                "message_display": "expanded-lg"
              },
              "layout": { "x": 0, "y": 0, "width": 12, "height": 12 }
            }
          ]
        }
      }
    ],
    "template_variables": [
      { "name": "cluster_name", "default": "*", "prefix": "cluster_name" },
      { "name": "node_name", "default": "*", "prefix": "node_name" }
    ],
    "layout_type": "ordered",
    "is_read_only": true,
    "notify_list": [],
    "reflow_type": "fixed",
    "id": "gsc-a6s-mt3"
  }
  