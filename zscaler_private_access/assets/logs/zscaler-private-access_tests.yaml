id: zscaler-private-access
tests:
  - sample: >-
      {
          "ModifiedTime": "2025-08-28T07:02:15.000Z",
          "CreationTime": "2025-08-28T07:02:15.000Z",
          "ModifiedBy": 99887766554433221,
          "RequestID": "b11bb11b-2233-bbc2-223bc223456b",
          "AuditOldValue": "",
          "AuditNewValue": "{\"id\":\"98765432100123457\",\"name\":\"finance.test.com\",\"applicationId\":\"22312312312312301\",\"applicationPort\":\"8443\",\"applicationProtocol\":\"HTTPS\",\"certificateId\":\"20203040506070810\",\"domain\":\"finance.test.com\",\"enabled\":\"true\",\"hidden\":\"false\",\"path\":\"/portal\",\"portal\":\"true\",\"trustUntrustedCert\":\"false\"}",
          "AuditOperationType": "Sign In",
          "ObjectType": "Authentication",
          "ObjectName": "finance.test.com",
          "ObjectID": "98765432100123457",
          "CustomerID": 22345678901234567,
          "User": "financeadmin@test.com",
          "ClientAuditUpdate": "0",
          "EventType": "audit-logs"
        },
    result: null
  - sample: |-
      {
          "LogTimestamp": "2025-08-28T08:15:42Z",
          "Customer": "Safe March",
          "SessionID": "8A64Qwj9zCkfYDGJVoUZ",
          "SessionType": "ZPN_ASSISTANT_BROKER_CONTROL",
          "SessionStatus": "ZPN_STATUS_AUTHENTICATED",
          "Version": "19.20.3",
          "Platform": "el7",
          "ZEN": "US-NY-8179",
          "Connector": "Seattle App Connector 1",
          "ConnectorGroup": "Azure App Connectors",
          "PrivateIP": "10.0.0.4",
          "PublicIP": "52.224.237.221",
          "Latitude": 47.0,
          "Longitude": -122.0,
          "CountryCode": "US",
          "TimestampAuthentication": "2019-06-27T05:05:23.348Z",
          "TimestampUnAuthentication": "",
          "CPUUtilization": 1,
          "MemUtilization": 20,
          "ServiceCount": 2,
          "InterfaceDefRoute": "eth0",
          "DefRouteGW": "10.0.0.1",
          "PrimaryDNSResolver": "168.63.129.16",
          "HostStartTime": "1513229995",
          "ConnectorStartTime": "1555920005",
          "NumOfInterfaces": 2,
          "BytesRxInterface": 319831966346,
          "PacketsRxInterface": 1617569938,
          "ErrorsRxInterface": 0,
          "DiscardsRxInterface": 0,
          "BytesTxInterface": 192958782635,
          "PacketsTxInterface": 1797471190,
          "ErrorsTxInterface": 0,
          "DiscardsTxInterface": 0,
          "TotalBytesRx": 10902554,
          "TotalBytesTx": 48931771,
          "MicroTenantID": "145257480799129312",
          "EventType": "app-connector-status"
        }
    result: null
  - sample: |-
      {
      "LogTimestamp": "",
      "Customer": "Contoso Corp",
      "Username": "alice.w",
      "SessionID": "XyZp98KlMn56",
      "SessionStatus": "ZPN_STATUS_AUTHENTICATED",
      "Version": "20.1.0-12-g5e7d3b9",
      "ZEN": "broker3.eu1",
      "CertificateCN": "slogger3.eu1.zpa.net",
      "PrivateIP": "10.0.5.12",
      "PublicIP": "52.174.23.17",
      "Latitude": 51.5074,
      "Longitude": -0.1278,
      "CountryCode": "GB",
      "TimestampAuthentication": "2019-06-03T08:11:40.000Z",
      "TimestampUnAuthentication": "",
      "TotalBytesRx": 5123432,
      "TotalBytesTx": 7234321,
      "Idp": "AzureAD",
      "Hostname": "LAPTOP-AW123",
      "Platform": "windows",
      "ClientType": "zpn_client_type_zapp",
      "TrustedNetworks": "TN2_eu1",
      "TrustedNetworksNames": "Corp_London",
      "SAMLAttributes": "myname:alice,myemail:alice.w@contoso.com",
      "PosturesHit": ["vpn-secure,av-installed"],
      "PosturesMisses": ["disk-encryption", "firewall-enabled"],
      "ZENLatitude": 52.5200,
      "ZENLongitude": 13.4050,
      "ZENCountryCode": "DE",
      "FQDNRegistered": "1",
      "FQDNRegisteredError": "",
      "City": "London",
      "MicroTenantID": "23459872345987",
      "EventType": "user-status"
      }
    result: null
  - sample: |-
      {
        "": "Sun Aug 28 07:02:11 2025",
        "Customer": "AlphaCorp",
        "ConnectionID": "a9K2s3LmTnYz84GhXvP1",
        "UserID": "user1@alphacorp.com",
        "AssistantID": "alpha-key-001",
        "ExchangeSequenceIndex": 0,
        "TimestampRequestReceiveStart": 1661670131000100,
        "TimestampRequestReceiveHeaderFinish": 1661670131000250,
        "TimestampRequestReceiveFinish": 1661670131000800,
        "TimestampRequestTransmitStart": 1661670131000900,
        "TimestampRequestTransmitFinish": 1661670131001200,
        "TimestampResponseReceiveStart": 1661670131002000,
        "TimestampResponseReceiveFinish": 1661670131002900,
        "TimestampResponseTransmitStart": 1661670131003000,
        "TimestampResponseTransmitFinish": 1661670131003500,
        "TotalTimeRequestReceive": 700,
        "TotalTimeRequestTransmit": 300,
        "TotalTimeResponseReceive": 900,
        "TotalTimeResponseTransmit": 500,
        "Domain": "alphacorp.com",
        "Method": "GET",
        "Protocol": "1.1",
        "ProtocolVersion": "",
        "ContentType": "",
        "ContentEncoding": "",
        "TransferEncoding": "",
        "Host": "alphacorp.com",
        "OriginDomain": "",
        "URL": "/login",
        "UserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64)",
        "HTTPError": "success",
        "ClientPublicIp": "192.168.1.101",
        "ClientPort": 54521,
        "UpgradeHeaderPresent": 0,
        "StatusCode": 200,
        "RequestHdrSize": 560,
        "ResponseHdrSize": 1240,
        "RequestBodySize": 0,
        "ResponseBodySize": 512,
        "Application": 145254438888544100,
        "ApplicationGroup": 145254438888544120,
        "InspectionPolicy": 145254438888543731,
        "InspectionProfile": 145254438888538680,
        "ParanoiaLevel": 2,
        "InspectionControlsHitCount": 0,
        "InspectionRuleProcessingTime": 0,
        "InspectionReqHeadersProcessingTime": 500,
        "InspectionReqBodyProcessingTime": 700,
        "InspectionRespHeadersProcessingTime": 30,
        "InspectionRespBodyProcessingTime": 5,
        "CertificateId": 145254438888538200,
        "DoubleEncryption": 1,
        "SSLInspection": 1,
        "TotalBytesProcessed": 1752,
          "EventType": "app-protection"
      }
    result: null
  - sample: >-
      {
          "LogTimestamp": "Thu August 28 07:12:25 2025",
          "ConnectionID": "xyz908op",
          "Exporter": "edge-instance-03",
          "TimestampRequestReceiveStart": "2025-08-28T07:06:48.552Z",
          "TimestampRequestReceiveHeaderFinish": "2025-08-28T07:06:48.553Z",
          "TimestampRequestReceiveFinish": "2025-08-28T07:06:48.556Z",
          "TimestampRequestTransmitStart": "2025-08-28T07:06:48.590Z",
          "TimestampRequestTransmitFinish": "2025-08-28T07:06:48.592Z",
          "TimestampResponseReceiveStart": "2025-08-28T07:06:48.701Z",
          "TimestampResponseReceiveFinish": "2025-08-28T07:06:48.704Z",
          "TimestampResponseTransmitStart": "2025-08-28T07:06:48.710Z",
          "TimestampResponseTransmitFinish": "2025-08-28T07:06:48.712Z",
          "TotalTimeRequestReceive": 4,
          "TotalTimeRequestTransmit": 2,
          "TotalTimeResponseReceive": 3,
          "TotalTimeResponseTransmit": 2,
          "TotalTimeConnectionSetup": 34,
          "TotalTimeServerResponse": 109,
          "Method": "POST",
          "Protocol": "HTTPS",
          "Host": "api.beta.demo.org",
          "URL": "/api/v1/login",
          "UserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Safari/605.1.15",
          "XFF": "198.51.100.42",
          "NameID": "jane.doe@demo.org",
          "StatusCode": 502,
          "RequestSize": 1200,
          "ResponseSize": 498,
          "ApplicationPort": 443,
          "ClientPublicIp": "198.51.100.10",
          "ClientPublicPort": 60012,
          "ClientPrivateIp": "192.168.1.25",
          "Customer": "Beta Testers",
          "ConnectionStatus": "Redirect",
          "ConnectionReason": "AuthRedirect",
          "CorsToken": "token_login_345",
          "Origin": "https://beta.demo.org",
          "EventType": "browser-access"
      }
    result: null
  - sample: >-
      {
          "LogTimestamp": "Fri Aug 29 05:40:42 2025",
          "Customer": "Global Corp",
          "SessionID": "pra001",
          "ConnectionID": "pra001,conn001",
          "ConnectionStatus": "active",
          "Username": "dave@global.com",
          "DoubleEncryption": "0",
          "ServicePort": 22,
          "ClientPublicIP": "23.44.55.66",
          "ClientPrivateIP": "10.0.4.15",
          "ClientCity": "New York",
          "ClientCountryCode": "US",
          "ClientZEN": "broker1.us-east",
          "Policy": "PRA SSH Policy",
          "Connector": "NY-AppConnector-2",
          "Host": "10.40.1.100",
          "Application": "PRA-SSH-Server",
          "AppGroup": "Privileged Access",
          "Platform": "linux",
          "Hostname": "PRA-SERVER",
          "Idp": "Okta",
          "PRAApprovalID": 11111,
          "PRACapabilityPolicyID": 22222,
          "PRAConnectionID": "PRA-SESSION-1",
          "PRAConsoleType": "SSH",
          "PRACredentialLoginType": "Username/Password",
          "PRACredentialUserName": "root",
          "PRAErrorStatus": "",
          "PRARecordingStatus": "Available",
          "PRASharedMode": "control",
          "PRASharedUserList": "{\"shared_user_list\":[{\"name\":\"secops@global.com\"}]}",
          "EventType": "user-activity"
        }
    result: null
  - sample: |-
      {
        "LogTimestamp": "Fri Aug 29 05:40:42 2025",
        "Customer": "NextGenHealth",
        "AgentID": "72097421269663744-12345678901234567",
        "AgentName": "agent3.nextgen.net",
        "ResourceID": "72097421269663744-23456789012345678",
        "ResourceName": "app01.nextgen.net",
        "AppZoneID": "72097421269663744-34567890123456789",
        "AppZoneName": "prod-zone",
        "ConnectionStartTime": 1661675251000100,
        "SourceIP": "192.168.1.101",
        "DestinationIP": "10.45.23.89",
        "SourcePorts": 54521,
        "DestinationPort": 43321,
        "Protocol": 6,
        "AppName": "curl",
        "AppExecutablePath": ["/usr/bin/curl"],
        "Direction": "OUTBOUND",
        "PolicyID": "72097421269663744-45678901234567890",
        "PolicyName": "web_tls_policy",
        "EnforcementReason": "NO_POLICY_EXISTS",
        "EnforcementAction": "BLOCK",
        "EnforcementDisposition": "REJECTED",
        "EventType": "microsegmentation"
      }
    result: null

# The `result` field should be left blank to start. Once you submit your log asset files with
# your integration pull-request in a Datadog GitHub repository, Datadog's validations will
# run your raw logs against your pipeline and return the result. If the result output in the
# validation is accurate, take the output and add it to the `result` field in your test YAML file.