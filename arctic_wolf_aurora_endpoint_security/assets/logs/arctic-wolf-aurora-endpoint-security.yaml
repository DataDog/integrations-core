id: arctic-wolf-aurora-endpoint-security
metric_id: arctic-wolf-aurora-endpoint-security
backend_only: false
facets:
  - groups:
      - Web Access
    name: User-Agent
    path: http.useragent
    source: log
pipeline:
  type: pipeline
  name: Arctic Wolf Aurora Endpoint Security
  enabled: true
  filter:
    query: source:arctic-wolf-aurora-endpoint-security
  processors:
    - type: date-remapper
      name: Define `syslog.timestamp` as the official date of the log
      enabled: true
      sources:
        - syslog.timestamp
    - type: grok-parser
      name: Parse common log format
      enabled: true
      source: message
      samples:
        - 'Tenant ID: 82ee77a2-76a6-4d8f-97de-231bd4d5a4f3, Tenant Name:
          Mimecast, Event Type: AuditLog, Event Name: LoginFailure, Message:
          {"data":[["Cylance Administrator Password","One-Time
          Password"]],"clientIp":"163.116.205.114"}, User: Nilay Modi
          (nilay.modi@crestdata.ai), Eco Id: AqplNaZ7IyIQjDzBguyH5Bs='
        - 'Tenant Name: Mimecast, Event Type: AuditLog, Event Name:
          LoginFailure, Message: {"data":[["Cylance Administrator
          Password","One-Time Password"]],"clientIp":"163.116.205.114"}, User:
          Nilay Modi (nilay.modi@crestdata.ai), Eco Id:
          AqplNaZ7IyIQjDzBguyH5Bs='
        - 'Event Type: AuditLog, Event Name: LoginFailure, Message:
          {"data":[["Cylance Administrator Password","One-Time
          Password"]],"clientIp":"163.116.205.114"}, User: Nilay Modi
          (nilay.modi@crestdata.ai), Eco Id: AqplNaZ7IyIQjDzBguyH5Bs='
        - 'Tenant ID: 82ee77a2-76a6-4d8f-97de-231bd4d5a4f3, Event Type:
          AuditLog, Event Name: LoginFailure, Message: {"data":[["Cylance
          Administrator Password","One-Time
          Password"]],"clientIp":"163.116.205.114"}, User: Nilay Modi
          (nilay.modi@crestdata.ai), Eco Id: AqplNaZ7IyIQjDzBguyH5Bs='
        - "Event Name: OpticsCaeApiEvent, Device Name: SECURITYSERVER3, Zone
          Names: (ZoneOne,ZoneTwo), Event Id:
          d29ee101-a2a2-42f1-b9ab-7e4b18aeeef1, Severity: High, Description:
          Test - API Sensor, High priority event, Instigating Process Name:
          IReadCredentials.exe, Instigating Process Owner:
          PENTEST//Administrator, Instigating Process ImageFileSha256:
          E24F5A2B51EC1C260388348AF764B8794CE0566749F5801D024B7B422C63DC56,
          Event Timestamp: 2022-09-28T14:23:37.384Z, Event Received Timestamp:
          2022-09-28T14:24:30Z, Device Last Reported Users:
          (PENTEST\\Administrator), Zone Ids:
          (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CAA),
          Detection Rule Id: be7403ca-a9f4-4aa7-ad6d-7c672bfa8fc9, Instigating
          Process Command Line: IReadCredentials.exe, Instigating Process File
          Path: c:\\apisensor\\ireadcredentials.exe, API DLL: Advapi32.dll, API
          Function: CredEnumerateW, API Parameters: Unknown"
      grok:
        supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
        matchRules: "parse_rule (Tenant ID: %{notSpace:tenant_id}, )?(Tenant Name:
          %{PARSE_TILL_COMMA:tenant_name}, )?(Event Type:
          %{notSpace:event_type}, )?Event Name: %{notSpace:evt.name},
          %{data:additional_details}"
    - type: category-processor
      name: Categorise `service` based on `event_type`
      enabled: true
      categories:
        - filter:
            query: "@event_type:(AuditLog OR AppControl OR Device OR DeviceControl OR
              ExploitAttempt OR ScriptControl OR Threat OR
              ThreatClassification)"
          name: desktop-events
        - filter:
            query: "@event_type:(OpticsCaeProcessEvent OR OpticsCaeFileEvent OR
              OpticsCaeRegistryEvent OR OpticsCaeNetworkEvent OR
              OpticsCaeMemoryEvent OR OpticsCaeDnsEvent OR OpticsCaeLogEvent OR
              OpticsCaePowershellTraceEvent OR OpticsCaeWmiEvent OR
              OpticsCaeComEvent OR OpticsCaeHttpEvent)
              @evt.name:OpticsCaeApiEvent"
          name: detection-events
      target: service
    - type: service-remapper
      name: Define `service` as the official service of the log
      enabled: true
      sources:
        - service
    - type: pipeline
      name: Processing Aurora Protect Desktop Application Control Events
      enabled: true
      filter:
        query: "@event_type:AppControl"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Application Control Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: Unknown (test1), IP Address: (), Action: Deny,
              Action Type: PE File Change, File Path: , SHA256:
              56D1590A0D04771A1D5DBDEBEC7D4609A22B42085CEC07F0CF63222668FA5091,
              Zone Names: (Windows Zone (Default)), Device Id:
              0929f443-2a56-46b3-bcfe-fc598da81d8c, Policy Name: Stage 3 - All
              Threats AQT + Critical Exploit Prevention + Malicious Script
              Prevention (Cylance Reference Policy)"
            - "Device Name: WIN-7entSh64, IP Address: (192.168.119.128), Action:
              Deny, Action Type: PEFileChange, File Path:
              C:\\Users\\admin\\AppData\\Local\\Temp\\MyInstaller.exe, SHA256:
              04D4DC02D96673ECA9050FE7201044FDB380E3CFE0D727E93DB35A709B45EDAA),
              Zone Names: (Script Test,Server Test)"
            - "Device Name: WIN-7entSh64, IP Address: (192.168.119.128), Action:
              Deny, Action Type: PEFileChange, File Path:
              \\\\shared1\\psexec.exe, SHA256:
              F8DBABDFA03068130C277CE49C60E35C029FF29D9E3C74C362521F3FB02670D5),
              Zone Names: (Script Test,Server Test)"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_appcontrol_rule Device Name: %{PARSE_TILL_COMMA:device_name},
              IP Address: %{notSpace:ip_addresses:array("()",",")}, Action:
              %{word:action}, Action Type: %{PARSE_TILL_COMMA:action_type}, File
              Path: %{PARSE_TILL_COMMA:file_path}, SHA256:
              %{PARSE_TILL_COMMA:sha256}, Zone Names:
              %{data:zone_names:array("()",",")}(, Device Id:
              %{PARSE_TILL_COMMA:device_id}, Policy Name: %{data:policy_name})?'
    - type: pipeline
      name: Processing Aurora Protect Desktop Audit Events
      enabled: true
      filter:
        query: "@event_type:AuditLog"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Audit Events
          enabled: true
          source: additional_details
          samples:
            - 'Message: {"data":[["Cylance Administrator Password","One-Time
              Password"]],"clientIp":"163.116.205.114"}, User: Nilay Modi
              (nilay.modi@crestdata.ai), Eco Id: AqplNaZ7IyIQjDzBguyH5Bs='
            - "Message: Policy Assigned: Focus; Devices: DESKTOP-Q401L6N, User:
              Nilay Modi (nilay.modi@crestdata.ai)"
            - 'Message:
              {"Enable":true,"Siem":"Other","UseSsl":false,"ServerAddress":"103.108.207.59","ServerPort":"9809","Protocol":"tcp","Severity":7,"Facility":16,"TenantIdentifierLogging":0,"EnableForAppControl":true,"EnableForAuditLog":true,"EnableForDevice":true,"EnableForExploitAttempt":true,"EnableForDeviceControl":true,"EnableForOptics":true,"EnableForThreat":true,"EnableForThreatClassification":true,"EnableForScriptControl":true,"EnableForMobileAlerts":true,"EnableForNetworkThreats":true,"EnableForDirectorySync":false,"EnableForAvert":true,"EnableForRiskAssessment":false,"EnableMessagesOver2KB":true,"EnableForCloudWorkload":false,"CustomToken":"","TenantPreferredNotificationEmails":null},
              User: Nilay Modi (nilay.modi@crestdata.ai)'
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              parse_audit_rule1 Message: %{PARSE_TILL_COMMA:message}, User:
              %{PARSE_TILL_COMMA:user}, Eco Id: %{data:eco_id}

              parse_audit_rule2 Message: %{PARSE_TILL_COMMA:message}, User: %{data:user}
    - type: pipeline
      name: Processing Aurora Protect Desktop Device Events
      enabled: true
      filter:
        query: "@event_type:Device"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Device Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: Unknown (Windows VM) Crest, Last Scan: 11/21/2025
              15:11:31"
            - "Device Name: admin, Zone Names: (), Device Id:
              5cea413d-a8b2-4c19-8aef-8af1419e4b58"
            - "Device Message: Renamed: '' to 'Unknown (Windows VM) Crest';
              Policy Changed: 'Focus' to 'Focus BDE', User: Nilay Modi
              (nilay.modi@crestdata.ai), Zone Names: (Windows Zone (Default)),
              Device Id: e68ac8b2-bfc5-46da-b764-b9e405625c15"
            - "Device Names: (admin), User: Nilay Modi
              (nilay.modi@crestdata.ai), Zone Names: (Windows Zone (Default)),
              Device Ids: (5cea413d-a8b2-4c19-8aef-8af1419e4b58)"
            - "Device Message: Device: admin; Policy Changed: 'Stage 3 - All
              Threats AQT + Critical Exploit Prevention + Malicious Script
              Prevention (Cylance Reference Policy)' to 'Focus'; Zones Added:
              'IRV1', User: Nilay Modi (nilay.modi@crestdata.ai), Zone Names:
              (Windows Zone (Default)), Device Id:
              191c967b-264c-46c3-999b-94c071e2e790"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              rule1 Device Name: %{PARSE_TILL_COMMA:device_name}, Agent Version:
              %{PARSE_TILL_COMMA:agent_version}, IP Address:
              %{PARSE_TILL_COMMA:ip_address}, MAC Address:
              %{PARSE_TILL_COMMA:mac_address}, Logged On Users:
              %{PARSE_TILL_COMMA:logged_on_users}, OS: %{PARSE_TILL_COMMA:os},
              Kernel Version: %{PARSE_TILL_COMMA:kernel_version}, Optics
              Version: %{PARSE_TILL_COMMA:optics_version}, Zone Names:
              %{regex("(.*?)(?=)"):zone_names}

              rule2 Device Name: %{PARSE_TILL_COMMA:device_name}, Zone Names: %{PARSE_TILL_COMMA:zone_names}, Device Id: %{regex("(.*?)(?=)"):device_id}

              rule3 Device Names: %{PARSE_TILL_COMMA:device_names}, Policy Name: %{PARSE_TILL_COMMA:policy_name}, User: %{PARSE_TILL_COMMA:user}, Zone Names: %{regex("(.*?)(?=)"):zone_names}

              rule4 Device Names: %{PARSE_TILL_COMMA:device_names}, User: %{PARSE_TILL_COMMA:user}, Zone Names: %{PARSE_TILL_COMMA:zone_names}, Device Ids: %{regex("(.*?)(?=)"):device_ids}

              rule5 Device Message: Device: %{regex("(.*?)(?=;)"):device_name}; Policy Changed: '%{regex("(.*?)(?=')"):previous_policy}' to '%{regex("(.*?)(?=')"):policy_name}'(; Zones Added: '%{regex("(.*?)(?=')"):zones_added}')?, User: %{PARSE_TILL_COMMA:user}, Zone Names: %{PARSE_TILL_COMMA:zone_names}, Device Id: %{regex("(.*?)(?=)"):device_id}

              rule6 Device Name: %{PARSE_TILL_COMMA:device_name}, Agent Version: %{PARSE_TILL_COMMA:agent_version}, IP Address: %{PARSE_TILL_COMMA:ip_address}, MAC Address: %{PARSE_TILL_COMMA:mac_address}, Logged On Users: %{PARSE_TILL_COMMA:logged_on_users}, OS: %{regex("(.*?)(?=)"):os}

              rule7 Device Name: %{PARSE_TILL_COMMA:device_name}, Last Scan: %{regex("(.*?)(?=)"):last_scan}

              rule8 Device Names: %{PARSE_TILL_COMMA:device_name}, User: %{regex("(.*?)(?=)"):user}

              rule11 Device Message: Renamed: '%{regex("(.*?)(?=')"):previous_device}' to '%{regex("(.*?)(?=')"):device_name}'(; Policy Changed: '%{regex("(.*?)(?=')"):previous_policy}' to '%{regex("(.*?)(?=')"):policy_name}')?(; Zones Added: '%{regex("(.*?)(?=')"):zones_added}')?, User: %{regex("(.*?)(?=)"):user}, Zone Names: %{PARSE_TILL_COMMA:zone_names}, Device Id: %{regex("(.*?)(?=)"):device_id}

              rule9 Device Message: Renamed: '%{regex("(.*?)(?=')"):previous_device}' to '%{regex("(.*?)(?=')"):device_name}'; Policy Changed: '%{regex("(.*?)(?=')"):previous_policy}' to '%{regex("(.*?)(?=')"):policy_name}'(; Zones Added: '%{regex("(.*?)(?=')"):zones_added}')?, User: %{regex("(.*?)(?=)"):user}

              rule10 Device Name: %{regex("(.*?)(?=)"):device_name}

              rule12 Device Message: Device: %{PARSE_TILL_COMMA:device_name}, User: %{PARSE_TILL_COMMA:user}, Zone Names: %{PARSE_TILL_COMMA:zone_names}, Device Id: %{regex("(.*?)(?=)"):device_id}
    - type: pipeline
      name: Processing Aurora Protect Desktop Device Control Events
      enabled: true
      filter:
        query: "@event_type:DeviceControl"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Device Control Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: , External Device Type: USBDrive, External Device
              Vendor ID: 090C, External Device Name: USB Flash DISK USB Device,
              External Device Product ID: 1000, External Device Serial Number:
              1408033910001641, Zone Names: (Windows Zone (Default)), Device Id:
              cf753b5b-6ce6-4648-b2df-a827d3560b6f, Policy Name: Stage 3 - All
              Threats AQT + Critical Exploit Prevention + Malicious Script
              Prevention (Cylance Reference Policy)"
            - "Device Name: Test_Device_1, External Device Type: iOS, External
              Device Vendor ID: 1953, External Device Name: Generic USB Drive -
              2017/02/16-01, External Device Product ID: 0202, External Device
              Serial Number: 575833314133343210041246, Zone Names:
              (test_zone_02)"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              parse_device_control_rule1 Device Name:
              %{PARSE_TILL_COMMA:device_name}, External Device Type:
              ()?(%{notSpace:external_device_type})?, External Device Vendor ID:
              ()?(%{notSpace:external_device_vendor_id})?, External Device Name:
              %{PARSE_TILL_COMMA:external_device_name}, External Device Product
              ID: ()?(%{notSpace:external_device_product_id})?, External Device
              Serial Number: ()?(%{notSpace:external_device_serial_number})?,
              Zone Names: %{data:zone_names:array("()",",")}, Device Id:
              %{PARSE_TILL_COMMA:device_id}, Policy Name: %{data:policy_name}

              parse_device_control_rule2 Device Name: %{PARSE_TILL_COMMA:device_name}, External Device Type: ()?(%{notSpace:external_device_type})?, External Device Vendor ID: ()?(%{notSpace:external_device_vendor_id})?, External Device Name: %{PARSE_TILL_COMMA:external_device_name}, External Device Product ID: ()?(%{notSpace:external_device_product_id})?, External Device Serial Number: ()?(%{notSpace:external_device_serial_number})?, Zone Names: %{data:zone_names:array("()",",")}
    - type: pipeline
      name: Processing Aurora Protect Desktop Memory Protection Events
      enabled: true
      filter:
        query: "@event_type:ExploitAttempt"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Memory Protection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: Unknown (test1), IP Address: (), Action: Terminated,
              Process ID: 18288, Process Name: SearchProtocolHost.exe, User
              Name: , Violation Type: Direct System Calls, Zone Names: (Windows
              Zone (Default)), Device Id: 0929f443-2a56-46b3-bcfe-fc598da81d8c,
              Policy Name: Stage 3 - All Threats AQT + Critical Exploit
              Prevention + Malicious Script Prevention (Cylance Reference
              Policy)"
            - "Device Name: WIN-7entSh64, IP Address: (192.168.119.128), Action:
              Blocked, Process ID: 3804, Process Name: C:\\AttackTest64.exe,
              User Name: admin, Violation Type: LSASS Read, Zone Names: (Script
              Test,Server Test), Device ID:
              e378dacb-9324-453a-b8c6-5a8406952195"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              parse_memory_protection_rule1 Device Name:
              %{PARSE_TILL_COMMA:device_name}, IP Address:
              %{data:ip_addresses:array("()",",")}, Action:
              ()?(%{notSpace:action})?, Process ID:
              ()?(%{notSpace:process_id})?, Process Name:
              %{PARSE_TILL_COMMA:process_name}, User Name:
              %{PARSE_TILL_COMMA:usr.name}, Violation Type:
              %{PARSE_TILL_COMMA:violation_type}, Zone Names:
              %{PARSE_TILL_COMMA:zone_names}, Device Id:
              %{PARSE_TILL_COMMA:device_id}(, Policy Name: %{data:policy_name})?

              parse_memory_protection_rule2 Device Name: %{PARSE_TILL_COMMA:device_name}, IP Address: %{data:ip_addresses:array("()",",")}, Action: ()?(%{notSpace:action})?, Process ID: ()?(%{notSpace:process_id})?, Process Name: %{PARSE_TILL_COMMA:process_name}, User Name: %{PARSE_TILL_COMMA:usr.name}, Violation Type: %{PARSE_TILL_COMMA:violation_type}, Zone Names: %{data:zone_names:array("()",",")}, Device ID: %{data:device_id}
    - type: pipeline
      name: Processing Aurora Protect Desktop Script Control Events
      enabled: true
      filter:
        query: "@event_type:ScriptControl"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Script Control Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: Unknown (test1), File Path: , SHA256:
              FEA0867AE0769D8858FFD94EA93EFBFE5C4531DB8CA75719D42BF074FE22F902,
              Status: Unscored, Interpreter: Jscript, Interpreter Version:
              10.0.22621.5983, Zone Names: (Windows Zone (Default)), User Name:
              , Device Id: 0929f443-2a56-46b3-bcfe-fc598da81d8c, Policy Name:
              Stage 3 - All Threats AQT + Critical Exploit Prevention +
              Malicious Script Prevention (Cylance Reference Policy)"
            - "Device Name: , File Path: , SHA256:
              fe9b64defd8bf214c7490aa7f35b495a79a95e81f8943ee279dc99998d3d3440,
              Status: Unscored, Interpreter: PowershellConsole, Interpreter
              Version: 10.0.22621.1 (WinBuild.160101.0800), Zone Names: (Windows
              Zone (Default)), User Name: , Device Id:
              191c967b-264c-46c3-999b-94c071e2e790, Policy Name: Focus"
            - "Device Name: , File Path: , SHA256:
              fe9b64defd8bf214c7490aa7f35b495a79a95e81f8943ee279dc99998d3d3440,
              Interpreter: PowershellConsole, Interpreter Version: 10.0.22621.1
              (WinBuild.160101.0800), Zone Names: (Windows Zone (Default)), User
              Name: , Device Id: 191c967b-264c-46c3-999b-94c071e2e790, Policy
              Name: Focus"
            - "Device Name: Fake_Device, File Path:
              d:\\windows\\system32\\windowspowershell\\v2.1\\newlyMade.vbs,
              SHA256:
              FE9B64DEFD8BF214C7490BB7F35B495A79A95E81F8943EE279DC99998D3D3440,
              Interpreter: active, Interpreter Version: 6.1.7600.16385
              (win7_rtm.090713-1255), Zone Names: (Script Test,Server Test),
              Device ID: e378dacb-9324-453a-b8c6-5a8406952195, Policy Name:
              Default"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              parse_script_control_rule1 Device Name:
              %{PARSE_TILL_COMMA:device_name}, File Path:
              %{PARSE_TILL_COMMA:file_path}, SHA256: ()?(%{notSpace:sha256})?,
              (Status: %{PARSE_TILL_COMMA:script_control_status}, )?Interpreter:
              ()?(%{notSpace:interpreter})?, Interpreter Version:
              %{PARSE_TILL_COMMA:interpreter_version}, Zone Names:
              %{data:zone_names:array("()",",")}, (User Name:
              %{PARSE_TILL_COMMA:user}, )?Device Id:
              %{PARSE_TILL_COMMA:device_id}, Policy Name: %{data:policy_name}

              parse_script_control_rule2 Device Name: %{PARSE_TILL_COMMA:device_name}, File Path: %{PARSE_TILL_COMMA:file_path}, SHA256: ()?(%{notSpace:sha256})?, (Status: %{PARSE_TILL_COMMA:script_control_status}, )?Interpreter: ()?(%{notSpace:interpreter})?, Interpreter Version: %{PARSE_TILL_COMMA:interpreter_version}, Zone Names: %{data:zone_names:array("()",",")}, (User Name: %{PARSE_TILL_COMMA:user}, )?Device ID: %{PARSE_TILL_COMMA:device_id}, Policy Name: %{data:policy_name}
    - type: pipeline
      name: Processing of Aurora Protect Desktop Threat Events
      enabled: true
      filter:
        query: "@event_type:Threat"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Threat Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: , IP Address: (), File Name: , Path: , Drive Type:
              Internal Hard Drive, SHA256:
              1C7E66126306537A453D7A792978464AA8AD5AC2F34BD1FCCFFFE7E0B9C6D85C,
              MD5: D2EBA7BA9D87AC9D902D39540C7854EB, Status: Quarantined,
              Cylance Score: 100, Found Date: 11/18/2025 12:06:53 PM, File Type:
              Executable, Is Running: False, Auto Run: False, Detected By:
              FileWatcher, Zone Names: (Windows Zone (Default)), Is Malware:
              True, Is Unique To Cylance: False, Threat Classification: Malware
              - Trojan - msil/convagent, Device Id:
              3daa966a-3b70-4a5a-90fd-33aee165ea1f, Policy Name: Focus"
            - "Device Name: , IP Address: (), File Name: , Path: , Drive Type:
              Internal Hard Drive, SHA256:
              93502C2277984F26EE5C0B7F74AA1045C5CF648F8511939CDAE130F051BCF7B4,
              MD5: BA1D384701CD80CF80428F3729369584, Status: Default, Cylance
              Score: 97, Found Date: 11/18/2025 12:48:16 PM, File Type:
              Executable, Is Running: False, Auto Run: False, Detected By:
              FileWatcher, Zone Names: (Windows Zone (Default)), Is Malware:
              False, Is Unique To Cylance: False, Threat Classification:
              UNCLASSIFIED, Device Id: 3daa966a-3b70-4a5a-90fd-33aee165ea1f,
              Policy Name: Focus"
            - "Device Name: , IP Address: (), File Name: , Path: , Drive Type:
              Internal Hard Drive, SHA256:
              780BB152049A5921FABBE0DE066B53C36BF45D895B60B1651E35C69052E6703D,
              MD5: EDF913F2D9993F003E5FE25BE9A48929, Status: FileRemoved,
              Cylance Score: 95, Found Date: 11/18/2025 12:37:25 PM, File Type:
              Executable, Is Running: False, Auto Run: False, Detected By:
              FileWatcher, Zone Names: (Windows Zone (Default)), Is Malware:
              False, Is Unique To Cylance: False, Threat Classification:
              UNCLASSIFIED, Device Id: 3daa966a-3b70-4a5a-90fd-33aee165ea1f,
              Policy Name: Focus"
            - "Device Name: , IP Address: (), File Name: , Path: , Drive Type:
              Internal Hard Drive, SHA256:
              FD4BB08C311EB04165C7DE20F21B2A4BF78776ABAB859448976BDE951BC8F593,
              MD5: 2E2D79BAF18F763D0059ED1149871D79, Status: Quarantined,
              Cylance Score: 100, Found Date: 11/18/2025 2:42:14 PM, File Type:
              Executable, Is Running: False, Auto Run: False, Detected By:
              FileWatcher, Zone Names: (Windows Zone (Default)), Is Malware:
              False, Is Unique To Cylance: False, Threat Classification:
              UNCLASSIFIED, Device Id: 3daa966a-3b70-4a5a-90fd-33aee165ea1f,
              Policy Name: Focus"
            - "Device Name: SH-Win81-1, IP Address: (10.3.0.132), File Name:
              virusshare_00fbc4cc4b42774b50a9f71074b79bd9, Path:
              c:\\ruby\\host_automation\\test\\data\\test_files\\, Drive Type:
              None, File Owner: SH-Win81-1\\Exampleuser, SHA256:
              1EBF3B8A61A7E0023AAB3B0CB24938536A1D87BCE1FCC6442E137FB2A7DD510B,
              MD5: , Status: Unsafe, Cylance Score: 100, Found Date: 6/1/2015
              10:57:42 PM, File Type: Executable, Is Running: False, Auto Run:
              False, Detected By: FileWatcher, Zone Names: (Script Test,Server
              Test), Is Malware: False, Is Unique to Cylance: False, Threat
              Classification: File Unavailable"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              parse_threat_rule1 Device Name: %{PARSE_TILL_COMMA:device_name},
              IP Address: %{data:ip_addresses:array("()",",")}, File Name:
              %{PARSE_TILL_COMMA:file_name}, Path:
              %{PARSE_TILL_COMMA:file_path}, Drive Type:
              %{PARSE_TILL_COMMA:drive_type}, SHA256: ()?(%{notSpace:sha256})?,
              MD5: %{PARSE_TILL_COMMA:md5}, Status: ()?(%{word:Status})?,
              Cylance Score: ()?(%{integer:cylance_score})?, Found Date:
              %{PARSE_TILL_COMMA:found_date}, File Type:
              %{PARSE_TILL_COMMA:file_type}, Is Running:
              ()?(%{word:is_running})?, Auto Run: ()?(%{word:auto_run})?,
              Detected By: ()?(%{notSpace:detected_by})?, Zone Names:
              %{data:zone_names:array("()",",")}, Is Malware:
              ()?(%{notSpace:is_malware})?, Is Unique To Cylance:
              ()?(%{notSpace:is_unique_to_cylance})?, Threat Classification:
              %{PARSE_TILL_COMMA:threat_classification}, Device Id:
              %{PARSE_TILL_COMMA:device_id}, Policy Name: %{data:policy_name}

              parse_threat_rule2 Device Name: %{PARSE_TILL_COMMA:device_name}, IP Address: %{data:ip_addresses:array("()",",")}, File Name: %{PARSE_TILL_COMMA:file_name}, Path: %{PARSE_TILL_COMMA:file_path}, Drive Type: %{PARSE_TILL_COMMA:drive_type}, File Owner: %{PARSE_TILL_COMMA:file_owner}, SHA256: ()?(%{notSpace:sha256})?, MD5: %{PARSE_TILL_COMMA:md5}, Status: ()?(%{word:Status})?, Cylance Score: ()?(%{integer:cylance_score})?, Found Date: %{PARSE_TILL_COMMA:found_date}, File Type: %{PARSE_TILL_COMMA:file_type}, Is Running: ()?(%{word:is_running})?, Auto Run: ()?(%{word:auto_run})?, Detected By: ()?(%{notSpace:detected_by})?, Zone Names: %{data:zone_names:array("()",",")}, Is Malware: ()?(%{notSpace:is_malware})?, Is Unique to Cylance: ()?(%{notSpace:is_unique_to_cylance})?, Threat Classification: %{data:threat_classification}
        - type: category-processor
          name: Category processor for `file_state`
          enabled: true
          categories:
            - filter:
                query: "@cylance_score:[1 TO 59]"
              name: Abnormal
            - filter:
                query: "@cylance_score:[60 TO 100]"
              name: Unsafe
          target: file_state
        - type: category-processor
          name: Category processor for `status`
          enabled: true
          categories:
            - filter:
                query: "@Status:(Unsafe OR Abnormal)"
              name: critical
            - filter:
                query: "@Status:Corrupt"
              name: warning
            - filter:
                query: "@Status:(Waived OR Quarantined OR Cleared)"
              name: info
          target: status
    - type: pipeline
      name: Processing Aurora Protect Desktop Threat Classification Events
      enabled: true
      filter:
        query: "@event_type:ThreatClassification"
      processors:
        - type: grok-parser
          name: Parsing Aurora Protect Desktop Threat Classification Events
          enabled: true
          source: additional_details
          samples:
            - "Threat Class: Malware, Threat Subclass: Dropper, Threat Family:
              injuke, SHA256:
              5B63698F6FC9FBEE366BD01AF6A383652B09FC1B136A3408EB4187FD3C12973A,
              MD5: 30AD7FF97EEDC9D14F06F9A8C96DC066"
            - "SHA256:
              1218493137321C1D1F897B0C25BEF17CDD0BE9C99B84B4DD8B51EAC8F9794F65,
              Threat Classification: Malware - Worm - QuKart"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: >-
              rule1 Threat Class: %{PARSE_TILL_COMMA:threat_class}, Threat
              Subclass: %{PARSE_TILL_COMMA:threat_subclass}, Threat Family:
              %{PARSE_TILL_COMMA:threat_family}, SHA256:
              ()?(%{notSpace:sha256})?, MD5: %{data:md5}

              rule2 SHA256: ()?(%{notSpace:sha256})?, Threat Classification: %{data:threat_classification}
    - type: pipeline
      name: Processing Aurora Focus Process Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeProcessEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Process Based Detection Events
          enabled: true
          source: event
          samples:
            - "Device Name: ADMIN, Zone Names: (Windows Zone (Default)), Event
              Id: 1ac592a3-357f-43b9-86f5-6f750f809a2f, Severity: Low,
              Description: Application Shimming Persistence (MITRE), Instigating
              Process Name: svchost.exe, Instigating Process Owner: NT
              AUTHORITY//SYSTEM, Instigating Process ImageFileSha256:
              949BFB5B4C7D58D92F3F9C5F8EC7CA4CEAFFD10EC5F0020F0A987C472D61C54B,
              Event Timestamp: 2025-11-20T04:46:43.792Z, Event Received
              Timestamp: 2025-11-20T04:46:51Z, Device Last Reported Users:
              (admin\\crest,Window Manager\\DWM-1,Window Manager\\DWM-2), Zone
              Ids: (E79C47BC6292419DBD0AE117798FB353), Detection Rule Id:
              5e5b01a7-2bdf-49c9-a58b-82703706a84d, Instigating Process Command
              Line: C:\\Windows\\system32\\svchost.exe -k
              LocalSystemNetworkRestricted -p -s PcaSvc, Instigating Process
              File Path: c:\\windows\\system32\\svchost.exe, Target Process
              Name: sdbinst.exe, Target Process Owner: NT AUTHORITY//SYSTEM,
              Target Process ImageFileSha256:
              7E6B42AF9D8B1E1A4EFDEEB152997C7C9BBFA010B2FCE65BEF29A2903819E0E5,
              Device Id: 191c967b-264c-46c3-999b-94c071e2e790, Target Process
              Command Line: C:\\Windows\\System32\\sdbinst.exe -m -bg, Target
              Process File Path: c:\\windows\\system32\\sdbinst.exe, test1:
              test1, test2: test2, test3: test3, test4: test4"
            - "Device Name: ADMIN, Zone Names: (Windows Zone (Default)), Event
              Id: 72de5df2-5700-4977-9b66-580e6e697428, Severity: Low,
              Description: Application Shimming Persistence (MITRE), Instigating
              Process Name: svchost.exe, Instigating Process Owner: NT
              AUTHORITY//SYSTEM, Instigating Process ImageFileSha256:
              949BFB5B4C7D58D92F3F9C5F8EC7CA4CEAFFD10EC5F0020F0A987C472D61C54B,
              Event Timestamp: 2025-11-19T21:46:33.166Z, Event Received
              Timestamp: 2025-11-19T21:46:42Z, Device Last Reported Users:
              (admin\\crest,Window Manager\\DWM-1,Window Manager\\DWM-2), Zone
              Ids: (E79C47BC6292419DBD0AE117798FB353), Detection Rule Id:
              5e5b01a7-2bdf-49c9-a58b-82703706a84d, Instigating Process Command
              Line: C:\\Windows\\system32\\svchost.exe -k
              LocalSystemNetworkRestricted -p -s PcaSvc, Instigating Process
              File Path: c:\\windows\\system32\\svchost.exe, Target Process
              Name: sdbinst.exe, Target Process Owner: NT AUTHORITY//SYSTEM,
              Target Process ImageFileSha256:
              7E6B42AF9D8B1E1A4EFDEEB152997C7C9BBFA010B2FCE65BEF29A2903819E0E5,
              Device Id: 191c967b-264c-46c3-999b-94c071e2e790, Target Process
              Command Line: C:\\Windows\\System32\\sdbinst.exe -m -bg, Target
              Process File Path: c:\\windows\\system32\\sdbinst.exe"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_process_rule %{regex("[^,]*")}
             %{regex("[^,]*")}%{regex("[^,]*")} %{regex("[^,]*")} %{regex("[^,]*")}'
    - type: pipeline
      name: Processing Aurora Focus File Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeFileEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus File Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - 'Device Name: ADMIN, Zone Names: (Windows Zone (Default)), Event
              Id: 3013d82e-6b4c-4677-a334-3fd4934fed7a, Severity: Informational,
              Description: Win Browser CredTheft Mitre T1003, Instigating
              Process Name: msedge.exe, Instigating Process Owner: admin//crest,
              Instigating Process ImageFileSha256:
              2C853AA78C45045C540668AC2EE63407CEF02EE55BFAFD6F678EC9E84EC23CBB,
              Event Timestamp: 2025-11-19T09:45:11.336Z, Event Received
              Timestamp: 2025-11-19T09:45:17Z, Device Last Reported Users:
              (admin\crest1,admin\crest,Window Manager\DWM-1,Window
              Manager\DWM-2,Window Manager\DWM-3), Zone Ids:
              (E79C47BC6292419DBD0AE117798FB353), Detection Rule Id:
              26cadfe8-1b8c-489c-ae29-115b5bc9d591, Instigating Process Command
              Line: "C:\Program Files
              (x86)\Microsoft\Edge\Application\msedge.exe" --type=utility
              --utility-sub-type=chrome.mojom.ProfileImport --lang=en-US
              --service-sandbox-type=none --skip-read-main-dll
              --metrics-shmem-handle=5020,i,3478498035652716424,1717516754338192010,524288
              --field-trial-handle=2372,i,11122849255781664600,8070874040734229388,262144
              --variations-seed-version
              --trace-process-track-uuid=3190708991934122588
              --mojo-platform-channel-handle=5012 /prefetch:14, Instigating
              Process File Path: c:\program files
              (x86)\microsoft\edge\application\msedge.exe, Target File Path:
              c:\users\crest\appdata\local\google\chrome\user data\default\login
              data for account, Target File Owner: admin//crest, Target File
              Sha256: , Device Id: 191c967b-264c-46c3-999b-94c071e2e790'
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_file_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Target File
              Path: %{PARSE_TILL_COMMA:target_file_path}, Target File Owner:
              %{PARSE_TILL_COMMA:target_file_owner}, Target File Sha256:
              ()?(%{notSpace:target_process_imagefilesha256})?, Device Id:
              %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus Registry Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeRegistryEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Registry Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: SECURITYSERVER3, Zone Names:
              (JeffTesting,JeffSecurityServer), Event Id:
              6d33d636-dcdc-48c2-911a-ead99ac17f88, Severity: Medium,
              Description: SYSLOG detections - RegistryKey
              \\software\\classes\\*\\shellex\\contextmenuhandlers\\cywareshlex\
              t, Instigating Process Name: ICreatePersistencePoints.exe,
              Instigating Process Owner: PENTEST//Administrator, Instigating
              Process ImageFileSha256:
              F83926AB855E860C9B1A6D72EB6024D9E1D569A59E4901A62E8543B1C978D5E5,
              Event Timestamp: 2022-06-28T18:08:49.103Z, Event Received
              Timestamp: 2022-06-28T18:08:54Z, Device Last Reported Users:
              (PENTEST\\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: 74354415-7d28-4f31-830d-72a14c0c3d8b,
              Instigating Process Command Line: ICreatePersistencePoints.exe
              --trigger 0, Instigating Process File Path:
              c:\\users\\administrator.pentest\\downloads\\syslog_test_cae_rules\
              \\icreatepersistencepoints.exe, Target Registry KeyPath:
              HKLM\\software\\classes\\*\\shellex\\contextmenuhandlers\\cywares\
              hlext, Target Registry ValueName: , Device Id:
              c7b79f9f-4fbe-4f90-9658-ec7e17af1954"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_registry_rule Device Name: %{PARSE_TILL_COMMA:device_name},
              Zone Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Target Registry
              KeyPath: %{PARSE_TILL_COMMA:target_registry_keypath}, Target
              Registry ValueName: %{PARSE_TILL_COMMA:target_registry_keypath},
              Device Id: %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus Network Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeNetworkEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Network Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - 'Device Name: ADMIN, Zone Names: (Windows Zone (Default)), Event
              Id: fbc31190-9974-48b9-956c-5e080bd6ad5a, Severity: Low,
              Description: Unsigned Application Network Beaconing, Instigating
              Process Name: FXAALZ.exe, Instigating Process Owner: admin//crest,
              Instigating Process ImageFileSha256:
              F0AAAE0364306BB7A4681D01935C96C2AC76B3576B7982990F86BCAF811A45BA,
              Event Timestamp: 2025-11-19T09:52:15.782Z, Event Received
              Timestamp: 2025-11-19T09:52:22Z, Device Last Reported Users:
              (admin\crest1,admin\crest,Window Manager\DWM-1,Window
              Manager\DWM-2,Window Manager\DWM-3), Zone Ids:
              (E79C47BC6292419DBD0AE117798FB353), Detection Rule Id:
              6ab20572-8eb4-41a8-a8ea-d16766de0e44, Instigating Process Command
              Line: "C:\CPZIVC\FXAALZ.exe" -f C:\CPZIVC\NGHVQE, Instigating
              Process File Path: c:\cpzivc\fxaalz.exe, Destination IP:
              142.202.51.68, Destination Port: 9001, Device Id:
              191c967b-264c-46c3-999b-94c071e2e790, Source IP: 192.168.90.23,
              Source Port: 61132'
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_network_rule Device Name: %{PARSE_TILL_COMMA:device_name},
              Zone Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Destination IP:
              ()?(%{ip:network.destination.ip})?, Destination Port:
              ()?(%{port:network.destination.port})?, Device Id:
              %{PARSE_TILL_COMMA:device_id}, Source IP:
              ()?(%{ip:network.client.ip})?, Source Port:
              ()?(%{port:network.client.port})?'
        - type: geo-ip-parser
          name: Extracting Geo Location from Client IP Address
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
        - type: geo-ip-parser
          name: Extracting Geo Location from Destination IP Address
          enabled: true
          sources:
            - network.destination.ip
          target: network.destination.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Processing Aurora Focus Memory Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeMemoryEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Memory Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: SECURITYSERVER3, Zone Names: (JeffTesting,Jeff_3.0),
              Event Id: c4e7d4e1-8739-4996-83a3-19d9ba583882, Severity: Medium,
              Description: Looking for a protect memory event, Instigating
              Process Name: AttackTest32.exe, Instigating Process Owner:
              PENTEST/Administrator, Instigating Process ImageFileSha256:
              2762CB5818C67BDD28DFE88FB528EF06B0C1AB5C175E2206B49C85BB8672C2EC,
              Event Timestamp: 2022-07-21T12:55:02.277Z, Event Received
              Timestamp: 2022-07-21T12:55:25Z, Device Last Reported Users:
              PENTEST\\Administrator, Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: edf530c6-6b0e-4be2-aeb6-d3f8001fce05,
              Instigating Process Command Line: AttackTest32.exe -p:8000,
              Instigating Process File Path:
              c:\\users\\administrator.pentest\\downloads\\attacktest\\attackte\
              st32.exe, Device Id: e378dacb-9324-453a-b8c6-5a8406952195"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_memory_rule Device Name: %{PARSE_TILL_COMMA:device_name},
              Zone Names: %{data:zone_names:array("()",",")}, Event Id:
              c4e7d4e1-8739-4996-83a3-19d9ba583882, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Device Id:
              %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus DNS Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeDnsEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus DNS Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: SECURITYSERVER, Zone Names:
              (JeffTesting,JeffSecurityServer), Event Id:
              6458f3ac-e527-4922-83ac-654518c3137e, Severity: Medium,
              Description: Win_Suspicious_DNSLength_MitreT1071, Instigating
              Process Name: lsass.exe, Instigating Process Owner: NT
              AUTHORITY//SYSTEM, Instigating Process ImageFileSha256:
              91EAB6178A9BB2B268E7438E54B128F939C0BDF5BD8AC8B15EFCAF0572AADC3F,
              Event Timestamp: 2022-06-28T17:34:12.772Z, Event Received
              Timestamp: 2022-06-28T17:34:33Z, Device Last Reported Users:
              (PENTEST\\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: 0da4f7c3-af0d-46be-8f6b-1884a1c67331,
              Instigating Process Command Line:
              C:\\Windows\\system32\\lsass.exe, Instigating Process File Path:
              c:\\windows\\system32\\lsass.exe, Target Domain Name:
              7f2a98df-486e-4cec-8d6e-c227073955e6._msdcs.Pentest.Local.,
              Resolved Address: securityserver.Pentest.Local, Resolved Address
              Count: 1, Device Id: 41666e82-50e6-4777-88b6-5f2b567027b9"
            - "Device Name: SECURITYSERVER, Zone Names:
              (JeffTesting,JeffSecurityServer), Event Id:
              6458f3ac-e527-4922-83ac-654518c3137e, Severity: Medium,
              Description: Win_Suspicious_DNSLength_MitreT1071, Instigating
              Process Name: lsass.exe, Instigating Process Owner: NT
              AUTHORITY//SYSTEM, Instigating Process ImageFileSha256:
              91EAB6178A9BB2B268E7438E54B128F939C0BDF5BD8AC8B15EFCAF0572AADC3F,
              Event Timestamp: 2022-06-28T17:34:12.772Z, Event Received
              Timestamp: 2022-06-28T17:34:33Z, Device Last Reported Users:
              (PENTEST\\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: 0da4f7c3-af0d-46be-8f6b-1884a1c67331,
              Instigating Process Command Line:
              C:\\Windows\\system32\\lsass.exe, Instigating Process File Path:
              c:\\windows\\system32\\lsass.exe, Target Domain Name:
              7f2a98df-486e-4cec-8d6e-c227073955e6._msdcs.Pentest.Local.,
              Resolved Address: securityserver.Pentest.Local, Resolved Address
              Count: 1, Device Id: 41666e82-50e6-4777-88b6-5f2b567027b9"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_dns_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Target Domain
              Name: %{PARSE_TILL_COMMA:dns.question.name}, Resolved Address:
              %{PARSE_TILL_COMMA:resolved_address}, Resolved Address Count:
              ()?(%{integer:resolved_address_count})?, Device Id:
              %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus Log Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeLogEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Log Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: SECURITYSERVER3, Zone Names:
              (JeffTesting,JeffSecurityServer), Event Id:
              ba8810a9-afac-4579-82a2-638f0f584d60, Severity: High, Description:
              Win_CreateAccount_MitreT1136, Instigating Process Name: lsass.exe,
              Instigating Process Owner: NT AUTHORITY//SYSTEM, Instigating
              Process ImageFileSha256:
              BBC83E4759D4B82BAD31E371AD679AA414C72273BF97CEE5AED8337ED8A4D79F,
              Event Timestamp: 2022-06-28T18:17:05.001Z, Event Received
              Timestamp: 2022-06-28T18:17:10Z, Device Last Reported Users:
              (PENTEST\\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: 266e750f-a838-4974-9afc-20cb863031cc,
              Instigating Process Command Line:
              C:\\Windows\\system32\\lsass.exe, Instigating Process File Path:
              c:\\windows\\system32\\lsass.exe, Windows Event Id: 4720, Security
              Provider: SecurityAuditProvider, Device Id:
              c7b79f9f-4fbe-4f90-9658-ec7e17af1954"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_log_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Windows Event
              Id: %{PARSE_TILL_COMMA:windows_event_id}, Security Provider:
              %{PARSE_TILL_COMMA:security_provider}, Device Id:
              %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus Powershell Trace Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaePowershellTraceEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus Powershell Trace Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - 'Device Name: SECURITYSERVER3, Zone Names:
              (JeffTesting,JeffSecurityServer), Event Id:
              4b199c5c-60dc-4b5c-8dac-86965ba5b051, Severity: Medium,
              Description: SYSLOG detections - Looking for PowershellTrace
              get-childitem, Instigating Process Name: powershell.exe,
              Instigating Process Owner: PENTEST//Administrator, Instigating
              Process ImageFileSha256:
              DE96A6E69944335375DC1AC238336066889D9FFC7D73628EF4FE1B1B160AB32C,
              Event Timestamp: 2022-06-28T18:10:39.547Z, Event Received
              Timestamp: 2022-06-28T18:10:43Z, Device Last Reported Users:
              (PENTEST\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CAA),
              Detection Rule Id: 9eb1073c-913f-49ab-9b12-2e5a28dad18d,
              Instigating Process Command Line: powershell gwmi -class
              win32_process, Instigating Process File Path:
              c:\windows\system32\windowspowershell\v1.0\powershell.exe, Script
              Block Text:
              @{GUID="EEFCB906-B326-4E99-9F54-8B4BB6EF3C6D"Author="Microsoft
              Corporation"CompanyName="Micros, Script Block Length: 2583,
              Payload: None, Payload Length: 0, Device Id:
              c7b79f9f-4fbe-4f90-9658-ec7e17af1954'
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_powershell_trace_rule Device Name:
              %{PARSE_TILL_COMMA:device_name}, Zone Names:
              %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Script Block
              Text: %{PARSE_TILL_COMMA:script_block_text}, Script Block Length:
              %{PARSE_TILL_COMMA:script_block_length}, Payload:
              %{PARSE_TILL_COMMA:payload}, Payload Length:
              ()?(%{integer:payload_length})?, Device Id: %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus WMI Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeWmiEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus WMI Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: JEFWILLIAMS-1, Zone Names: (JeffTesting,Jeff_3.0),
              Event Id: 9fa208e5-779d-40b1-b4e2-44c330600396, Severity: Medium,
              Description: SYSLOG detections - Looking for WmiTrace select,
              Instigating Process Name: WmiPrvSE.exe, Instigating Process Owner:
              NT AUTHORITY//NETWORK SERVICE, Instigating Process
              ImageFileSha256:
              B5C78BEF3883E3099F7EF844DA1446DB29107E5C0223B97F29E7FAFAB5527F15,
              Event Timestamp: 2022-06-28T18:09:55.613Z, Event Received
              Timestamp: 2022-06-28T18:09:57Z, Device Last Reported Users:
              (RIMNET\\jefwilliams), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,24362CB3F25D4EB59C03FD6E3800C20\
              E), Detection Rule Id: f83b1ac8-b966-4297-be47-bb893bf23f2d,
              Instigating Process Command Line:
              C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe-secured-Embedding,
              Instigating Process File Path:
              c:\\windows\\system32\\wbem\\wmiprvse.exe, Consumer Text: None,
              Consumer Text Length: 0, Operation: Start
              IWbemServices::CreateInstanceEnum - root\\Standardcimv2 :
              MSFT_NetIPAddress, Operation Length: 80, Device Id:
              c6246140-bba5-4c55-be02-77300bf91dbc"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_wmi_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Consumer Text:
              %{PARSE_TILL_COMMA:consumer_text}, Consumer Text Length:
              ()?(%{integer:consumer_text_length})?, Operation:
              %{PARSE_TILL_COMMA:operation}, Operation Length:
              ()?(%{integer:operation_length})?, Device Id: %{data:device_id}'
    - type: pipeline
      name: Processing Aurora Focus API Sensor Based Detection Events
      enabled: true
      filter:
        query: "@evt.name:OpticsCaeApiEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus API Sensor Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: SECURITYSERVER3, Zone Names: (ZoneOne,ZoneTwo),
              Event Id: d29ee101-a2a2-42f1-b9ab-7e4b18aeeef1, Severity: High,
              Description: Test - API Sensor, High priority event, Instigating
              Process Name: IReadCredentials.exe, Instigating Process Owner:
              PENTEST//Administrator, Instigating Process ImageFileSha256:
              E24F5A2B51EC1C260388348AF764B8794CE0566749F5801D024B7B422C63DC56,
              Event Timestamp: 2022-09-28T14:23:37.384Z, Event Received
              Timestamp: 2022-09-28T14:24:30Z, Device Last Reported Users:
              (PENTEST\\Administrator), Zone Ids:
              (F568A8A8E401470282C1FE98FDD1703C,161EB91D79D6466A80182CF685FA7CA\
              A), Detection Rule Id: be7403ca-a9f4-4aa7-ad6d-7c672bfa8fc9,
              Instigating Process Command Line: IReadCredentials.exe,
              Instigating Process File Path:
              c:\\apisensor\\ireadcredentials.exe, API DLL: Advapi32.dll, API
              Function: CredEnumerateW, API Parameters: Unknown"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_api_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, API DLL:
              %{PARSE_TILL_COMMA:api_dll}, API Function:
              %{PARSE_TILL_COMMA:api_function}, API Parameters:
              %{data:api_parameters}'
    - type: pipeline
      name: Processing Aurora Focus COM Based Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeComEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus COM Based Detection Events
          enabled: true
          source: additional_details
          samples:
            - 'Device Name: DEVICE-W19, Zone Names: (Zone_3.x), Event Id:
              9e5ac116-a20c-4929-9087-10fd7fdcb105, Severity: High, Description:
              Device - Application COM Event, Instigating Process Name:
              GoogleUpdate.exe, Instigating Process Owner: NT AUTHORITY//SYSTEM,
              Instigating Process ImageFileSha256:
              63854E78780866D2AE56A58958A1FDA017A71F54B71FE70CF5403958E961862A,
              Event Timestamp: 2023-08-23T07:28:59.588Z, Event Received
              Timestamp: 2023-08-23T07:29:01Z, Device Last Reported Users:
              (Window Manager\DWM-1), Zone Ids:
              (D215191148D64DEE826768B62D64B244), Detection Rule Id:
              15b11fa2-fc61-4aa3-aa04-082c488f8a86, Instigating Process Command
              Line: "C:\Program Files (x86)\Google\Update\GoogleUpdate.exe"
              /svc, Instigating Process File Path: c:\program files
              (x86)\google\update\googleupdate.exe, COM Interface ID:
              2933bf81-7b36-11d2-b20e-00c04f983e60, COM Program: msxml, COM
              Interface: IXMLDOMDocument, Device Id:
              744ac660-9704-4edb-a8d0-ae13a343f3bf'
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_com_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, COM Interface
              ID: %{PARSE_TILL_COMMA:com_interface_id}, COM Program:
              %{PARSE_TILL_COMMA:com_program}, COM Interface:
              %{PARSE_TILL_COMMA:com_interface}, Device Id: %{data:device_id}'
    - type: pipeline
      name: Processing of Aurora Focus HTTP Visibility Detection Events
      enabled: true
      filter:
        query: "@event_type:OpticsCaeHttpEvent"
      processors:
        - type: grok-parser
          name: Parsing Aurora Focus HTTP Visibility Detection Events
          enabled: true
          source: additional_details
          samples:
            - "Device Name: DEVICE-W19, Zone Names: (Zone_3.x), Event Id:
              41ea5ce4-6501-4c13-a7a2-80f9afec9eee, Severity: High, Description:
              DEVICE - Trigger on ANY http sensor event, Instigating Process
              Name: svchost.exe, Instigating Process Owner: NT
              AUTHORITY//SYSTEM, Instigating Process ImageFileSha256:
              2B105FB153B1BCD619B95028612B3A93C60B953EEF6837D3BB0099E4207AAF6B,
              Event Timestamp: 2023-08-23T15:48:52.992Z, Event Received
              Timestamp: 2023-08-23T15:48:57Z, Device Last Reported Users:
              (RIMNET\\adminuser,Window Manager\\DWM-1,Window Manager\\DWM-2),
              Zone Ids: (D215191148D64DEE826768B62D64B244), Detection Rule Id:
              9a82a2d3-e6b0-4177-9bac-80ba5b1ef982, Instigating Process Command
              Line: C:\\WINDOWS\\system32\\svchost.exe -k netsvcs -p -s wlidsvc,
              Instigating Process File Path: c:\\windows\\system32\\svchost.exe,
              Device Id: 744ac660-9704-4edb-a8d0-ae13a343f3bf, User Agent:
              Microsoft-CryptoAPI/10.0, Request Domain: ocsp.digicert.com,
              Request Path:
              /MFEwTzBNMEswSTAJBgUrDgMCGgUABBSAUQYBMq2awn1Rh6Doh%2FsBYgFV7gQUA9\
              5QNVbRTLtm8KPiGxvDl7I90VUCEAJ0LqoXyo4hxxe7H%2Fz9DKA%3D, Request
              Method: GET, Request Port: 80, Request Version: HTTP/1.1, Request
              Headers: 0, Request Length: 0, Response Status: 0, Response
              Headers: 0, Response Length: 0"
          grok:
            supportRules: PARSE_TILL_COMMA %{regex("(.*?)(?=,)")}
            matchRules: 'parse_http_rule Device Name: %{PARSE_TILL_COMMA:device_name}, Zone
              Names: %{data:zone_names:array("()",",")}, Event Id:
              %{PARSE_TILL_COMMA:event_id}, Severity:
              ()?(%{notSpace:severity})?, Description:
              %{PARSE_TILL_COMMA:description}, Instigating Process Name:
              %{PARSE_TILL_COMMA:instigating_process_name}, Instigating Process
              Owner: %{PARSE_TILL_COMMA:instigating_process_owner}, Instigating
              Process ImageFileSha256:
              ()?(%{notSpace:instigating_process_imagefilesha256})?, Event
              Timestamp: %{PARSE_TILL_COMMA:event_timestamp}, Event Received
              Timestamp: %{PARSE_TILL_COMMA:event_received_timestamp}, Device
              Last Reported Users:
              %{data:device_last_reported_users:array("()",",")}, Zone Ids:
              %{data:zone_ids:array("()",",")}, Detection Rule Id:
              %{PARSE_TILL_COMMA:detection_rule_id}, Instigating Process Command
              Line: %{PARSE_TILL_COMMA:instigating_process_command_line},
              Instigating Process File Path:
              %{PARSE_TILL_COMMA:instigating_process_file_path}, Device Id:
              %{PARSE_TILL_COMMA:device_id}, User Agent:
              %{PARSE_TILL_COMMA:user_agent}, Request Domain:
              %{PARSE_TILL_COMMA:dns.question.name}, Request Path:
              %{PARSE_TILL_COMMA:request_path}, Request Method:
              ()?(%{notSpace:request_method})?, Request Port:
              ()?(%{port:request_port})?, Request Version:
              %{PARSE_TILL_COMMA:request_version}, Request Headers:
              %{PARSE_TILL_COMMA:request_headers}, Request Length:
              ()?(%{integer:request_length})?, Response Status:
              %{PARSE_TILL_COMMA:response_status}, Response Headers:
              %{PARSE_TILL_COMMA:response_headers}, Response Length:
              %{data:response_length}'
        - type: attribute-remapper
          name: Map `user_agent` to `http.useragent`
          enabled: true
          sources:
            - user_agent
          sourceType: attribute
          target: http.useragent
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Processing Aurora Focus Detection Events
      enabled: true
      filter:
        query: service:detection-events
      processors:
        - name: Lookup on `severity` to `status`
          enabled: true
          source: severity
          target: status
          lookupTable: |-
            High,critical
            Medium,warning
            Low,info
            Info,info
            Informational,info
          type: lookup-processor
    - type: status-remapper
      name: Define `status` as the official status of the log
      enabled: true
      sources:
        - status
    - type: string-builder-processor
      name: Reset `additional_details` attribute
      enabled: true
      template: "%{resolve_to_empty_string}"
      target: additional_details
      replaceMissing: true
