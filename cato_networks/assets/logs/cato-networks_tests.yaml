id: "cato-networks"
tests:
 -
  sample: |-
    {
      "fieldsMap" : {
        "account_id" : "20123123",
        "model_name" : "IpsConfiguration",
        "admin_id" : "400000123",
        "change" : {
          "After" : {
            "suspiciousIPQuarantine" : "true",
            "samEnabled" : "true",
            "blockNewDomains" : "false",
            "name" : "IpsConfiguration"
          }
        },
        "module" : "IPS Configuration",
        "model_type" : "IPS Configuration",
        "admin" : "CATO-IN1-APAC-PTNR-ITPL User #123",
        "change_type" : "CREATED",
        "creation_date" : "1763455623000",
        "insertion_date" : "1763455630734"
      }
    }
  service: "audit-logs"
  result:
    custom:
      fieldsMap:
        account_id: "20123123"
        change:
          After:
            blockNewDomains: "false"
            name: "IpsConfiguration"
            samEnabled: "true"
            suspiciousIPQuarantine: "true"
        change_type: "CREATED"
        creation_date: "1763455623000"
        insertion_date: "1763455630734"
        model_name: "IpsConfiguration"
        model_type: "IPS Configuration"
        module: "IPS Configuration"
      usr:
        id: "400000123"
        name: "CATO-IN1-APAC-PTNR-ITPL User #123"
    message: |-
      {
        "fieldsMap" : {
          "account_id" : "20123123",
          "model_name" : "IpsConfiguration",
          "admin_id" : "400000123",
          "change" : {
            "After" : {
              "suspiciousIPQuarantine" : "true",
              "samEnabled" : "true",
              "blockNewDomains" : "false",
              "name" : "IpsConfiguration"
            }
          },
          "module" : "IPS Configuration",
          "model_type" : "IPS Configuration",
          "admin" : "CATO-IN1-APAC-PTNR-ITPL User #123",
          "change_type" : "CREATED",
          "creation_date" : "1763455623000",
          "insertion_date" : "1763455630734"
        }
      }
    service: "audit-logs"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763455630734
 -
  sample: |-
    {
      "fieldsMap" : {
        "account_id" : "20000232",
        "model_name" : "WAN Traffic",
        "admin_id" : "400000123",
        "change" : {
          "After" : {
            "suspiciousAction" : "MONITOR",
            "ruleType" : "IPS",
            "name" : "WAN Traffic",
            "action" : "BLOCK",
            "enabled" : "true"
          }
        },
        "module" : "Threat Protection Rule",
        "model_type" : "Antivirus Rule",
        "admin" : "CATO-IN1-APAC-PTNR-ITPL User #123",
        "change_type" : "CREATED",
        "creation_date" : "1763455623000",
        "insertion_date" : "1763455630734"
      }
    }
  service: "audit-logs"
  result:
    custom:
      fieldsMap:
        account_id: "20000232"
        change:
          After:
            action: "BLOCK"
            enabled: "true"
            name: "WAN Traffic"
            ruleType: "IPS"
            suspiciousAction: "MONITOR"
        change_type: "CREATED"
        creation_date: "1763455623000"
        insertion_date: "1763455630734"
        model_name: "WAN Traffic"
        model_type: "Antivirus Rule"
        module: "Threat Protection Rule"
      usr:
        id: "400000123"
        name: "CATO-IN1-APAC-PTNR-ITPL User #123"
    message: |-
      {
        "fieldsMap" : {
          "account_id" : "20000232",
          "model_name" : "WAN Traffic",
          "admin_id" : "400000123",
          "change" : {
            "After" : {
              "suspiciousAction" : "MONITOR",
              "ruleType" : "IPS",
              "name" : "WAN Traffic",
              "action" : "BLOCK",
              "enabled" : "true"
            }
          },
          "module" : "Threat Protection Rule",
          "model_type" : "Antivirus Rule",
          "admin" : "CATO-IN1-APAC-PTNR-ITPL User #123",
          "change_type" : "CREATED",
          "creation_date" : "1763455623000",
          "insertion_date" : "1763455630734"
        }
      }
    service: "audit-logs"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763455630734
 -
  sample: |-
    {
      "internal_id" : "c8d2456ef8b48123",
      "login_type" : "API",
      "event_count" : 1,
      "event_sub_type" : "ApiKey",
      "time_str" : "2025-11-18T15:02:28Z",
      "authentication_type" : "APIKEY",
      "key_name" : "demo-key",
      "src_ip" : "10.10.10.10",
      "internalId" : "c8d2456ef8b48123",
      "src_is_site_or_vpn" : "API",
      "account_id" : 20000232,
      "event_type" : "Connectivity",
      "event_id" : "c8d2456ef8b48123",
      "api_type" : "query",
      "src_country" : "India",
      "api_name" : "eventsFeed",
      "src_country_code" : "IN",
      "account_name" : "test-account",
      "action" : "Succeeded",
      "time" : 1763478148991,
      "event_message" : "ApiKey login successfully"
    }
  service: "events"
  result:
    custom:
      account_id: 20000232
      account_name: "test-account"
      action: "Succeeded"
      api_name: "eventsFeed"
      api_type: "query"
      authentication_type: "APIKEY"
      event_count: 1
      event_id: "c8d2456ef8b48123"
      event_message: "ApiKey login successfully"
      event_status: "info"
      event_sub_type: "ApiKey"
      evt:
        name: "Connectivity"
      internalId: "c8d2456ef8b48123"
      internal_id: "c8d2456ef8b48123"
      key_name: "demo-key"
      login_type: "API"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      src_country: "India"
      src_country_code: "IN"
      src_is_site_or_vpn: "API"
      time: 1763478148991
      time_str: "2025-11-18T15:02:28Z"
    message: |-
      {
        "internal_id" : "c8d2456ef8b48123",
        "login_type" : "API",
        "event_count" : 1,
        "event_sub_type" : "ApiKey",
        "time_str" : "2025-11-18T15:02:28Z",
        "authentication_type" : "APIKEY",
        "key_name" : "demo-key",
        "src_ip" : "10.10.10.10",
        "internalId" : "c8d2456ef8b48123",
        "src_is_site_or_vpn" : "API",
        "account_id" : 20000232,
        "event_type" : "Connectivity",
        "event_id" : "c8d2456ef8b48123",
        "api_type" : "query",
        "src_country" : "India",
        "api_name" : "eventsFeed",
        "src_country_code" : "IN",
        "account_name" : "test-account",
        "action" : "Succeeded",
        "time" : 1763478148991,
        "event_message" : "ApiKey login successfully"
      }
    service: "events"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763478148991
 -
  sample: |-
    {
      "event_count" : 1,
      "story_id" : "691dea630a267b749814b123",
      "criticality" : 5,
      "time_str" : "2025-11-19T16:03:48Z",
      "src_ip" : "10.10.10.10",
      "internalId" : "c14b9006b130bd27",
      "device_name" : "DESKTOP-ENI0ABC",
      "event_type" : "Detection and Response",
      "vendor" : "Cato",
      "account_name" : "test-account",
      "vpn_user_email" : "test@example.com",
      "action" : "Monitor",
      "src_site_id" : 2,
      "raw_data" : "",
      "internal_id" : "c14b9006b130b123",
      "rule_name" : "Test",
      "event_sub_type" : "XDR Threat",
      "ad_name" : "John Doe",
      "trigger" : "Story Created",
      "rule_id" : "691d9f390a267b749814b123",
      "src_is_site_or_vpn" : "SDP User",
      "account_id" : 20000232,
      "event_id" : "c14b9006b130b123",
      "src_site_name" : "John Doe",
      "user_id" : 2,
      "producer" : "Threat Prevention",
      "time" : 1763568228849,
      "indication" : "Cybersquatting Malicious Activity",
      "status" : "Open"
    }
  service: "events"
  result:
    custom:
      account_id: 20000232
      account_name: "test-account"
      action: "Monitor"
      ad_name: "John Doe"
      criticality: 5
      device_name: "DESKTOP-ENI0ABC"
      event_count: 1
      event_id: "c14b9006b130b123"
      event_status: "info"
      event_sub_type: "XDR Threat"
      evt:
        name: "Detection and Response"
      indication: "Cybersquatting Malicious Activity"
      internalId: "c14b9006b130bd27"
      internal_id: "c14b9006b130b123"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
      producer: "Threat Prevention"
      raw_data: ""
      rule_id: "691d9f390a267b749814b123"
      rule_name: "Test"
      src_is_site_or_vpn: "SDP User"
      src_site_id: 2
      src_site_name: "John Doe"
      status: "Open"
      story_id: "691dea630a267b749814b123"
      time: 1763568228849
      time_str: "2025-11-19T16:03:48Z"
      trigger: "Story Created"
      usr:
        email: "test@example.com"
        id: 2
      vendor: "Cato"
    message: |-
      {
        "event_count" : 1,
        "story_id" : "691dea630a267b749814b123",
        "criticality" : 5,
        "time_str" : "2025-11-19T16:03:48Z",
        "src_ip" : "10.10.10.10",
        "internalId" : "c14b9006b130bd27",
        "device_name" : "DESKTOP-ENI0ABC",
        "event_type" : "Detection and Response",
        "vendor" : "Cato",
        "account_name" : "test-account",
        "vpn_user_email" : "test@example.com",
        "action" : "Monitor",
        "src_site_id" : 2,
        "raw_data" : "",
        "internal_id" : "c14b9006b130b123",
        "rule_name" : "Test",
        "event_sub_type" : "XDR Threat",
        "ad_name" : "John Doe",
        "trigger" : "Story Created",
        "rule_id" : "691d9f390a267b749814b123",
        "src_is_site_or_vpn" : "SDP User",
        "account_id" : 20000232,
        "event_id" : "c14b9006b130b123",
        "src_site_name" : "John Doe",
        "user_id" : 2,
        "producer" : "Threat Prevention",
        "time" : 1763568228849,
        "indication" : "Cybersquatting Malicious Activity",
        "status" : "Open"
      }
    service: "events"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763568228849
 -
  sample: |-
    {
      "ISP_name" : "Bharti Airtel Ltd.",
      "src_isp_ip" : "10.10.10.10",
      "time_str" : "2025-11-18T13:41:22Z",
      "configured_host_name" : "AssetTag-EID",
      "internalId" : "e278205a1f4c73",
      "domain_name" : "signaler-pa.clients6.google.com",
      "application_name" : "Google Applications",
      "event_type" : "Security",
      "src_country_code" : "IN",
      "vpn_user_email" : "test@example.com",
      "action" : "Block",
      "src_site_id" : 0,
      "static_host" : false,
      "dest_port" : 443,
      "host_mac" : "aa:aa:83:20:60:ab",
      "internal_id" : "e278205a1f4c73",
      "rule_name" : "Block QUIC services",
      "custom_category_id" : [ 400000307 ],
      "event_sub_type" : "Internet Firewall",
      "visible_device_id" : "ab-b1-83-20-65-de",
      "user_reference_id" : "3248201907",
      "application_id" : "googleApps",
      "dest_country_code" : "IN",
      "cato_app" : "googleApps",
      "src_country" : "India",
      "src_site_name" : "John Doe",
      "user_id" : 0,
      "dest_ip" : "10.10.10.10",
      "os_type" : "OS_WINDOWS",
      "app_stack" : [ "UDP", "QUIC", "Google Applications" ],
      "network_rule" : "Internet Traffic - Predefined",
      "dest_country" : "India",
      "event_count" : 1,
      "user_name" : "John Doe",
      "connection_origin" : "Cato Client",
      "src_ip" : "10.10.10.10",
      "device_name" : "AssetTag-EID",
      "application_risk" : 3,
      "account_name" : "test-account",
      "categories" : [ "General", "Network Utilities", "Search Engines and Portals" ],
      "client_version" : "5.18.1.1234",
      "pop_name" : "Mumbai",
      "host_ip" : "10.10.10.10",
      "os_version" : "11",
      "ad_name" : "John Doe",
      "ip_protocol" : "UDP",
      "traffic_direction" : "OUTBOUND",
      "qos_priority" : 255,
      "rule_id" : "3145367409754000885",
      "src_port" : 65222,
      "src_is_site_or_vpn" : "SDP User",
      "account_id" : 20000232,
      "event_id" : "e278205a1f4c73",
      "time" : 1763473282069
    }
  service: "events"
  result:
    custom:
      ISP_name: "Bharti Airtel Ltd."
      account_id: 20000232
      account_name: "test-account"
      action: "Block"
      ad_name: "John Doe"
      app_stack:
       - "UDP"
       - "QUIC"
       - "Google Applications"
      application_id: "googleApps"
      application_name: "Google Applications"
      application_risk: 3
      categories:
       - "General"
       - "Network Utilities"
       - "Search Engines and Portals"
      cato_app: "googleApps"
      client_version: "5.18.1.1234"
      configured_host_name: "AssetTag-EID"
      connection_origin: "Cato Client"
      custom_category_id:
       - 400000307
      dest_country: "India"
      dest_country_code: "IN"
      device_name: "AssetTag-EID"
      dns:
        question:
          name: "signaler-pa.clients6.google.com"
      event_count: 1
      event_id: "e278205a1f4c73"
      event_status: "info"
      event_sub_type: "Internet Firewall"
      evt:
        name: "Security"
      host_ip: "10.10.10.10"
      host_mac: "aa:aa:83:20:60:ab"
      internalId: "e278205a1f4c73"
      internal_id: "e278205a1f4c73"
      ip_protocol: "UDP"
      network:
        client:
          geoip: {}
          ip: "10.10.10.10"
          port: 65222
        destination:
          geoip: {}
          ip: "10.10.10.10"
          port: 443
      network_rule: "Internet Traffic - Predefined"
      os_type: "OS_WINDOWS"
      os_version: "11"
      pop_name: "Mumbai"
      qos_priority: 255
      rule_id: "3145367409754000885"
      rule_name: "Block QUIC services"
      src_country: "India"
      src_country_code: "IN"
      src_is_site_or_vpn: "SDP User"
      src_isp_ip: "10.10.10.10"
      src_site_id: 0
      src_site_name: "John Doe"
      static_host: false
      time: 1763473282069
      time_str: "2025-11-18T13:41:22Z"
      traffic_direction: "OUTBOUND"
      user_reference_id: "3248201907"
      usr:
        email: "test@example.com"
        id: 0
        name: "John Doe"
      visible_device_id: "ab-b1-83-20-65-de"
    message: |-
      {
        "ISP_name" : "Bharti Airtel Ltd.",
        "src_isp_ip" : "10.10.10.10",
        "time_str" : "2025-11-18T13:41:22Z",
        "configured_host_name" : "AssetTag-EID",
        "internalId" : "e278205a1f4c73",
        "domain_name" : "signaler-pa.clients6.google.com",
        "application_name" : "Google Applications",
        "event_type" : "Security",
        "src_country_code" : "IN",
        "vpn_user_email" : "test@example.com",
        "action" : "Block",
        "src_site_id" : 0,
        "static_host" : false,
        "dest_port" : 443,
        "host_mac" : "aa:aa:83:20:60:ab",
        "internal_id" : "e278205a1f4c73",
        "rule_name" : "Block QUIC services",
        "custom_category_id" : [ 400000307 ],
        "event_sub_type" : "Internet Firewall",
        "visible_device_id" : "ab-b1-83-20-65-de",
        "user_reference_id" : "3248201907",
        "application_id" : "googleApps",
        "dest_country_code" : "IN",
        "cato_app" : "googleApps",
        "src_country" : "India",
        "src_site_name" : "John Doe",
        "user_id" : 0,
        "dest_ip" : "10.10.10.10",
        "os_type" : "OS_WINDOWS",
        "app_stack" : [ "UDP", "QUIC", "Google Applications" ],
        "network_rule" : "Internet Traffic - Predefined",
        "dest_country" : "India",
        "event_count" : 1,
        "user_name" : "John Doe",
        "connection_origin" : "Cato Client",
        "src_ip" : "10.10.10.10",
        "device_name" : "AssetTag-EID",
        "application_risk" : 3,
        "account_name" : "test-account",
        "categories" : [ "General", "Network Utilities", "Search Engines and Portals" ],
        "client_version" : "5.18.1.1234",
        "pop_name" : "Mumbai",
        "host_ip" : "10.10.10.10",
        "os_version" : "11",
        "ad_name" : "John Doe",
        "ip_protocol" : "UDP",
        "traffic_direction" : "OUTBOUND",
        "qos_priority" : 255,
        "rule_id" : "3145367409754000885",
        "src_port" : 65222,
        "src_is_site_or_vpn" : "SDP User",
        "account_id" : 20000232,
        "event_id" : "e278205a1f4c73",
        "time" : 1763473282069
      }
    service: "events"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763473282069
 -
  sample: |-
    {
      "internalId" : "a7cc4c4bb7fe123a",
      "account_id" : 20000232,
      "event_type" : "System",
      "event_id" : "a7cc4c4bb7feda4e",
      "internal_id" : "a7cc4c4bb7feda4e",
      "event_count" : 1,
      "event_sub_type" : "Sdp license",
      "account_name" : "test-account",
      "action" : "Succeeded",
      "time" : 1763531560065,
      "event_message" : "License job applied 1 and revoked 0 licenses",
      "time_str" : "2025-11-19T05:52:40Z"
    }
  service: "events"
  result:
    custom:
      account_id: 20000232
      account_name: "test-account"
      action: "Succeeded"
      event_count: 1
      event_id: "a7cc4c4bb7feda4e"
      event_message: "License job applied 1 and revoked 0 licenses"
      event_status: "info"
      event_sub_type: "Sdp license"
      evt:
        name: "System"
      internalId: "a7cc4c4bb7fe123a"
      internal_id: "a7cc4c4bb7feda4e"
      time: 1763531560065
      time_str: "2025-11-19T05:52:40Z"
    message: |-
      {
        "internalId" : "a7cc4c4bb7fe123a",
        "account_id" : 20000232,
        "event_type" : "System",
        "event_id" : "a7cc4c4bb7feda4e",
        "internal_id" : "a7cc4c4bb7feda4e",
        "event_count" : 1,
        "event_sub_type" : "Sdp license",
        "account_name" : "test-account",
        "action" : "Succeeded",
        "time" : 1763531560065,
        "event_message" : "License job applied 1 and revoked 0 licenses",
        "time_str" : "2025-11-19T05:52:40Z"
      }
    service: "events"
    status: "info"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1763531560065