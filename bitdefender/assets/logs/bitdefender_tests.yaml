id: bitdefender
tests:
  -
    sample: |-
      {
        "method" : "addEvents",
        "id" : 1731566555000,
        "jsonrpc" : "2.0",
        "params" : {
          "events" : [ {
            "computer_id" : "aaaaaaaa1111111112222222sssssss",
            "parent_process_id" : 22222,
            "date" : "2019-01-24T11:13:04.000Z",
            "computer_name" : "ABC",
            "file_path" : "aaaa22222sssssss222.bender",
            "malware_name" : "",
            "process_info_command_line" : "c:\\\\aaa.exe-test",
            "attack_type" : "suspiciousfilesandnetworktraffic",
            "module" : "hd",
            "detection_level" : "normal",
            "command_line_parameters" : "abc",
            "computer_fqdn" : "abc",
            "is_fileless_attack" : 1,
            "companyId" : "1111aaaaasssss222s",
            "computer_ip" : "10.10.10.10",
            "final_status" : "quarantined",
            "product_installed" : "XYZ",
            "process_info_path" : "C:\\\\aa.exe",
            "hwid" : "00000000-0000-0000-0000-111111****",
            "user" : {
              "name" : "admin",
              "sid" : "AA222AA11-55FF-41E1-BF8F-1111AAAA"
            },
            "malware_type" : "file",
            "parent_process_path" : "C:\\\\AVAA\\\\BBBB\\\\cmd.exe",
            "hash" : "hash_3"
          }, {
            "computer_id" : "1111aaaaaaa222bbbb",
            "parent_process_id" : 2222,
            "date" : "2019-01-24T11:13:04.000Z",
            "computer_name" : "Knight",
            "file_path" : "aaaaaaa111111sssssss2dddd.bender",
            "malware_name" : "",
            "process_info_command_line" : "c:\\\\aaa.exe-test",
            "attack_type" : "attack1",
            "module" : "hd",
            "detection_level" : "aggressive",
            "command_line_parameters" : "abc",
            "computer_fqdn" : "knight",
            "is_fileless_attack" : 1,
            "companyId" : "111111f***",
            "computer_ip" : "100.10.0.100",
            "final_status" : "quarantined",
            "product_installed" : "ABC",
            "process_info_path" : "C:\\\\a.exe",
            "hwid" : "00000000-0000-0000-0000-406186b5****",
            "user" : {
              "name" : "admin2",
              "sid" : "AAA2222-222AA-1A1S-BF8F-55AABB55AA55"
            },
            "malware_type" : "file",
            "parent_process_path" : "C:\\\\AAA\\\\SFGB\\\\cmd.exe",
            "hash" : "hash_3"
          } ]
        }
      }
    result:
      custom:
        computer_ip_extracted: "10.10.10.10,100.10.0.100"
        id: 1731566555000
        jsonrpc: "2.0"
        method: "addEvents"
        module_extracted: "hd,hd"
        network:
          client:
            ip:
            - "10.10.10.10"
            - "100.10.0.100"
        params:
          events:
          -
            computer_id: "aaaaaaaa1111111112222222sssssss"
            parent_process_id: 22222
            date: "2019-01-24T11:13:04.000Z"
            computer_name: "ABC"
            file_path: "aaaa22222sssssss222.bender"
            malware_name: ""
            process_info_command_line: "c:\\\\aaa.exe-test"
            attack_type: "suspiciousfilesandnetworktraffic"
            module: "hd"
            detection_level: "normal"
            command_line_parameters: "abc"
            computer_fqdn: "abc"
            is_fileless_attack: 1
            companyId: "1111aaaaasssss222s"
            computer_ip: "10.10.10.10"
            final_status: "quarantined"
            product_installed: "XYZ"
            process_info_path: "C:\\\\aa.exe"
            hwid: "00000000-0000-0000-0000-111111****"
            user:
              name: "admin"
              sid: "AA222AA11-55FF-41E1-BF8F-1111AAAA"
            malware_type: "file"
            parent_process_path: "C:\\\\AVAA\\\\BBBB\\\\cmd.exe"
            hash: "hash_3"
          -
            computer_id: "1111aaaaaaa222bbbb"
            parent_process_id: 2222
            date: "2019-01-24T11:13:04.000Z"
            computer_name: "Knight"
            file_path: "aaaaaaa111111sssssss2dddd.bender"
            malware_name: ""
            process_info_command_line: "c:\\\\aaa.exe-test"
            attack_type: "attack1"
            module: "hd"
            detection_level: "aggressive"
            command_line_parameters: "abc"
            computer_fqdn: "knight"
            is_fileless_attack: 1
            companyId: "111111f***"
            computer_ip: "100.10.0.100"
            final_status: "quarantined"
            product_installed: "ABC"
            process_info_path: "C:\\\\a.exe"
            hwid: "00000000-0000-0000-0000-406186b5****"
            user:
              name: "admin2"
              sid: "AAA2222-222AA-1A1S-BF8F-55AABB55AA55"
            malware_type: "file"
            parent_process_path: "C:\\\\AAA\\\\SFGB\\\\cmd.exe"
            hash: "hash_3"
        service: "hyper-detect-event"
      message: |-
        {
          "method" : "addEvents",
          "id" : 1731566555000,
          "jsonrpc" : "2.0",
          "params" : {
            "events" : [ {
              "computer_id" : "aaaaaaaa1111111112222222sssssss",
              "parent_process_id" : 22222,
              "date" : "2019-01-24T11:13:04.000Z",
              "computer_name" : "ABC",
              "file_path" : "aaaa22222sssssss222.bender",
              "malware_name" : "",
              "process_info_command_line" : "c:\\\\aaa.exe-test",
              "attack_type" : "suspiciousfilesandnetworktraffic",
              "module" : "hd",
              "detection_level" : "normal",
              "command_line_parameters" : "abc",
              "computer_fqdn" : "abc",
              "is_fileless_attack" : 1,
              "companyId" : "1111aaaaasssss222s",
              "computer_ip" : "10.10.10.10",
              "final_status" : "quarantined",
              "product_installed" : "XYZ",
              "process_info_path" : "C:\\\\aa.exe",
              "hwid" : "00000000-0000-0000-0000-111111****",
              "user" : {
                "name" : "admin",
                "sid" : "AA222AA11-55FF-41E1-BF8F-1111AAAA"
              },
              "malware_type" : "file",
              "parent_process_path" : "C:\\\\AVAA\\\\BBBB\\\\cmd.exe",
              "hash" : "hash_3"
            }, {
              "computer_id" : "1111aaaaaaa222bbbb",
              "parent_process_id" : 2222,
              "date" : "2019-01-24T11:13:04.000Z",
              "computer_name" : "Knight",
              "file_path" : "aaaaaaa111111sssssss2dddd.bender",
              "malware_name" : "",
              "process_info_command_line" : "c:\\\\aaa.exe-test",
              "attack_type" : "attack1",
              "module" : "hd",
              "detection_level" : "aggressive",
              "command_line_parameters" : "abc",
              "computer_fqdn" : "knight",
              "is_fileless_attack" : 1,
              "companyId" : "111111f***",
              "computer_ip" : "100.10.0.100",
              "final_status" : "quarantined",
              "product_installed" : "ABC",
              "process_info_path" : "C:\\\\a.exe",
              "hwid" : "00000000-0000-0000-0000-406186b5****",
              "user" : {
                "name" : "admin2",
                "sid" : "AAA2222-222AA-1A1S-BF8F-55AABB55AA55"
              },
              "malware_type" : "file",
              "parent_process_path" : "C:\\\\AAA\\\\SFGB\\\\cmd.exe",
              "hash" : "hash_3"
            } ]
          }
        }
      service: "hyper-detect-event"
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1731566555000
