id: cisco-umbrella-dns
tests:
 -
  sample: |-
    {
      "date" : "2023-12-11",
      "returncode" : 0,
      "type" : "dns",
      "internalip" : "185.64.148.0",
      "allapplications" : [ {
        "id" : 989025,
        "label" : "Some APIs",
        "category" : {
          "id" : 1,
          "label" : "Application Development and Testing"
        }
      } ],
      "identities" : [ {
        "deleted" : false,
        "id" : 617808138,
        "label" : "DESKTOP-Example",
        "type" : {
          "id" : 9,
          "label" : "Roaming Computers",
          "type" : "roaming"
        }
      }, {
        "deleted" : false,
        "id" : 617804059,
        "label" : "Test",
        "type" : {
          "id" : 1,
          "label" : "Networks",
          "type" : "network"
        }
      } ],
      "verdict" : "blocked",
      "domain" : "optimizationguide-pa.someapis.com",
      "time" : "09:47:00",
      "policycategories" : [ {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "categories" : [ {
        "deprecated" : true,
        "integration" : false,
        "id" : 23,
        "label" : "Search Engines",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 148,
        "label" : "Application",
        "type" : "application"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "externalip" : "185.64.148.0",
      "querytype" : "A",
      "timestamp" : 1702288020000
    }
  result:
    null
 -
  sample: |-
    {
      "date" : "2023-12-19",
      "returncode" : 0,
      "type" : "dns",
      "internalip" : "185.64.148.0",
      "allapplications" : [ {
        "id" : 992107,
        "label" : "test.com",
        "category" : {
          "id" : 47,
          "label" : "Media"
        }
      } ],
      "identities" : [ {
        "deleted" : false,
        "id" : 618368586,
        "label" : "DESKTOP-Name",
        "type" : {
          "id" : 9,
          "label" : "Roaming Computers",
          "type" : "roaming"
        }
      } ],
      "verdict" : "allowed",
      "domain" : "test.com",
      "time" : "12:56:56",
      "policycategories" : [ {
        "deprecated" : false,
        "integration" : false,
        "id" : 194,
        "label" : "Streaming Video",
        "type" : "content"
      } ],
      "categories" : [ {
        "deprecated" : true,
        "integration" : false,
        "id" : 17,
        "label" : "Movies",
        "type" : "content"
      }, {
        "deprecated" : true,
        "integration" : false,
        "id" : 26,
        "label" : "Television",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 148,
        "label" : "Application",
        "type" : "application"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 194,
        "label" : "Streaming Video",
        "type" : "content"
      } ],
      "externalip" : "185.64.148.0",
      "querytype" : "A",
      "timestamp" : 1702990616000
    }
  result:
    null
 -
  sample: |-
    {
      "date" : "2023-12-19",
      "returncode" : 0,
      "type" : "dns",
      "internalip" : "185.64.148.0",
      "allapplications" : [ {
        "id" : 987820,
        "label" : "Social Media Platform",
        "category" : {
          "id" : 33,
          "label" : "Social Networking"
        }
      } ],
      "identities" : [ {
        "deleted" : false,
        "id" : 618368586,
        "label" : "DESKTOP-Test",
        "type" : {
          "id" : 9,
          "label" : "Roaming Computers",
          "type" : "roaming"
        }
      } ],
      "verdict" : "proxied",
      "domain" : "instagram.com",
      "time" : "12:56:56",
      "policycategories" : [ {
        "deprecated" : false,
        "integration" : false,
        "id" : 24,
        "label" : "Social Networking",
        "type" : "content"
      } ],
      "categories" : [ {
        "deprecated" : true,
        "integration" : false,
        "id" : 20,
        "label" : "Photo Sharing",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 24,
        "label" : "Social Networking",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 148,
        "label" : "Application",
        "type" : "application"
      } ],
      "externalip" : "185.64.148.0",
      "querytype" : "A",
      "timestamp" : 1702990616000
    }
  result:
    null
 -
  sample: |-
    {
      "date" : "2023-12-11",
      "referer" : "",
      "requestmethod" : "POST",
      "sha256" : "",
      "amp" : {
        "score" : 0,
        "disposition" : "",
        "malware" : ""
      },
      "useragent" : "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.81",
      "isolated" : {
        "fileaction" : "",
        "state" : "not-isolated"
      },
      "bundleid" : 14367283,
      "requestsize" : 517,
      "type" : "proxy",
      "internalip" : "185.64.148.0",
      "egress" : {
        "ip" : "185.64.148.0",
        "type" : "shared"
      },
      "statuscode" : 303,
      "datalossprevention" : {
        "state" : ""
      },
      "tenantcontrols" : false,
      "identities" : [ {
        "deleted" : false,
        "id" : 617808138,
        "label" : "DESKTOP-Test",
        "type" : {
          "id" : 9,
          "label" : "Roaming Computers",
          "type" : "roaming"
        }
      }, {
        "deleted" : false,
        "id" : 617804059,
        "label" : "Test",
        "type" : {
          "id" : 1,
          "label" : "Networks",
          "type" : "network"
        }
      } ],
      "responsesize" : 746,
      "policycategories" : [ {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "categories" : [ {
        "deprecated" : true,
        "integration" : false,
        "id" : 23,
        "label" : "Search Engines",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 148,
        "label" : "Application",
        "type" : "application"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "externalip" : "185.64.148.0",
      "policy" : {
        "timebasedrule" : false
      },
      "timestamp" : 1702288841000,
      "securityoverridden" : false,
      "forwardingmethod" : "",
      "warnstatus" : "",
      "datacenter" : {
        "label" : "Singapore, SG",
        "id" : "SIN"
      },
      "url" : "https://www.bing.com/api/shopping/v1/savings/user/readNotifications",
      "contenttype" : "text/html",
      "destinationip" : "",
      "port" : 443,
      "blockedfiletype" : "",
      "verdict" : "blocked",
      "time" : "10:00:41",
      "responsefilename" : ""
    }
  result:
    null
 -
  sample: |-
    {
      "date" : "2023-12-07",
      "referer" : "",
      "requestmethod" : "POST",
      "sha256" : "",
      "amp" : {
        "score" : 0,
        "disposition" : "",
        "malware" : ""
      },
      "useragent" : "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.81",
      "isolated" : {
        "fileaction" : "",
        "state" : "not-isolated"
      },
      "bundleid" : 14367283,
      "requestsize" : 517,
      "type" : "proxy",
      "internalip" : "185.64.148.0",
      "egress" : {
        "ip" : "185.64.148.0",
        "type" : "shared"
      },
      "statuscode" : 303,
      "datalossprevention" : {
        "state" : ""
      },
      "tenantcontrols" : false,
      "identities" : [ {
        "deleted" : false,
        "id" : 617808138,
        "label" : "DESKTOP-Test",
        "type" : {
          "id" : 9,
          "label" : "Roaming Computers",
          "type" : "roaming"
        }
      }, {
        "deleted" : false,
        "id" : 617804059,
        "label" : "Test",
        "type" : {
          "id" : 1,
          "label" : "Networks",
          "type" : "network"
        }
      } ],
      "responsesize" : 746,
      "policycategories" : [ {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "categories" : [ {
        "deprecated" : true,
        "integration" : false,
        "id" : 23,
        "label" : "Search Engines",
        "type" : "content"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 148,
        "label" : "Application",
        "type" : "application"
      }, {
        "deprecated" : false,
        "integration" : false,
        "id" : 190,
        "label" : "Search Engines and Portals",
        "type" : "content"
      } ],
      "externalip" : "185.64.148.0",
      "policy" : {
        "timebasedrule" : false
      },
      "timestamp" : 1701943235000,
      "securityoverridden" : false,
      "forwardingmethod" : "",
      "warnstatus" : "",
      "datacenter" : {
        "label" : "Singapore, SG",
        "id" : "SIN"
      },
      "url" : "https://www.bing.com/api/shopping/v1/savings/user/readNotifications",
      "contenttype" : "text/html",
      "destinationip" : "",
      "port" : 443,
      "blockedfiletype" : "",
      "verdict" : "allowed",
      "time" : "10:00:35",
      "responsefilename" : ""
    }
  result:
    null
