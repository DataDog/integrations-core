{"title":"FoundationDB Queues","description":"","widgets":[{"id":6651640501940114,"definition":{"title":"Storage Queues","type":"group","show_title":true,"layout_type":"ordered","widgets":[{"id":1363564845763694,"definition":{"title":"Maximum Data Lag","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">=","palette":"white_on_red","value":1},{"comparator":">=","palette":"white_on_yellow","value":0.5},{"comparator":"<","palette":"white_on_green","value":0.5}],"response_format":"scalar","queries":[{"query":"avg:foundationdb.process.role.data_lag.seconds{*}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":2},"layout":{"x":0,"y":0,"width":2,"height":3}},{"id":3779554554856520,"definition":{"title":"Data Lag History","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Average (seconds)","formula":"query1"},{"alias":"Maximum (seconds)","formula":"query2"}],"response_format":"timeseries","queries":[{"query":"avg:foundationdb.process.role.data_lag.seconds{*}","data_source":"metrics","name":"query1"},{"query":"max:foundationdb.process.role.data_lag.seconds{*}","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":2,"y":0,"width":4,"height":3}},{"id":877674090829804,"definition":{"type":"note","content":"Data lag represents how far the storage server is behind the current version. A storage server with high data lag will not be able to answer read queries for recent versions. This may result in transactions failing with \"Request for future version\".\n\nSuch a problem may indicate that the storage server cannot hold the write throughput; if it afflicts only a particular storage server, perhaps the writes are heavily focused on a certain key.","background_color":"white","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":5394879523525366,"definition":{"title":"Maximum Durability Lag","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","palette":"white_on_red","value":60},{"comparator":">=","palette":"white_on_yellow","value":10},{"comparator":"<","palette":"white_on_green","value":10}],"response_format":"scalar","queries":[{"query":"avg:foundationdb.process.role.durability_lag.seconds{*}","data_source":"metrics","name":"query1","aggregator":"max"}]}],"autoscale":true,"precision":2},"layout":{"x":0,"y":3,"width":2,"height":3}},{"id":6946105225798296,"definition":{"title":"Durability Lag History","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Average (seconds)","formula":"query1"},{"alias":"Maximum (seconds)","formula":"query2"}],"response_format":"timeseries","queries":[{"query":"avg:foundationdb.process.role.durability_lag.seconds{*}","data_source":"metrics","name":"query1"},{"query":"max:foundationdb.process.role.durability_lag.seconds{*}","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":2,"y":3,"width":4,"height":3}},{"id":1170485563155884,"definition":{"type":"note","content":"Durability lag is the time taken between a value arriving at the storage server and being committed to the storage engine.\n\nTypically, values are held in memory for 5 seconds to be available for transactions to read, and then committed. A little higher than this is normal, but much higher may indicate the storage server cannot handle the write throughput.","background_color":"white","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":3,"width":6,"height":3}}]},"layout":{"x":0,"y":0,"width":12,"height":7}},{"id":1412188565105088,"definition":{"title":"Log Queues","type":"group","show_title":true,"layout_type":"ordered","widgets":[{"id":1732457648173902,"definition":{"title":"Queue Length","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1 / 1000000"}],"conditional_formats":[{"comparator":">","palette":"white_on_red","value":1600},{"comparator":">=","palette":"white_on_yellow","value":1000},{"comparator":"<","palette":"white_on_green","value":1000}],"response_format":"scalar","queries":[{"query":"avg:foundationdb.process.role.queue_length{fdb_role:log}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":false,"custom_unit":"MB","precision":2},"layout":{"x":0,"y":0,"width":2,"height":3}},{"id":2489872583913144,"definition":{"title":"Queue Length History","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Queue Length (bytes)","formula":"query1"}],"response_format":"timeseries","queries":[{"query":"avg:foundationdb.process.role.queue_length{fdb_role:log}","data_source":"metrics","name":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":2,"y":0,"width":4,"height":3}},{"id":1898653223123090,"definition":{"type":"note","content":"Transaction logs hold transactions that have been committed, but that have not yet been written by a storage server. The queue is held in memory and written durably to disk.\n\nWhen the log exceeds 1.5GB, log spilling takes place. This may be a sign that the database can't keep up with the workload, although may also happen when a storage server fails.\n\nInput bytes is new data coming into the logs, while durable bytes is data removed from the logs by the storage servers after writing it.","background_color":"white","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":2798068125922784,"definition":{"title":"Log Length Change","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Change (bytes)","formula":"query1 - query2"}],"response_format":"timeseries","on_right_yaxis":false,"queries":[{"query":"sum:foundationdb.process.role.input_bytes.counter{fdb_role:log} by {fdb_process}.as_count()","data_source":"metrics","name":"query1"},{"query":"sum:foundationdb.process.role.durable_bytes.counter{fdb_role:log} by {fdb_process}.as_count()","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":0,"y":3,"width":4,"height":3}},{"id":7646097341264514,"definition":{"title":"Input Bytes","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Average (bytes / second)","formula":"query1"},{"alias":"Maximum (bytes / second)","formula":"query2"}],"response_format":"timeseries","queries":[{"query":"avg:foundationdb.process.role.input_bytes.hz{fdb_role:log}","data_source":"metrics","name":"query1"},{"query":"max:foundationdb.process.role.input_bytes.hz{fdb_role:log}","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":4,"y":3,"width":4,"height":3}},{"id":6534209379730168,"definition":{"title":"Durable (Output) Bytes","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"Average (bytes / second)","formula":"query1"},{"alias":"Maximum (bytes / second)","formula":"query2"}],"response_format":"timeseries","queries":[{"query":"avg:foundationdb.process.role.durable_bytes.hz{fdb_role:log}","data_source":"metrics","name":"query1"},{"query":"max:foundationdb.process.role.durable_bytes.hz{fdb_role:log}","data_source":"metrics","name":"query2"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]},"layout":{"x":8,"y":3,"width":4,"height":3}}]},"layout":{"x":0,"y":7,"width":12,"height":7}}],"template_variables":[],"layout_type":"ordered","is_read_only":false,"notify_list":[],"reflow_type":"fixed","id":"6uk-hdt-t9u"}
