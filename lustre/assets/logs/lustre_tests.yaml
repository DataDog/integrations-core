id: lustre
tests:
-
  sample: "t=[0x200000bd1:0x3:0x0] ef=0x13 u=0:0 nid=172.31.38.176@tcp p=[0x200000007:0x1:0x0] some_dir"
  result:
    custom:
      lustre:
        extended_flags: "0x13"
        nid: "172.31.38.176@tcp"
        parent_fid: "[0x200000007:0x1:0x0]"
        target_fid: "[0x200000bd1:0x3:0x0]"
        target_name: "some_dir"
        user: "0:0"
      network:
        client:
          ip: "172.31.38.176"
          protocol: "tcp"
    message: "t=[0x200000bd1:0x3:0x0] ef=0x13 u=0:0 nid=172.31.38.176@tcp p=[0x200000007:0x1:0x0] some_dir"
    tags:
     - "source:LOGS_SOURCE"
-
  sample: "t=[0x200000bd1:0x14:0x0] j=vim.0 ef=0x1b u=0:0 nid=172.31.38.176@tcp x=user.job p=[0x200000007:0x1:0x0]"
  result:
    custom:
      lustre:
        extended_attribute: "user.job"
        extended_flags: "0x1b"
        job_id: "vim.0"
        nid: "172.31.38.176@tcp"
        parent_fid: "[0x200000007:0x1:0x0]"
        target_fid: "[0x200000bd1:0x14:0x0]"
        user: "0:0"
      network:
        client:
          ip: "172.31.38.176"
          protocol: "tcp"
    message: "t=[0x200000bd1:0x14:0x0] j=vim.0 ef=0x1b u=0:0 nid=172.31.38.176@tcp x=user.job p=[0x200000007:0x1:0x0]"
    tags:
     - "source:LOGS_SOURCE"
-
  sample: "t=[0:0x0:0x0] j=vim.0 ef=0x13 u=0:0 nid=172.31.38.176@tcp p=[0x200000007:0x1:0x0] vim_edited_file.txt~ s=[0x200000bd1:0x26:0x0] sp=[0x200000007:0x1:0x0] vim_edited_file.txt"
  result:
    custom:
      lustre:
        extended_flags: "0x13"
        job_id: "vim.0"
        nid: "172.31.38.176@tcp"
        parent_fid: "[0x200000007:0x1:0x0]"
        source_fid: "[0x200000bd1:0x26:0x0]"
        source_name: "vim_edited_file.txt"
        source_parent_fid: "[0x200000007:0x1:0x0]"
        target_fid: "[0:0x0:0x0]"
        target_name: "vim_edited_file.txt~"
        user: "0:0"
      network:
        client:
          ip: "172.31.38.176"
          protocol: "tcp"
    message: "t=[0:0x0:0x0] j=vim.0 ef=0x13 u=0:0 nid=172.31.38.176@tcp p=[0x200000007:0x1:0x0] vim_edited_file.txt~ s=[0x200000bd1:0x26:0x0] sp=[0x200000007:0x1:0x0] vim_edited_file.txt"
    tags:
     - "source:LOGS_SOURCE"
-
  sample: "t=[0x200000bd1:0x2b:0x0] j=vim.0 ef=0x13 u=0:0 nid=172.31.38.176@tcp"
  result:
    custom:
      lustre:
        extended_flags: "0x13"
        job_id: "vim.0"
        nid: "172.31.38.176@tcp"
        target_fid: "[0x200000bd1:0x2b:0x0]"
        user: "0:0"
      network:
        client:
          ip: "172.31.38.176"
          protocol: "tcp"
    message: "t=[0x200000bd1:0x2b:0x0] j=vim.0 ef=0x13 u=0:0 nid=172.31.38.176@tcp"
    tags:
     - "source:LOGS_SOURCE"
