Improve error handling implementation with enhanced debug logs and refined logic
