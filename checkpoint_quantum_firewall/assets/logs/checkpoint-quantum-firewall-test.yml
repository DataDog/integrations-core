id: checkpoint-quantum-firewall
tests:
  - sample: >-
      {
      	"time":1611840577,
      	"hostname":"r81-t279-leui-main-take-2",
      	"severity":"High",
      	"product":"Anti-Exploit",
      	"action":"Prevent",
      	"ifdir":"inbound",
      	"loguid":"{0x6012bc47,0x33a3,0xd10617ac,0x21e842d}",
      	"origin":"20.2.2.3",
      	"sequencenum":14884,
      	"time":"1611840577,
      	"version":1,
      	"client_name":"Check Point Endpoint Security Client",
      	"client_version":"80.71.3026"
      	"description":"An exploit attack was prevented in chrome.exe",
      	"event_type":"Antex Event",
      	"file_name":"chrome.exe",
      	"file_size":1586008,
      	"file_type":"",
      	"host_type":"Desktop",
      	"installed_products":"Anti-Malware; Anti-Bot; Forensics; Threat Emulation",
      	"local_time":1529504331,
      	"malware_action":"Shellcode exploit",
      	"os_name":"Windows 7 Professional N Edition",
      	"os_version":"6.1-7601-SP1.0-SMP",
      	"packet_capture_unique_id":"d6a13693-936d-42f3-9cad-20b455f882fb",
      	"policy_date":1529495787,
      	"policy_name":"policy_name3",
      	"policy_number":0,
      	"protection_type":"Generic",
      	"src":"121.121.12.21",
      	"src_machine_name":"machine0",
      	"src_user_name":"James White",
      	"user_name":"user_name",
      }
    result: null
  - sample: |-

      {
      	"action": "Detect",
      	"confidence_level": "Low",
      	"description_url": "05syslg_sport_514_help.html",
      	"dst": "2.222.222.112",
      	"hostname": "gw-81e3ba",
      	"ifdir": "outbound",
      	"ifname": "eth0",
      	"lastupdatetime": 1702272887,
      	"log_id": 2,
      	"malware_rule_name": "Test",
      	"origin": "20.2.2.3",
      	"performance_impact": 2,
      	"policy": "Standard",
      	"policy_time": 1702016778,
      	"product": "IPS",
      	"protection_id": "05syslg_sport_514",
      	"protection_type": "IPS",
      	"proto": 17,
      	"received_bytes": 0,
      	"s_port": 35098,
      	"sent_bytes": 0,
      	"sequencenum": 1,
      	"service": 514,
      	"service_id": "syslog",
      	"severity": "Low",
      	"smartdefense_profile": "Strict",
      	"src": "20.2.2.3",
      	"suppressed_logs": 352,
      	"time": 1702271803,
      	"version": 5
      }
    result: null
  - sample: >-

      {
      	"__policy_id_tag": "product=VPN-1 & FireWall-1[db_tag={AEAE5176-6F89-B64B-AF25-7181B191B13A};mgmt=gw-81e3ba;date=1702026887;policy_name=Standard]",
      	"action": "Accept",
      	"aggregated_log_count": 2,
      	"app_category": "Network Protocols",
      	"app_category_": {
      			"_": {
      					"_match_table": [
      							"Network Protocols"
      					]
      			}
      	},
      	"app_desc": "The Internet Control Message Protocol (ICMP) is a protocol used by network devices, including routers, to send error messages and operational information.",
      	"app_desc_": {
      			"_": {
      					"_match_table": [
      							"The Internet Control Message Protocol (ICMP) is a protocol used by network devices, including routers, to send error messages and operational information."
      					]
      			}
      	},
      	"app_id": 60526220,
      	"app_id_": {
      			"_": {
      					"_match_table": [
      							0,
      							60526220
      					]
      			}
      	},
      	"app_properties": "Low Risk, Network Protocols",
      	"app_properties_": {
      			"_": {
      					"_match_table": [
      							"Low Risk, Network Protocols"
      					]
      			}
      	},
      	"app_risk": 2,
      	"app_risk_": {
      			"_": {
      					"_match_table": [
      							0,
      							2
      					]
      			}
      	},
      	"app_sig_id": "60526220:1",
      	"app_sig_id_": {
      			"_": {
      					"_match_table": [
      							"60526220:1"
      					]
      			}
      	},
      	"appi_name": "ICMP Protocol",
      	"appi_name_": {
      			"_": {
      					"_match_table": [
      							"ICMP Protocol"
      					]
      			}
      	},
      	"bytes": 106200,
      	"client_inbound_bytes": 106200,
      	"client_inbound_packets": 1770,
      	"client_outbound_bytes": 0,
      	"client_outbound_packets": 0,
      	"conn_direction": "Internal",
      	"connection_count": 1,
      	"creation_time": 1702027684,
      	"dst": "1.2.3.4",
      	"duration": 10800,
      	"flags": 4210688,
      	"h_version": 5,
      	"hll_key": 16791445055475980000,
      	"ifdir": "inbound",
      	"ifname": "eth0",
      	"inzone": "Internal",
      	"last_hit_time": 1702029491,
      	"lastupdatetime": 1702038484,
      	"layer_name_": {
      			"_": {
      					"_match_table": [
      							"Network",
      							"URL"
      					]
      			}
      	},
      	"layer_uuid_": {
      			"_": {
      					"_match_table": [
      							"38271c2f-ab44-4e25-9aa4-e219cb6e12cf",
      							"06f20a0e-e099-40d7-85c3-1a9f551b09a0"
      					]
      			}
      	},
      	"logid": 352,
      	"loguid": "0xe4530a02,0x7e3167a6,0xd0ad64f6,0x45aa62d1",
      	"match_id_": {
      			"_": {
      					"_match_table": [
      							2,
      							16777221
      					]
      			}
      	},
      	"matched_category": "Network Protocols",
      	"matched_category_": {
      			"_": {
      					"_match_table": [
      							"Network Protocols"
      					]
      			}
      	},
      	"origin": "20.2.2.3",
      	"originsicname": "cn=cp_mgmt,o=gw-81e3ba..2qb6fg",
      	"outzone": "Internal",
      	"packets": 1770,
      	"parent_rule_": {
      			"_": {
      					"_match_table": [
      							0,
      							0
      					]
      			}
      	},
      	"product": "Application Control",
      	"proto": 1,
      	"rule_action_": {
      			"_": {
      					"_match_table": [
      							"Accept",
      							"Accept"
      					]
      			}
      	},
      	"rule_name_": {
      			"_": {
      					"_match_table": [
      							"Cleanup rule"
      					]
      			}
      	},
      	"rule_uid_": {
      			"_": {
      					"_match_table": [
      							"2b922948-da96-4c9d-a654-063e0183f9ae",
      							"a0cb0cad-2c5a-4256-90f9-37c4125fb5c9"
      					]
      			}
      	},
      	"sequencenum": 2,
      	"server_inbound_bytes": 0,
      	"server_inbound_packets": 0,
      	"server_outbound_bytes": 106200,
      	"server_outbound_packets": 1770,
      	"service_id": "echo-request",
      	"src": "23.323.23.32",
      	"time": 1702027684,
      	"update_count": 3
      }
    result: null
  - sample: >-

      {
          "creation_time": 1703224270,
          "app_category_": {
              "_": {
                  "_match_table": [
                      "High Risk"
                  ]
              }
          },
          "protocol": "HTTPS",
          "appi_name_": {
              "_": {
                  "_match_table": [
                      "malware.wicar.org"
                  ]
              }
          },
          "loguid": "0xb3226fa7,0x68fbe420,0x5b302790,0x50baf76f",
          "rule_name_": {
              "_": {
                  "_match_table": [
                      "Cleanup rule",
                      "Block"
                  ]
              }
          },
          "action": "Reject",
          "layer_name_": {
              "_": {
                  "_match_table": [
                      "Network",
                      "URL"
                  ]
              }
          },
          "aggregated_log_count": 1,
          "__policy_id_tag": "product=VPN-1 & FireWall-1[db_tag={059648D4-3B2C-3349-8364-64FFBE8A0162};mgmt=gw-81e3ba;date=1703155353;policy_name=Standard]",
          "app_id": 199853687,
          "app_properties_": {
              "_": {
                  "_match_table": [
                      "Spyware / Malicious Sites,High Risk,URL Filtering"
                  ]
              }
          },
          "conn_direction": "External",
          "sequencenum": 2,
          "inzone": "External",
          "ifdir": "inbound",
          "originsicname": "cn=cp_mgmt,o=gw-81e3ba..2qb6fg",
          "browse_time": 0,
          "match_id_": {
              "_": {
                  "_match_table": [
                      2,
                      33554435
                  ]
              }
          },
          "app_id_": {
              "_": {
                  "_match_table": [
                      0,
                      199853687
                  ]
              }
          },
          "connection_count": 1,
          "app_risk": 4,
          "proto": 6,
          "app_category": "High Risk",
          "rule_uid_": {
              "_": {
                  "_match_table": [
                      "2b922948-da96-4c9d-a654-063e0183f9ae",
                      "cca58c2b-c4af-4e65-80bf-79d792aecfee"
                  ]
              }
          },
          "matched_category_": {
              "_": {
                  "_match_table": [
                      "High Risk"
                  ]
              }
          },
          "dst": "208.94.116.246",
          "appi_name": "malware.wicar.org",
          "origin": "10.50.5.135",
          "flags": 2244608,
          "last_hit_time": 1703224270,
          "rule_action_": {
              "_": {
                  "_match_table": [
                      "Accept",
                      "Reject"
                  ]
              }
          },
          "parent_rule_": {
              "_": {
                  "_match_table": [
                      0,
                      0
                  ]
              }
          },
          "h_version": 5,
          "duration": 0,
          "app_properties": "Spyware / Malicious Sites,High Risk,URL Filtering",
          "ifname": "eth0",
          "service_id": "cp_tcp_A936BBAC_EBC3_4F18_B3CC_A63365F07477",
          "matched_category": "High Risk",
          "layer_uuid_": {
              "_": {
                  "_match_table": [
                      "38271c2f-ab44-4e25-9aa4-e219cb6e12cf",
                      "06f20a0e-e099-40d7-85c3-1a9f551b09a0"
                  ]
              }
          },
          "product": "URL Filtering",
          "src": "10.50.5.136",
          "update_count": 1,
          "outzone": "External",
          "app_risk_": {
              "_": {
                  "_match_table": [
                      0,
                      4
                  ]
              }
          },
          "service": 443,
          "logid": 256,
          "hll_key": 13668953065894260000,
          "time": 1703224270,
          "sig_id": 13
      }
    result: null
  - sample: |-

      {
      	"__nsons": 0,
      	"__p_dport": 0,
      	"__pos": 4,
      	"action": "Accept",
      	"bytes": 1264,
      	"client_inbound_bytes": 3445,
      	"client_inbound_interface": "eth0",
      	"client_inbound_packets": 26,
      	"client_outbound_bytes": 7021,
      	"client_outbound_packets": 60,
      	"conn_direction": "Internal",
      	"context_num": 2,
      	"contextnum": 2,
      	"dst": "201.131.243.137",
      	"elapsed": 593,
      	"hll_key": 2670827913415797000,
      	"hostname": "gw-81e3ba",
      	"ifdir": "outbound",
      	"ifname": "eth0",
      	"inzone": "Internal",
      	"last_rematch_time": 1702013332,
      	"lastupdatetime": 1702013677,
      	"layer_name": [
      			"Network",
      			"URL"
      	],
      	"layer_uuid": [
      			"38271c2f-ab44-4e25-9aa4-e219cb6e12cf",
      			"06f20a0e-e099-40d7-85c3-1a9f551b09a0"
      	],
      	"logid": 6,
      	"match_id": [
      			2,
      			16777220
      	],
      	"nat_addtnl_rulenum": 0,
      	"nat_rule_uid": "b281bd59-c11d-4766-86fc-feef607a538e",
      	"nat_rulenum": 1,
      	"needs_browse_time": 1,
      	"new_time": 1702013332,
      	"origin": "20.3.3.4",
      	"outzone": "Internal",
      	"packets": 86,
      	"parent_rule": [
      			0,
      			0
      	],
      	"product": "Firewall",
      	"proto": 6,
      	"protocol": "HTTPS",
      	"rule_action": [
      			"Accept",
      			"Accept"
      	],
      	"rule_uid": [
      			"2b922948-da96-4c9d-a654-063e0183f9ae",
      			"a2358143-04f2-4238-bfc8-c8b436693040"
      	],
      	"s_port": 59029,
      	"segment_time": 1702013332,
      	"sequencenum": 1,
      	"server_inbound_bytes": 7283,
      	"server_inbound_packets": 30,
      	"server_outbound_bytes": 3445,
      	"server_outbound_interface": "eth0",
      	"server_outbound_packets": 52,
      	"service": 443,
      	"service_id": "https",
      	"sig_id": 4,
      	"src": "15.31.9.140",
      	"start_time": 1702013062,
      	"time": [
      			1702013332,
      			1702013332
      	],
      	"version": 5,
      	"xlatedport": 0,
      	"xlatedst": "0.0.0.0",
      	"xlatesport": 46898,
      	"xlatesrc": "20.3.3.4"
      }
    result: null
# The `result` field should be left blank to start. Once you submit your log asset files with
# your integration pull-request in a Datadog GitHub repository, Datadog's validations will
# run your raw logs against your pipeline and return the result. If the result output in the
# validation is accurate, take the output and add it to the `result` field in your test YAML file.
