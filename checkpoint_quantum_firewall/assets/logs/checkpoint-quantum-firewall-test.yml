id: checkpoint-quantum-firewall
tests:
  - sample: '{"__policy_id_tag": "product=VPN-1 &
      FireWall-1[db_tag={ABCD1234-5F67-B89B-AF12-3456B78B91A};mgmt=gw-81a3bc;date=1702026887;policy_name=Standard\\]","action":
      "Accept","aggregated_log_count": "10","app_category": "High
      Risk","app_id": "647368112","app_properties": "Spyware / Malicious
      Sites,High Risk,URL Filtering","app_risk": 4,"appi_name":
      "malware.wicar.org","browse_time": "170","bytes":
      "187659","client_inbound_bytes": "146518","client_inbound_packets":
      "217","client_outbound_bytes": "41141","client_outbound_packets":
      "468","conn_direction": "Internal","connection_count":
      "5","creation_time": "1702027299","dst": "10.10.10.10","duration":
      "2578","flags": "4210688","hll_key": "13407405998656291587","ifdir":
      "inbound","ifname": "eth0","inzone": "Internal","last_hit_time":
      "1702029425","lastupdatetime": "1702029877","layer_name":
      ["Network","URL"],"layer_uuid":
      ["a0bc0def-da96-4c9d-a654-37c4125fb5c9","a0bc0def-da96-4c9d-a654-37c4125fb5c9"],"logid":
      "320","loguid":
      "{0xab66c4d0,0x8d99f544,0x8d99f545,0x8d99f546}","match_id":
      ["2","16777221"],"matched_category": "High Risk","origin":
      "10.11.11.11","originsicname": "cn=ab_mgmt,o=gw-12a3bc..4de5fg","outzone":
      "Internal","packets": "685","parent_rule": ["0","0"],"product": "URL
      Filtering","proto": "6","protocol": "HTTPS","rule_action":
      ["Accept","Accept"],"rule_name": "Cleanup rule","rule_uid":
      ["a0bc0def-da96-4c9d-a654-37c4125fb5c9","a0bc0def-0g0h-0012-90i9-37c4125fb5c9"],"sequencenum":
      "1","server_inbound_bytes": "42122","server_inbound_packets":
      "234","server_outbound_bytes": "146518","server_outbound_packets":
      "434","service": "443","service_id": "https","sig_id": "4","src":
      "10.11.11.11","time": "1702027299","update_count": "6","version": "5"}'
    result: null
  - sample: '{"action": "Detect","confidence_level": "Low","description_url":
      "abc.html","dst": "10.10.10.10","hostname": "gw-12e3ab","ifdir":
      "outbound","ifname": "eth9","lastupdatetime": 1702272887,"log_id":
      2,"malware_rule_name": "Test","origin": "10.2.2.3","performance_impact":
      2,"policy": "Standard","policy_time": 1702016778,"product":
      "IPS","protection_id": "sample_514","protection_type": "IPS","proto":
      17,"received_bytes": 0,"s_port": 35098,"sent_bytes": 0,"sequencenum":
      1,"service": 514,"service_id": "syslog","severity":
      "Low","smartdefense_profile": "Strict","src":
      "10.10.10.10","suppressed_logs": 352,"time": 1702271803,"version": 5}'
    result: null
  - sample: '{"action": "Log In","auth_method": "Machine Authentication (Active
      Directory)","auth_status": "Successful Login","client_name": "Active
      Directory Query","client_version": "R81.20","domain_name":
      "abc.xyz","endpoint_ip": "10.10.10.10","flags": "150783","identity_src":
      "AD Query","identity_type": "machine","ifdir": "inbound","logid":
      "131111","loguid": "{0x1abcde0,0x1abcde0,0x1abcde0,0x1abcde0}","origin":
      "10.2.2.2","originsicname": "cn=ab_mgmt,o=ab-12e3ba..2ab6cd","product":
      "Identity Awareness","sequencenum": "1","snid": "1e23f0dd","src":
      "10.10.10.10","src_machine_group": "All Machines","src_machine_name":
      "sample-46-123","time": "1702458184","version": "5"}'
    result: null
  - sample: '{"__nsons": 0,"__p_dport": 0,"__pos": 4,"action": "Accept","bytes":
      1264,"client_inbound_bytes": 3445,"client_inbound_interface":
      "eth0","client_inbound_packets": 26,"client_outbound_bytes":
      7021,"client_outbound_packets": 60,"conn_direction":
      "Internal","context_num": 2,"contextnum": 2,"dst":
      "10.10.10.10","elapsed": 593,"hll_key": 1652457895635214780,"hostname":
      "gw-81e3ba","ifdir": "outbound","ifname": "eth0","inzone":
      "Internal","last_rematch_time": 1702013332,"lastupdatetime":
      1702013677,"layer_name": ["Network","URL"],"layer_uuid":
      ["46523c2a-ld45-6q65-8cc5-q165ks7w45sh","46523c2a-ld45-6q78-8cq5-q165ks8Qg5ll"],"logid":
      6,"match_id": [2,46521458],"nat_addtnl_rulenum": 0,"nat_rule_uid":
      "a164ak46-r46a-4652-79av-rqqf465c465q","nat_rulenum":
      1,"needs_browse_time": 1,"new_time": 1702013332,"origin":
      "20.20.20.20","outzone": "Internal","packets": 86,"parent_rule":
      [0,0],"product": "Firewall","proto": 6,"protocol": "HTTPS","rule_action":
      ["Accept","Accept"],"rule_uid":
      ["46523c2a-ld45-6q65-8cc5-q165ks7w45sh","46523c2a-ld45-6q78-8cq5-q165ks8Qg5ll"],"s_port":
      59029,"segment_time": 1702013332,"sequencenum": 1,"server_inbound_bytes":
      7283,"server_inbound_packets": 30,"server_outbound_bytes":
      3445,"server_outbound_interface": "eth0","server_outbound_packets":
      52,"service": 443,"service_id": "https","sig_id": 4,"src":
      "30.30.30.30","start_time": 1702013062,"time":
      [1702013332,1702013332],"version": 5,"xlatedport": 0,"xlatedst":
      "0.0.0.0","xlatesport": 46898,"xlatesrc": "20.3.3.4"}'
    result: null
  - sample: '{"__policy_id_tag": "product=VPN-1 &
      FireWall-1[db_tag={AJSK4652-7Q56-A46N-AK56-4652A4665B46B};mgmt=gw-81e3ba;date=1702026887;policy_name=Standard]","action":
      "Accept","aggregated_log_count": 2,"app_category": "Network
      Protocols","app_category_": {"_": {"_match_table": ["Network
      Protocols"]}},"app_desc": "The Internet Control Message Protocol (ICMP) is
      a protocol used by network devices, including routers, to send error
      messages and operational information.","app_desc_": {"_": {"_match_table":
      ["The Internet Control Message Protocol (ICMP) is a protocol used by
      network devices, including routers, to send error messages and operational
      information."]}},"app_id": 60526220,"app_id_": {"_": {"_match_table":
      [0,60526220]}},"app_properties": "Low Risk, Network
      Protocols","app_properties_": {"_": {"_match_table": ["Low Risk, Network
      Protocols"]}},"app_risk": 2,"app_risk_": {"_": {"_match_table":
      [0,2]}},"app_sig_id": "60526220:1","app_sig_id_": {"_": {"_match_table":
      ["60526220:1"]}},"appi_name": "ICMP Protocol","appi_name_": {"_":
      {"_match_table": ["ICMP Protocol"]}},"bytes":
      106200,"client_inbound_bytes": 106200,"client_inbound_packets":
      1770,"client_outbound_bytes": 0,"client_outbound_packets":
      0,"conn_direction": "Internal","connection_count": 1,"creation_time":
      1702027684,"dst": "1.2.3.4","duration": 10800,"flags":
      4210688,"h_version": 5,"hll_key": 16791445055475980000,"ifdir":
      "inbound","ifname": "eth0","inzone": "Internal","last_hit_time":
      1702029491,"lastupdatetime": 1702038484,"layer_name_": {"_":
      {"_match_table": ["Network","URL"]}},"layer_uuid_": {"_": {"_match_table":
      ["46523c2a-ld45-6q65-8cc5-q165ks7w45sh","46523c2a-ld45-6q78-8cq5-q165ks8Qg5ll"]}},"logid":
      352,"loguid": "0xe4530a02,0x7e3167a6,0xd0ad64f6,0x45aa62d1","match_id_":
      {"_": {"_match_table": [2,16777221]}},"matched_category": "Network
      Protocols","matched_category_": {"_": {"_match_table": ["Network
      Protocols"]}},"origin": "20.2.2.3","originsicname":
      "cn=cp_mgmt,o=gw-81e3ba..2qb6fg","outzone": "Internal","packets":
      1770,"parent_rule_": {"_": {"_match_table": [0,0]}},"product":
      "Application Control","proto": 1,"rule_action_": {"_": {"_match_table":
      ["Accept","Accept"]}},"rule_name_": {"_": {"_match_table": ["Cleanup
      rule"]}},"rule_uid_": {"_": {"_match_table":
      ["46523c2a-ld45-6q65-8cc5-q165ks7w45sh","46523c2a-ld45-6q78-8cq5-q165ks8Qg5ll"]}},"sequencenum":
      2,"server_inbound_bytes": 0,"server_inbound_packets":
      0,"server_outbound_bytes": 106200,"server_outbound_packets":
      1770,"service_id": "echo-request","src": "23.323.23.32","time":
      1702027684,"update_count": 3}'
    result: null
