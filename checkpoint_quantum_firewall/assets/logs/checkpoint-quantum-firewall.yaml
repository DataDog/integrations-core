id: checkpoint-quantum-firewall
metric_id: checkpoint-quantum-firewall
backend_only: false
facets:
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Client Port
    path: network.client.port
    source: log
  - groups:
      - Geoip
    name: Destination City Name
    path: network.destination.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Destination Continent Code
    path: network.destination.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Destination Continent Name
    path: network.destination.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Destination Country ISO Code
    path: network.destination.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Country Name
    path: network.destination.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision ISO Code
    path: network.destination.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Subdivision Name
    path: network.destination.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Destination IP
    path: network.destination.ip
    source: log
  - groups:
      - Web Access
    name: Destination Port
    path: network.destination.port
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Action
    path: checkpoint.quantum.firewall.action
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Category
    path: app_category
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Name
    path: appi_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Risk
    path: app_risk_str
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Authentication Method
    path: auth_method
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Authentication Status
    path: auth_status
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Inbound Bytes
    path: client_inbound_bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Inbound Packets
    path: client_inbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Client Name
    path: checkpoint.quantum.firewall.client_name
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Outbound Bytes
    path: client_outbound_bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Outbound Packets
    path: client_outbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Confidence Level
    path: confidence_level
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Connection Direction
    path: conn_direction
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Destination
    path: dst
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Event Type
    path: checkpoint.quantum.firewall.event_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Host Type
    path: host_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Identity Source
    path: identity_src
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Identity Type
    path: identity_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Layer Name
    path: layer_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Malware Action
    path: malware_action
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Malware Rule Name
    path: malware_rule_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Matched Category
    path: matched_category
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Operation
    path: checkpoint.quantum.firewall.operation
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: OS Name
    path: os_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protection Name
    path: protection_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protection Type
    path: protection_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protocol
    path: checkpoint.quantum.firewall.protocol
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Reject Category
    path: reject_category
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Server Inbound Packets
    path: server_inbound_packets
    source: log
    type: integer
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Server Outbound Packets
    path: server_outbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Severity
    path: checkpoint.quantum.firewall.severity
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: SmartDefense Profile
    path: smartdefense_profile
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Source
    path: src
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Source Machine Name
    path: src_machine_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Status
    path: checkpoint.quantum.firewall.status
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Subject
    path: checkpoint.quantum.firewall.subject
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Total Bytes
    path: checkpoint.quantum.firewall.bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
pipeline:
  type: pipeline
  name: Checkpoint Quantum Firewall
  enabled: true
  filter:
    query: "source:checkpoint-quantum-firewall"
  processors:
    - type: service-remapper
      name: Define `product` as the official service of the log
      enabled: true
      sources:
        - product
    - type: date-remapper
      name: Define `time` as the official date of the log
      enabled: true
      sources:
        - time
    - name: Lookup for `severity` to `checkpoint.quantum.firewall.severity` field
      enabled: true
      source: severity
      target: checkpoint.quantum.firewall.severity
      lookupTable: |-
        0, Info
        1, Low
        2, Medium
        3, High
        4, Critical
        Info, Info
        Low, Low
        Medium, Medium
        High, High
        Critical, Critical
      type: lookup-processor
    - type: attribute-remapper
      name: Map `subject` to `checkpoint.quantum.firewall.subject`
      enabled: true
      sources:
        - subject
      sourceType: attribute
      target: checkpoint.quantum.firewall.subject
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `client_name` to `checkpoint.quantum.firewall.client_name`
      enabled: true
      sources:
        - client_name
      sourceType: attribute
      target: checkpoint.quantum.firewall.client_name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `action` to `checkpoint.quantum.firewall.action`
      enabled: true
      sources:
        - action
      sourceType: attribute
      target: checkpoint.quantum.firewall.action
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `protocol` to `checkpoint.quantum.firewall.protocol`
      enabled: true
      sources:
        - protocol
      sourceType: attribute
      target: checkpoint.quantum.firewall.protocol
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `bytes` to `checkpoint.quantum.firewall.bytes`
      enabled: true
      sources:
        - bytes
      sourceType: attribute
      target: checkpoint.quantum.firewall.bytes
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `operation` to `checkpoint.quantum.firewall.operation`
      enabled: true
      sources:
        - operation
      sourceType: attribute
      target: checkpoint.quantum.firewall.operation
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: pipeline
      name: Remapper for Web Access Attributes
      enabled: true
      filter:
        query: '@product:("Application Control" OR "DLP" OR Firewall OR "Identity
          Awareness" OR "URL Filtering" OR "Threat Emulation" OR "Anti-Spam and
          Email Security" OR "IPS") '
      processors:
        - type: attribute-remapper
          name: Map `src` to `network.client.ip`
          enabled: true
          sources:
            - src
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `dst` to `network.destination.ip`
          enabled: true
          sources:
            - dst
          sourceType: attribute
          target: network.destination.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `s_port` to `network.client.port`
          enabled: true
          sources:
            - s_port
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `src_country` to `network.client.geoip.country.iso_code`
          enabled: true
          sources:
            - src_country
          sourceType: attribute
          target: network.client.geoip.country.iso_code
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `service` to `network.destination.port`
          enabled: true
          sources:
            - service
          sourceType: attribute
          target: network.destination.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `server_inbound_bytes` to `network.bytes_read`
          enabled: true
          sources:
            - server_inbound_bytes
          sourceType: attribute
          target: network.bytes_read
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `server_outbound_bytes` to `network.bytes_written`
          enabled: true
          sources:
            - server_outbound_bytes
          sourceType: attribute
          target: network.bytes_written
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: GeoIP Parser for `network.client.ip`
          enabled: true
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
        - type: geo-ip-parser
          name: GeoIP Parser for `network.destination.ip`
          enabled: true
          sources:
            - network.destination.ip
          target: network.destination.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Remapper for Username Attribute
      enabled: true
      filter:
        query: '@product:("Anti-Exploit" OR "Anti-Ransomware" OR "Anti-Bot") '
      processors:
        - type: attribute-remapper
          name: Map `src_user_name` to `usr.name`
          enabled: true
          sources:
            - src_user_name
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `event_type` to `checkpoint.quantum.firewall.event_type`
          enabled: true
          sources:
            - event_type
          sourceType: attribute
          target: checkpoint.quantum.firewall.event_type
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Remapper for Username Attribute
      enabled: true
      filter:
        query: "@product:DLP "
      processors:
        - type: attribute-remapper
          name: Map `user` to `usr.name`
          enabled: true
          sources:
            - user
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: String Building for Source and Destination IP Port
      enabled: true
      filter:
        query: '@product:("Firewall" OR "IPS" OR "Anti-Spam and Email Security" OR "URL
          Filtering") '
      processors:
        - type: string-builder-processor
          name: "Define `src_ip_port` equal to %{network.client.ip}:
            %{network.client.port}"
          enabled: true
          template: "%{network.client.ip}:%{network.client.port}"
          target: src_ip_port
          replaceMissing: false
        - type: string-builder-processor
          name: "Define `dst_ip_port` equal to %{network.destination.ip}:
            %{network.destination.port}"
          enabled: true
          template: "%{network.destination.ip}:%{network.destination.port}"
          target: dst_ip_port
          replaceMissing: false
    - type: pipeline
      name: Lookup for `app_risk` field
      enabled: true
      filter:
        query: '@product:("Application Control" OR "URL Filtering") '
      processors:
        - name: Lookup for `app_risk` to `app_risk_str` field
          enabled: true
          source: app_risk
          target: app_risk_str
          lookupTable: |-
            0, Unknown
            1, Very low
            2, Low
            3, Medium
            4, High
            5, Critical
            Unknown, Unknown
            Very low, Very low
            Low, Low
            Medium, Medium
            High, High
            Critical, Critical
          type: lookup-processor
    - type: pipeline
      name: Remapper for Status Attribute
      enabled: true
      filter:
        query: '@product:"HTTPS Inspection" '
      processors:
        - type: attribute-remapper
          name: Map `status` to `checkpoint.quantum.firewall.status`
          enabled: true
          sources:
            - status
          sourceType: attribute
          target: checkpoint.quantum.firewall.status
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
