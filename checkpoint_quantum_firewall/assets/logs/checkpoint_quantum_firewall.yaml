id: checkpoint_quantum_firewall
metric_id: checkpoint-quantum-firewall
backend_only: false
facets:
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Action
    path: checkpoint_firewall_action
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Category
    path: app_category
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Name
    path: appi_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Application Risk
    path: app_risk_str
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Authentication Method
    path: auth_method
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Authentication Status
    path: auth_status
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Inbound Bytes
    path: client_inbound_bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Inbound Packets
    path: client_inbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Client Name
    path: checkpoint_firewall_client_name
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Outbound Bytes
    path: client_outbound_bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Client Outbound Packets
    path: client_outbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Confidence Level
    path: confidence_level
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Connection Direction
    path: conn_direction
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Destination
    path: dst
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Event Type
    path: checkpoint_event_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Host Type
    path: host_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Identity Source
    path: identity_src
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Identity Type
    path: identity_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Layer Name
    path: layer_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Malware Action
    path: malware_action
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Malware Rule Name
    path: malware_rule_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Matched Category
    path: matched_category
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Operation
    path: checkpoint_operation
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: OS Name
    path: os_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protection Name
    path: protection_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protection Type
    path: protection_type
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Protocol
    path: checkpoint_firewall_protocol
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Reject Category
    path: reject_category
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Server Inbound Packets
    path: server_inbound_packets
    source: log
    type: integer
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Server Outbound Packets
    path: server_outbound_packets
    source: log
    type: integer
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Severity
    path: checkpoint_firewall_severity
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: SmartDefense Profile
    path: smartdefense_profile
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Source
    path: src
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Source Machine Name
    path: src_machine_name
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Status
    path: checkpoint_firewall_status
    source: log
    type: string
  - facetType: list
    groups:
      - Checkpoint Quantum Firewall
    name: Subject
    path: checkpoint_firewall_subject
    source: log
    type: string
  - facetType: range
    groups:
      - Checkpoint Quantum Firewall
    name: Total Bytes
    path: checkpoint_firewall_bytes
    source: log
    type: integer
    unit:
      family: bytes
      name: byte
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Destination Country ISO Code
    path: network.destination.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Client Port
    path: network.client.port
    source: log
  - groups:
      - Web Access
    name: Destination IP
    path: network.destination.ip
    source: log
  - groups:
      - Web Access
    name: Destination Port
    path: network.destination.port
    source: log
  - groups:
      - User
    name: User Name
    path: usr.name
    source: log
pipeline:
  type: pipeline
  name: Checkpoint Quantum Firewall
  enabled: true
  filter:
    query: "source:checkpoint_quantum_firewall"
  processors:
    - type: service-remapper
      name: Define `product` as the official service of the log
      enabled: true
      meta:
        last_update:
          timestamp: 1705906057304
          user_name: Mohit Tilala
          user_email: mohit.tilala@crestdatasys.com
        tags: []
      sources:
        - product
    - type: date-remapper
      name: Define `time` as the official date of the log
      enabled: true
      meta:
        last_update:
          timestamp: 1705906095040
          user_name: Mohit Tilala
          user_email: mohit.tilala@crestdatasys.com
        tags: []
      sources:
        - time
    - name: Lookup for `severity` to `checkpoint_firewall_severity` field
      enabled: true
      meta:
        last_update:
          timestamp: 1704277532736
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      source: severity
      target: checkpoint_firewall_severity
      lookupTable: |-
        0, Info
        1, Low
        2, Medium
        3, High
        4, Critical
        Info, Info
        Low, Low
        Medium, Medium
        High, High
        Critical, Critical
      type: lookup-processor
    - type: attribute-remapper
      name: Map `subject` to `checkpoint_firewall_subject`
      enabled: true
      meta:
        last_update:
          timestamp: 1704264725763
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - subject
      sourceType: attribute
      target: checkpoint_firewall_subject
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `client_name` to `checkpoint_firewall_client_name`
      enabled: true
      meta:
        last_update:
          timestamp: 1704267865463
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - client_name
      sourceType: attribute
      target: checkpoint_firewall_client_name
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `action` to `checkpoint_firewall_action`
      enabled: true
      meta:
        last_update:
          timestamp: 1704267875932
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - action
      sourceType: attribute
      target: checkpoint_firewall_action
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `protocol` to `checkpoint_firewall_protocol`
      enabled: true
      meta:
        last_update:
          timestamp: 1704267881691
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - protocol
      sourceType: attribute
      target: checkpoint_firewall_protocol
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `bytes` to `checkpoint_firewall_bytes`
      enabled: true
      meta:
        last_update:
          timestamp: 1704279118956
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - bytes
      sourceType: attribute
      target: checkpoint_firewall_bytes
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: attribute-remapper
      name: Map `operation` to `checkpoint_operation`
      enabled: true
      meta:
        last_update:
          timestamp: 1705911703578
          user_name: null
          user_email: dev.patel@crestdatasys.com
        tags: []
      sources:
        - operation
      sourceType: attribute
      target: checkpoint_operation
      targetType: attribute
      preserveSource: false
      overrideOnConflict: false
    - type: pipeline
      name: Remapper for Web Access Attributes
      enabled: true
      filter:
        query: '@product:("Application Control" OR "DLP" OR Firewall OR "Identity
          Awareness" OR "URL Filtering" OR "Threat Emulation" OR "Anti-Spam and
          Email Security" OR "IPS") '
      processors:
        - type: attribute-remapper
          name: Map `src` to `network.client.ip`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704083245096
            tags: []
          sources:
            - src
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `dst` to `network.destination.ip`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704083268444
            tags: []
          sources:
            - dst
          sourceType: attribute
          target: network.destination.ip
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `s_port` to `network.client.port`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704197224039
            tags: []
          sources:
            - s_port
          sourceType: attribute
          target: network.client.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `src_country` to `network.client.geoip.country.iso_code`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704197268303
            tags: []
          sources:
            - src_country
          sourceType: attribute
          target: network.client.geoip.country.iso_code
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `service` to `network.destination.port`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704197338098
            tags: []
          sources:
            - service
          sourceType: attribute
          target: network.destination.port
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `server_inbound_bytes` to `network.bytes_read`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704197854427
            tags: []
          sources:
            - server_inbound_bytes
          sourceType: attribute
          target: network.bytes_read
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `server_outbound_bytes` to `network.bytes_written`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704199593022
            tags: []
          sources:
            - server_outbound_bytes
          sourceType: attribute
          target: network.bytes_written
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: geo-ip-parser
          name: GeoIP Parser for `network.client.ip`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704083759665
            tags: []
          sources:
            - network.client.ip
          target: network.client.geoip
          ip_processing_behavior: do-nothing
        - type: geo-ip-parser
          name: GeoIP Parser for `network.destination.ip`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704083781165
            tags: []
          sources:
            - network.destination.ip
          target: network.destination.geoip
          ip_processing_behavior: do-nothing
    - type: pipeline
      name: Remapper for Username Attribute
      enabled: true
      filter:
        query: '@product:("Anti-Exploit" OR "Anti-Ransomware" OR "Anti-Bot") '
      processors:
        - type: attribute-remapper
          name: Map `src_user_name` to `usr.name`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704286395470
            tags: []
          sources:
            - src_user_name
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `event_type` to `checkpoint_event_type`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1705911649321
            tags: []
          sources:
            - event_type
          sourceType: attribute
          target: checkpoint_event_type
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: Remapper for Username Attribute
      enabled: true
      filter:
        query: "@product:DLP "
      processors:
        - type: attribute-remapper
          name: Map `user` to `usr.name`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704367145639
            tags: []
          sources:
            - user
          sourceType: attribute
          target: usr.name
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
    - type: pipeline
      name: String Building for Source and Destination IP Port
      enabled: true
      filter:
        query: '@product:("Firewall" OR "IPS" OR "Anti-Spam and Email Security" OR "URL
          Filtering") '
      processors:
        - type: string-builder-processor
          name: "Define `src_ip_port` equal to %{network.client.ip}:
            %{network.client.port}"
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1703667959676
            tags: []
          template: "%{network.client.ip}:%{network.client.port}"
          target: src_ip_port
          replaceMissing: false
        - type: string-builder-processor
          name: "Define `dst_ip_port` equal to %{network.destination.ip}:
            %{network.destination.port}"
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1703667966285
            tags: []
          template: "%{network.destination.ip}:%{network.destination.port}"
          target: dst_ip_port
          replaceMissing: false
    - type: pipeline
      name: Lookup for `app_risk` field
      enabled: true
      filter:
        query: '@product:("Application Control" OR "URL Filtering") '
      processors:
        - name: Lookup for `app_risk` to `app_risk_str` field
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704295525972
            tags: []
          source: app_risk
          target: app_risk_str
          lookupTable: |-
            0, Unknown
            1, Very low
            2, Low
            3, Medium
            4, High
            5, Critical
            Unknown, Unknown
            Very low, Very low
            Low, Low
            Medium, Medium
            High, High
            Critical, Critical
          type: lookup-processor
    - type: pipeline
      name: Remapper for Status Attribute
      enabled: true
      filter:
        query: '@product:"HTTPS Inspection" '
      processors:
        - type: attribute-remapper
          name: Map `status` to `checkpoint_firewall_status`
          enabled: true
          meta:
            last_update:
              user_id: "5795819"
              timestamp: 1704281014539
            tags: []
          sources:
            - status
          sourceType: attribute
          target: checkpoint_firewall_status
          targetType: attribute
          preserveSource: false
          overrideOnConflict: false
