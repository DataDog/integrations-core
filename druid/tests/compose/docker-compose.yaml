version: '3.5'
services:
  zookeeper:
    build:
      context: .
      dockerfile: Dockerfile
    command: ["bin/run-zk", "conf"]
    volumes:
      - ./conf:/usr/local/druid/conf

  druid-broker:
    build:
      context: .
      dockerfile: Dockerfile
    command: ["bin/run-druid", "broker", "conf/druid/single-server/micro-quickstart"]
    depends_on:
      - zookeeper
    volumes:
      - ./conf:/usr/local/druid/conf
    ports:
      - 8082:8082

  druid-coordinator:
    build:
      context: .
      dockerfile: Dockerfile
    command: ["bin/run-druid", "coordinator-overlord", "conf/druid/single-server/micro-quickstart"]
    depends_on:
      - zookeeper
    volumes:
      - ./conf:/usr/local/druid/conf
    ports:
      - 8081:8081
