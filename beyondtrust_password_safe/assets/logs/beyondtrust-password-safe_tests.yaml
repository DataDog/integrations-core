id: beyondtrust-password-safe
tests:
  - sample: |-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Requestor",
        "eventdate": "Jun 24 2025 05:07:09",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "10.10.10.10",
          "reason": "SSH",
          "objecttypeid": "6",
          "ticketsystem": "BT Ticket System",
          "eventseverity": "0",
          "clienthost": "pf60fc91A000001",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "4",
          "target": "10.50.8.44/admin, Account #12",
          "btcategory": "System",
          "roleused": "Requestor",
          "logid": "445",
          "details": "Request #3",
          "objecttype": "Release Request",
          "logtime": "6/24/2025 5:07:09 AM",
          "operation": "Add",
          "objectid": "3",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: >-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 25 2025 09:22:01",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "10.10.10.10",
          "objecttypeid": "5",
          "eventseverity": "0",
          "clienthost": "pf60fc91A000001",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "3",
          "target": "ManagedSystem for DB Server Instance: Asset=keycloak-server InstanceName=keycloak",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "514",
          "details": "Set Local FunctionalAccount=keycloakdb (id=21)",
          "objecttype": "System",
          "logtime": "6/25/2025 9:22:01 AM",
          "operation": "Update",
          "objectid": "25",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: |-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 24 2025 05:02:08",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "10.10.10.10",
          "reason": "SSH",
          "objecttypeid": "18",
          "ticketsystem": "BT Ticket System",
          "eventseverity": "0",
          "failed": "0",
          "clienthost": "pf60fc91A000001",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "4",
          "target": "Asset:Sonicwall FW Account:admin",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "440",
          "details": "Type=SSH ReleaseRequestId=139",
          "objecttype": "Session",
          "logtime": "6/24/2025 5:02:08 AM",
          "operation": "Add",
          "objectid": "135",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: >-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 24 2025 05:02:07",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "10.10.10.10",
          "reason": "SSH",
          "objecttypeid": "9",
          "ticketsystem": "BT Ticket System",
          "eventseverity": "0",
          "clienthost": "pf60fc91A000001",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "4",
          "target": "Asset:Sonicwall FW MAccount:admin",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "439",
          "details": "ISA Release #139, Ticket #, TicketSystem=BT Ticket System",
          "objecttype": "Password",
          "logtime": "6/24/2025 5:02:07 AM",
          "operation": "Retrieve",
          "objectid": "139",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: |-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000000",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 23 2025 11:03:56",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "64.252.101.252",
          "objecttypeid": "5",
          "eventseverity": "0",
          "clienthost": "pf60fc91A000000",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "3",
          "target": "ManagedSystem for Asset=system",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "416",
          "details": "Domain FunctionalAccount=zeroad/test\\test (id=20)",
          "objecttype": "System",
          "logtime": "6/23/2025 11:03:56 AM",
          "operation": "Update",
          "objectid": "23",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: >-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000000",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 25 2025 09:23:00",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "64.252.101.52",
          "objecttypeid": "4",
          "eventseverity": "0",
          "failed": "0",
          "clienthost": "pf60fc91A000000",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "3",
          "target": "Asset:keycloak-server (Db Instance: keycloak, Port:5432) MAccount:keycloakdb",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "516",
          "details": "New auto-managed account",
          "objecttype": "Account",
          "logtime": "6/25/2025 9:23:00 AM",
          "operation": "Add",
          "objectid": "26",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: >-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000000",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "System",
        "eventdate": "Jun 25 2025 05:59:48",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "10.10.10.10",
          "reason": "SSH",
          "objecttypeid": "6",
          "ticketsystem": "BT Ticket System",
          "eventseverity": "0",
          "failed": "0",
          "clienthost": "pf60fc91A000000",
          "subjectdescription": "Internal process",
          "userid": "0",
          "target": "ManagedSystem=Linux-VM ManagedAccount=admin",
          "btcategory": "System",
          "roleused": "System",
          "logid": "495",
          "details": "ReleaseRequest #8, Ticket #, TicketSystem=BT Ticket System",
          "objecttype": "Release Request",
          "logtime": "6/25/2025 5:59:48 AM",
          "operation": "Approve",
          "objectid": "8",
          "username": "Internal process"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "Internal process"
      }
    service: "password-safe"
    result: null
  - sample: >-
      {
        "severity": "0",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "System",
        "eventname": "Administrators",
        "eventdate": "Jun 23 2025 08:59:35",
        "agentver": "25.1.0.1570",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "ipaddress": "64.252.99.200",
          "objecttypeid": "3",
          "eventseverity": "0",
          "failed": "0",
          "clienthost": "pf60fc91A000001",
          "subjectdescription": "admin.user@tom.ai",
          "userid": "3",
          "target": "FAccount=test FAlias=client-231 FDomain=zeroad/10.10.10.10 PFid=1",
          "btcategory": "System",
          "roleused": "Administrators",
          "logid": "370",
          "details": "New un-managed Functional Account",
          "objecttype": "Functional Account",
          "logtime": "6/23/2025 8:59:35 AM",
          "operation": "Add",
          "objectid": "18",
          "username": "admin.user@tom.ai"
        },
        "eventtype": "0",
        "category": "System",
        "formatVersion": "1.0",
        "user": "admin.user@tom.ai"
      }
    service: "password-safe"
    result: null
  - sample: |-
      {
        "AuditID": 1845,
        "ActionType": "Login",
        "Section": "PMM API SignAppIn",
        "UserID": 7,
        "UserName": "oauth_user",
        "IPAddress": "10.10.10.10",
        "CreateDate": "2025-06-24T09:27:01.38Z"
      }
    service: "audit-logs"
    result: null
  - sample: |-
      {
        "severity": "1",
        "eventid": "PBPS",
        "product": "BeyondInsight",
        "agentid": "PBPS",
        "workgroupdesc": "Default Workgroup",
        "eventsubject": "10.10.10.10",
        "sourcehost": "pf60fc91A000001",
        "version": "25.1.0.1570",
        "eventdesc": "Failed",
        "eventname": "Managed",
        "eventdate": "Jun 19 2025 16:36:16",
        "agentver": "25.1.0.1570",
        "workgroupid": "1",
        "sourceip": "10.10.10.10",
        "vendor": "BeyondTrust",
        "nvps": {
          "changedt": "6/19/2025 4:37:04 PM",
          "managedaccountid": "3",
          "nextchangedate": "7/1/2025 11:30:00 PM",
          "eventseverity": "1",
          "clienthost": "pf60fc91A000001",
          "userid": "5",
          "result": "F",
          "btcategory": "Change",
          "accountname": "zeroad",
          "releaseid": "37",
          "logid": "170",
          "managedsystemid": "4",
          "logtime": "6/19/2025 4:36:16 PM",
          "username": "admin.user@gmail.com",
          "changereasoncd": "R"
        },
        "eventtype": "0",
        "category": "Change",
        "formatVersion": "1.0",
        "user": "admin.user@gmail.com"
      }
    service: "password-safe"
    result: null