# bypass-global-facets-path-checks
id: pan.firewall
metric_id: pan-firewall
backend_only: false
facets:
  - groups:
      - Event
    name: Event Name
    path: evt.name
    source: log
  - groups:
      - Event
    name: Event Outcome
    path: evt.outcome
    source: log
  - groups:
      - Web Access
    name: Browser
    path: http.useragent_details.browser.family
    source: log
  - groups:
      - Web Access
    name: Device
    path: http.useragent_details.device.family
    source: log
  - groups:
      - Web Access
    name: OS
    path: http.useragent_details.os.family
    source: log
  - groups:
      - Geoip
    name: City Name
    path: network.client.geoip.city.name
    source: log
  - groups:
      - Geoip
    name: Continent Code
    path: network.client.geoip.continent.code
    source: log
  - groups:
      - Geoip
    name: Continent Name
    path: network.client.geoip.continent.name
    source: log
  - groups:
      - Geoip
    name: Country ISO Code
    path: network.client.geoip.country.iso_code
    source: log
  - groups:
      - Geoip
    name: Country Name
    path: network.client.geoip.country.name
    source: log
  - groups:
      - Geoip
    name: Subdivision ISO Code
    path: network.client.geoip.subdivision.iso_code
    source: log
  - groups:
      - Geoip
    name: Subdivision Name
    path: network.client.geoip.subdivision.name
    source: log
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Client Port
    path: network.client.port
    source: log
  - groups:
      - Web Access
    name: Destination IP
    path: network.destination.ip
    source: log
  - groups:
      - Web Access
    name: Destination Port
    path: network.destination.port
    source: log
  - groups:
      - User
    name: User ID
    path: usr.id
    source: log
  - groups:
      - Event
    name: Type
    path: type
    source: log
  - groups:
      - PAN Firewall
    name: Sub Type
    path: subtype
    source: log
  - groups:
      - PAN Firewall
    name: Module
    path: module
    source: log
  - groups:
      - PAN Firewall
    name: Source Zone
    path: source_zone
    source: log
  - groups:
      - PAN Firewall
    name: Destination Zone
    path: destination_zone
    source: log
  - facetType: range
    groups:
      - PAN Firewall
    name: Repeat Count
    path: repeatcnt
    source: log
    type: double
  - groups:
      - PAN Firewall
    name: Category
    path: category
    source: log
  - groups:
      - PAN Firewall
    name: Severity
    path: severity
    source: log
  - groups:
      - PAN Firewall
    name: Virtual System Name
    path: vsys_name
    source: log
  - groups:
      - PAN Firewall
    name: Device Name
    path: device_name
    source: log
  - facetType: range
    groups:
      - Web Access
    name: Network Bytes Read
    path: network.bytes_read
    source: log
    type: double
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Web Access
    name: Bytes Written
    path: network.bytes_written
    source: log
    type: double
    unit:
      family: bytes
      name: byte
  - facetType: range
    groups:
      - Web Access
    name: Packets Sent
    path: pkts_sent
    source: log
    type: double
  - facetType: range
    groups:
      - Web Access
    name: Packets Recieved
    path: pkts_received
    source: log
    type: double
  - groups:
      - PAN Firewall
    name: Authentication Policy
    path: authpolicy
    source: log
  - groups:
      - PAN Firewall
    name: Server Profile
    path: serverprofile
    source: log
  - groups:
      - PAN Firewall
    name: Security Rule
    path: rule
    source: log
  - groups:
      - OCSF
    name: Time
    path: ocsf.time
    source: log
  - groups:
      - OCSF
    name: Activity ID
    path: ocsf.activity_id
    source: log
  - groups:
      - OCSF
    name: Activity Name
    path: ocsf.activity_name
    source: log
  - groups:
      - OCSF
    name: Category ID
    path: ocsf.category_uid
    source: log
  - groups:
      - OCSF
    name: Category
    path: ocsf.category_name
    source: log
  - groups:
      - OCSF
    name: Class ID
    path: ocsf.class_uid
    source: log
  - groups:
      - OCSF
    name: Class
    path: ocsf.class_name
    source: log
  - groups:
      - OCSF
    name: Status
    path: ocsf.status
    source: log
  - groups:
      - OCSF
    name: Status ID
    path: ocsf.status_id
    source: log
  - groups:
      - OCSF
    name: Type ID
    path: ocsf.type_uid
    source: log
  - groups:
      - OCSF
    name: Type Name
    path: ocsf.type_name
    source: log
  - groups:
      - OCSF
    name: Severity
    path: ocsf.severity
    source: log
  - groups:
      - OCSF
    name: Severity ID
    path: ocsf.severity_id
    source: log
  - groups:
      - OCSF
    name: Product Name
    path: ocsf.metadata.product.name
    source: log
  - groups:
      - OCSF
    name: Product Vendor
    path: ocsf.metadata.product.vendor_name
    source: log
  - groups:
      - OCSF
    name: Product Version
    path: ocsf.metadata.version
    source: log
  - groups:
      - OCSF
    name: Sequence
    path: ocsf.metadata.sequence
    source: log
  - groups:
      - OCSF
    name: Is Alert
    path: ocsf.is_alert
    source: log
  - groups:
      - OCSF
    name: Source IP Address
    path: ocsf.src_endpoint.ip
    source: log
  - groups:
      - OCSF
    name: Source Port
    path: ocsf.src_endpoint.port
    source: log
  - groups:
      - OCSF
    name: Destination IP Address
    path: ocsf.dst_endpoint.ip
    source: log
  - groups:
      - OCSF
    name: Destination Port
    path: ocsf.dst_endpoint.port
    source: log
  - groups:
      - OCSF
    name: Evidence Device Name
    path: ocsf.evidence.device.name
    source: log
  - groups:
      - OCSF
    name: Evidence Device Type ID
    path: ocsf.evidence.device.type_id
    source: log
  - groups:
      - OCSF
    name: Evidence URL Path
    path: ocsf.evidence.url.path
    source: log
  - groups:
      - OCSF
    name: Evidence File Name
    path: ocsf.evidence.file.name
    source: log
  - groups:
      - OCSF
    name: Evidence File Type ID
    path: ocsf.evidence.file.type_id
    source: log
  - groups:
      - OCSF
    name: Finding UID
    path: ocsf.finding_info.uid
    source: log
  - groups:
      - OCSF
    name: Finding Analytic UID
    path: ocsf.finding_info.analytic.uid
    source: log
pipeline:
  type: pipeline
  name: Palo Alto Networks Firewall
  enabled: true
  filter:
    query: source:pan.firewall
  processors:
    - type: grok-parser
      name: Parsing Palo Alto Network Firewall logs
      enabled: true
      source: message
      samples:
        - "<14>Sep  3 19:40:32 PA-3220 timestamp=2025/09/03 19:40:32, serial=016201026426, type=TRAFFIC, subtype=end, time_generated=2025/09/03 19:40:32, network.client.ip=172.16.28.190, network.destination.ip=17.253.2.43, natsrc=72.138.81.50, natdst=17.253.2.43, rule=L3_Orca to L3_Untrust, usr.id=, dstuser=, app=ntp-base, vsys=vsys1, from=L3_Orca, to=L3_Untrust, inbound_if=ethernet1/6.115, outbound_if=ethernet1/7, logset=datadog-forwarder, sessionid=393714, repeatcnt=1, network.client.port=123, network.destination.port=123, natsport=29153 natdport=123, flags=0x40407a, proto=udp, evt.name=allow, bytes=372, network.bytes_read=282, network.bytes_written=90, start=2025/09/03 19:39:53, elapsed=36, category=any, seqno=7489817491394537148, actionflags=0x0, network.client.geoip.country.name=172.16.0.0-172.31.255.255, dstloc=United States, pkts_sent=3, pkts_received=1, session_end_reason=aged-out, device_name=PA-3220, action_source=from-policy, src_uuid=, dst_uuid=, tunnelid=0, imsi= 0, monitortag=, imei=, parent_session_id=0, parent_start_time=, tunnel=N/A, assoc_id=0, chunks=0 chunks_sent=0 chunks_received=0"
      grok:
        matchRules: |
          rule_panos %{data::keyvalue("=","/: \"")}
        supportRules: ""
    - type: grok-parser
      name: Parsing event time
      enabled: true
      source: time_generated
      samples:
        - "2025/08/25 17:15:02"
      grok:
        matchRules: |
          zero %{date("yyyy/MM/dd HH:mm:ss"):time_generated}
        supportRules: ""
    - type: date-remapper
      name: Define `time_generated` as the official date of the log
      enabled: true
      sources:
        - time_generated
    - type: geo-ip-parser
      name: Fetching GeoIp data for client ip
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
    - type: user-agent-parser
      name: Parsing useragent detils from http.useragent
      enabled: true
      sources:
        - http.useragent
      target: http.useragent_details
      encoded: false
    - type: string-builder-processor
      name: Add title
      enabled: true
      target: title
      template: "%{usr.id} performed event %{evt.name} from %{network.client.geoip.country.name}"
      replaceMissing: false
    - type: pipeline
      name: OCSF pre transformations
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "*"
      processors:
        - type: attribute-remapper
          name: Map `time_generated` to `ocsf.time`
          enabled: true
          sources:
            - time_generated
          sourceType: attribute
          target: ocsf.time
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `seqno` to `ocsf.metadata.sequence`
          enabled: true
          sources:
            - seqno
          sourceType: attribute
          target: ocsf.metadata.sequence
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add product name
          enabled: true
          template: Firewall
          target: ocsf.metadata.product.name
          replaceMissing: false
        - type: attribute-remapper
          name: Map `serial` to `ocsf.metadata.product.uid`
          enabled: true
          sources:
            - serial
          sourceType: attribute
          target: ocsf.metadata.product.uid
          targetType: attribute
          targetFormat: string
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add vendor name
          enabled: true
          template: Palo Alto
          target: ocsf.metadata.product.vendor_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add version
          enabled: true
          template: "1.5.0"
          target: ocsf.metadata.version
          replaceMissing: false
        - type: category-processor
          name: Severity ID Mapping
          enabled: true
          categories:
            - filter:
                query: "@severity:informational OR @type:TRAFFIC"
              name: "1"
            - filter:
                query: "@severity:low"
              name: "2"
            - filter:
                query: "@severity:medium"
              name: "3"
            - filter:
                query: "@severity:high"
              name: "4"
            - filter:
                query: "@severity:critical"
              name: "5"
            - filter:
                query: "-@severity:*"
              name: "1"
          target: ocsf.severity_id
        - type: attribute-remapper
          name: Map `ocsf.severity_id` to `ocsf.severity_id`
          enabled: true
          sources:
            - ocsf.severity_id
          sourceType: attribute
          target: ocsf.severity_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: category-processor
          name: Severity Name Mapping
          enabled: true
          categories:
            - filter:
                query: "@ocsf.severity_id:0"
              name: Unknown
            - filter:
                query: "@ocsf.severity_id:1"
              name: Informational
            - filter:
                query: "@ocsf.severity_id:2"
              name: Low
            - filter:
                query: "@ocsf.severity_id:3"
              name: Medium
            - filter:
                query: "@ocsf.severity_id:4"
              name: High
            - filter:
                query: "@ocsf.severity_id:5"
              name: Critical
          target: ocsf.severity
    - type: pipeline
      name: OCSF sub pipeline for class Network Activity [4001]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:TRAFFIC"
      processors:
        - type: category-processor
          name: Map activity name
          enabled: true
          categories:
            - filter:
                query: "@subtype:start"
              name: "Open"
            - filter:
                query: "@subtype:end"
              name: "Close"
            - filter:
                query: "@subtype:drop"
              name: "Reset"
            - filter:
                query: "@subtype:deny"
              name: "Refuse"
          target: ocsf.activity_name
        - type: category-processor
          name: Activity ID Category
          enabled: true
          categories:
            - filter:
                query: "@subtype:start"
              name: "1"
            - filter:
                query: "@subtype:end"
              name: "2"
            - filter:
                query: "@subtype:drop"
              name: "3"
            - filter:
                query: "@subtype:deny"
              name: "5"
          target: ocsf.activity_id
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "4"
          replaceMissing: false
          target: ocsf.category_uid
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: Network Activity
          target: ocsf.class_name
          replaceMissing: true
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "4001"
          target: ocsf.class_uid
          replaceMissing: false
        - type: attribute-remapper
          name: Map `network.destination.ip` to `ocsf.dst_endpoint.ip`
          enabled: true
          sources:
            - network.destination.ip
          sourceType: attribute
          target: ocsf.dst_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.client.ip' to `ocsf.src_endpoint.ip`
          enabled: true
          sources:
            - network.client.ip
          sourceType: attribute
          target: ocsf.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.destination.port` to `ocsf.dst_endpoint.port`
          enabled: true
          sources:
            - network.destination.port
          sourceType: attribute
          target: ocsf.dst_endpoint.port
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.client.port` to `ocsf.src_endpoint.port`
          enabled: true
          sources:
            - network.client.port
          sourceType: attribute
          target: ocsf.src_endpoint.port
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add direction id
          enabled: true
          template: "0"
          target: ocsf.connection_info.direction_id
          replaceMissing: false
        - type: attribute-remapper
          name: Map `sessionid` to `ocsf.connection_info.session.uid`
          enabled: true
          sources:
            - sessionid
          sourceType: attribute
          target: ocsf.connection_info.session.uid
          targetType: attribute
          targetFormat: string
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `proto` to `ocsf.connection_info.protocol_name`
          enabled: true
          sources:
            - proto
          sourceType: attribute
          target: ocsf.connection_info.protocol_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `bytes` to `ocsf.traffic.bytes`
          enabled: true
          sources:
            - bytes
          sourceType: attribute
          target: ocsf.traffic.bytes
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `bytes_out` to `ocsf.traffic.bytes_out`
          enabled: true
          sources:
            - bytes_out
          sourceType: attribute
          target: ocsf.traffic.bytes_out
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `bytes_in` to `ocsf.traffic.bytes_in`
          enabled: true
          sources:
            - bytes_in
          sourceType: attribute
          target: ocsf.traffic.bytes_in
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `pkts` to `ocsf.traffic.packets`
          enabled: true
          sources:
            - pkts
          sourceType: attribute
          target: ocsf.traffic.packets
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `pkts_sent` to `ocsf.traffic.packets_out`
          enabled: true
          sources:
            - pkts_sent
          sourceType: attribute
          target: ocsf.traffic.packets_out
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `pkts_received` to `ocsf.traffic.packets_in`
          enabled: true
          sources:
            - pkts_received
          sourceType: attribute
          target: ocsf.traffic.packets_in
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `chunks` to `ocsf.traffic.chunks`
          enabled: true
          sources:
            - chunks
          sourceType: attribute
          target: ocsf.traffic.chunks
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `chunks_sent` to `ocsf.traffic.chunks_out`
          enabled: true
          sources:
            - chunks_sent
          sourceType: attribute
          target: ocsf.traffic.chunks_out
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `chunks_received` to `ocsf.traffic.chunks_in`
          enabled: true
          sources:
            - chunks_received
          sourceType: attribute
          target: ocsf.traffic.chunks_in
          targetType: attribute
          targetFormat: integer
          preserveSource: true
          overrideOnConflict: false
    - type: pipeline
      name: OCSF sub pipeline for class Detection Finding [2004]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:THREAT"
      processors:
        - type: string-builder-processor
          name: Add activity id
          enabled: true
          template: "1"
          target: ocsf.activity_id
          replaceMissing: false
        - type: string-builder-processor
          name: Add activity name
          enabled: true
          template: Create
          target: ocsf.activity_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "2"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: Findings
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "2004"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: Detection Finding
          target: ocsf.class_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add name
          enabled: true
          template: Firewall
          target: ocsf.finding_info.product.name
          replaceMissing: false
        - type: string-builder-processor
          name: Add vendor name
          enabled: true
          template: Palo Alto
          target: ocsf.finding_info.product.vendor_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add confidence id
          enabled: true
          template: "0"
          target: ocsf.confidence_id
          replaceMissing: false
        - type: string-builder-processor
          name: Add type id
          enabled: true
          template: "1"
          target: ocsf.evidence.device.type_id
          replaceMissing: false
        - type: attribute-remapper
          name: Map `device_name` to `ocsf.evidence.device.name`
          enabled: true
          sources:
            - device_name
          sourceType: attribute
          target: ocsf.evidence.device.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add is alert
          enabled: true
          template: "true"
          target: ocsf.is_alert
          replaceMissing: false
        - type: string-builder-processor
          name: Add status id
          enabled: true
          template: "1"
          target: ocsf.status_id
          replaceMissing: false
        - type: string-builder-processor
          name: Add status
          enabled: true
          template: New
          target: ocsf.status
          replaceMissing: false
        - type: attribute-remapper
          name: Map `action` to `ocsf.status_detail`
          enabled: true
          sources:
            - action
          sourceType: attribute
          target: ocsf.status_detail
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add type id
          enabled: true
          template: "1"
          target: ocsf.finding_info.analytic.type_id
          replaceMissing: false
        - type: string-builder-processor
          name: Add type
          enabled: true
          template: Rule
          target: ocsf.finding_info.analytic.type
          replaceMissing: false
        - type: attribute-remapper
          name: Map `rule` to `ocsf.finding_info.analytic.name`
          enabled: true
          sources:
            - rule
          sourceType: attribute
          target: ocsf.finding_info.analytic.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `subtype` to `ocsf.finding_info.analytic.category`
          enabled: true
          sources:
            - subtype
          sourceType: attribute
          target: ocsf.finding_info.analytic.category
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `rule_uuid` to `ocsf.finding_info.analytic.uid`
          enabled: true
          sources:
            - rule_uuid
          sourceType: attribute
          target: ocsf.finding_info.analytic.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `seqno` to `ocsf.finding_info.uid`
          enabled: true
          sources:
            - seqno
          sourceType: attribute
          target: ocsf.finding_info.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `srcuser` to `ocsf.evidence.actor.user`
          enabled: true
          sources:
            - srcuser
          sourceType: attribute
          target: ocsf.evidence.actor.user
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `sessionid` to `ocsf.evidence.actor.session.uid`
          enabled: true
          sources:
            - sessionid
          sourceType: attribute
          target: ocsf.evidence.actor.session.uid
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `app` to `ocsf.evidence.actor.app_name`
          enabled: true
          sources:
            - app
          sourceType: attribute
          target: ocsf.evidence.actor.app_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add direction id
          enabled: true
          template: "0"
          target: ocsf.evidence.connection_info.direction_id
          replaceMissing: false
        - type: attribute-remapper
          name: Map `proto` to `ocsf.evidence.connection_info.protocol_name`
          enabled: true
          sources:
            - proto
          sourceType: attribute
          target: ocsf.evidence.connection_info.protocol_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.destination.ip` to `ocsf.evidence.dst_endpoint.ip`
          enabled: true
          sources:
            - network.destination.ip
          sourceType: attribute
          target: ocsf.evidence.dst_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.destination.port` to `ocsf.evidence.dst_endpoint.port`
          enabled: true
          sources:
            - network.destination.port
          sourceType: attribute
          target: ocsf.evidence.dst_endpoint.port
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `to` to `ocsf.evidence.dst_endpoint.zone`
          enabled: true
          sources:
            - to
          sourceType: attribute
          target: ocsf.evidence.dst_endpoint.zone
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.client.ip` to `ocsf.evidence.src_endpoint.ip`
          enabled: true
          sources:
            - network.client.ip
          sourceType: attribute
          target: ocsf.evidence.src_endpoint.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `network.client.port` to `ocsf.evidence.src_endpoint.port`
          enabled: true
          sources:
            - network.client.port
          sourceType: attribute
          target: ocsf.evidence.src_endpoint.port
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `from` to `ocsf.evidence.src_endpoint.zone`
          enabled: true
          sources:
            - from
          sourceType: attribute
          target: ocsf.evidence.src_endpoint.zone
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: category-processor
          name: map status id
          enabled: true
          categories:
            - filter:
                query: "@ocsf.status_id:0"
              name: "Unknown"
            - filter:
                query: "@ocsf.status_id:1"
              name: "New"
            - filter:
                query: "@ocsf.status_id:2"
              name: "In Progress"
            - filter:
                query: "@ocsf.status_id:3"
              name: "Suppressed"
            - filter:
                query: "@ocsf.status_id:4"
              name: "Resolved"
            - filter:
                query: "@ocsf.status_id:5"
              name: "Archived"
            - filter:
                query: "@ocsf.status_id:99"
              name: "Other"
          target: ocsf.status
    - type: pipeline
      name: misc field URL extraction
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:THREAT @subtype:url"
      processors:
        - type: attribute-remapper
          name: URL extraction
          enabled: true
          sources:
            - misc
          sourceType: attribute
          target: ocsf.evidence.url.path
          targetType: attribute
          targetFormat: string
          preserveSource: true
          overrideOnConflict: false
    - type: pipeline
      name: misc field filename extraction
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "@type:THREAT @subtype:(file OR virus OR wildire-virus OR wildfire)"
      processors:
        - type: attribute-remapper
          name: Map `misc` to `ocsf.evidence.file.name`
          enabled: true
          sources:
            - misc
          sourceType: attribute
          target: ocsf.evidence.file.name
          targetType: attribute
          targetFormat: string
          preserveSource: true
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add type id
          enabled: true
          template: "0"
          target: ocsf.evidence.file.type_id
          replaceMissing: false
    - type: pipeline
      name: OCSF sub pipeline for class Base Event [0]
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "-@type:(TRAFFIC OR THREAT)"
      processors:
        - type: string-builder-processor
          name: Add activity id
          enabled: true
          template: "99"
          target: ocsf.activity_id
          replaceMissing: false
        - type: attribute-remapper
          name: Map `ocsf.metadata.event_code` to `ocsf.activity_name`
          enabled: true
          sources:
            - ocsf.metadata.event_code
          sourceType: attribute
          target: ocsf.activity_name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.activity_id` to `ocsf.activity_id`
          enabled: true
          sources:
            - ocsf.activity_id
          sourceType: attribute
          target: ocsf.activity_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: string-builder-processor
          name: Add category uid
          enabled: true
          template: "0"
          target: ocsf.category_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add category name
          enabled: true
          template: "Uncategorized"
          target: ocsf.category_name
          replaceMissing: false
        - type: string-builder-processor
          name: Add class uid
          enabled: true
          template: "0"
          target: ocsf.class_uid
          replaceMissing: false
        - type: string-builder-processor
          name: Add class name
          enabled: true
          template: "Base Event"
          target: ocsf.class_name
          replaceMissing: false
    - type: pipeline
      name: OCSF Post Transformation
      enabled: true
      ocsf:
        isOcsf: true
      filter:
        query: "*"
      processors:
        - type: attribute-remapper
          name: Map `ocsf.connection_info.direction_id` to `ocsf.connection_info.direction_id`
          enabled: true
          sources:
            - ocsf.connection_info.direction_id
          sourceType: attribute
          target: ocsf.connection_info.direction_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: category-processor
          name: Add connection direction
          enabled: true
          categories:
            - filter:
                query: "@ocsf.connection_info.direction_id:0"
              name: "Unknown"
            - filter:
                query: "@ocsf.connection_info.direction_id:1"
              name: "Inbound"
            - filter:
                query: "@ocsf.connection_info.direction_id:2"
              name: "Outbound"
            - filter:
                query: "@ocsf.connection_info.direction_id:3"
              name: "Lateral"
            - filter:
                query: "@ocsf.connection_info.direction_id:99"
              name: "Other"
          target: ocsf.connection_info.direction
        - type: attribute-remapper
          name: Map `ocsf.evidence.file.type_id` to `ocsf.evidence.file.type_id`
          enabled: true
          sources:
            - ocsf.evidence.file.type_id
          sourceType: attribute
          target: ocsf.evidence.file.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.evidence.url.path` to `ocsf.evidence.url.path`
          enabled: true
          sources:
            - ocsf.evidence.url.path
          sourceType: attribute
          target: ocsf.evidence.url.path
          targetType: attribute
          targetFormat: string
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.evidence.connection_info.direction_id` to `ocsf.evidence.connection_info.direction_id`
          enabled: true
          sources:
            - ocsf.evidence.connection_info.direction_id
          sourceType: attribute
          target: ocsf.evidence.connection_info.direction_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.activity_id` to `ocsf.activity_id`
          enabled: true
          sources:
            - ocsf.activity_id
          sourceType: attribute
          target: ocsf.activity_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.category_uid` to `ocsf.category_uid`
          enabled: true
          sources:
            - ocsf.category_uid
          sourceType: attribute
          target: ocsf.category_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.status_id` to `ocsf.status_id`
          enabled: true
          sources:
            - ocsf.status_id
          sourceType: attribute
          target: ocsf.status_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.class_uid` to `ocsf.class_uid`
          enabled: true
          sources:
            - ocsf.class_uid
          sourceType: attribute
          target: ocsf.class_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.confidence_id` to `ocsf.confidence_id`
          enabled: true
          sources:
            - ocsf.confidence_id
          sourceType: attribute
          target: ocsf.confidence_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: category-processor
          name: add confidence
          enabled: true
          categories:
            - filter:
                query: "@ocsf.confidence_id:0"
              name: "Unknown"
            - filter:
                query: "@ocsf.confidence_id:1"
              name: "Low"
            - filter:
                query: "@ocsf.confidence_id:2"
              name: "Medium"
            - filter:
                query: "@ocsf.confidence_id:3"
              name: "High"
          target: ocsf.confidence
        - type: attribute-remapper
          name: Map 'ocsf.evidence.device.type_id' to `ocsf.evidence.device.type_id`
          enabled: true
          sources:
            - ocsf.evidence.device.type_id
          sourceType: attribute
          target: ocsf.evidence.device.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.status_id` to `ocsf.status_id`
          enabled: true
          sources:
            - ocsf.status_id
          sourceType: attribute
          target: ocsf.status_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.evidence.actor.session.uid` to `ocsf.evidence.actor.session.uid`
          enabled: true
          sources:
            - ocsf.evidence.actor.session.uid
          sourceType: attribute
          target: ocsf.evidence.actor.session.uid
          targetType: attribute
          targetFormat: string
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.finding_info.uid` to `ocsf.finding_info.uid`
          enabled: true
          sources:
            - ocsf.finding_info.uid
          sourceType: attribute
          target: ocsf.finding_info.uid
          targetType: attribute
          targetFormat: string
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.finding_info.analytic.type_id` to `ocsf.finding_info.analytic.type_id`
          enabled: true
          sources:
            - ocsf.finding_info.analytic.type_id
          sourceType: attribute
          target: ocsf.finding_info.analytic.type_id
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.src_endpoint.port` to `ocsf.src_endpoint.port`
          enabled: true
          sources:
            - ocsf.src_endpoint.port
          sourceType: attribute
          target: ocsf.src_endpoint.port
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.dst_endpoint.port` to `ocsf.dst_endpoint.port` 
          enabled: true
          sources:
            - ocsf.dst_endpoint.port
          sourceType: attribute
          target: ocsf.dst_endpoint.port
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.evidence.src_endpoint.port` to `ocsf.evidence.src_endpoint.port`
          enabled: true
          sources:
            - ocsf.evidence.src_endpoint.port
          sourceType: attribute
          target: ocsf.evidence.src_endpoint.port
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: attribute-remapper
          name: Map `ocsf.evidence.dst_endpoint.port` to `ocsf.evidence.dst_endpoint.port`
          enabled: true
          sources:
            - ocsf.evidence.dst_endpoint.port
          sourceType: attribute
          target: ocsf.evidence.dst_endpoint.port
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: arithmetic-processor
          name: Type ID calculator
          enabled: true
          expression: (ocsf.class_uid * 100) + ocsf.activity_id
          target: ocsf.type_uid_float
          replaceMissing: false
        - type: attribute-remapper
          name: Map `ocsf.type_uid_float` to `ocsf.type_uid`
          enabled: true
          sources:
            - ocsf.type_uid_float
          sourceType: attribute
          target: ocsf.type_uid
          targetType: attribute
          targetFormat: integer
          preserveSource: false
          overrideOnConflict: false
        - type: category-processor
          name: Type Name
          enabled: true
          categories:
            - filter:
                query: "@ocsf.type_uid:400101"
              name: "Network Activity: Open"
            - filter:
                query: "@ocsf.type_uid:400102"
              name: "Network Activity: Close"
            - filter:
                query: "@ocsf.type_uid:400103"
              name: "Network Activity: Reset"
            - filter:
                query: "@ocsf.type_uid:400105"
              name: "Network Activity: Refuse"
            - filter:
                query: "@ocsf.type_uid:200400"
              name: "Detection Finding: Unknown"
            - filter:
                query: "@ocsf.type_uid:200401"
              name: "Detection Finding: Create"
            - filter:
                query: "@ocsf.type_uid:200402"
              name: "Detection Finding: Update"
            - filter:
                query: "@ocsf.type_uid:200403"
              name: "Detection Finding: Close"
            - filter:
                query: "@ocsf.type_uid:200499"
              name: "Detection Finding: Unknown"
          target: ocsf.type_name
        - type: grok-parser
          name: Convert `ocsf.is_alert` to boolean type
          enabled: true
          source: ocsf.is_alert
          samples:
            - "true"
            - "false"
          grok:
            supportRules: ""
            matchRules: |
              convert_to_boolean %{boolean("true","false"):ocsf.is_alert}
        - type: array-processor
          name: Move attributes into ocsf.evidences array
          enabled: true
          operation:
            source: ocsf.evidence
            target: ocsf.evidences
            preserveSource: false
            type: append
