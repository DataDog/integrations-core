# ECS Fargate Integration

## Overview

Get metrics from all your containers running in ECS Fargate:

* CPU/Memory usage & limit metrics
* I/O metrics

## Setup
### Installation

The ECS Fargate check is packaged with the Agent, [run the Agent][1] with your containers to start collecting metrics.

### Configuration

#### Metric Collection

1. Edit the `ecs_fargate.d/conf.yaml` file, in the `conf.d/` folder at the root of your [Agent's configuration directory][2] to start collecting your ECS Fargate performance data.
    See the [sample ecs_fargate.d/conf.yaml][3] for all available configuration options.

2. [Restart the Agent][4]

#### Log Collection

1. Define the Fargate AwsLogDriver in your task. [Consult the AWS Fargate developer guide][5] to learn how to do it.

2. Fargate task definitions only support the awslogs log driver for the log configuration. This configures your Fargate tasks to send log information to Amazon CloudWatch Logs. The following shows a snippet of a task definition where the awslogs log driver is configured:

    ```
    "logConfiguration": { 
       "logDriver": "awslogs",
       "options": { 
          "awslogs-group" : "/ecs/fargate-task-definition",
          "awslogs-region": "us-east-1",
          "awslogs-stream-prefix": "ecs"
    }
    ```

    For more information about using the awslogs log driver in task definitions to send your container logs to CloudWatch Logs, see [Using the awslogs Log Driver][6].

    This driver collects logs generated by the container and sends them to CloudWatch directly.

3. Finally, [use a lambda function in order to collect logs from CloudWatch and send them to Datadog][7].

### Validation

[Run the Agent's `status` subcommand][1] and look for `ecs_fargate` under the Checks section.

## Data Collected

### Metrics

See [metadata.csv][8] for a list of metrics provided by this integration.

### Events

The ECS Fargate check does not include any events at this time.

### Service Checks

The ECS Fargate check does not include any service checks at this time.

## Troubleshooting

Need help? Contact [Datadog Support][9].

## Further Reading

* [Monitor AWS Fargate applications with Datadog][10]


[1]: https://docs.datadoghq.com/agent/faq/agent-commands/#agent-status-and-information
[2]: https://docs.datadoghq.com/agent/faq/agent-configuration-files/#agent-configuration-directory
[3]: https://github.com/DataDog/integrations-core/blob/master/ecs_fargate/datadog_checks/ecs_fargate/data/conf.yaml.example
[4]: https://docs.datadoghq.com/agent/faq/agent-commands/#start-stop-restart-the-agent
[5]: https://docs.aws.amazon.com/AmazonECS/latest/developerguide/AWS_Fargate.html
[6]: https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html
[7]: https://docs.datadoghq.com/integrations/amazon_lambda/#log-collection
[8]: https://github.com/DataDog/integrations-core/blob/master/ecs_fargate/metadata.csv
[9]: https://docs.datadoghq.com/help
[10]: https://www.datadoghq.com/blog/monitor-aws-fargate
