{
    "description": "This dashboard provides information about the Squid logs generated in Squid Proxy server.",
    "layout_type": "ordered",
    "notify_list": [
    ],
    "reflow_type": "fixed",
    "template_variables": [
        {
            "available_values": [
                "TCP",
                "UDP"
            ],
            "default": "*",
            "name": "Protocol",
            "prefix": "@network.protocol"
        },
        {
            "available_values": [
            ],
            "default": "*",
            "name": "User",
            "prefix": "@usr.name"
        },
        {
            "available_values": [
                "200",
                "400",
                "403",
                "407",
                "500"
            ],
            "default": "*",
            "name": "Status_Code",
            "prefix": "@http.status_code"
        },
        {
            "available_values": [
                "Success",
                "Notice",
                "Warning",
                "Error",
                "Critical"
            ],
            "default": "*",
            "name": "Status_Category",
            "prefix": "@http.status_category"
        },
        {
            "available_values": [
                "DENIED",
                "MISS",
                "HIT"
            ],
            "default": "*",
            "name": "Squid_Status",
            "prefix": "@squid.status"
        }
    ],
    "title": "Squid",
    "widgets": [
        {
            "definition": {
                "has_background": true,
                "has_border": true,
                "horizontal_align": "center",
                "sizing": "contain",
                "type": "image",
                "url": "https://www.squid-cache.org/Artwork/Banner.png",
                "url_dark_theme": "https://www.squid-cache.org/Artwork/Banner.png",
                "vertical_align": "center"
            },
            "id": 993530611301326,
            "layout": {
                "height": 2,
                "width": 6,
                "x": 0,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "vivid_blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Squid Monitors Summary",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "color_preference": "text",
                            "count": 50,
                            "display_format": "countsAndList",
                            "hide_zero_counts": true,
                            "last_triggered_format": "relative",
                            "query": "tag:squid",
                            "show_last_triggered": false,
                            "show_priority": false,
                            "show_status": true,
                            "sort": "status,asc",
                            "start": 0,
                            "summary_type": "monitors",
                            "title": "Squid Monitors Summary",
                            "type": "manage_status"
                        },
                        "id": 5292238472737108,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 0,
                            "y": 0
                        }
                    }
                ]
            },
            "id": 6105759479053774,
            "layout": {
                "height": 6,
                "width": 6,
                "x": 6,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "white",
                "content": "Gain a comprehensive view of your network's web and cache activities by monitoring detailed Squid Access logs through this dashboard.\n\nSquid Access Logs provide in-depth insights into web access patterns, such as Total Squid Logs and Logs Over Time. Analyze Top Client IPs and Top Users by Error Status Category to identify which clients and users are experiencing the most issues. \n\nOperational metrics provides a comprehensive overview of server performance, caching effectiveness, and client behavior. This helps you monitor key metrics, identify potential issues, and optimize your caching configuration. The dashboard covers CPU and memory usage, HTTP requests and errors, and FTP traffic.\n\nFor more information, see the [Squid Integration Documentation](https://docs.datadoghq.com/integrations/squid)\n  \n**Tips**\n- Use the timeframe selector in the top right of the dashboard to change the default timeframe.\n- Clone this dashboard to rearrange, modify and add widgets and visualizations.",
                "font_size": "14",
                "has_padding": true,
                "show_tick": false,
                "text_align": "left",
                "tick_edge": "left",
                "tick_pos": "50%",
                "type": "note",
                "vertical_align": "top"
            },
            "id": 6404359088381374,
            "layout": {
                "height": 4,
                "width": 6,
                "x": 0,
                "y": 2
            }
        },
        {
            "definition": {
                "background_color": "vivid_orange",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Datadog Cloud SIEM",
                "title_align": "center",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "vivid_blue",
                            "content": "\nDatadog Cloud SIEM analyzes and correlates Squid logs to detect threats to your environment in real time. If you don't see signals, make sure you've enabled [Datadog Cloud SIEM](/security?query=source%3Asquid). ",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 8135504331313588,
                        "layout": {
                            "height": 1,
                            "width": 12,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#bc303c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:critical source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "CRITICALs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 5242677795523096,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 0,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e5a21c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:medium source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "MEDIUMs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 4007960417434418,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 2,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                            ],
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#bc303c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:critical source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                            },
                            "title": "Critical Security Signals",
                            "type": "toplist"
                        },
                        "id": 8976826436340736,
                        "layout": {
                            "height": 4,
                            "width": 8,
                            "x": 4,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#d33043",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:high source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "HIGHs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 1502810820524424,
                        "layout": {
                            "height": 2,
                            "width": 2,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#ffb52b",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:low source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "LOWs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 6966298510286182,
                        "layout": {
                            "height": 1,
                            "width": 2,
                            "x": 2,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "custom_links": [
                            ],
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#84c1e0",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:info source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "INFOs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 57798377027784,
                        "layout": {
                            "height": 1,
                            "width": 2,
                            "x": 2,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                            ],
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#d33043",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:high source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                            },
                            "title": "High Security Signals",
                            "type": "toplist"
                        },
                        "id": 8289651080064226,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 5
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                            ],
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e5a21c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "security_signals",
                                            "group_by": [
                                                {
                                                    "facet": "@workflow.rule.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "status:medium source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                            },
                            "title": "Medium Security Signals",
                            "type": "toplist"
                        },
                        "id": 3439516698249068,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 6,
                            "y": 5
                        }
                    }
                ]
            },
            "id": 3255980586575102,
            "layout": {
                "height": 1,
                "width": 12,
                "x": 0,
                "y": 6
            }
        },
        {
            "definition": {
                "background_color": "vivid_green",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Squid Log Details",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#dbdef5",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Total Squid Logs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 2544834834046598,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "horizontal",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Access Logs",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "classic",
                                                "palette_index": 1
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Squid Logs over time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6929593419963792,
                        "layout": {
                            "height": 4,
                            "width": 9,
                            "x": 3,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "palette": "white_on_green",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1",
                                            "number_format": {
                                                "unit": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "byte"
                                                },
                                                "unit_scale": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "byte"
                                                }
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "sum",
                                                "metric": "@network.bytes_written"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "Total Bytes Sent to Client",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 4301951353466508,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "legend": {
                                "type": "table"
                            },
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.status_category",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    },
                                    "style": {
                                        "palette": "datadog16"
                                    }
                                }
                            ],
                            "title": "Distribution by Status Category ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "sunburst"
                        },
                        "id": 5210794857327700,
                        "layout": {
                            "height": 4,
                            "width": 9,
                            "x": 3,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#db3333",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid @squid.status:DENIED @network.protocol:TCP $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "Total TCP Denied Logs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 1552732595455472,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "avg",
                                                "metric": "@duration"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.url_details.host",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "avg",
                                                        "metric": "@duration",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                },
                                "palette": "dog_classic"
                            },
                            "title": "Top Avg Request Duration by URL Host",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 1821045533603400,
                        "layout": {
                            "height": 4,
                            "width": 9,
                            "x": 3,
                            "y": 8
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#db3333",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid @squid.status:DENIED @network.protocol:UDP $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area"
                            },
                            "title": "Total UDP Denied Logs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 7196619253169032,
                        "layout": {
                            "height": 3,
                            "width": 3,
                            "x": 0,
                            "y": 9
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@squid.status",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Squid Status Over Time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 4592726907280998,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 12
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@squid.peer_status",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Squid Peer Status Over Time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6060795960521114,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 6,
                            "y": 12
                        }
                    },
                    {
                        "definition": {
                            "legend": {
                                "type": "table"
                            },
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.protocol",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    },
                                    "style": {
                                        "palette": "datadog16"
                                    }
                                }
                            ],
                            "title": "Distribution by Protocol",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "sunburst"
                        },
                        "id": 452983347022802,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 16
                        }
                    },
                    {
                        "definition": {
                            "legend": {
                                "type": "table"
                            },
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.method",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    },
                                    "style": {
                                        "palette": "datadog16"
                                    }
                                }
                            ],
                            "title": "Distribution by HTTP Methods",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "sunburst"
                        },
                        "id": 2209657631600598,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 6,
                            "y": 16
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.useragent_details.browser.family",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Browsers",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 6753071570035770,
                        "layout": {
                            "height": 5,
                            "width": 4,
                            "x": 0,
                            "y": 20
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.ip",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Client IPs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 6865073291942784,
                        "layout": {
                            "height": 5,
                            "width": 4,
                            "x": 4,
                            "y": 20
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.destination.ip",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Destination IPs",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 8115192646989834,
                        "layout": {
                            "height": 5,
                            "width": 4,
                            "x": 8,
                            "y": 20
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.ip",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                },
                                                {
                                                    "facet": "@http.status_category",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   @http.status_code:>=400 $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 100,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Client IPs by Error Status Category",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 374174089069424,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 0,
                            "y": 25
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.url_details.host",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Sites",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 2144528520612260,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 6,
                            "y": 25
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@usr.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                },
                                                {
                                                    "facet": "@http.status_category",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   @http.status_code:>=400 $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 100,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Users by Error Status Category",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 2586504510271436,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 0,
                            "y": 30
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@usr.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Users",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 5832480649610576,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 6,
                            "y": 30
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#8c3131",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.url_details.host",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   @squid.status:DENIED $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Denied URL Host ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 2363694544637748,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 0,
                            "y": 35
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#e29d3c",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.url_details.host",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   @squid.status:MISS $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Missed URL Host ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 6502090782347636,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 6,
                            "y": 35
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@http.referer",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top HTTP Referrer",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 760898709982526,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 0,
                            "y": 40
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#a63f3f",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@error.message",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "display": {
                                    "legend": "automatic",
                                    "type": "stacked"
                                }
                            },
                            "title": "Top Error Messages",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "toplist"
                        },
                        "id": 4376134812588716,
                        "layout": {
                            "height": 5,
                            "width": 6,
                            "x": 6,
                            "y": 40
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.client.geoip.country.iso_code",
                                                    "limit": 250,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 250,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "palette": "hostmap_blues",
                                "palette_flip": false
                            },
                            "title": "Traffic Over Client Geoip Location",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "geomap",
                            "view": {
                                "focus": "WORLD"
                            }
                        },
                        "id": 6204659465091390,
                        "layout": {
                            "height": 5,
                            "width": 12,
                            "x": 0,
                            "y": 45
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [
                                                {
                                                    "facet": "@network.destination.geoip.country.iso_code",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:squid   $Protocol $User $Status_Code $Status_Category $Squid_Status"
                                            },
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "sort": {
                                        "count": 10,
                                        "order_by": [
                                            {
                                                "index": 0,
                                                "order": "desc",
                                                "type": "formula"
                                            }
                                        ]
                                    }
                                }
                            ],
                            "style": {
                                "palette": "hostmap_blues",
                                "palette_flip": false
                            },
                            "title": "Traffic Over Destination Geoip Location",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "geomap",
                            "view": {
                                "focus": "WORLD"
                            }
                        },
                        "id": 6079251722162984,
                        "layout": {
                            "height": 5,
                            "width": 12,
                            "x": 0,
                            "y": 50
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "columns": [
                                        {
                                            "field": "status_line",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "timestamp",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "host",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@network.client.ip",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@http.status_category",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@http.status_code",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@network.protocol",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "@network.bytes_written",
                                            "width": "auto"
                                        },
                                        {
                                            "field": "http.url_details.host",
                                            "width": "auto"
                                        }
                                    ],
                                    "query": {
                                        "data_source": "logs_stream",
                                        "indexes": [
                                        ],
                                        "query_string": "source:squid $Protocol $User $Status_Code $Status_Category $Squid_Status ",
                                        "storage": "hot"
                                    },
                                    "response_format": "event_list"
                                }
                            ],
                            "title": "Squid Log Details",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "list_stream"
                        },
                        "id": 8589078903940764,
                        "layout": {
                            "height": 6,
                            "width": 12,
                            "x": 0,
                            "y": 55
                        }
                    }
                ]
            },
            "id": 2539290368467106,
            "layout": {
                "height": 62,
                "width": 12,
                "x": 0,
                "y": 7
            }
        },
        {
            "definition": {
                "background_color": "blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Squid Metric Details",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": "<",
                                            "palette": "white_on_green",
                                            "value": 80
                                        },
                                        {
                                            "comparator": ">=",
                                            "palette": "black_on_light_red",
                                            "value": 80
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.cpu_time{*}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "CPU Usage ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 3820300543090186,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "horizontal",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "CPU Usage",
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.cpu_time{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "time": {
                                "hide_incomplete_cost_data": true
                            },
                            "title": "CPU Usage Over Time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6415929501862064,
                        "layout": {
                            "height": 3,
                            "width": 8,
                            "x": 4,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "palette": "white_on_green",
                                            "value": 0
                                        },
                                        {
                                            "comparator": ">",
                                            "palette": "white_on_yellow",
                                            "value": 750
                                        },
                                        {
                                            "comparator": ">=",
                                            "palette": "black_on_light_red",
                                            "value": 1000
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1 + query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.cd.memory{*}"
                                        },
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.cd.local_memory{*}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area"
                            },
                            "title": "Memory Usage ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 4258165939341752,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "custom_bg_color": "#26b0df",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1 + query2",
                                            "number_format": {
                                                "unit": {
                                                    "per_unit_name": "second",
                                                    "type": "canonical_unit",
                                                    "unit_name": "request"
                                                }
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.client_http.requests{*}"
                                        },
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.server.all.requests{*}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "HTTP Requests Per Second",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 2674308426925946,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 4,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "custom_bg_color": "#e66833",
                                            "palette": "custom_bg",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.aborted_requests{*}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": true
                                }
                            },
                            "title": "Aborted Requests Per Second",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 2786611055040880,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 8,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "horizontal",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Client HTTP Requests",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "classic",
                                                "palette_index": 1
                                            }
                                        },
                                        {
                                            "alias": "Client HTTP Hits",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "Client Hits Rate",
                                            "formula": "query2 / query1 * 100"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.client_http.requests{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.client_http.hits{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Client HTTP Requests vs HTTP Hits Over Time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 2069184515494228,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 0,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Client HTTP Errors",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "warm",
                                                "palette_index": 5
                                            }
                                        },
                                        {
                                            "alias": "Server HTTP Errors",
                                            "formula": "query2",
                                            "style": {
                                                "palette": "purple",
                                                "palette_index": 5
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.client_http.errors{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.server.all.errors{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Client Errors vs Server Errors ",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6482725862183798,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 6,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "horizontal",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Traffic Read",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "warm",
                                                "palette_index": 3
                                            }
                                        },
                                        {
                                            "alias": "Traffic Write",
                                            "formula": "query2",
                                            "style": {
                                                "palette": "classic",
                                                "palette_index": 3
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.server.all.kbytes_in{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.server.all.kbytes_out{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "time": {
                                "hide_incomplete_cost_data": true
                            },
                            "title": "Squid Cache Server Traffic Read Vs Traffic Write",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3053023205098324,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 0,
                            "y": 9
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "horizontal",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Server HTTP Requests",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Traffic Read",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "Traffic Write",
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.server.http.requests{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.server.http.kbytes_in{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "sum:squid.cachemgr.server.http.kbytes_out{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "HTTP Traffic Analysis",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1805246720143070,
                        "layout": {
                            "height": 3,
                            "width": 6,
                            "x": 6,
                            "y": 9
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "FTP Requests",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "dd20",
                                                "palette_index": 3
                                            }
                                        },
                                        {
                                            "alias": "FTP Errors",
                                            "formula": "query2",
                                            "style": {
                                                "palette": "dd20",
                                                "palette_index": 4
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:squid.cachemgr.server.ftp.requests{*}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:squid.cachemgr.server.ftp.errors{*}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "order_by": "values",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "time": {
                                "hide_incomplete_cost_data": true
                            },
                            "title": "FTP Requests vs FTP Errors Over Time",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1932830340289702,
                        "layout": {
                            "height": 3,
                            "width": 12,
                            "x": 0,
                            "y": 12
                        }
                    }
                ]
            },
            "id": 4126822935793754,
            "layout": {
                "height": 16,
                "width": 12,
                "x": 0,
                "y": 69
            }
        }
    ]
}