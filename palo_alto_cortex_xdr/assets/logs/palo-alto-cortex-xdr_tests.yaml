id: palo-alto-cortex-xdr
tests:
  - sample: |-
      {
                      "incident_id": "1",
                      "incident_name": null,
                      "creation_time": 1719992075000,
                      "modification_time": 1720175552000,
                      "detection_time": null,
                      "status": "new",
                      "severity": "critical",
                      "description": "'Credential Gathering Protection - 657061549' along with 23 other alerts generated by XDR Agent detected on host assettag-eid-new involving user test",
                      "assigned_user_mail": "test@test.com",
                      "assigned_user_pretty_name": "test",
                      "alert_count": 24,
                      "low_severity_alert_count": 0,
                      "med_severity_alert_count": 23,
                      "high_severity_alert_count": 1,
                      "critical_severity_alert_count": 0,
                      "user_count": 1,
                      "host_count": 1,
                      "notes": null,
                      "resolve_comment": null,
                      "resolved_timestamp": null,
                      "manual_severity": "critical",
                      "manual_description": null,
                      "xdr_url": "https://demo.xdr.in.paloaltonetworks.com/incident-view?caseId=1",
                      "starred": false,
                      "starred_manually": false,
                      "hosts": [
                          "assettag-eid-new:16adfdb6bbe145d59ac4f69e80e2053d"
                      ],
                      "users": [
                          "test"
                      ],
                      "incident_sources": [
                          "XDR Agent"
                      ],
                      "rule_based_score": null,
                      "predicted_score": null,
                      "manual_score": null,
                      "aggregated_score": null,
                      "wildfire_hits": 15,
                      "alerts_grouping_status": "Enabled",
                      "mitre_tactics_ids_and_names": [
                          "TA0002 - Execution",
                          "TA0006 - Credential Access"
                      ],
                      "mitre_techniques_ids_and_names": null,
                      "alert_categories": [
                          "Malware"
                      ],
                      "original_tags": [
                          "EG:CDS-Windows",
                          "DS:PANW/XDR Agent"
                      ],
                      "tags": [
                          "EG:CDS-Windows",
                          "DS:PANW/XDR Agent"
                      ]
                  }
    result: null
  - sample: |-
      {
                      "external_id": "3f17037afd964e2183186dc511f70000",
                      "severity": "medium",
                      "matching_status": "MATCHED",
                      "end_match_attempt_ts": null,
                      "local_insert_ts": 1720078478362,
                      "last_modified_ts": null,
                      "bioc_indicator": null,
                      "matching_service_rule_id": null,
                      "attempt_counter": 0,
                      "bioc_category_enum_key": null,
                      "case_id": 4,
                      "is_whitelisted": false,
                      "starred": false,
                      "deduplicate_tokens": "ebe57f36f1e24ad880960f528b7bc966",
                      "filter_rule_id": null,
                      "mitre_technique_id_and_name": null,
                      "mitre_tactic_id_and_name": null,
                      "agent_version": "8.5.0.624",
                      "agent_ip_addresses_v6": null,
                      "agent_device_domain": "WORKGROUP",
                      "agent_fqdn": "WIN-K6RDJEH98JU.WORKGROUP",
                      "agent_os_type": "Windows",
                      "agent_os_sub_type": "10.0.17763",
                      "agent_data_collection_status": false,
                      "mac": "53:d5:bc:a2:dc:44",
                      "agent_is_vdi": false,
                      "agent_install_type": "STANDARD",
                      "agent_host_boot_time": null,
                      "event_sub_type": null,
                      "module_id": "WildFire",
                      "association_strength": 50,
                      "dst_association_strength": null,
                      "story_id": null,
                      "event_id": null,
                      "event_type": "File Event",
                      "event_timestamp": 1720078472000,
                      "actor_process_instance_id": null,
                      "actor_process_image_path": null,
                      "actor_process_image_name": null,
                      "actor_process_command_line": null,
                      "actor_process_signature_status": "N/A",
                      "actor_process_signature_vendor": null,
                      "actor_process_image_sha256": null,
                      "actor_process_image_md5": null,
                      "actor_process_causality_id": null,
                      "actor_causality_id": null,
                      "actor_process_os_pid": null,
                      "actor_thread_thread_id": null,
                      "causality_actor_process_image_name": null,
                      "causality_actor_process_command_line": null,
                      "causality_actor_process_image_path": null,
                      "causality_actor_process_signature_vendor": null,
                      "causality_actor_process_signature_status": "N/A",
                      "causality_actor_causality_id": null,
                      "causality_actor_process_execution_time": null,
                      "causality_actor_process_image_md5": null,
                      "causality_actor_process_image_sha256": null,
                      "action_file_path": "C:\\Windows\\assembly\\NativeImages_v4.0.30319_32\\Microsoft.W0bb5dac4#\\ec7c64064720dda079529bc9a162d426\\Microsoft.Windows.Diagnosis.Commands.UpdateDiagRootcause.ni.dll",
                      "action_file_name": "Microsoft.Windows.Diagnosis.Commands.UpdateDiagRootcause.ni.dll",
                      "action_file_md5": null,
                      "action_file_sha256": "ff6663c867f962270831d6ffdb1d48b53d69217a2508112cee535dbacd72f619",
                      "action_file_macro_sha256": null,
                      "action_registry_data": null,
                      "action_registry_key_name": null,
                      "action_registry_value_name": null,
                      "action_registry_full_key": null,
                      "action_local_ip": null,
                      "action_local_ip_v6": null,
                      "action_local_port": null,
                      "action_remote_ip": null,
                      "action_remote_ip_v6": null,
                      "action_remote_port": null,
                      "action_external_hostname": null,
                      "action_country": "UNKNOWN",
                      "action_process_instance_id": null,
                      "action_process_causality_id": null,
                      "action_process_image_name": null,
                      "action_process_image_sha256": null,
                      "action_process_image_command_line": null,
                      "action_process_signature_status": "N/A",
                      "action_process_signature_vendor": null,
                      "os_actor_effective_username": null,
                      "os_actor_process_instance_id": null,
                      "os_actor_process_image_path": null,
                      "os_actor_process_image_name": null,
                      "os_actor_process_command_line": null,
                      "os_actor_process_signature_status": "N/A",
                      "os_actor_process_signature_vendor": null,
                      "os_actor_process_image_sha256": null,
                      "os_actor_process_causality_id": null,
                      "os_actor_causality_id": null,
                      "os_actor_process_os_pid": null,
                      "os_actor_thread_thread_id": null,
                      "fw_app_id": null,
                      "fw_interface_from": null,
                      "fw_interface_to": null,
                      "fw_rule": null,
                      "fw_rule_id": null,
                      "fw_device_name": null,
                      "fw_serial_number": null,
                      "fw_url_domain": null,
                      "fw_email_subject": null,
                      "fw_email_sender": null,
                      "fw_email_recipient": "test@recipient.com",
                      "fw_app_subcategory": null,
                      "fw_app_category": null,
                      "fw_app_technology": null,
                      "fw_vsys": null,
                      "fw_xff": null,
                      "fw_misc": null,
                      "fw_is_phishing": "N/A",
                      "dst_agent_id": null,
                      "dst_causality_actor_process_execution_time": null,
                      "dns_query_name": null,
                      "dst_action_external_hostname": null,
                      "dst_action_country": null,
                      "dst_action_external_port": null,
                      "is_pcap": false,
                      "contains_featured_host": "NO",
                      "contains_featured_user": "NO",
                      "contains_featured_ip": "NO",
                      "image_name": null,
                      "image_id": null,
                      "container_id": null,
                      "container_name": null,
                      "namespace": null,
                      "cluster_name": null,
                      "referenced_resource": null,
                      "operation_name": null,
                      "identity_sub_type": null,
                      "identity_type": null,
                      "project": null,
                      "cloud_provider": null,
                      "resource_type": null,
                      "resource_sub_type": null,
                      "user_agent": null,
                      "alert_type": "Unclassified",
                      "resolution_status": "STATUS_010_NEW",
                      "resolution_comment": null,
                      "dynamic_fields": null,
                      "tags": "EG:CDS-Windows,DS:PANW/XDR Agent",
                      "malicious_urls": "http://test.com",
                      "alert_id": "120",
                      "detection_timestamp": 1720078472000,
                      "name": "WildFire Malware",
                      "category": "Malware",
                      "endpoint_id": "ca3df2ac46eb4450ad9917380c8bc3e0",
                      "description": "Suspicious DLL detected",
                      "host_ip": "192.0.2.1",
                      "host_name": "WIN-K6RDJEH98JU",
                      "source": "XDR Agent",
                      "action": "SCANNED",
                      "action_pretty": "Detected (Scanned)",
                      "user_name": "N/A",
                      "events_length": 1,
                      "original_tags": "DS:PANW/XDR Agent,EG:CDS-Windows"
                  }
    result: null