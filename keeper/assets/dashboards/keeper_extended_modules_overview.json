{
  "title": "Keeper - Extended Modules Overview",
  "description": "This dashboard provides an overview of Keeper events from modules beyond password management. These modules include KeeperPAM, Keeper Secrets Manager, KeeperChat, and Compliance Reporting. Event data will appear based on which modules are enabled. ",
  "widgets": [
    {
      "id": 134195612895242,
      "definition": {
        "type": "image",
        "url": "https://keeper-email-images.s3.amazonaws.com/common/keeper-no-tag.jpg",
        "url_dark_theme": "https://keeper-email-images.s3.amazonaws.com/common/keeper-header-logo-short.jpg",
        "sizing": "contain",
        "margin": "sm",
        "has_background": true,
        "has_border": false,
        "vertical_align": "center",
        "horizontal_align": "center"
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 5,
        "height": 4
      }
    },
    {
      "id": 5480221141110144,
      "definition": {
        "type": "note",
        "content": "**[Keeper](https://www.keepersecurity.com/)** is a zero-knowledge password management solution that helps organizations securely store, share, and manage credentials across users, devices, and applications.\n\nThis dashboard provides an overview of Keeper events from modules beyond password management. \n\n**Note**: These modules include **KeeperPAM**, **Keeper Secrets Manager**, **KeeperChat**, and **Compliance Reporting**. Event data will appear based on which modules are enabled.\n\nFor more information, see the [Keeper Integration Documentation](https://docs.datadoghq.com/integrations/keeper/).\n\n**Tip**:\n- Use the timeframe selector in the top right of the dashboard to change the default timeframe.\n- Clone this dashboard to rearrange, modify and add widgets and visualizations.",
        "background_color": "gray",
        "font_size": "14",
        "text_align": "left",
        "vertical_align": "center",
        "show_tick": true,
        "tick_pos": "50%",
        "tick_edge": "left",
        "has_padding": true
      },
      "layout": {
        "x": 5,
        "y": 0,
        "width": 7,
        "height": 4
      }
    },
    {
      "id": 8470355047411639,
      "definition": {
        "title": "Secret Manager Operations",
        "background_color": "vivid_yellow",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 7535630246846724,
            "definition": {
              "title": "Record Rotation Status Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(record_rotation_on_demand_fail OR record_rotation_on_demand_ok OR record_rotation_scheduled_fail OR record_rotation_scheduled_ok) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 12,
              "height": 3
            }
          },
          {
            "id": 4465291452237829,
            "definition": {
              "title": "Successful On-Demand Rotations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:record_rotation_on_demand_ok $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_green"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 1214720740780664,
            "definition": {
              "title": "Failed On-Demand Rotations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:record_rotation_on_demand_fail $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_red"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 3,
              "y": 3,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7304188163592166,
            "definition": {
              "title": "Successful Scheduled Rotations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:record_rotation_scheduled_ok $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_green"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 6,
              "y": 3,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 4048836622964740,
            "definition": {
              "title": "Failed Scheduled Rotations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:record_rotation_scheduled_fail $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_red"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 9,
              "y": 3,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 6993275699964931,
            "definition": {
              "title": "Secrets Access Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_client_access OR app_client_access_denied) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 5,
              "width": 12,
              "height": 3
            }
          },
          {
            "id": 140604160031166,
            "definition": {
              "title": "Secret Access Events",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_client_access OR app_client_access_denied OR app_client_added OR app_client_connected OR app_client_expired OR app_client_removed) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 500,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 0,
              "y": 8,
              "width": 7,
              "height": 4
            }
          },
          {
            "id": 4788497375665244,
            "definition": {
              "title": "Top Devices by Secret Access",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:app_client_access $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@device_name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@client_version",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_green"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 7,
              "y": 8,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 8468384310573409,
            "definition": {
              "title": "App Client Folder/Record Operations",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_client_folder_* OR app_client_record_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 15,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 0,
              "y": 12,
              "width": 7,
              "height": 4
            }
          },
          {
            "id": 3741296248182259,
            "definition": {
              "title": "Top Devices by Secret Access Denial",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:app_client_access_denied $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@device_name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@client_version",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_green"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 7,
              "y": 12,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 4934398769305860,
            "definition": {
              "title": "App Client Folder/Record Operations Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_client_folder_* OR app_client_record_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 16,
              "width": 12,
              "height": 3
            }
          },
          {
            "id": 7354637234819227,
            "definition": {
              "title": "User Folder/Record Actions",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_folder_* OR app_record_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 15,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 0,
              "y": 19,
              "width": 7,
              "height": 4
            }
          },
          {
            "id": 2642355195492335,
            "definition": {
              "title": "Top Devices by Folder/Record Operations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_client_folder_* OR app_client_record_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@device_name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@client_version",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_green"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 7,
              "y": 19,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 7086638701426917,
            "definition": {
              "title": "Top Users based on Folder/Record Actions",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(app_folder_* OR app_record_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@usr.email",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_green"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 23,
              "width": 6,
              "height": 4
            }
          },
          {
            "id": 8587273852883574,
            "definition": {
              "title": "Folder/Record Permission Change Details",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "event_list",
                  "query": {
                    "data_source": "logs_stream",
                    "query_string": "source:keeper @evt.name:(app_folder_share_changed OR app_record_share_changed) $enterprise_id $user_email $ip $event_category $event_name",
                    "indexes": [],
                    "storage": "hot"
                  },
                  "columns": [
                    {
                      "field": "timestamp",
                      "width": "auto"
                    },
                    {
                      "field": "@evt.name",
                      "width": "auto"
                    },
                    {
                      "field": "@enterprise_id",
                      "width": "auto"
                    },
                    {
                      "field": "@app_uid",
                      "width": "auto"
                    },
                    {
                      "field": "@secret_uid",
                      "width": "auto"
                    },
                    {
                      "field": "@usr.email",
                      "width": "auto"
                    }
                  ]
                }
              ],
              "type": "list_stream"
            },
            "layout": {
              "x": 6,
              "y": 23,
              "width": 6,
              "height": 4
            }
          },
          {
            "id": 2298340290855731,
            "definition": {
              "title": "Records with Rotation Failures",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(record_rotation_on_demand_fail OR record_rotation_scheduled_fail) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "inline"
              }
            },
            "layout": {
              "x": 0,
              "y": 27,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 299270342980691,
            "definition": {
              "title": "Record Rotation Action Details",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "event_list",
                  "query": {
                    "data_source": "logs_stream",
                    "query_string": "source:keeper @evt.name:(record_rotation_created OR record_rotation_disabled OR record_rotation_updated) $enterprise_id $user_email $ip $event_category $event_name",
                    "indexes": [],
                    "storage": "hot"
                  },
                  "columns": [
                    {
                      "field": "timestamp",
                      "width": "auto"
                    },
                    {
                      "field": "@evt.name",
                      "width": "auto"
                    },
                    {
                      "field": "@enterprise_id",
                      "width": "auto"
                    },
                    {
                      "field": "@record_uid",
                      "width": "auto"
                    },
                    {
                      "field": "@usr.email",
                      "width": "auto"
                    }
                  ]
                }
              ],
              "type": "list_stream"
            },
            "layout": {
              "x": 5,
              "y": 27,
              "width": 7,
              "height": 4
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 4,
        "width": 12,
        "height": 32
      }
    },
    {
      "id": 6140297012955837,
      "definition": {
        "title": "Privileged Access Manager Operations",
        "background_color": "vivid_yellow",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5027643543964496,
            "definition": {
              "title": "Tunnel Operations Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_tunnel_started OR pam_tunnel_stopped OR pam_tunnel_terminated) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "alias": "Operations",
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 12,
              "height": 3
            }
          },
          {
            "id": 6356439523091735,
            "definition": {
              "title": "Tunnel Terminations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:pam_tunnel_terminated $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_yellow"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 1492071343908876,
            "definition": {
              "title": "KCM Connection Terminations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:pam_kcm_connection_terminated $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_yellow"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 4,
              "y": 3,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 8641965301751324,
            "definition": {
              "title": "RBI Session Terminations",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:pam_rbi_terminated $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_yellow"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 8,
              "y": 3,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 3652060163933442,
            "definition": {
              "title": "Top Users by PAM Activity",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_* OR ssh_agent_*) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@usr.email",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_green"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 5,
              "width": 4,
              "height": 6
            }
          },
          {
            "id": 8955373832643484,
            "definition": {
              "title": "KCM Connection Events Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_kcm_connection_started OR pam_kcm_connection_stopped OR pam_kcm_connection_terminated) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 5,
              "width": 8,
              "height": 3
            }
          },
          {
            "id": 284690429296623,
            "definition": {
              "title": "RBI Session Activity Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_rbi_started OR pam_rbi_stopped OR pam_rbi_terminated) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 8,
              "width": 8,
              "height": 3
            }
          },
          {
            "id": 2766368113226973,
            "definition": {
              "title": "Top PAM Operations",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_* OR ssh_agent_approved) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "white_on_green"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 15,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "style": {
                "display": {
                  "type": "stacked",
                  "legend": "inline"
                },
                "scaling": "relative"
              }
            },
            "layout": {
              "x": 0,
              "y": 11,
              "width": 4,
              "height": 4
            }
          },
          {
            "id": 4711475600518547,
            "definition": {
              "title": "Session Recording Event Details",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "event_list",
                  "query": {
                    "data_source": "logs_stream",
                    "query_string": "source:keeper @evt.name:(pam_session_recording_started OR pam_session_recording_stopped OR pam_session_rbi_recording_started OR pam_session_rbi_recording_stopped) $enterprise_id $user_email $ip $event_category $event_name",
                    "indexes": [],
                    "storage": "hot"
                  },
                  "columns": [
                    {
                      "field": "timestamp",
                      "width": "auto"
                    },
                    {
                      "field": "@evt.name",
                      "width": "auto"
                    },
                    {
                      "field": "@enterprise_id",
                      "width": "auto"
                    },
                    {
                      "field": "@record_uid",
                      "width": "auto"
                    },
                    {
                      "field": "@usr.email",
                      "width": "auto"
                    },
                    {
                      "field": "@client_version",
                      "width": "auto"
                    },
                    {
                      "field": "@network.client.ip",
                      "width": "auto"
                    },
                    {
                      "field": "@protocol",
                      "width": "auto"
                    }
                  ]
                }
              ],
              "type": "list_stream"
            },
            "layout": {
              "x": 4,
              "y": 11,
              "width": 8,
              "height": 4
            }
          },
          {
            "id": 4041395323961381,
            "definition": {
              "title": "Gateway Actions",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_gateway_created OR pam_gateway_removed) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 10,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "inline"
              }
            },
            "layout": {
              "x": 0,
              "y": 15,
              "width": 6,
              "height": 4
            }
          },
          {
            "id": 5700848582135861,
            "definition": {
              "title": "Protocols used for Session Recordings",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_session_recording_started OR pam_session_recording_stopped) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@protocol",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 10,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "inline"
              }
            },
            "layout": {
              "x": 6,
              "y": 15,
              "width": 6,
              "height": 4
            }
          },
          {
            "id": 8348059170469339,
            "definition": {
              "title": "Top Gateways by Activity",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_gateway_created OR pam_gateway_removed OR pam_gateway_online OR pam_gateway_offline) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@device_name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 150,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_yellow"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 19,
              "width": 5,
              "height": 6
            }
          },
          {
            "id": 251885021836618,
            "definition": {
              "title": "Gateway Availability Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(pam_gateway_online OR pam_gateway_offline) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 5,
              "y": 19,
              "width": 7,
              "height": 3
            }
          },
          {
            "id": 3491542861045233,
            "definition": {
              "title": "SSH Agent Activity Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(ssh_agent_started OR ssh_agent_stopped) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 5,
              "y": 22,
              "width": 7,
              "height": 3
            }
          },
          {
            "id": 6864923652750366,
            "definition": {
              "title": "PAM Configuration Distribution",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:pam_configuration_* $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 10,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 0,
              "y": 25,
              "width": 12,
              "height": 4
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 36,
        "width": 12,
        "height": 30
      }
    },
    {
      "id": 7782884391160822,
      "definition": {
        "title": "KeeperChat Activity",
        "background_color": "vivid_yellow",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1292749618503549,
            "definition": {
              "title": "Chat Logins",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:chat_login $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "custom_bg",
                      "custom_bg_color": "#65a8e6"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 2970162870550404,
            "definition": {
              "title": "Chat Login Events Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(chat_login OR chat_login_failed) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 9,
              "height": 4
            }
          },
          {
            "id": 100248049896120,
            "definition": {
              "title": "Chat Login Failures",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:chat_login_failed $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_red"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 272574289901859,
            "definition": {
              "title": "Top Users by Chat Activity",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:chat $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@usr.email",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_yellow"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 7,
              "height": 4
            }
          },
          {
            "id": 713494243514108,
            "definition": {
              "title": "Top User Clients by Chat Activity",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:chat $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@client_version",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 15,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "style": {
                "display": {
                  "type": "stacked",
                  "legend": "automatic"
                }
              }
            },
            "layout": {
              "x": 7,
              "y": 4,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 2683159008124543,
            "definition": {
              "title": "Top Remote Addresses by Login Failures",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:chat_login_failed $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@network.client.ip",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "white_on_red"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 15,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "style": {
                "display": {
                  "type": "stacked",
                  "legend": "automatic"
                }
              }
            },
            "layout": {
              "x": 0,
              "y": 8,
              "width": 4,
              "height": 4
            }
          },
          {
            "id": 3702311008102898,
            "definition": {
              "title": "Chat Logins by Location",
              "title_size": "16",
              "title_align": "left",
              "type": "geomap",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:chat_login $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@network.client.geoip.country.iso_code",
                          "limit": 250,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 250,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "style": {
                "palette": "hostmap_blues",
                "palette_flip": false
              },
              "view": {
                "focus": "WORLD"
              }
            },
            "layout": {
              "x": 4,
              "y": 8,
              "width": 8,
              "height": 4
            }
          },
          {
            "id": 3573301233125605,
            "definition": {
              "title": "Chat Activity Distribution",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:chat -@evt.name:(chat_login OR chat_login_failed) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 10,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "inline"
              }
            },
            "layout": {
              "x": 0,
              "y": 12,
              "width": 4,
              "height": 4
            }
          },
          {
            "id": 1033949946860226,
            "definition": {
              "title": "Chat Activity Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:chat -@evt.name:(chat_login OR chat_login_failed) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          }
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 12,
              "width": 8,
              "height": 4
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 66,
        "width": 12,
        "height": 17
      }
    },
    {
      "id": 7724970467855111,
      "definition": {
        "title": "Compliance Report Activity",
        "background_color": "vivid_yellow",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 8585537407072852,
            "definition": {
              "title": "Total Compliance Report Activities",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:compliance_report $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "black_on_light_yellow"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 7662226120949990,
            "definition": {
              "title": "Compliance Report Activity Over Time",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Activity",
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:compliance_report $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "dog_classic",
                    "order_by": "values",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 9,
              "height": 3
            }
          },
          {
            "id": 3761341734406800,
            "definition": {
              "title": "Top Users by Compliance Report Actions",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:compliance_report $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@usr.email",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 225,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "conditional_formats": [
                        {
                          "comparator": ">",
                          "value": 0,
                          "palette": "black_on_light_yellow"
                        }
                      ],
                      "cell_display_mode": "number",
                      "alias": "# Count",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 5,
              "height": 4
            }
          },
          {
            "id": 6580399967168620,
            "definition": {
              "title": "Compliance Report Actions",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.category:compliance_report $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 15,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 5,
              "y": 3,
              "width": 7,
              "height": 4
            }
          },
          {
            "id": 2081484018750728,
            "definition": {
              "title": "Compliance Report Exports",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(compliance_report_exported OR unsaved_compliance_report_exported OR compliance_report_downloaded) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0,
                      "palette": "custom_bg",
                      "custom_bg_color": "#65a8e6"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "bars",
                "yaxis": {}
              }
            },
            "layout": {
              "x": 0,
              "y": 7,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 7918482009217986,
            "definition": {
              "title": "Compliance Report Export Details",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(compliance_report_exported OR unsaved_compliance_report_exported OR compliance_report_downloaded) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@usr.email",
                          "limit": 25,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@enterprise_id",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        },
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "response_format": "scalar",
                  "sort": {
                    "count": 2500,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  },
                  "formulas": [
                    {
                      "cell_display_mode": "number",
                      "alias": "Exports",
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 3,
              "y": 7,
              "width": 9,
              "height": 3
            }
          },
          {
            "id": 5572989000523173,
            "definition": {
              "title": "Compliance Report Criteria Changes",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "logs",
                      "search": {
                        "query": "source:keeper @evt.name:(saved_criteria_deleted OR saved_criteria_edited OR saved_criteria_saved) $enterprise_id $user_email $ip $event_category $event_name"
                      },
                      "indexes": [
                        "*"
                      ],
                      "group_by": [
                        {
                          "facet": "@evt.name",
                          "limit": 10,
                          "sort": {
                            "aggregation": "count",
                            "order": "desc",
                            "metric": "count"
                          },
                          "should_exclude_missing": true
                        }
                      ],
                      "compute": {
                        "aggregation": "count"
                      },
                      "storage": "hot"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  },
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "sort": {
                    "count": 10,
                    "order_by": [
                      {
                        "type": "formula",
                        "index": 0,
                        "order": "desc"
                      }
                    ]
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "table"
              }
            },
            "layout": {
              "x": 0,
              "y": 10,
              "width": 12,
              "height": 4
            }
          },
          {
            "id": 2435359071035178,
            "definition": {
              "title": "Compliance Report Activity Details",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "event_list",
                  "query": {
                    "data_source": "logs_stream",
                    "query_string": "source:keeper @evt.category:compliance_report $enterprise_id $user_email $ip $event_category $event_name",
                    "indexes": [],
                    "storage": "hot"
                  },
                  "columns": [
                    {
                      "field": "timestamp",
                      "width": "auto"
                    },
                    {
                      "field": "@evt.name",
                      "width": "auto"
                    },
                    {
                      "field": "@enterprise_id",
                      "width": "auto"
                    },
                    {
                      "field": "@usr.email",
                      "width": "auto"
                    },
                    {
                      "field": "@client_version",
                      "width": "auto"
                    },
                    {
                      "field": "@network.client.ip",
                      "width": "auto"
                    },
                    {
                      "field": "content",
                      "width": "auto"
                    }
                  ]
                }
              ],
              "type": "list_stream"
            },
            "layout": {
              "x": 0,
              "y": 14,
              "width": 12,
              "height": 4
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 83,
        "width": 12,
        "height": 19
      }
    }
  ],
  "template_variables": [
    {
      "name": "enterprise_id",
      "prefix": "@enterprise_id",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "event_category",
      "prefix": "@evt.category",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "event_name",
      "prefix": "@evt.name",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "user_email",
      "prefix": "@usr.email",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "ip",
      "prefix": "@network.client.ip",
      "available_values": [],
      "default": "*"
    }
  ],
  "layout_type": "ordered",
  "notify_list": [],
  "reflow_type": "fixed"
}
