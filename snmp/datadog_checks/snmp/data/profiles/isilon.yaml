# Example sysDescr:
# - device-name-3 263829375 Isilon OneFS v8.2.0.0"
# - device-name-5 2316163007 Isilon OneFS v8.1.2.0"
extends:
  - _base.yaml
  - _generic-ip.yaml
  - _generic-tcp.yaml
  - _generic-udp.yaml

device:
  vendor: "emc"

sysobjectid:
  - 1.3.6.1.4.1.12124.*

  # Looks like EMC Isilon devices might use the wrong sysObjectID `1.3.6.1.4.1.12325.1.1.2.1.1` (FreeBSD-FOKUS)
  # Few related discussions:
  # - https://thwack.solarwinds.com/product-forums/network-performance-monitor-npm/f/forum/66098/emc-isilon-showing-up-as-non-emc-device-after-upgrade/39511
  # - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB0761173
  # - https://github.com/librenms/librenms/issues/6412
  # Long term solution:
  # Similar to librenms a possible solution is to have other ways to match devices like sysDescr text matching. See example:
  # https://github.com/librenms/librenms/pull/6416/files#diff-ec0470a0c495f1349b349f62b0dfdf14b928a5acb94f0de5f6c5a6e523f7817cR12-R16
  - 1.3.6.1.4.1.12325.1.1.2.1.1



#.1.3.6.1.2.1.1.1.0 = STRING: EMC-DEV-NAME 4280738500 Isilon OneFS v8.0.1.1
#.1.3.6.1.2.1.1.2.0 = OID: .1.3.6.1.4.1.12325.1.1.2.1.1
#.1.3.6.1.2.1.1.3.0 = Timeticks: (59085573) 6 days, 20:07:35.73
#.1.3.6.1.2.1.1.4.0 = STRING: support@netcast.rs
#.1.3.6.1.2.1.1.5.0 = STRING: EMC-DEV-NAME
#.1.3.6.1.2.1.1.6.0 = STRING: XXXX
#.1.3.6.1.2.1.1.7.0 = INTEGER: 76
#.1.3.6.1.2.1.1.8.0 = Timeticks: (8) 0:00:00.08

metadata:
  device:
    fields:
      vendor:
        value: "emc"
      serial_number:
        symbol:
          OID: 1.3.6.1.4.1.12124.2.51.1.3.1
          name: chassisSerialNumber  # The chassis serial number.
      version:
#        symbol:
#          OID: 1.3.6.1.4.1.25461.2.1.2.1.1.0
#          name: panSysSwVersion # Full software version. The first two components of the full version are the major
#                                # and minor versions. The third component indicates the maintenance release number
#                                # and the fourth, the build number.
      product_name:
        symbol:
#          OID: 1.3.6.1.2.1.1.1.0
#          name: sysDescr
#          match_pattern: 'Palo Alto Networks\s+(PA-\d+ series firewall|WildFire Appliance|VM-Series firewall)'
#          match_value: '$1'
#          # Examples:
#          #  - Palo Alto Networks VM-Series firewall
#          #  - Palo Alto Networks PA-3200 series firewall
#          #  - Palo Alto Networks WildFire Appliance
      model:
#        symbol:
#          OID: 1.3.6.1.4.1.25461.2.1.2.2.1.0
#          name: panChassisType
#          # Examples:
#          #  - PA-3020
      os_name:
#        # "PAN‑OS® is the software that runs all Palo Alto Networks® next-generation firewalls."
#        # Source https://docs.paloaltonetworks.com/pan-os.html
#        value: 'PAN-OS'
      os_version:
#        symbol:
#          OID: 1.3.6.1.4.1.25461.2.1.2.1.1.0
#          name: panSysSwVersion # Full software version. The first two components of the full version are the major
#                                # and minor versions. The third component indicates the maintenance release number
#                                # and the fourth, the build number.



metrics:
  # fan hardware
  - MIB: ISILON-MIB
    table:
      OID: 1.3.6.1.4.1.12124.2.53
      name: fanTable
    symbols:
      - OID: 1.3.6.1.4.1.12124.2.53.1.4
        name: fanSpeed
    metric_tags:
      - tag: fan_name
        column:
          OID: 1.3.6.1.4.1.12124.2.53.1.2
          name: fanName
      - tag: fan_number
        column:
          OID: 1.3.6.1.4.1.12124.2.53.1.1
          name: fanNumber

  # cluster
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.1.1.2.0
      name: clusterHealth
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.1.2.1.1.0
      name: clusterIfsInBytes
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.1.2.1.3.0
      name: clusterIfsOutBytes

  # file system
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.1.3.2.0
      name: ifsUsedBytes
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.1.3.1.0
      name: ifsTotalBytes

  # node
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.2.1.2.0
      name: nodeHealth
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.2.2.1.1.0
      name: nodeIfsInBytes
  - MIB: ISILON-MIB
    symbol:
      OID: 1.3.6.1.4.1.12124.2.2.1.3.0
      name: nodeIfsOutBytes

  # disk
  - MIB: ISILON-MIB
    table:
      OID: 1.3.6.1.4.1.12124.2.52
      name: diskTable
    symbols:
      - OID: 1.3.6.1.4.1.12124.2.52.1.9
        name: diskSizeBytes
    metric_tags:
      - column:
          OID: 1.3.6.1.4.1.12124.2.52.1.5
          name: diskStatus
        tag: disk_status
      - column:
          OID: 1.3.6.1.4.1.12124.2.52.1.1
          name: diskBay
        tag: disk_bay


  # protocol
  - MIB: ISILON-MIB
    table:
      OID: 1.3.6.1.4.1.12124.2.2.10
      name: nodeProtocolPerfTable
    symbols:
      - OID: 1.3.6.1.4.1.12124.2.2.10.1.3
        name: protocolOpsPerSecond
      - OID: 1.3.6.1.4.1.12124.2.2.10.1.14
        name: latencyMin
      - OID: 1.3.6.1.4.1.12124.2.2.10.1.15
        name: latencyMax
      - OID: 1.3.6.1.4.1.12124.2.2.10.1.16
        name: latencyAverage
    metric_tags:
      - tag: protocol_name
        column:
          OID: 1.3.6.1.4.1.12124.2.2.10.1.1
          name: protocolName

  # quota
  - MIB: ISILON-MIB
    table:
      OID: 1.3.6.1.4.1.12124.1.12.1
      name: quotaTable
    symbols:
      - OID: 1.3.6.1.4.1.12124.1.12.1.1.7
        name: quotaHardThreshold
      - OID: 1.3.6.1.4.1.12124.1.12.1.1.9
        name: quotaSoftThreshold
      - OID: 1.3.6.1.4.1.12124.1.12.1.1.13
        name: quotaUsage
      - OID: 1.3.6.1.4.1.12124.1.12.1.1.11
        name: quotaAdvisoryThreshold
    metric_tags:
      - tag: quota_type
        column:
          OID: 1.3.6.1.4.1.12124.1.12.1.1.2
          name: quotaType
      - tag: quota_id
        column:
          OID: 1.3.6.1.4.1.12124.1.12.1.1.3
          name: quotaID
metric_tags:
  - tag: cluster_name
    OID: 1.3.6.1.4.1.12124.1.1.1.0
    symbol: clusterName
  - tag: node_name
    OID: 1.3.6.1.4.1.12124.2.1.1.0
    symbol: nodeName
  - tag: node_type
    OID: 1.3.6.1.4.1.12124.2.1.3.0
    symbol: nodeType
