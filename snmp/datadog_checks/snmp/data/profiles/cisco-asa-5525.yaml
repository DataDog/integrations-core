# Profile for Cisco ASA 5525 devices

extends:
  - _base_cisco.yaml

sysobjectid: 1.3.6.1.4.1.9.1.1408

# 5505 1.3.6.1.4.1.9.1.745
# 5555 1.3.6.1.4.1.9.1.1410

metrics:
  - MIB: CISCO-FIREWALL-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.147.1.2.2.2
      name: cfwConnectionStatTable
    symbols:
      - OID: 1.3.6.1.4.1.9.9.147.1.2.2.2.1.5
        name: cfwConnectionStatValue
    metric_tags:
      - column:
          OID: 1.3.6.1.4.1.9.9.147.1.2.2.2.1.2
          name: cfwConnectionStatType
        tag: stat_type
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    symbol:
      # declined sessions
      OID: 1.3.6.1.4.1.9.9.392.1.4.1.2
      name: crasNumDeclinedSessions
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    symbol:
      # num sessions
      OID: 1.3.6.1.4.1.9.9.392.1.3.1
      name: crasNumSessions
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    symbol:
      # num users
      OID: 1.3.6.1.4.1.9.9.392.1.3.3
      name: crasNumUsers
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    forced_type: monotonic_count
    symbol:
      # session setup failed
      OID: 1.3.6.1.4.1.9.9.392.1.4.1.3
      name: crasNumSetupFailInsufResources
  - MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
    symbol:
      OID: 1.3.6.1.4.1.9.9.171.1.3.1.1
      name: cipSecGlobalActiveTunnels
  - MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
    forced_type: monotonic_count
    symbol:
      OID: 1.3.6.1.4.1.9.9.171.1.3.1.4
      name: cipSecGlobalHcInOctets
  - MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
    forced_type: monotonic_count
    symbol:
      OID: 1.3.6.1.4.1.9.9.171.1.3.1.17
      name: cipSecGlobalHcOutOctets
  - MIB: ENTITY-SENSOR-MIB
    table:
      OID: 1.3.6.1.2.1.99.1.1
      name: entPhySensorTable
    symbols:
      - OID: 1.3.6.1.2.1.99.1.1.1.4
        name: entPhySensorValue
    metric_tags:
      - column:
          OID: 1.3.6.1.2.1.99.1.1.1.1
          name: entPhySensorType
        tag: sensor_type
      - index: 1
        tag: sensor_id

    # SVC Sessions
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    symbol:
      OID: 1.3.6.1.4.1.9.9.392.1.3.35
      name: crasSVCNumSessions

    # ASA VPN Tunnel stats
  - MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.171.1.2.3
      name: cikeTunnelTable
    symbols:
      - OID: 1.3.6.1.4.1.9.9.171.1.2.3.1.16
        name: cikeTunActiveTime
      - OID: 1.3.6.1.4.1.9.9.171.1.2.3.1.19
        name: cikeTunInOctets
      - OID: 1.3.6.1.4.1.9.9.171.1.2.3.1.27
        name: cikeTunOutOctets
    metric_tags:
      - tag: vpn_tunnel_hexip
        OID: 1.3.6.1.4.1.9.9.171.1.2.3.1.8
        column: cikeTunRemoteAddr
        table: cikeTunnelTable
        MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
      - tag: vpn_tunnel_ip
        OID: 1.3.6.1.4.1.9.9.171.1.2.3.1.7
        column: cikeTunRemoteValue
        table: cikeTunnelTable
        MIB: CISCO-IPSEC-FLOW-MONITOR-MIB

  - MIB: CISCO-IPSEC-FLOW-MONITOR-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.171.1.3.2
      name: cipSecTunnelTable
    symbols:
      - OID: 1.3.6.1.4.1.9.9.171.1.3.2.1.2
        name: cipSecTunIkeTunnelIndex
      - OID: 1.3.6.1.4.1.9.9.171.1.3.2.1.3
        name: cipSecTunIkeTunnelAlive
      - OID: 1.3.6.1.4.1.9.9.171.1.3.2.1.26
        name: cipSecTunInOctets
      - OID: 1.3.6.1.4.1.9.9.171.1.3.2.1.39
        name: cipSecTunOutOctets
    metric_tags:
      - tag: vpn_tunnel_hexip
        OID: 1.3.6.1.4.1.9.9.171.1.3.2.1.5
        column: cipSecTunRemoteAddr
        table: cipSecTunnelTable
        MIB: CISCO-IPSEC-FLOW-MONITOR-MIB

  # Cluster status
  - MIB: CISCO-FIREWALL-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.147.1.2.1.1
      name: cfwHardwareStatusTable
    symbol:
      OID: 1.3.6.1.4.1.9.9.147.1.2.1.1.1.3
      name: cfwHardwareStatusValue
    metric_tags:
      - tag: cfwHardwareInformation
        OID: 1.3.6.1.4.1.9.9.147.1.2.1.1.1.2
        column: cfwHardwareInformation
        table: cfwHardwareStatusTable
        MIB: CISCO-FIREWALL-MIB

  # Connection stats
  - MIB: CISCO-FIREWALL-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.147.1.2.2.2
      name: cfwConnectionStatTable
    symbols:
      - OID: 1.3.6.1.4.1.9.9.147.1.2.2.2.1.5
        name: cfwConnectionStatValue
      - OID: 1.3.6.1.4.1.9.9.147.1.2.2.2.1.4
        name: cfwConnectionStatCount
    metric_tags:
      - tag: cfwConnectionStatDescription
        OID: 1.3.6.1.4.1.9.9.147.1.2.2.2.1.3
        column: cfwConnectionStatDescription
        table: cfwConnectionStatTable
        MIB: CISCO-FIREWALL-MIB