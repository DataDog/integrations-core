extends:
  - _base.yaml
  - _generic-if.yaml
metadata:
  device:
    fields:
      vendor:
        value: "mikrotik"
sysobjectid:
  - 1.3.6.1.4.1.14988.1.*
metrics:
  - MIB: MIKROTIK-MIB
    table:
      OID: 1.3.6.1.4.1.14988.1.1.19.1
      name: mtxrOpticalTable
    symbols:
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.6
        name: mtxrOpticalTemperature
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.10
        name: mtxrOpticalRxPower
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.7
        name: mtxrOpticalSupplyVoltage
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.8
        name: mtxrOpticalTxBiasCurrent
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.5
        name: mtxrOpticalWavelength
      - OID: 1.3.6.1.4.1.14988.1.1.19.1.1.9
        name: mtxrOpticalTxPower
    metric_tags:
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.19.1.1.1
          name: mtxrOpticalIndex
        tag: mtxr_optical_index
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.19.1.1.2
          name: mtxrOpticalName
        tag: mtxr_optical_name
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.19.1.1.4
          name: mtxrOpticalTxFault
        tag: mtxr_optical_tx_fault
        mapping:
          0: 'false'
          1: 'true'
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.19.1.1.3
          name: mtxrOpticalRxLoss
        tag: mtxr_optical_rx_loss
        mapping:
          0: 'false'
          1: 'true'
  - MIB: MIKROTIK-MIB
    symbol:
      OID: 1.3.6.1.4.1.14988.1.1.3.6
      name: mtxrHlCpuTemperature
  - MIB: MIKROTIK-MIB
    symbol:
      OID: 1.3.6.1.4.1.14988.1.1.3.10
      name: mtxrHlTemperature
  - MIB: MIKROTIK-MIB
    symbol:
      OID: 1.3.6.1.4.1.14988.1.1.3.8
      name: mtxrHlVoltage
  - MIB: MIKROTIK-MIB
    table:
      OID: 1.3.6.1.4.1.14988.1.1.15.1
      name: mtxrPOETable
    symbols:
      - OID: 1.3.6.1.4.1.14988.1.1.15.1.1.6
        name: mtxrPOEPower
      - OID: 1.3.6.1.4.1.14988.1.1.15.1.1.4
        name: mtxrPOEVoltage
      - OID: 1.3.6.1.4.1.14988.1.1.15.1.1.5
        name: mtxrPOECurrent
    metric_tags:
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.15.1.1.1
          name: mtxrPOEInterfaceIndex
        tag: mtxr_poe_interface_index
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.15.1.1.2
          name: mtxrPOEName
        tag: mtxr_poe_name
      - column:
          OID: 1.3.6.1.4.1.14988.1.1.15.1.1.3
          name: mtxrPOEStatus
        tag: mtxr_poe_status
        mapping:
          1: disabled
          2: waiting_for_load
          3: powered_on
          4: overload
  - MIB: HOST-RESOURCES-MIB
    symbol:
      OID: 1.3.6.1.2.1.25.3.3.1.2.1
      name: cpu.usage
      TODO_OID_NOT_FOUND: |
        OID 1.3.6.1.2.1.25.3.3.1.2.1 not found
        Hints:
        1. Check if the MIB compiles correctly (check output above).
        2. Check if the MIB is up to date.
        3. Check if OID is correct.
        Note:
        1. Manual handling is needed in cases where the OID contains index part and the name of the metric is based
            on the specific meaning of this index.
            In the example below, the `.7` is the index and means hrCachedMemory:
            https://github.com/DataDog/integrations-core/blame/master/snmp/datadog_checks/snmp/data/default_profiles/dell-emc-data-domain.yaml#L60
  - MIB: HOST-RESOURCES-MIB
    table:
      OID: 1.3.6.1.2.1.25.2.3
      name: hrStorageTable
    symbols:
      - OID: 1.3.6.1.2.1.25.2.3.1.5
        name: memory.total
      - OID: 1.3.6.1.2.1.25.2.3.1.6
        name: memory.used
    metric_tags:
      - tag: mem
        index: 1
