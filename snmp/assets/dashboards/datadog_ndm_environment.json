{
    "author_name": "Datadog",
    "description": null,
    "layout_type": "ordered",
    "template_variables": [
        {
            "available_values": [],
            "default": "*",
            "name": "Agent_Hostname",
            "prefix": "host"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "SNMP_Device",
            "prefix": "snmp_device"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "Netflow_Exporter",
            "prefix": "exporter_ip"
        },
        {
            "available_values": [],
            "default": "*",
            "name": "Custom_Tag"
        }
    ],
    "title": "Datadog NDM Environment",
    "widgets": [
        {
            "definition": {
                "background_color": "white",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Datadog NDM Environment",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "transparent",
                            "content": "This dashboard provides a high-level overview to help you monitor and troubleshoot the health of your Network Device Monitoring environment. You can track health and performance of your running agents, as well as SNMP, Traps, and NetFlow Monitoring integrations.\n\n**Further reading on NDM**\n\n- Our blog post on [Monitoring Datacenters and network devices with Datadog](https://www.datadoghq.com/blog/datacenter-monitoring-dashboards/)\n- Our blog post on [Monitoring network devices with SNMP](https://www.datadoghq.com/blog/monitor-snmp-with-datadog/)\n- Network Device Monitoring [docs](https://docs.datadoghq.com/network_performance_monitoring/devices) ",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": false,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 3628964508547190,
                        "layout": {
                            "height": 4,
                            "width": 6,
                            "x": 0,
                            "y": 0
                        }
                    }
                ]
            },
            "id": 2663583616845740,
            "layout": {
                "height": 5,
                "width": 6,
                "x": 0,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "pink",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Overview",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{agent_host:$Agent_Hostname.value}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Devices monitored",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 5448907116074094,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "sum",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.snmp.submitted_metrics{agent_host:$Agent_Hostname.value}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Submitted metrics",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 3962787759927314,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 3,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:snmp-traps"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Traps indexed",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 6115005518968934,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "network_device_flows",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query3",
                                            "search": {
                                                "query": "@exporter.ip:$Netflow_Exporter.value"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Flows indexed",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 3547436194124732,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 3,
                            "y": 2
                        }
                    }
                ]
            },
            "id": 4997228044177920,
            "layout": {
                "height": 5,
                "width": 6,
                "x": 6,
                "y": 0
            }
        },
        {
            "definition": {
                "background_color": "blue",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Agents",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "has_search_bar": "auto",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "CPU",
                                            "cell_display_mode": "bar",
                                            "formula": "query1",
                                            "limit": {
                                                "count": 500,
                                                "order": "desc"
                                            }
                                        },
                                        {
                                            "alias": "MEMORY",
                                            "cell_display_mode": "bar",
                                            "formula": "(query2 / query3) * 100",
                                            "number_format": {
                                                "unit": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "percent"
                                                }
                                            }
                                        },
                                        {
                                            "alias": "DISK",
                                            "cell_display_mode": "bar",
                                            "formula": "(query4 / query5) * 100",
                                            "number_format": {
                                                "unit": {
                                                    "type": "canonical_unit",
                                                    "unit_name": "percent"
                                                }
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:system.cpu.user{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:system.mem.used{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "avg:system.mem.total{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query4",
                                            "query": "avg:system.disk.used{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query5",
                                            "query": "avg:system.disk.total{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Running Agents",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 7022637295997678,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [
                                {
                                    "display_type": "error dashed",
                                    "value": "y = 100"
                                }
                            ],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "CPU",
                                            "formula": "top(query1, 50, 'mean', 'desc')"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:system.cpu.user{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "CPU",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3003257047015150,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Used",
                                            "formula": "top(query1, 50, 'mean', 'desc')"
                                        },
                                        {
                                            "alias": "Total",
                                            "formula": "top(query2, 50, 'mean', 'desc')"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:system.mem.used{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:system.mem.total{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Memory",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3478725624423596,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.agent.running{$Agent_Hostname,$Custom_Tag} by {version}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Running versions",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3765410346567274,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.agent.started{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Agent Restarts",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 5753872191409390,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 2
                        }
                    }
                ]
            },
            "id": 7775029902313268,
            "layout": {
                "height": 5,
                "width": 12,
                "x": 0,
                "y": 5
            }
        },
        {
            "definition": {
                "background_color": "green",
                "layout_type": "ordered",
                "show_title": true,
                "title": "SNMP",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "palette": "black_on_light_green",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.device.reachable{agent_host:$Agent_Hostname.value,$Custom_Tag}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Devices reachable",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 1777355458473480,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are my devices unreachable?**\n\nAn unreachable device means that the agent cannot collect metrics from it.\nReachability is determined by performing a GETNEXT on the OID '1.0'. \n-  Try loosening ACLs/firewall rules for your devices. To check connectivity from the Agent host to a network device, use the integrated `agent snmp walk` command.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "75%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 7875957059726684,
                        "layout": {
                            "height": 4,
                            "width": 3,
                            "x": 3,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "is_hidden": true,
                                    "override_label": "traces"
                                },
                                {
                                    "is_hidden": true,
                                    "override_label": "profiles"
                                },
                                {
                                    "label": "Device performance",
                                    "link": "/dash/integration/Datacenter%20Overview?tpl_var_snmp_device[0]={{snmp_device}}&tpl_var_snmp_host[0]={{snmp_host}}&live=true&from_ts={{timestamp_start}}&to_ts={{timestamp_end}}"
                                }
                            ],
                            "has_search_bar": "auto",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Status",
                                            "cell_display_mode": "bar",
                                            "conditional_formats": [
                                                {
                                                    "comparator": ">",
                                                    "palette": "black_on_light_green",
                                                    "value": 0
                                                },
                                                {
                                                    "comparator": "<",
                                                    "palette": "black_on_light_red",
                                                    "value": 1
                                                }
                                            ],
                                            "formula": "exclude_null(query1)",
                                            "limit": {
                                                "count": 500,
                                                "order": "asc"
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:snmp.device.reachable{agent_host:$Agent_Hostname.value,snmp_device:$SNMP_Device.value,$Custom_Tag} by {snmp_host,snmp_device,snmp_profile}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Device status",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 5449853565034480,
                        "layout": {
                            "height": 8,
                            "width": 6,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "palette": "red_on_white",
                                            "value": 1
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.device.unreachable{agent_host:$Agent_Hostname.value,$Custom_Tag}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Devices unreachable",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 780110642340810,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Are you using the Python integration ?**\n\nNetwork Device Monitoring requires the SNMP core check, which is substantially faster and includes the latest features.\n\n To migrate from the Python integration to the core check, see [Migrating to the SNMP Core Check](https://docs.datadoghq.com/network_monitoring/devices/guide/migrating-to-snmp-core-check).",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "right",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 792699600428684,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">=",
                                            "palette": "black_on_light_yellow",
                                            "value": 1
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "default_zero(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{loader:python,agent_host:$Agent_Hostname.value,$Custom_Tag}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Devices monitored using the Python integration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 7163614881507442,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 3,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 0,
                            "requests": [
                                {
                                    "conditional_formats": [
                                        {
                                            "comparator": ">",
                                            "palette": "black_on_light_yellow",
                                            "value": 0
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "last",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{snmp_profile IN (generic-router,generic-device) AND agent_host:$Agent_Hostname.value AND $Custom_Tag}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Devices monitored using generic profile",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 6148374944546170,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 0,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are my devices matched to the generic device profile?**\n\nSome devices may not be supported out-of-the-box and default to the generic device profile, which may cause some missing metrics.\n\n To create a custom SNMP profile for your network devices, see [Build a NDM Profile](https://docs.datadoghq.com/network_monitoring/devices/guide/build-ndm-profile/).",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 8897893996896618,
                        "layout": {
                            "height": 2,
                            "width": 3,
                            "x": 3,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "is_hidden": true,
                                    "override_label": "traces"
                                },
                                {
                                    "is_hidden": true,
                                    "override_label": "profiles"
                                },
                                {
                                    "label": "Device performance",
                                    "link": "/dash/integration/Datacenter%20Overview?tpl_var_snmp_device[0]={{snmp_device}}&tpl_var_snmp_host[0]={{snmp_host}}&live=true&from_ts={{timestamp_start}}&to_ts={{timestamp_end}}"
                                }
                            ],
                            "has_search_bar": "auto",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Check duration",
                                            "cell_display_mode": "bar",
                                            "conditional_formats": [
                                                {
                                                    "comparator": "<",
                                                    "palette": "green_on_white",
                                                    "value": 1
                                                },
                                                {
                                                    "comparator": ">=",
                                                    "palette": "yellow_on_white",
                                                    "value": 1
                                                },
                                                {
                                                    "comparator": ">=",
                                                    "palette": "red_on_white",
                                                    "value": 5
                                                }
                                            ],
                                            "formula": "query1",
                                            "limit": {
                                                "count": 500,
                                                "order": "desc"
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.snmp.check_duration{agent_host:$Agent_Hostname.value,snmp_device:$SNMP_Device.value,$Custom_Tag} by {snmp_host,snmp_device,snmp_profile}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Check duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 735654265082152,
                        "layout": {
                            "height": 8,
                            "width": 6,
                            "x": 0,
                            "y": 8
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Abnormal check duration/interval?**\n\n- Try increasing the number of check runners (`check_runners:`) in your `datadog.yaml` configuration.\n- Try also increasing the `oid_batch_size` in your SNMP configuration. **Note:** A high value can lead to timeouts on some network devices.\n- If neither suggestions work, you may need to split the monitoring of your devices across several agents.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 7849039364315490,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 8
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.snmp.check_duration{$Custom_Tag,agent_host:$Agent_Hostname.value} by {snmp_host}"
                                        }
                                    ],
                                    "response_format": "scalar",
                                    "style": {
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Check duration",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "distribution",
                            "xaxis": {
                                "include_zero": true,
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            },
                            "yaxis": {
                                "include_zero": true,
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 4206875433855820,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 10
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "is_hidden": true,
                                    "override_label": "traces"
                                },
                                {
                                    "is_hidden": true,
                                    "override_label": "profiles"
                                },
                                {
                                    "label": "Device performance",
                                    "link": "/dash/integration/Datacenter%20Overview?tpl_var_snmp_device[0]={{snmp_device}}&tpl_var_snmp_host[0]={{snmp_host}}&live=true&from_ts={{timestamp_start}}&to_ts={{timestamp_end}}"
                                }
                            ],
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Check duration",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Average check duration",
                                            "formula": "query2",
                                            "style": {
                                                "palette": "warm",
                                                "palette_index": 5
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.snmp.check_duration{agent_host:$Agent_Hostname.value,snmp_device:$SNMP_Device.value,$Custom_Tag} by {snmp_device,snmp_host}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:datadog.snmp.check_duration{agent_host:$Agent_Hostname.value,$Custom_Tag}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Check duration by device",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 6160580379144472,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 12
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Interval",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "Mean",
                                            "formula": "query1",
                                            "style": {
                                                "palette": "red"
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:datadog.snmp.check_interval{agent_host:$Agent_Hostname.value,snmp_device:$SNMP_Device.value,$Custom_Tag} by {agent_host,snmp_device}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.snmp.check_interval{agent_host:$Agent_Hostname.value,$Custom_Tag} by {agent_host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Check interval by device",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 5001526233424088,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 14
                        }
                    },
                    {
                        "definition": {
                            "custom_links": [
                                {
                                    "is_hidden": true,
                                    "override_label": "traces"
                                },
                                {
                                    "is_hidden": true,
                                    "override_label": "profiles"
                                },
                                {
                                    "label": "Device performance",
                                    "link": "/dash/integration/Datacenter%20Overview?tpl_var_snmp_device[0]={{snmp_device}}&tpl_var_snmp_host[0]={{snmp_host}}&from_ts={{timestamp_start}}&to_ts={{timestamp_end}}"
                                }
                            ],
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.snmp.submitted_metrics{agent_host:$Agent_Hostname.value,snmp_device:$SNMP_Device.value,$Custom_Tag} by {snmp_device,snmp_host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Submitted metrics by device",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 5801694486858972,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 0,
                            "y": 16
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are no metrics being collected?**\n\n- Try loosening ACLs/firewall rules for your devices. You can check connectivity from the Agent host to a network device by using the integrated `agent snmp walk` command.\n- Check connectivity between the Agent host and Datadog.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 4718119505230002,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 16
                        }
                    },
                    {
                        "definition": {
                            "autoscale": true,
                            "precision": 2,
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "formula": "count_not_null(query1)"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{agent_host:$Agent_Hostname.value,autodiscovery_subnet:*,$Custom_Tag} by {autodiscovery_subnet}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "timeseries_background": {
                                "type": "area",
                                "yaxis": {
                                    "include_zero": false
                                }
                            },
                            "title": "Autodiscovery subnets",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_value"
                        },
                        "id": 5659283089795536,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 18
                        }
                    },
                    {
                        "definition": {
                            "has_search_bar": "auto",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Devices",
                                            "cell_display_mode": "bar",
                                            "conditional_formats": [],
                                            "formula": "query1",
                                            "limit": {
                                                "count": 500,
                                                "order": "desc"
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{autodiscovery_subnet:*,$Custom_Tag} by {autodiscovery_subnet}"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Autodiscovery subnets",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 8213948129173374,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 4,
                            "y": 18
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "You can find more information on how to setup network devices Autodiscovery using the Datadog Agent. \n\n See [Collect SNMP Metrics From Your Network Devices](https://docs.datadoghq.com/network_monitoring/devices/snmp_metrics/?tab=snmpv2#autodiscovery).",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 7889780943665434,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 8,
                            "y": 18
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:snmp.devices_monitored{agent_host:$Agent_Hostname.value,autodiscovery_subnet:*,$Custom_Tag} by {autodiscovery_subnet}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Devices autodiscovered",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 3939913409583366,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 20
                        }
                    }
                ]
            },
            "id": 1819147315966742,
            "layout": {
                "height": 23,
                "width": 12,
                "x": 0,
                "y": 10
            }
        },
        {
            "definition": {
                "background_color": "orange",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Traps",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "markers": [],
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Traps stored",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Traps received",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "Traps forwarded",
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "logs",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query1",
                                            "search": {
                                                "query": "source:snmp-traps snmp_device:$SNMP_Device.value"
                                            }
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.snmp_traps.received{$SNMP_Device, $Agent_Hostname, $Custom_Tag}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "sum:datadog.snmp_traps.forwarded{$SNMP_Device, $Agent_Hostname, $Custom_Tag}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Traps received, forwarded and stored in Datadog",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": true,
                                "label": "",
                                "max": "auto",
                                "min": "auto",
                                "scale": "linear"
                            }
                        },
                        "id": 2416305919884594,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are traps not being received?**\n\n- Check your device configuration and ensure it is sending traps to the right port.\n- Check the Traps server listening port and ensure it is using an unprivileged port (> 1024). Or, allow the Datadog Agent to listen on privileged ports.\n\nTraps telemetry metrics requires Agent 7.47+",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 6823560756326244,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.snmp_traps.invalid_packet{$SNMP_Device, $Agent_Hostname, $Custom_Tag} by {snmp_device,reason}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Invalid packets",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 4099907010209564,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.snmp_traps.incorrect_format{$SNMP_Device, $Agent_Hostname, $Custom_Tag} by {error}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "time": {},
                            "title": "Traps incorrectly formatted",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6797913275200746,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Traps not enriched",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Variables not enriched",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.snmp_traps.traps_not_enriched{$SNMP_Device, $Agent_Hostname, $Custom_Tag}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.snmp_traps.vars_not_enriched{$SNMP_Device, $Agent_Hostname, $Custom_Tag}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "time": {},
                            "title": "Traps and variables not enriched",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6242616545438898,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 2
                        }
                    }
                ]
            },
            "id": 5474701659400592,
            "layout": {
                "height": 5,
                "is_column_break": true,
                "width": 12,
                "x": 0,
                "y": 33
            }
        },
        {
            "definition": {
                "background_color": "purple",
                "layout_type": "ordered",
                "show_title": true,
                "title": "Netflow",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Raw flows received by agent",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Flows sent by agent to backend",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "Flows stored in backend",
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.flows_received{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.netflow.aggregator.flows_flushed{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        },
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "network_device_flows",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query3",
                                            "search": {
                                                "query": ""
                                            }
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Netflow records received, flushed, and stored in Datadog",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 2668407055310816,
                        "layout": {
                            "height": 2,
                            "width": 7,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why is there a difference between the number of received Netflow records and Netflow records sent to Datadog?**\n\nNetflow records are aggregated Agent side, with a default flush time of 5 minutes. It means that if two records with the same source, destination, and protocol are collected within 5 minutes, they appear as one in the UI. \n",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 2155094662673870,
                        "layout": {
                            "height": 2,
                            "width": 5,
                            "x": 7,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "Flows",
                                            "formula": "query1",
                                            "limit": {
                                                "count": 500,
                                                "order": "desc"
                                            }
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "aggregator": "avg",
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.sequence.last{environment:mimic,$Netflow_Exporter} by {exporter_ip,flow_type}.fill(null)"
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "title": "Exporters",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "query_table"
                        },
                        "id": 7915767577147442,
                        "layout": {
                            "height": 4,
                            "width": 4,
                            "x": 0,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query3",
                                            "query": "sum:datadog.netflow.traffic.packets{$Agent_Hostname,$Netflow_Exporter,$Custom_Tag} by {listener_port,exporter_ip}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "NetFlow packets per Exporter IP",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1581438962270510,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "alias": "Gap",
                                            "formula": "query2 - query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.netflow.aggregator.flows_flushed{$Agent_Hostname}.as_count()"
                                        },
                                        {
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "data_source": "network_device_flows",
                                            "group_by": [],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query3",
                                            "search": {
                                                "query": ""
                                            }
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "purple"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Gap in Flows (Agent Flushed - Stored in Datadog)",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 5931787176867662,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 2
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query3"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "compute": {
                                                "aggregation": "count",
                                                "interval": 30000
                                            },
                                            "data_source": "network_device_flows",
                                            "group_by": [
                                                {
                                                    "facet": "@exporter.ip",
                                                    "limit": 10,
                                                    "sort": {
                                                        "aggregation": "count",
                                                        "order": "desc"
                                                    }
                                                }
                                            ],
                                            "indexes": [
                                                "*"
                                            ],
                                            "name": "query3",
                                            "search": {
                                                "query": "@exporter.ip:$Netflow_Exporter.value"
                                            }
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "NetFlow records indexed by Exporter IP",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 94895140851006,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.netflow.aggregator.flows_flushed{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Flows flushed",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 2983214365183878,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 4
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.netflow.aggregator.flows_contexts{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Flow contexts",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 5636371141448454,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Duration",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Interval",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.netflow.aggregator.flush_duration{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:datadog.netflow.aggregator.flush_interval{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Flush duration and interval",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 562795752102848,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Decoded",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Processed",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.decoder.messages{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.netflow.processor.processed{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Flows decoded vs  processed",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 439388606056846,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 6
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**What is NetFlow port rollup?**\n\nNetFlow records with a source or destination port that is detected as ephemeral are aggregated together. To detect these ephemeral ports, Datadog keeps a record of every source/destination port combination seen in the last 5 minutes. If a specific source port is associated with more than 10 different destination ports during that time, the destination port is marked as ephemeral and all NetFlow records with this source port will be aggregated.\n\n  ",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "right",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 8998029467490578,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 0,
                            "y": 8
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Current store size",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "New store size",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.netflow.aggregator.port_rollup.current_store_size{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:datadog.netflow.aggregator.port_rollup.new_store_size{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Port rollup",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3862271101257530,
                        "layout": {
                            "height": 3,
                            "width": 8,
                            "x": 4,
                            "y": 8
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.traffic.bytes{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Bytes received",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3338699430806034,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 11
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.traffic.packets{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Packets received",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 3045968110036954,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 11
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are packets not being received?**\n\n- Check your NetFlow exporter configuration and ensure it is sending flows to the right port.\n- Check the NetFlow server listening port and ensure that it is using an unprivileged port (> 1024). Or, allow the Datadog Agent to listen on privileged ports.\n",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 1108502935304848,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 11
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**Why are there bursts in buffer length?**\n\nIf the buffer length is close to the buffer capacity, you can increase the buffer capacity by updating `aggregator_buffer_size` in your `datadog.yaml` configuration.\n",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "right",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 4111141821837056,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 13
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "line",
                                    "formulas": [
                                        {
                                            "alias": "Length",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "Capacity",
                                            "formula": "query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "avg:datadog.netflow.aggregator.input_buffer.length{$Agent_Hostname,$Custom_Tag} by {host}"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "avg:datadog.netflow.aggregator.input_buffer.capacity{$Agent_Hostname,$Custom_Tag} by {host}"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Input buffer length and capacity",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries",
                            "yaxis": {
                                "include_zero": false
                            }
                        },
                        "id": 7376343243995186,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 13
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.hash_collisions{$Agent_Hostname,$Custom_Tag} by {host}.as_count()"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "purple"
                                    }
                                }
                            ],
                            "show_legend": true,
                            "title": "Hash collisions",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 6036396658807928,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 8,
                            "y": 13
                        }
                    }
                ]
            },
            "id": 2504847901545020,
            "layout": {
                "height": 16,
                "width": 12,
                "x": 0,
                "y": 38
            }
        },
        {
            "definition": {
                "background_color": "yellow",
                "layout_type": "ordered",
                "show_title": true,
                "title": "NetfFlow Packet Drop",
                "type": "group",
                "widgets": [
                    {
                        "definition": {
                            "background_color": "gray",
                            "content": "The following widget is only valid for **NetFlow5/SFlow**.\n",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "center",
                            "tick_edge": "bottom",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 6709450430375580,
                        "layout": {
                            "height": 1,
                            "width": 4,
                            "x": 0,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "gray",
                            "content": "The following widget is only valid for **NetFlow9/IPFIX**.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "center",
                            "tick_edge": "bottom",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "center"
                        },
                        "id": 2209019171340808,
                        "layout": {
                            "height": 1,
                            "width": 4,
                            "x": 4,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "background_color": "white",
                            "content": "**How can I detect missing NetFlow records?**\n\nNetFlow missing packet detection helps you identify potential issues in your network. It is an estimation of the number of packet (or flows, depending on NetFlow version) that are lost.\n\nThis metric can appear noisy depending on time aggregation, but a significant increase indicates that some NetFlow packets are lost between the exporter and the Datadog Agent.",
                            "font_size": "14",
                            "has_padding": true,
                            "show_tick": true,
                            "text_align": "left",
                            "tick_edge": "left",
                            "tick_pos": "50%",
                            "type": "note",
                            "vertical_align": "top"
                        },
                        "id": 1389581184770506,
                        "layout": {
                            "height": 3,
                            "width": 4,
                            "x": 8,
                            "y": 0
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1 - query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.sequence.delta{environment:mimic,$Netflow_Exporter} by {exporter_ip}.as_count().fill(null)"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.netflow.processor.flowsets{environment:mimic,$Netflow_Exporter} by {exporter_ip}.as_count().fill(null)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "NetFlow5 Missing Flows",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1379019082310528,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 0,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1 - query2"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.sequence.delta{environment:mimic,$Netflow_Exporter} by {exporter_ip}.as_count().fill(null)"
                                        },
                                        {
                                            "data_source": "metrics",
                                            "name": "query2",
                                            "query": "sum:datadog.netflow.processor.processed{environment:mimic,$Netflow_Exporter} by {exporter_ip}.as_count().fill(null)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "NetFlow9/IPFIX Missing Packets",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1165672826764582,
                        "layout": {
                            "height": 2,
                            "width": 4,
                            "x": 4,
                            "y": 1
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.sequence.delta{environment:mimic,$Netflow_Exporter} by {exporter_ip,flow_type}.as_count().fill(null)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Sequence Delta",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 1630157338757350,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 0,
                            "y": 3
                        }
                    },
                    {
                        "definition": {
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "legend_layout": "auto",
                            "requests": [
                                {
                                    "display_type": "bars",
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "metrics",
                                            "name": "query1",
                                            "query": "sum:datadog.netflow.aggregator.sequence.reset{environment:mimic,$Netflow_Exporter} by {exporter_ip,flow_type}.fill(null)"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "line_type": "solid",
                                        "line_width": "normal",
                                        "palette": "dog_classic"
                                    }
                                }
                            ],
                            "show_legend": false,
                            "title": "Sequence Reset",
                            "title_align": "left",
                            "title_size": "16",
                            "type": "timeseries"
                        },
                        "id": 87836312062350,
                        "layout": {
                            "height": 2,
                            "width": 6,
                            "x": 6,
                            "y": 3
                        }
                    }
                ]
            },
            "id": 7355716067222530,
            "layout": {
                "height": 6,
                "width": 12,
                "x": 0,
                "y": 54
            }
        }
    ]
}