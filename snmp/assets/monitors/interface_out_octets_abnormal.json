{
	"version": 2,
	"created_at": "2023-12-27",
	"last_updated_at": "2023-12-27",
	"title": "Outgoing traffic for {{snmp_device.name}} on interface {{interface.name}}  in {{device_namespace.name}} is outside of normal range",
	"description": "Detect abnormalities for outgoing traffic on the network interface",
	"definition": {
		"name": "[SNMP] Outgoing traffic for {{snmp_device.name}} on interface {{interface.name}}  in {{device_namespace.name}} is outside of normal range",
		"type": "query alert",
		"query": "avg(last_15m):anomalies(sum:snmp.ifHCOutOctets{*} by {device_namespace,snmp_device,interface,interface_alias}.as_count(), 'agile', 2, direction='both', interval=60, alert_window='last_15m', count_default_zero='true', seasonality='weekly') >= 1",
		"message": "{{#is_alert}} \n{{snmp_device.name}} in namespace {{device_namespace.name}} is reporting outside of normal range of octets sent on interface {{interface_alias.name}}\n{{/is_alert}} \n\n{{#is_recovery}} \nDevice {{snmp_device.name}} in namespace {{device_namespace.name}} has interface {{interface_alias.name}} outgoing traffic in normal range.\n{{/is_recovery}}",
		"tags": [
            "integration:snmp"
        ],
		"options": {
			"thresholds": {
				"critical": 1,
				"critical_recovery": 0
			},
			"notify_audit": false,
			"require_full_window": false,
			"notify_no_data": true,
			"no_data_timeframe": 15,
			"renotify_interval": 0,
			"threshold_windows": {
				"trigger_window": "last_15m",
				"recovery_window": "last_15m"
			},
			"include_tags": true,
			"new_group_delay": 60
		}
	},
	"tags": [
        "integration:snmp"
	]
}