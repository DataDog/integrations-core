id: sophos-central-cloud
tests:
  - sample: |-
      {
              "log_message": {
                  "created_at": "2024-06-20T09:12:22.091Z",
                  "source_info": {
                      "ip": "172.217.0.101"
                  },
                  "customer_id": "10803332-7bfd-4d55-8840-a9361eab0040",
                  "severity": "medium",
                  "endpoint_id": "63e2361c-7ab7-427a-b1d2-6069a34302a6",
                  "endpoint_type": "computer",
                  "user_id": "666abf8090d89a2d91cc5c7e",
                  "when": "2024-06-20T09:12:15.000Z",
                  "source": "ASSETTAG-EID\\Test",
                  "type": "Event::Endpoint::SavScanComplete",
                  "name": "Scan 'User Initiated Scan' completed",
                  "location": "AssetTag-EID",
                  "threat": "Unknown Threat",
                  "id": "28cd46c4-8075-45bb-bf73-7e43384344a9",
                  "group": "PROTECTION",
                  "ips_threat_data": {
                      "detectionType": 1,
                      "executableName": "malicious.exe",
                      "executablePath": "C:\\Windows\\System32\\malicious.exe",
                      "executablePid": "1234",
                      "executableVersion": "1.0.0.0",
                      "localPort": "8080",
                      "rawData": "This is raw data",
                      "remoteIp": "172.217.0.100",
                      "remotePort": "80",
                      "techSupportId": "123456789"
                  }
              },
              "endpoint_details": {
                  "id": "63e2361c-7ab7-427a-b1d2-6069a34302a6",
                  "hostname": "AssetTag-EID",
                  "health": {
                      "overall": "good",
                      "threats": {
                          "status": "good"
                      },
                      "services": {
                          "status": "good",
                          "serviceDetails": [
                              {
                                  "name": "HitmanPro.Alert service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Endpoint Defense",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Endpoint Defense Service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos File Scanner",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos File Scanner Service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos MCS Agent",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos MCS Client",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos NetFilter",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Network Threat Protection",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos System Protection Service",
                                  "status": "running"
                              }
                          ]
                      }
                  },
                  "os": {
                      "isServer": false,
                      "platform": "windows",
                      "name": "Windows 11 Pro",
                      "majorVersion": 11,
                      "minorVersion": 0,
                      "build": 22631
                  },
                  "tamperProtectionEnabled": true,
                  "isolation": {
                      "status": "notIsolated",
                      "adminIsolated": false,
                      "selfIsolated": false,
                      "behaviorallyIsolated": false
                  },
                  "lockdown": {
                      "status": "notInstalled",
                      "updateStatus": "notInstalled"
                  }
              }
          }
    result: null
  - sample: |-
      {
              "log_message": {
                  "javaUUID": "d6f23593-448d-74d4-bb06-2c88e6703c8a",
                  "data": {
                      "created_at": 1718358456463,
                      "endpoint_id": "37f42f12-068c-4fed-8480-3b24051e8ae2",
                      "endpoint_java_id": "37f42f12-068c-4fed-8480-3b24051e8ae2",
                      "endpoint_platform": "mac",
                      "endpoint_type": "computer",
                      "event_service_id": {
                          "type": 3,
                          "data": "bS9TOUTYR027YMKIbgfDqA=="
                      },
                      "inserted_at": 1718358456463,
                      "source_info": {
                          "ip": "172.217.0.101"
                      },
                      "threat_id": {
                          "timestamp": 1718358455,
                          "date": 1718358455000
                      },
                      "threat_status": "CLEANUPABLE",
                      "uriId": "150413515",
                      "user_match_id": {
                          "timestamp": 1718358455,
                          "date": 1718358455000
                      },
                      "user_match_uuid": {
                          "type": 3,
                          "data": "gTEb0gwCQ8ijentX0by4Kw=="
                      }
                  },
                  "type": "Event::Endpoint::Threat::CommandAndControlDetected",
                  "description": "Malicious connection detected: 'C2/Generic-A' at '/Library/Apple/System/Library/StagedFrameworks/Safari/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.Networking.xpc/Contents/MacOS/com.apple.WebKit.Networking' (Technical Support reference: 150413515)",
                  "severity": "high",
                  "actionable": false,
                  "customer_id": "10803332-7bfd-4d55-8840-a9361eab0040",
                  "created_at": "2024-06-14T09:47:36.491Z",
                  "threat": "C2/Generic-A",
                  "threat_cleanable": true,
                  "event_service_event_id": "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
                  "when": "2024-06-14T09:47:31.000Z",
                  "location": "Testing-Netskope",
                  "id": "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
                  "source": "WORKGROUP\\it"
              },
              "endpoint_details": {
                  "id": "37f42f12-068c-4fed-8480-3b24051e8ae2",
                  "hostname": "Testing-Netskope",
                  "health": {
                      "overall": "suspicious",
                      "threats": {
                          "status": "suspicious"
                      },
                      "services": {
                          "status": "good",
                          "serviceDetails": [
                              {
                                  "name": "HitmanPro.Alert service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Endpoint Defense",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Endpoint Defense Service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos File Scanner",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos File Scanner Service",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos MCS Agent",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos MCS Client",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos NetFilter",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos Network Threat Protection",
                                  "status": "running"
                              },
                              {
                                  "name": "Sophos System Protection Service",
                                  "status": "running"
                              }
                          ]
                      }
                  },
                  "os": {
                      "isServer": true,
                      "platform": "windows",
                      "name": "Windows Server 2019 Standard Evaluation",
                      "majorVersion": 10,
                      "minorVersion": 0,
                      "build": 17763
                  },
                  "tamperProtectionEnabled": false,
                  "isolation": {
                      "status": "notIsolated",
                      "adminIsolated": false,
                      "selfIsolated": false,
                      "behaviorallyIsolated": false
                  },
                  "lockdown": {
                      "status": "notInstalled",
                      "updateStatus": "notInstalled"
                  }
              }
          }
    result: null
