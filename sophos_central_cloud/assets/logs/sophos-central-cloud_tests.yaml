id: sophos-central-cloud
tests:
  - 
    sample: |-
      {
        "log_message" : {
          "severity" : "medium",
          "created_at" : "2024-06-20T09:12:22.091Z",
          "endpoint_id" : "63e2361c-7ab7-427a-b1d2-6069a34302a6",
          "source" : "ASSETTAG-EID\\Test",
          "type" : "Event::Endpoint::SavScanComplete",
          "when" : "2024-06-20T09:12:15.000Z",
          "endpoint_type" : "computer",
          "ips_threat_data" : {
            "detectionType" : 1,
            "remoteIp" : "172.217.0.100",
            "executablePath" : "C:\\Windows\\System32\\malicious.exe",
            "localPort" : "8080",
            "techSupportId" : "123456789",
            "remotePort" : "80",
            "rawData" : "This is raw data",
            "executableVersion" : "1.0.0.0",
            "executablePid" : "1234",
            "executableName" : "malicious.exe"
          },
          "user_id" : "666abf8090d89a2d91cc5c7e",
          "name" : "Scan 'User Initiated Scan' completed",
          "location" : "AssetTag-EID",
          "threat" : "Unknown Threat",
          "id" : "28cd46c4-8075-45bb-bf73-7e43384344a9",
          "customer_id" : "10803332-7bfd-4d55-8840-a9361eab0040",
          "source_info" : {
            "ip" : "172.217.0.101"
          },
          "group" : "PROTECTION"
        },
        "endpoint_details" : {
          "hostname" : "AssetTag-EID",
          "tamperProtectionEnabled" : true,
          "os" : {
            "isServer" : false,
            "build" : 22631,
            "name" : "Windows 11 Pro",
            "majorVersion" : 11,
            "minorVersion" : 0,
            "platform" : "windows"
          },
          "lockdown" : {
            "updateStatus" : "notInstalled",
            "status" : "notInstalled"
          },
          "health" : {
            "overall" : "good",
            "threats" : {
              "status" : "good"
            },
            "services" : {
              "serviceDetails" : [ {
                "name" : "HitmanPro.Alert service",
                "status" : "running"
              }, {
                "name" : "Sophos Endpoint Defense",
                "status" : "running"
              }, {
                "name" : "Sophos Endpoint Defense Service",
                "status" : "running"
              }, {
                "name" : "Sophos File Scanner",
                "status" : "running"
              }, {
                "name" : "Sophos File Scanner Service",
                "status" : "running"
              }, {
                "name" : "Sophos MCS Agent",
                "status" : "running"
              }, {
                "name" : "Sophos MCS Client",
                "status" : "running"
              }, {
                "name" : "Sophos NetFilter",
                "status" : "running"
              }, {
                "name" : "Sophos Network Threat Protection",
                "status" : "running"
              }, {
                "name" : "Sophos System Protection Service",
                "status" : "running"
              } ],
              "status" : "good"
            }
          },
          "isolation" : {
            "behaviorallyIsolated" : false,
            "adminIsolated" : false,
            "selfIsolated" : false,
            "status" : "notIsolated"
          },
          "id" : "63e2361c-7ab7-427a-b1d2-6069a34302a6"
        }
      }
    result:
      custom:
        endpoint_details:
          health:
            overall: "good"
            services:
              serviceDetails:
              -
                name: "HitmanPro.Alert service"
                status: "running"
              -
                name: "Sophos Endpoint Defense"
                status: "running"
              -
                name: "Sophos Endpoint Defense Service"
                status: "running"
              -
                name: "Sophos File Scanner"
                status: "running"
              -
                name: "Sophos File Scanner Service"
                status: "running"
              -
                name: "Sophos MCS Agent"
                status: "running"
              -
                name: "Sophos MCS Client"
                status: "running"
              -
                name: "Sophos NetFilter"
                status: "running"
              -
                name: "Sophos Network Threat Protection"
                status: "running"
              -
                name: "Sophos System Protection Service"
                status: "running"
              status: "good"
            threats:
              status: "good"
          hostname: "AssetTag-EID"
          id: "63e2361c-7ab7-427a-b1d2-6069a34302a6"
          isolation:
            adminIsolated: false
            behaviorallyIsolated: false
            selfIsolated: false
            status: "notIsolated"
          lockdown:
            status: "notInstalled"
            updateStatus: "notInstalled"
          os:
            build: 22631
            isServer: false
            majorVersion: 11
            minorVersion: 0
            name: "Windows 11 Pro"
            platform: "windows"
          tamperProtectionEnabled: true
        log_message:
          created_at: "2024-06-20T09:12:22.091Z"
          customer_id: "10803332-7bfd-4d55-8840-a9361eab0040"
          endpoint_id: "63e2361c-7ab7-427a-b1d2-6069a34302a6"
          endpoint_type: "computer"
          group: "PROTECTION"
          id: "28cd46c4-8075-45bb-bf73-7e43384344a9"
          ips_threat_data:
            detectionType: 1
            executableName: "malicious.exe"
            executablePath: "C:\\Windows\\System32\\malicious.exe"
            executablePid: "1234"
            executableVersion: "1.0.0.0"
            localPort: "8080"
            rawData: "This is raw data"
            remoteIp: "172.217.0.100"
            remotePort: "80"
            techSupportId: "123456789"
          location: "AssetTag-EID"
          name: "Scan 'User Initiated Scan' completed"
          severity: "medium"
          source: "ASSETTAG-EID\\Test"
          source_info:
            ip: "172.217.0.101"
          threat: "Unknown Threat"
          type: "Event::Endpoint::SavScanComplete"
          user_id: "666abf8090d89a2d91cc5c7e"
          when: "2024-06-20T09:12:15.000Z"
      message: |-
        {
          "log_message" : {
            "severity" : "medium",
            "created_at" : "2024-06-20T09:12:22.091Z",
            "endpoint_id" : "63e2361c-7ab7-427a-b1d2-6069a34302a6",
            "source" : "ASSETTAG-EID\\Test",
            "type" : "Event::Endpoint::SavScanComplete",
            "when" : "2024-06-20T09:12:15.000Z",
            "endpoint_type" : "computer",
            "ips_threat_data" : {
              "detectionType" : 1,
              "remoteIp" : "172.217.0.100",
              "executablePath" : "C:\\Windows\\System32\\malicious.exe",
              "localPort" : "8080",
              "techSupportId" : "123456789",
              "remotePort" : "80",
              "rawData" : "This is raw data",
              "executableVersion" : "1.0.0.0",
              "executablePid" : "1234",
              "executableName" : "malicious.exe"
            },
            "user_id" : "666abf8090d89a2d91cc5c7e",
            "name" : "Scan 'User Initiated Scan' completed",
            "location" : "AssetTag-EID",
            "threat" : "Unknown Threat",
            "id" : "28cd46c4-8075-45bb-bf73-7e43384344a9",
            "customer_id" : "10803332-7bfd-4d55-8840-a9361eab0040",
            "source_info" : {
              "ip" : "172.217.0.101"
            },
            "group" : "PROTECTION"
          },
          "endpoint_details" : {
            "hostname" : "AssetTag-EID",
            "tamperProtectionEnabled" : true,
            "os" : {
              "isServer" : false,
              "build" : 22631,
              "name" : "Windows 11 Pro",
              "majorVersion" : 11,
              "minorVersion" : 0,
              "platform" : "windows"
            },
            "lockdown" : {
              "updateStatus" : "notInstalled",
              "status" : "notInstalled"
            },
            "health" : {
              "overall" : "good",
              "threats" : {
                "status" : "good"
              },
              "services" : {
                "serviceDetails" : [ {
                  "name" : "HitmanPro.Alert service",
                  "status" : "running"
                }, {
                  "name" : "Sophos Endpoint Defense",
                  "status" : "running"
                }, {
                  "name" : "Sophos Endpoint Defense Service",
                  "status" : "running"
                }, {
                  "name" : "Sophos File Scanner",
                  "status" : "running"
                }, {
                  "name" : "Sophos File Scanner Service",
                  "status" : "running"
                }, {
                  "name" : "Sophos MCS Agent",
                  "status" : "running"
                }, {
                  "name" : "Sophos MCS Client",
                  "status" : "running"
                }, {
                  "name" : "Sophos NetFilter",
                  "status" : "running"
                }, {
                  "name" : "Sophos Network Threat Protection",
                  "status" : "running"
                }, {
                  "name" : "Sophos System Protection Service",
                  "status" : "running"
                } ],
                "status" : "good"
              }
            },
            "isolation" : {
              "behaviorallyIsolated" : false,
              "adminIsolated" : false,
              "selfIsolated" : false,
              "status" : "notIsolated"
            },
            "id" : "63e2361c-7ab7-427a-b1d2-6069a34302a6"
          }
        }
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1718874742091
  - 
    sample: |-
      {
        "log_message" : {
          "severity" : "high",
          "data" : {
            "uriId" : "150413515",
            "event_service_id" : {
              "data" : "bS9TOUTYR027YMKIbgfDqA==",
              "type" : 3
            },
            "created_at" : 1718358456463,
            "endpoint_id" : "37f42f12-068c-4fed-8480-3b24051e8ae2",
            "threat_id" : {
              "date" : 1718358455000,
              "timestamp" : 1718358455
            },
            "endpoint_java_id" : "37f42f12-068c-4fed-8480-3b24051e8ae2",
            "user_match_uuid" : {
              "data" : "gTEb0gwCQ8ijentX0by4Kw==",
              "type" : 3
            },
            "endpoint_type" : "computer",
            "endpoint_platform" : "mac",
            "threat_status" : "CLEANUPABLE",
            "user_match_id" : {
              "date" : 1718358455000,
              "timestamp" : 1718358455
            },
            "inserted_at" : 1718358456463,
            "source_info" : {
              "ip" : "172.217.0.101"
            }
          },
          "description" : "Malicious connection detected: 'C2/Generic-A' at '/Library/Apple/System/Library/StagedFrameworks/Safari/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.Networking.xpc/Contents/MacOS/com.apple.WebKit.Networking' (Technical Support reference: 150413515)",
          "created_at" : "2024-06-14T09:47:36.491Z",
          "source" : "WORKGROUP\\it",
          "type" : "Event::Endpoint::Threat::CommandAndControlDetected",
          "when" : "2024-06-14T09:47:31.000Z",
          "javaUUID" : "d6f23593-448d-74d4-bb06-2c88e6703c8a",
          "threat_cleanable" : true,
          "actionable" : false,
          "event_service_event_id" : "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
          "location" : "Testing-Netskope",
          "threat" : "C2/Generic-A",
          "id" : "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
          "customer_id" : "10803332-7bfd-4d55-8840-a9361eab0040"
        },
        "endpoint_details" : {
          "hostname" : "Testing-Netskope",
          "tamperProtectionEnabled" : false,
          "os" : {
            "isServer" : true,
            "build" : 17763,
            "name" : "Windows Server 2019 Standard Evaluation",
            "majorVersion" : 10,
            "minorVersion" : 0,
            "platform" : "windows"
          },
          "lockdown" : {
            "updateStatus" : "notInstalled",
            "status" : "notInstalled"
          },
          "health" : {
            "overall" : "suspicious",
            "threats" : {
              "status" : "suspicious"
            },
            "services" : {
              "serviceDetails" : [ {
                "name" : "HitmanPro.Alert service",
                "status" : "running"
              }, {
                "name" : "Sophos Endpoint Defense",
                "status" : "running"
              }, {
                "name" : "Sophos Endpoint Defense Service",
                "status" : "running"
              }, {
                "name" : "Sophos File Scanner",
                "status" : "running"
              }, {
                "name" : "Sophos File Scanner Service",
                "status" : "running"
              }, {
                "name" : "Sophos MCS Agent",
                "status" : "running"
              }, {
                "name" : "Sophos MCS Client",
                "status" : "running"
              }, {
                "name" : "Sophos NetFilter",
                "status" : "running"
              }, {
                "name" : "Sophos Network Threat Protection",
                "status" : "running"
              }, {
                "name" : "Sophos System Protection Service",
                "status" : "running"
              } ],
              "status" : "good"
            }
          },
          "isolation" : {
            "behaviorallyIsolated" : false,
            "adminIsolated" : false,
            "selfIsolated" : false,
            "status" : "notIsolated"
          },
          "id" : "37f42f12-068c-4fed-8480-3b24051e8ae2"
        }
      }
    result:
      custom:
        endpoint_details:
          health:
            overall: "suspicious"
            services:
              serviceDetails:
              -
                name: "HitmanPro.Alert service"
                status: "running"
              -
                name: "Sophos Endpoint Defense"
                status: "running"
              -
                name: "Sophos Endpoint Defense Service"
                status: "running"
              -
                name: "Sophos File Scanner"
                status: "running"
              -
                name: "Sophos File Scanner Service"
                status: "running"
              -
                name: "Sophos MCS Agent"
                status: "running"
              -
                name: "Sophos MCS Client"
                status: "running"
              -
                name: "Sophos NetFilter"
                status: "running"
              -
                name: "Sophos Network Threat Protection"
                status: "running"
              -
                name: "Sophos System Protection Service"
                status: "running"
              status: "good"
            threats:
              status: "suspicious"
          hostname: "Testing-Netskope"
          id: "37f42f12-068c-4fed-8480-3b24051e8ae2"
          isolation:
            adminIsolated: false
            behaviorallyIsolated: false
            selfIsolated: false
            status: "notIsolated"
          lockdown:
            status: "notInstalled"
            updateStatus: "notInstalled"
          os:
            build: 17763
            isServer: true
            majorVersion: 10
            minorVersion: 0
            name: "Windows Server 2019 Standard Evaluation"
            platform: "windows"
          tamperProtectionEnabled: false
        log_message:
          actionable: false
          created_at: "2024-06-14T09:47:36.491Z"
          customer_id: "10803332-7bfd-4d55-8840-a9361eab0040"
          data:
            created_at: 1718358456463
            endpoint_id: "37f42f12-068c-4fed-8480-3b24051e8ae2"
            endpoint_java_id: "37f42f12-068c-4fed-8480-3b24051e8ae2"
            endpoint_platform: "mac"
            endpoint_type: "computer"
            event_service_id:
              data: "bS9TOUTYR027YMKIbgfDqA=="
              type: 3
            inserted_at: 1718358456463
            source_info:
              ip: "172.217.0.101"
            threat_id:
              date: 1718358455000
              timestamp: 1718358455
            threat_status: "CLEANUPABLE"
            uriId: "150413515"
            user_match_id:
              date: 1718358455000
              timestamp: 1718358455
            user_match_uuid:
              data: "gTEb0gwCQ8ijentX0by4Kw=="
              type: 3
          description: "Malicious connection detected: 'C2/Generic-A' at '/Library/Apple/System/Library/StagedFrameworks/Safari/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.Networking.xpc/Contents/MacOS/com.apple.WebKit.Networking' (Technical Support reference: 150413515)"
          event_service_event_id: "6d2f5339-44d8-474d-bb60-c2886e07c3a8"
          id: "6d2f5339-44d8-474d-bb60-c2886e07c3a8"
          javaUUID: "d6f23593-448d-74d4-bb06-2c88e6703c8a"
          location: "Testing-Netskope"
          severity: "high"
          source: "WORKGROUP\\it"
          threat: "C2/Generic-A"
          threat_cleanable: true
          type: "Event::Endpoint::Threat::CommandAndControlDetected"
          when: "2024-06-14T09:47:31.000Z"
      message: |-
        {
          "log_message" : {
            "severity" : "high",
            "data" : {
              "uriId" : "150413515",
              "event_service_id" : {
                "data" : "bS9TOUTYR027YMKIbgfDqA==",
                "type" : 3
              },
              "created_at" : 1718358456463,
              "endpoint_id" : "37f42f12-068c-4fed-8480-3b24051e8ae2",
              "threat_id" : {
                "date" : 1718358455000,
                "timestamp" : 1718358455
              },
              "endpoint_java_id" : "37f42f12-068c-4fed-8480-3b24051e8ae2",
              "user_match_uuid" : {
                "data" : "gTEb0gwCQ8ijentX0by4Kw==",
                "type" : 3
              },
              "endpoint_type" : "computer",
              "endpoint_platform" : "mac",
              "threat_status" : "CLEANUPABLE",
              "user_match_id" : {
                "date" : 1718358455000,
                "timestamp" : 1718358455
              },
              "inserted_at" : 1718358456463,
              "source_info" : {
                "ip" : "172.217.0.101"
              }
            },
            "description" : "Malicious connection detected: 'C2/Generic-A' at '/Library/Apple/System/Library/StagedFrameworks/Safari/WebKit.framework/Versions/A/XPCServices/com.apple.WebKit.Networking.xpc/Contents/MacOS/com.apple.WebKit.Networking' (Technical Support reference: 150413515)",
            "created_at" : "2024-06-14T09:47:36.491Z",
            "source" : "WORKGROUP\\it",
            "type" : "Event::Endpoint::Threat::CommandAndControlDetected",
            "when" : "2024-06-14T09:47:31.000Z",
            "javaUUID" : "d6f23593-448d-74d4-bb06-2c88e6703c8a",
            "threat_cleanable" : true,
            "actionable" : false,
            "event_service_event_id" : "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
            "location" : "Testing-Netskope",
            "threat" : "C2/Generic-A",
            "id" : "6d2f5339-44d8-474d-bb60-c2886e07c3a8",
            "customer_id" : "10803332-7bfd-4d55-8840-a9361eab0040"
          },
          "endpoint_details" : {
            "hostname" : "Testing-Netskope",
            "tamperProtectionEnabled" : false,
            "os" : {
              "isServer" : true,
              "build" : 17763,
              "name" : "Windows Server 2019 Standard Evaluation",
              "majorVersion" : 10,
              "minorVersion" : 0,
              "platform" : "windows"
            },
            "lockdown" : {
              "updateStatus" : "notInstalled",
              "status" : "notInstalled"
            },
            "health" : {
              "overall" : "suspicious",
              "threats" : {
                "status" : "suspicious"
              },
              "services" : {
                "serviceDetails" : [ {
                  "name" : "HitmanPro.Alert service",
                  "status" : "running"
                }, {
                  "name" : "Sophos Endpoint Defense",
                  "status" : "running"
                }, {
                  "name" : "Sophos Endpoint Defense Service",
                  "status" : "running"
                }, {
                  "name" : "Sophos File Scanner",
                  "status" : "running"
                }, {
                  "name" : "Sophos File Scanner Service",
                  "status" : "running"
                }, {
                  "name" : "Sophos MCS Agent",
                  "status" : "running"
                }, {
                  "name" : "Sophos MCS Client",
                  "status" : "running"
                }, {
                  "name" : "Sophos NetFilter",
                  "status" : "running"
                }, {
                  "name" : "Sophos Network Threat Protection",
                  "status" : "running"
                }, {
                  "name" : "Sophos System Protection Service",
                  "status" : "running"
                } ],
                "status" : "good"
              }
            },
            "isolation" : {
              "behaviorallyIsolated" : false,
              "adminIsolated" : false,
              "selfIsolated" : false,
              "status" : "notIsolated"
            },
            "id" : "37f42f12-068c-4fed-8480-3b24051e8ae2"
          }
        }
      tags:
      - "source:LOGS_SOURCE"
      timestamp: 1718358456491